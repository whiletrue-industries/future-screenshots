import{$ as Yr,$a as Wa,A as Eo,Aa as S,Ab as rt,B as gr,Ba as te,Bb as Bs,C as Xt,Ca as ve,Cb as Hi,D as Nt,Da as be,Db as On,E as Oo,Ea as Z,Eb as j0,F as $n,Fa as j,Fb as $0,G as Cc,Ga as C0,Gb as Tn,H as st,Ha as rp,Hb as U0,I as p0,Ia as Pt,Ib as H0,J as tn,Ja as wt,Jb as Oc,K as bc,Ka as Mt,Kb as Tc,L as Qt,La as $i,Lb as kc,M as zt,Ma as N,Mb as W0,N as To,Na as Ve,Nb as on,O as xc,Oa as vt,Ob as kn,P as f0,Pa as Sc,Pb as G0,Q as Pc,Qa as Qe,Qb as pw,R as ip,Ra as et,S as g0,Sa as tt,T as X,Ta as b0,U as q,Ua as x0,V as ke,Va as P0,W as Ye,Wa as yt,X as Wr,Xa as op,Y as ii,Ya as Ha,Z as wc,Za as w0,_ as Gr,_a as M0,a as D,aa as Xr,ab as S0,b as se,ba as nn,bb as Ec,c as lt,ca as Ns,cb as sp,d as s0,da as G,e as a0,ea as m0,eb as _e,f as Mo,fa as _0,fb as at,g as J,ga as Mc,gb as E0,h as Ur,ha as Ue,hb as O0,i as En,ib as ri,j as So,ja as v0,jb as T0,k as l0,ka as I,kb as k0,l as c0,la as ue,lb as Ui,m as h0,ma as Me,mb as I0,n as yc,na as y0,nb as A0,o as Qu,oa as ge,ob as F0,p as ep,pa as ct,pb as R0,q as Ua,qa as K,qb as L0,r as tp,ra as Et,rb as D0,s as d0,sa as Se,sb as Ct,t as Jt,ta as mr,tb as N0,u as u0,ua as he,ub as gt,v as Hr,va as jt,vb as rn,w as jn,wa as ji,wb as B0,x as Ds,xa as ze,xb as V0,y as np,ya as je,yb as z0,z as Vt,za as P,zb as it}from"./chunk-NWR7T6GD.js";var Yy=s0((exports,module)=>{"use strict";typeof document<"u"&&typeof navigator<"u"&&function(n,e){typeof exports=="object"&&typeof module<"u"?module.exports=e():typeof define=="function"&&define.amd?define(e):(n=typeof globalThis<"u"?globalThis:n||self,n.lottie=e());}(exports,function(){"use strict";var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(e){_useWebWorker=!!e;},getWebWorker=function(){return _useWebWorker;},setLocationHref=function(e){locationHref=e;},getLocationHref=function(){return locationHref;};function createTag(n){return document.createElement(n);}function extendPrototype(n,e){var t,i=n.length,r;for(t=0;t<i;t+=1){r=n[t].prototype;for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e.prototype[o]=r[o]);}}function getDescriptor(n,e){return Object.getOwnPropertyDescriptor(n,e);}function createProxyFunction(n){function e(){}return e.prototype=n,e;}var audioControllerFactory=function(){function n(e){this.audios=[],this.audioFactory=e,this._volume=1,this._isMuted=!1;}return n.prototype={addAudio:function(t){this.audios.push(t);},pause:function(){var t,i=this.audios.length;for(t=0;t<i;t+=1)this.audios[t].pause();},resume:function(){var t,i=this.audios.length;for(t=0;t<i;t+=1)this.audios[t].resume();},setRate:function(t){var i,r=this.audios.length;for(i=0;i<r;i+=1)this.audios[i].setRate(t);},createAudio:function(t){return this.audioFactory?this.audioFactory(t):window.Howl?new window.Howl({src:[t]}):{isPlaying:!1,play:function(){this.isPlaying=!0;},seek:function(){this.isPlaying=!1;},playing:function(){},rate:function(){},setVolume:function(){}};},setAudioFactory:function(t){this.audioFactory=t;},setVolume:function(t){this._volume=t,this._updateVolume();},mute:function(){this._isMuted=!0,this._updateVolume();},unmute:function(){this._isMuted=!1,this._updateVolume();},getVolume:function(){return this._volume;},_updateVolume:function(){var t,i=this.audios.length;for(t=0;t<i;t+=1)this.audios[t].volume(this._volume*(this._isMuted?0:1));}},function(){return new n();};}(),createTypedArray=function(){function n(t,i){var r=0,o=[],s;switch(t){case"int16":case"uint8c":s=1;break;default:s=1.1;break;}for(r=0;r<i;r+=1)o.push(s);return o;}function e(t,i){return t==="float32"?new Float32Array(i):t==="int16"?new Int16Array(i):t==="uint8c"?new Uint8ClampedArray(i):n(t,i);}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?e:n;}();function createSizedArray(n){return Array.apply(null,{length:n});}function _typeof$6(n){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e;}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_typeof$6(n);}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),_shouldRoundValues=!1,bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var n=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],e,t=n.length;for(e=0;e<t;e+=1)BMMath[n[e]]=Math[n[e]];})();function ProjectInterface$1(){return{};}BMMath.random=Math.random,BMMath.abs=function(n){var e=_typeof$6(n);if(e==="object"&&n.length){var t=createSizedArray(n.length),i,r=n.length;for(i=0;i<r;i+=1)t[i]=Math.abs(n[i]);return t;}return Math.abs(n);};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function roundValues(n){_shouldRoundValues=!!n;}function bmRnd(n){return _shouldRoundValues?Math.round(n):n;}function styleDiv(n){n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.display="block",n.style.transformOrigin="0 0",n.style.webkitTransformOrigin="0 0",n.style.backfaceVisibility="visible",n.style.webkitBackfaceVisibility="visible",n.style.transformStyle="preserve-3d",n.style.webkitTransformStyle="preserve-3d",n.style.mozTransformStyle="preserve-3d";}function BMEnterFrameEvent(n,e,t,i){this.type=n,this.currentTime=e,this.totalTime=t,this.direction=i<0?-1:1;}function BMCompleteEvent(n,e){this.type=n,this.direction=e<0?-1:1;}function BMCompleteLoopEvent(n,e,t,i){this.type=n,this.currentLoop=t,this.totalLoops=e,this.direction=i<0?-1:1;}function BMSegmentStartEvent(n,e,t){this.type=n,this.firstFrame=e,this.totalFrames=t;}function BMDestroyEvent(n,e){this.type=n,this.target=e;}function BMRenderFrameErrorEvent(n,e){this.type="renderFrameError",this.nativeError=n,this.currentTime=e;}function BMConfigErrorEvent(n){this.type="configError",this.nativeError=n;}function BMAnimationConfigErrorEvent(n,e){this.type=n,this.nativeError=e;}var createElementID=function(){var n=0;return function(){return n+=1,idPrefix$1+"__lottie_element_"+n;};}();function HSVtoRGB(n,e,t){var i,r,o,s,l,c,d,u;switch(s=Math.floor(n*6),l=n*6-s,c=t*(1-e),d=t*(1-l*e),u=t*(1-(1-l)*e),s%6){case 0:i=t,r=u,o=c;break;case 1:i=d,r=t,o=c;break;case 2:i=c,r=t,o=u;break;case 3:i=c,r=d,o=t;break;case 4:i=u,r=c,o=t;break;case 5:i=t,r=c,o=d;break;default:break;}return[i,r,o];}function RGBtoHSV(n,e,t){var i=Math.max(n,e,t),r=Math.min(n,e,t),o=i-r,s,l=i===0?0:o/i,c=i/255;switch(i){case r:s=0;break;case n:s=e-t+o*(e<t?6:0),s/=6*o;break;case e:s=t-n+o*2,s/=6*o;break;case t:s=n-e+o*4,s/=6*o;break;default:break;}return[s,l,c];}function addSaturationToRGB(n,e){var t=RGBtoHSV(n[0]*255,n[1]*255,n[2]*255);return t[1]+=e,t[1]>1?t[1]=1:t[1]<=0&&(t[1]=0),HSVtoRGB(t[0],t[1],t[2]);}function addBrightnessToRGB(n,e){var t=RGBtoHSV(n[0]*255,n[1]*255,n[2]*255);return t[2]+=e,t[2]>1?t[2]=1:t[2]<0&&(t[2]=0),HSVtoRGB(t[0],t[1],t[2]);}function addHueToRGB(n,e){var t=RGBtoHSV(n[0]*255,n[1]*255,n[2]*255);return t[0]+=e/360,t[0]>1?t[0]-=1:t[0]<0&&(t[0]+=1),HSVtoRGB(t[0],t[1],t[2]);}var rgbToHex=function(){var n=[],e,t;for(e=0;e<256;e+=1)t=e.toString(16),n[e]=t.length===1?"0"+t:t;return function(i,r,o){return i<0&&(i=0),r<0&&(r=0),o<0&&(o=0),"#"+n[i]+n[r]+n[o];};}(),setSubframeEnabled=function(e){subframeEnabled=!!e;},getSubframeEnabled=function(){return subframeEnabled;},setExpressionsPlugin=function(e){expressionsPlugin=e;},getExpressionsPlugin=function(){return expressionsPlugin;},setExpressionInterfaces=function(e){expressionsInterfaces=e;},getExpressionInterfaces=function(){return expressionsInterfaces;},setDefaultCurveSegments=function(e){defaultCurveSegments=e;},getDefaultCurveSegments=function(){return defaultCurveSegments;},setIdPrefix=function(e){idPrefix$1=e;},getIdPrefix=function(){return idPrefix$1;};function createNS(n){return document.createElementNS(svgNS,n);}function _typeof$5(n){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e;}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_typeof$5(n);}var dataManager=function(){var n=1,e=[],t,i,r={onmessage:function(){},postMessage:function(m){t({data:m});}},o={postMessage:function(m){r.onmessage({data:m});}};function s(f){if(window.Worker&&window.Blob&&getWebWorker()){var m=new Blob(["var _workerSelf = self; self.onmessage = ",f.toString()],{type:"text/javascript"}),_=URL.createObjectURL(m);return new Worker(_);}return t=f,r;}function l(){i||(i=s(function(m){function _(){function E(re,A){var z,O,k=re.length,H,U,pe,me;for(O=0;O<k;O+=1)if(z=re[O],"ks"in z&&!z.completed){if(z.completed=!0,z.hasMask){var fe=z.masksProperties;for(U=fe.length,H=0;H<U;H+=1)if(fe[H].pt.k.i)T(fe[H].pt.k);else for(me=fe[H].pt.k.length,pe=0;pe<me;pe+=1)fe[H].pt.k[pe].s&&T(fe[H].pt.k[pe].s[0]),fe[H].pt.k[pe].e&&T(fe[H].pt.k[pe].e[0]);}z.ty===0?(z.layers=x(z.refId,A),E(z.layers,A)):z.ty===4?w(z.shapes):z.ty===5&&ce(z);}}function C(re,A){if(re){var z=0,O=re.length;for(z=0;z<O;z+=1)re[z].t===1&&(re[z].data.layers=x(re[z].data.refId,A),E(re[z].data.layers,A));}}function b(re,A){for(var z=0,O=A.length;z<O;){if(A[z].id===re)return A[z];z+=1;}return null;}function x(re,A){var z=b(re,A);return z?z.layers.__used?JSON.parse(JSON.stringify(z.layers)):(z.layers.__used=!0,z.layers):null;}function w(re){var A,z=re.length,O,k;for(A=z-1;A>=0;A-=1)if(re[A].ty==="sh"){if(re[A].ks.k.i)T(re[A].ks.k);else for(k=re[A].ks.k.length,O=0;O<k;O+=1)re[A].ks.k[O].s&&T(re[A].ks.k[O].s[0]),re[A].ks.k[O].e&&T(re[A].ks.k[O].e[0]);}else re[A].ty==="gr"&&w(re[A].it);}function T(re){var A,z=re.i.length;for(A=0;A<z;A+=1)re.i[A][0]+=re.v[A][0],re.i[A][1]+=re.v[A][1],re.o[A][0]+=re.v[A][0],re.o[A][1]+=re.v[A][1];}function R(re,A){var z=A?A.split("."):[100,100,100];return re[0]>z[0]?!0:z[0]>re[0]?!1:re[1]>z[1]?!0:z[1]>re[1]?!1:re[2]>z[2]?!0:z[2]>re[2]?!1:null;}var V=function(){var re=[4,4,14];function A(O){var k=O.t.d;O.t.d={k:[{s:k,t:0}]};}function z(O){var k,H=O.length;for(k=0;k<H;k+=1)O[k].ty===5&&A(O[k]);}return function(O){if(R(re,O.v)&&(z(O.layers),O.assets)){var k,H=O.assets.length;for(k=0;k<H;k+=1)O.assets[k].layers&&z(O.assets[k].layers);}};}(),B=function(){var re=[4,7,99];return function(A){if(A.chars&&!R(re,A.v)){var z,O=A.chars.length;for(z=0;z<O;z+=1){var k=A.chars[z];k.data&&k.data.shapes&&(w(k.data.shapes),k.data.ip=0,k.data.op=99999,k.data.st=0,k.data.sr=1,k.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},A.chars[z].t||(k.data.shapes.push({ty:"no"}),k.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})));}}};}(),Y=function(){var re=[5,7,15];function A(O){var k=O.t.p;typeof k.a=="number"&&(k.a={a:0,k:k.a}),typeof k.p=="number"&&(k.p={a:0,k:k.p}),typeof k.r=="number"&&(k.r={a:0,k:k.r});}function z(O){var k,H=O.length;for(k=0;k<H;k+=1)O[k].ty===5&&A(O[k]);}return function(O){if(R(re,O.v)&&(z(O.layers),O.assets)){var k,H=O.assets.length;for(k=0;k<H;k+=1)O.assets[k].layers&&z(O.assets[k].layers);}};}(),le=function(){var re=[4,1,9];function A(O){var k,H=O.length,U,pe;for(k=0;k<H;k+=1)if(O[k].ty==="gr")A(O[k].it);else if(O[k].ty==="fl"||O[k].ty==="st")if(O[k].c.k&&O[k].c.k[0].i)for(pe=O[k].c.k.length,U=0;U<pe;U+=1)O[k].c.k[U].s&&(O[k].c.k[U].s[0]/=255,O[k].c.k[U].s[1]/=255,O[k].c.k[U].s[2]/=255,O[k].c.k[U].s[3]/=255),O[k].c.k[U].e&&(O[k].c.k[U].e[0]/=255,O[k].c.k[U].e[1]/=255,O[k].c.k[U].e[2]/=255,O[k].c.k[U].e[3]/=255);else O[k].c.k[0]/=255,O[k].c.k[1]/=255,O[k].c.k[2]/=255,O[k].c.k[3]/=255;}function z(O){var k,H=O.length;for(k=0;k<H;k+=1)O[k].ty===4&&A(O[k].shapes);}return function(O){if(R(re,O.v)&&(z(O.layers),O.assets)){var k,H=O.assets.length;for(k=0;k<H;k+=1)O.assets[k].layers&&z(O.assets[k].layers);}};}(),ae=function(){var re=[4,4,18];function A(O){var k,H=O.length,U,pe;for(k=H-1;k>=0;k-=1)if(O[k].ty==="sh"){if(O[k].ks.k.i)O[k].ks.k.c=O[k].closed;else for(pe=O[k].ks.k.length,U=0;U<pe;U+=1)O[k].ks.k[U].s&&(O[k].ks.k[U].s[0].c=O[k].closed),O[k].ks.k[U].e&&(O[k].ks.k[U].e[0].c=O[k].closed);}else O[k].ty==="gr"&&A(O[k].it);}function z(O){var k,H,U=O.length,pe,me,fe,Fe;for(H=0;H<U;H+=1){if(k=O[H],k.hasMask){var Te=k.masksProperties;for(me=Te.length,pe=0;pe<me;pe+=1)if(Te[pe].pt.k.i)Te[pe].pt.k.c=Te[pe].cl;else for(Fe=Te[pe].pt.k.length,fe=0;fe<Fe;fe+=1)Te[pe].pt.k[fe].s&&(Te[pe].pt.k[fe].s[0].c=Te[pe].cl),Te[pe].pt.k[fe].e&&(Te[pe].pt.k[fe].e[0].c=Te[pe].cl);}k.ty===4&&A(k.shapes);}}return function(O){if(R(re,O.v)&&(z(O.layers),O.assets)){var k,H=O.assets.length;for(k=0;k<H;k+=1)O.assets[k].layers&&z(O.assets[k].layers);}};}();function ee(re){re.__complete||(le(re),V(re),B(re),Y(re),ae(re),E(re.layers,re.assets),C(re.chars,re.assets),re.__complete=!0);}function ce(re){re.t.a.length===0&&"m"in re.t.p;}var oe={};return oe.completeData=ee,oe.checkColors=le,oe.checkChars=B,oe.checkPathProperties=Y,oe.checkShapes=ae,oe.completeLayers=E,oe;}if(o.dataManager||(o.dataManager=_()),o.assetLoader||(o.assetLoader=function(){function E(b){var x=b.getResponseHeader("content-type");return x&&b.responseType==="json"&&x.indexOf("json")!==-1||b.response&&_typeof$5(b.response)==="object"?b.response:b.response&&typeof b.response=="string"?JSON.parse(b.response):b.responseText?JSON.parse(b.responseText):null;}function C(b,x,w,T){var R,V=new XMLHttpRequest();try{V.responseType="json";}catch{}V.onreadystatechange=function(){if(V.readyState===4)if(V.status===200)R=E(V),w(R);else try{R=E(V),w(R);}catch(B){T&&T(B);}};try{V.open(["G","E","T"].join(""),b,!0);}catch{V.open(["G","E","T"].join(""),x+"/"+b,!0);}V.send();}return{load:C};}()),m.data.type==="loadAnimation")o.assetLoader.load(m.data.path,m.data.fullPath,function(E){o.dataManager.completeData(E),o.postMessage({id:m.data.id,payload:E,status:"success"});},function(){o.postMessage({id:m.data.id,status:"error"});});else if(m.data.type==="complete"){var y=m.data.animation;o.dataManager.completeData(y),o.postMessage({id:m.data.id,payload:y,status:"success"});}else m.data.type==="loadData"&&o.assetLoader.load(m.data.path,m.data.fullPath,function(E){o.postMessage({id:m.data.id,payload:E,status:"success"});},function(){o.postMessage({id:m.data.id,status:"error"});});}),i.onmessage=function(f){var m=f.data,_=m.id,y=e[_];e[_]=null,m.status==="success"?y.onComplete(m.payload):y.onError&&y.onError();});}function c(f,m){n+=1;var _="processId_"+n;return e[_]={onComplete:f,onError:m},_;}function d(f,m,_){l();var y=c(m,_);i.postMessage({type:"loadAnimation",path:f,fullPath:window.location.origin+window.location.pathname,id:y});}function u(f,m,_){l();var y=c(m,_);i.postMessage({type:"loadData",path:f,fullPath:window.location.origin+window.location.pathname,id:y});}function g(f,m,_){l();var y=c(m,_);i.postMessage({type:"complete",animation:f,id:y});}return{loadAnimation:d,loadData:u,completeAnimation:g};}(),ImagePreloader=function(){var n=function(){var C=createTag("canvas");C.width=1,C.height=1;var b=C.getContext("2d");return b.fillStyle="rgba(0,0,0,0)",b.fillRect(0,0,1,1),C;}();function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null);}function t(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null);}function i(C,b,x){var w="";if(C.e)w=C.p;else if(b){var T=C.p;T.indexOf("images/")!==-1&&(T=T.split("/")[1]),w=b+T;}else w=x,w+=C.u?C.u:"",w+=C.p;return w;}function r(C){var b=0,x=setInterval(function(){var w=C.getBBox();(w.width||b>500)&&(this._imageLoaded(),clearInterval(x)),b+=1;}.bind(this),50);}function o(C){var b=i(C,this.assetsPath,this.path),x=createNS("image");isSafari?this.testImageLoaded(x):x.addEventListener("load",this._imageLoaded,!1),x.addEventListener("error",function(){w.img=n,this._imageLoaded();}.bind(this),!1),x.setAttributeNS("http://www.w3.org/1999/xlink","href",b),this._elementHelper.append?this._elementHelper.append(x):this._elementHelper.appendChild(x);var w={img:x,assetData:C};return w;}function s(C){var b=i(C,this.assetsPath,this.path),x=createTag("img");x.crossOrigin="anonymous",x.addEventListener("load",this._imageLoaded,!1),x.addEventListener("error",function(){w.img=n,this._imageLoaded();}.bind(this),!1),x.src=b;var w={img:x,assetData:C};return w;}function l(C){var b={assetData:C},x=i(C,this.assetsPath,this.path);return dataManager.loadData(x,function(w){b.img=w,this._footageLoaded();}.bind(this),function(){b.img={},this._footageLoaded();}.bind(this)),b;}function c(C,b){this.imagesLoadedCb=b;var x,w=C.length;for(x=0;x<w;x+=1)C[x].layers||(!C[x].t||C[x].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(C[x]))):C[x].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(C[x]))));}function d(C){this.path=C||"";}function u(C){this.assetsPath=C||"";}function g(C){for(var b=0,x=this.images.length;b<x;){if(this.images[b].assetData===C)return this.images[b].img;b+=1;}return null;}function f(){this.imagesLoadedCb=null,this.images.length=0;}function m(){return this.totalImages===this.loadedAssets;}function _(){return this.totalFootages===this.loadedFootagesCount;}function y(C,b){C==="svg"?(this._elementHelper=b,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this);}function E(){this._imageLoaded=e.bind(this),this._footageLoaded=t.bind(this),this.testImageLoaded=r.bind(this),this.createFootageData=l.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[];}return E.prototype={loadAssets:c,setAssetsPath:u,setPath:d,loadedImages:m,loadedFootages:_,destroy:f,getAsset:g,createImgData:s,createImageData:o,imageLoaded:e,footageLoaded:t,setCacheType:y},E;}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(e,t){if(this._cbs[e])for(var i=this._cbs[e],r=0;r<i.length;r+=1)i[r](t);},addEventListener:function(e,t){return this._cbs[e]||(this._cbs[e]=[]),this._cbs[e].push(t),function(){this.removeEventListener(e,t);}.bind(this);},removeEventListener:function(e,t){if(!t)this._cbs[e]=null;else if(this._cbs[e]){for(var i=0,r=this._cbs[e].length;i<r;)this._cbs[e][i]===t&&(this._cbs[e].splice(i,1),i-=1,r-=1),i+=1;this._cbs[e].length||(this._cbs[e]=null);}}};var markerParser=function(){function n(e){for(var t=e.split(`\r
`),i={},r,o=0,s=0;s<t.length;s+=1)r=t[s].split(":"),r.length===2&&(i[r[0]]=r[1].trim(),o+=1);if(o===0)throw new Error();return i;}return function(e){for(var t=[],i=0;i<e.length;i+=1){var r=e[i],o={time:r.tm,duration:r.dr};try{o.payload=JSON.parse(e[i].cm);}catch{try{o.payload=n(e[i].cm);}catch{o.payload={name:e[i].cm};}}t.push(o);}return t;};}(),ProjectInterface=function(){function n(e){this.compositions.push(e);}return function(){function e(t){for(var i=0,r=this.compositions.length;i<r;){if(this.compositions[i].data&&this.compositions[i].data.nm===t)return this.compositions[i].prepareFrame&&this.compositions[i].data.xt&&this.compositions[i].prepareFrame(this.currentFrame),this.compositions[i].compInterface;i+=1;}return null;}return e.compositions=[],e.currentFrame=0,e.registerComposition=n,e;};}(),renderers={},registerRenderer=function(e,t){renderers[e]=t;};function getRenderer(n){return renderers[n];}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var n in renderers)if(renderers[n])return n;return"";}function _typeof$4(n){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e;}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_typeof$4(n);}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader(),this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin();};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(n){(n.wrapper||n.container)&&(this.wrapper=n.wrapper||n.container);var e="svg";n.animType?e=n.animType:n.renderer&&(e=n.renderer);var t=getRenderer(e);this.renderer=new t(this,n.rendererSettings),this.imagePreloader.setCacheType(e,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=e,n.loop===""||n.loop===null||n.loop===void 0||n.loop===!0?this.loop=!0:n.loop===!1?this.loop=!1:this.loop=parseInt(n.loop,10),this.autoplay="autoplay"in n?n.autoplay:!0,this.name=n.name?n.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(n,"autoloadSegments")?n.autoloadSegments:!0,this.assetsPath=n.assetsPath,this.initialSegment=n.initialSegment,n.audioFactory&&this.audioController.setAudioFactory(n.audioFactory),n.animationData?this.setupAnimation(n.animationData):n.path&&(n.path.lastIndexOf("\\")!==-1?this.path=n.path.substr(0,n.path.lastIndexOf("\\")+1):this.path=n.path.substr(0,n.path.lastIndexOf("/")+1),this.fileName=n.path.substr(n.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(n.path,this.configAnimation,this.onSetupError));},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed");},AnimationItem.prototype.setupAnimation=function(n){dataManager.completeAnimation(n,this.configAnimation);},AnimationItem.prototype.setData=function(n,e){e&&_typeof$4(e)!=="object"&&(e=JSON.parse(e));var t={wrapper:n,animationData:e},i=n.attributes;t.path=i.getNamedItem("data-animation-path")?i.getNamedItem("data-animation-path").value:i.getNamedItem("data-bm-path")?i.getNamedItem("data-bm-path").value:i.getNamedItem("bm-path")?i.getNamedItem("bm-path").value:"",t.animType=i.getNamedItem("data-anim-type")?i.getNamedItem("data-anim-type").value:i.getNamedItem("data-bm-type")?i.getNamedItem("data-bm-type").value:i.getNamedItem("bm-type")?i.getNamedItem("bm-type").value:i.getNamedItem("data-bm-renderer")?i.getNamedItem("data-bm-renderer").value:i.getNamedItem("bm-renderer")?i.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var r=i.getNamedItem("data-anim-loop")?i.getNamedItem("data-anim-loop").value:i.getNamedItem("data-bm-loop")?i.getNamedItem("data-bm-loop").value:i.getNamedItem("bm-loop")?i.getNamedItem("bm-loop").value:"";r==="false"?t.loop=!1:r==="true"?t.loop=!0:r!==""&&(t.loop=parseInt(r,10));var o=i.getNamedItem("data-anim-autoplay")?i.getNamedItem("data-anim-autoplay").value:i.getNamedItem("data-bm-autoplay")?i.getNamedItem("data-bm-autoplay").value:i.getNamedItem("bm-autoplay")?i.getNamedItem("bm-autoplay").value:!0;t.autoplay=o!=="false",t.name=i.getNamedItem("data-name")?i.getNamedItem("data-name").value:i.getNamedItem("data-bm-name")?i.getNamedItem("data-bm-name").value:i.getNamedItem("bm-name")?i.getNamedItem("bm-name").value:"";var s=i.getNamedItem("data-anim-prerender")?i.getNamedItem("data-anim-prerender").value:i.getNamedItem("data-bm-prerender")?i.getNamedItem("data-bm-prerender").value:i.getNamedItem("bm-prerender")?i.getNamedItem("bm-prerender").value:"";s==="false"&&(t.prerender=!1),t.path?this.setParams(t):this.trigger("destroy");},AnimationItem.prototype.includeLayers=function(n){n.op>this.animationData.op&&(this.animationData.op=n.op,this.totalFrames=Math.floor(n.op-this.animationData.ip));var e=this.animationData.layers,t,i=e.length,r=n.layers,o,s=r.length;for(o=0;o<s;o+=1)for(t=0;t<i;){if(e[t].id===r[o].id){e[t]=r[o];break;}t+=1;}if((n.chars||n.fonts)&&(this.renderer.globalData.fontManager.addChars(n.chars),this.renderer.globalData.fontManager.addFonts(n.fonts,this.renderer.globalData.defs)),n.assets)for(i=n.assets.length,t=0;t<i;t+=1)this.animationData.assets.push(n.assets[t]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete);},AnimationItem.prototype.onSegmentComplete=function(n){this.animationData=n;var e=getExpressionsPlugin();e&&e.initExpressions(this),this.loadNextSegment();},AnimationItem.prototype.loadNextSegment=function(){var n=this.animationData.segments;if(!n||n.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return;}var e=n.shift();this.timeCompleted=e.time*this.frameRate;var t=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(t,this.includeLayers.bind(this),function(){this.trigger("data_failed");}.bind(this));},AnimationItem.prototype.loadSegments=function(){var n=this.animationData.segments;n||(this.timeCompleted=this.totalFrames),this.loadNextSegment();},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded();},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this));},AnimationItem.prototype.configAnimation=function(n){if(this.renderer)try{this.animationData=n,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(n),n.assets||(n.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(n.assets),this.markers=markerParser(n.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause();}catch(e){this.triggerConfigError(e);}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20));},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var n=getExpressionsPlugin();n&&n.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded");}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play();}},AnimationItem.prototype.resize=function(n,e){var t=typeof n=="number"?n:void 0,i=typeof e=="number"?e:void 0;this.renderer.updateContainerSize(t,i);},AnimationItem.prototype.setSubframe=function(n){this.isSubframeEnabled=!!n;},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame");},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame);}catch(n){this.triggerRenderFrameError(n);}},AnimationItem.prototype.play=function(n){n&&this.name!==n||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")));},AnimationItem.prototype.pause=function(n){n&&this.name!==n||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause());},AnimationItem.prototype.togglePause=function(n){n&&this.name!==n||(this.isPaused===!0?this.play():this.pause());},AnimationItem.prototype.stop=function(n){n&&this.name!==n||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0));},AnimationItem.prototype.getMarkerData=function(n){for(var e,t=0;t<this.markers.length;t+=1)if(e=this.markers[t],e.payload&&e.payload.name===n)return e;return null;},AnimationItem.prototype.goToAndStop=function(n,e,t){if(!(t&&this.name!==t)){var i=Number(n);if(isNaN(i)){var r=this.getMarkerData(n);r&&this.goToAndStop(r.time,!0);}else e?this.setCurrentRawFrameValue(n):this.setCurrentRawFrameValue(n*this.frameModifier);this.pause();}},AnimationItem.prototype.goToAndPlay=function(n,e,t){if(!(t&&this.name!==t)){var i=Number(n);if(isNaN(i)){var r=this.getMarkerData(n);r&&(r.duration?this.playSegments([r.time,r.time+r.duration],!0):this.goToAndStop(r.time,!0));}else this.goToAndStop(i,e,t);this.play();}},AnimationItem.prototype.advanceTime=function(n){if(!(this.isPaused===!0||this.isLoaded===!1)){var e=this.currentRawFrame+n*this.frameModifier,t=!1;e>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(e>this.totalFrames?e%this.totalFrames:0)||(t=!0,e=this.totalFrames-1):e>=this.totalFrames?(this.playCount+=1,this.checkSegments(e%this.totalFrames)||(this.setCurrentRawFrameValue(e%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(e):e<0?this.checkSegments(e%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+e%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(t=!0,e=0)):this.setCurrentRawFrameValue(e),t&&(this.setCurrentRawFrameValue(e),this.pause(),this.trigger("complete"));}},AnimationItem.prototype.adjustSegment=function(n,e){this.playCount=0,n[1]<n[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=n[0]-n[1],this.timeCompleted=this.totalFrames,this.firstFrame=n[1],this.setCurrentRawFrameValue(this.totalFrames-.001-e)):n[1]>n[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=n[1]-n[0],this.timeCompleted=this.totalFrames,this.firstFrame=n[0],this.setCurrentRawFrameValue(.001+e)),this.trigger("segmentStart");},AnimationItem.prototype.setSegment=function(n,e){var t=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<n?t=n:this.currentRawFrame+this.firstFrame>e&&(t=e-n)),this.firstFrame=n,this.totalFrames=e-n,this.timeCompleted=this.totalFrames,t!==-1&&this.goToAndStop(t,!0);},AnimationItem.prototype.playSegments=function(n,e){if(e&&(this.segments.length=0),_typeof$4(n[0])==="object"){var t,i=n.length;for(t=0;t<i;t+=1)this.segments.push(n[t]);}else this.segments.push(n);this.segments.length&&e&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play();},AnimationItem.prototype.resetSegments=function(n){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),n&&this.checkSegments(0);},AnimationItem.prototype.checkSegments=function(n){return this.segments.length?(this.adjustSegment(this.segments.shift(),n),!0):!1;},AnimationItem.prototype.destroy=function(n){n&&this.name!==n||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null);},AnimationItem.prototype.setCurrentRawFrameValue=function(n){this.currentRawFrame=n,this.gotoFrame();},AnimationItem.prototype.setSpeed=function(n){this.playSpeed=n,this.updaFrameModifier();},AnimationItem.prototype.setDirection=function(n){this.playDirection=n<0?-1:1,this.updaFrameModifier();},AnimationItem.prototype.setLoop=function(n){this.loop=n;},AnimationItem.prototype.setVolume=function(n,e){e&&this.name!==e||this.audioController.setVolume(n);},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume();},AnimationItem.prototype.mute=function(n){n&&this.name!==n||this.audioController.mute();},AnimationItem.prototype.unmute=function(n){n&&this.name!==n||this.audioController.unmute();},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection);},AnimationItem.prototype.getPath=function(){return this.path;},AnimationItem.prototype.getAssetsPath=function(n){var e="";if(n.e)e=n.p;else if(this.assetsPath){var t=n.p;t.indexOf("images/")!==-1&&(t=t.split("/")[1]),e=this.assetsPath+t;}else e=this.path,e+=n.u?n.u:"",e+=n.p;return e;},AnimationItem.prototype.getAssetData=function(n){for(var e=0,t=this.assets.length;e<t;){if(n===this.assets[e].id)return this.assets[e];e+=1;}return null;},AnimationItem.prototype.hide=function(){this.renderer.hide();},AnimationItem.prototype.show=function(){this.renderer.show();},AnimationItem.prototype.getDuration=function(n){return n?this.totalFrames:this.totalFrames/this.frameRate;},AnimationItem.prototype.updateDocumentData=function(n,e,t){try{var i=this.renderer.getElementByPath(n);i.updateDocumentData(e,t);}catch{}},AnimationItem.prototype.trigger=function(n){if(this._cbs&&this._cbs[n])switch(n){case"enterFrame":this.triggerEvent(n,new BMEnterFrameEvent(n,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(n,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(n,new BMCompleteLoopEvent(n,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(n,new BMCompleteEvent(n,this.frameMult));break;case"segmentStart":this.triggerEvent(n,new BMSegmentStartEvent(n,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(n,new BMDestroyEvent(n,this));break;default:this.triggerEvent(n);}n==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(n,this.currentFrame,this.totalFrames,this.frameMult)),n==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(n,this.loop,this.playCount,this.frameMult)),n==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(n,this.frameMult)),n==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(n,this.firstFrame,this.totalFrames)),n==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(n,this));},AnimationItem.prototype.triggerRenderFrameError=function(n){var e=new BMRenderFrameErrorEvent(n,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e);},AnimationItem.prototype.triggerConfigError=function(n){var e=new BMConfigErrorEvent(n,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e);};var animationManager=function(){var n={},e=[],t=0,i=0,r=0,o=!0,s=!1;function l(A){for(var z=0,O=A.target;z<i;)e[z].animation===O&&(e.splice(z,1),z-=1,i-=1,O.isPaused||g()),z+=1;}function c(A,z){if(!A)return null;for(var O=0;O<i;){if(e[O].elem===A&&e[O].elem!==null)return e[O].animation;O+=1;}var k=new AnimationItem();return f(k,A),k.setData(A,z),k;}function d(){var A,z=e.length,O=[];for(A=0;A<z;A+=1)O.push(e[A].animation);return O;}function u(){r+=1,le();}function g(){r-=1;}function f(A,z){A.addEventListener("destroy",l),A.addEventListener("_active",u),A.addEventListener("_idle",g),e.push({elem:z,animation:A}),i+=1;}function m(A){var z=new AnimationItem();return f(z,null),z.setParams(A),z;}function _(A,z){var O;for(O=0;O<i;O+=1)e[O].animation.setSpeed(A,z);}function y(A,z){var O;for(O=0;O<i;O+=1)e[O].animation.setDirection(A,z);}function E(A){var z;for(z=0;z<i;z+=1)e[z].animation.play(A);}function C(A){var z=A-t,O;for(O=0;O<i;O+=1)e[O].animation.advanceTime(z);t=A,r&&!s?window.requestAnimationFrame(C):o=!0;}function b(A){t=A,window.requestAnimationFrame(C);}function x(A){var z;for(z=0;z<i;z+=1)e[z].animation.pause(A);}function w(A,z,O){var k;for(k=0;k<i;k+=1)e[k].animation.goToAndStop(A,z,O);}function T(A){var z;for(z=0;z<i;z+=1)e[z].animation.stop(A);}function R(A){var z;for(z=0;z<i;z+=1)e[z].animation.togglePause(A);}function V(A){var z;for(z=i-1;z>=0;z-=1)e[z].animation.destroy(A);}function B(A,z,O){var k=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),H,U=k.length;for(H=0;H<U;H+=1)O&&k[H].setAttribute("data-bm-type",O),c(k[H],A);if(z&&U===0){O||(O="svg");var pe=document.getElementsByTagName("body")[0];pe.innerText="";var me=createTag("div");me.style.width="100%",me.style.height="100%",me.setAttribute("data-bm-type",O),pe.appendChild(me),c(me,A);}}function Y(){var A;for(A=0;A<i;A+=1)e[A].animation.resize();}function le(){!s&&r&&o&&(window.requestAnimationFrame(b),o=!1);}function ae(){s=!0;}function ee(){s=!1,le();}function ce(A,z){var O;for(O=0;O<i;O+=1)e[O].animation.setVolume(A,z);}function oe(A){var z;for(z=0;z<i;z+=1)e[z].animation.mute(A);}function re(A){var z;for(z=0;z<i;z+=1)e[z].animation.unmute(A);}return n.registerAnimation=c,n.loadAnimation=m,n.setSpeed=_,n.setDirection=y,n.play=E,n.pause=x,n.stop=T,n.togglePause=R,n.searchAnimations=B,n.resize=Y,n.goToAndStop=w,n.destroy=V,n.freeze=ae,n.unfreeze=ee,n.setVolume=ce,n.mute=oe,n.unmute=re,n.getRegisteredAnimations=d,n;}(),BezierFactory=function(){var n={};n.getBezierEasing=t;var e={};function t(b,x,w,T,R){var V=R||("bez_"+b+"_"+x+"_"+w+"_"+T).replace(/\./g,"p");if(e[V])return e[V];var B=new C([b,x,w,T]);return e[V]=B,B;}var i=4,r=.001,o=1e-7,s=10,l=11,c=1/(l-1),d=typeof Float32Array=="function";function u(b,x){return 1-3*x+3*b;}function g(b,x){return 3*x-6*b;}function f(b){return 3*b;}function m(b,x,w){return((u(x,w)*b+g(x,w))*b+f(x))*b;}function _(b,x,w){return 3*u(x,w)*b*b+2*g(x,w)*b+f(x);}function y(b,x,w,T,R){var V,B,Y=0;do B=x+(w-x)/2,V=m(B,T,R)-b,V>0?w=B:x=B;while(Math.abs(V)>o&&++Y<s);return B;}function E(b,x,w,T){for(var R=0;R<i;++R){var V=_(x,w,T);if(V===0)return x;var B=m(x,w,T)-b;x-=B/V;}return x;}function C(b){this._p=b,this._mSampleValues=d?new Float32Array(l):new Array(l),this._precomputed=!1,this.get=this.get.bind(this);}return C.prototype={get:function(x){var w=this._p[0],T=this._p[1],R=this._p[2],V=this._p[3];return this._precomputed||this._precompute(),w===T&&R===V?x:x===0?0:x===1?1:m(this._getTForX(x),T,V);},_precompute:function(){var x=this._p[0],w=this._p[1],T=this._p[2],R=this._p[3];this._precomputed=!0,(x!==w||T!==R)&&this._calcSampleValues();},_calcSampleValues:function(){for(var x=this._p[0],w=this._p[2],T=0;T<l;++T)this._mSampleValues[T]=m(T*c,x,w);},_getTForX:function(x){for(var w=this._p[0],T=this._p[2],R=this._mSampleValues,V=0,B=1,Y=l-1;B!==Y&&R[B]<=x;++B)V+=c;--B;var le=(x-R[B])/(R[B+1]-R[B]),ae=V+le*c,ee=_(ae,w,T);return ee>=r?E(x,ae,w,T):ee===0?ae:y(x,V,V+c,w,T);}},n;}(),pooling=function(){function n(e){return e.concat(createSizedArray(e.length));}return{double:n};}(),poolFactory=function(){return function(n,e,t){var i=0,r=n,o=createSizedArray(r),s={newElement:l,release:c};function l(){var d;return i?(i-=1,d=o[i]):d=e(),d;}function c(d){i===r&&(o=pooling.double(o),r*=2),t&&t(d),o[i]=d,i+=1;}return s;};}(),bezierLengthPool=function(){function n(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())};}return poolFactory(8,n);}(),segmentsLengthPool=function(){function n(){return{lengths:[],totalLength:0};}function e(t){var i,r=t.lengths.length;for(i=0;i<r;i+=1)bezierLengthPool.release(t.lengths[i]);t.lengths.length=0;}return poolFactory(8,n,e);}();function bezFunction(){var n=Math;function e(f,m,_,y,E,C){var b=f*y+m*E+_*C-E*y-C*f-_*m;return b>-.001&&b<.001;}function t(f,m,_,y,E,C,b,x,w){if(_===0&&C===0&&w===0)return e(f,m,y,E,b,x);var T=n.sqrt(n.pow(y-f,2)+n.pow(E-m,2)+n.pow(C-_,2)),R=n.sqrt(n.pow(b-f,2)+n.pow(x-m,2)+n.pow(w-_,2)),V=n.sqrt(n.pow(b-y,2)+n.pow(x-E,2)+n.pow(w-C,2)),B;return T>R?T>V?B=T-R-V:B=V-R-T:V>R?B=V-R-T:B=R-T-V,B>-1e-4&&B<1e-4;}var i=function(){return function(f,m,_,y){var E=getDefaultCurveSegments(),C,b,x,w,T,R=0,V,B=[],Y=[],le=bezierLengthPool.newElement();for(x=_.length,C=0;C<E;C+=1){for(T=C/(E-1),V=0,b=0;b<x;b+=1)w=bmPow(1-T,3)*f[b]+3*bmPow(1-T,2)*T*_[b]+3*(1-T)*bmPow(T,2)*y[b]+bmPow(T,3)*m[b],B[b]=w,Y[b]!==null&&(V+=bmPow(B[b]-Y[b],2)),Y[b]=B[b];V&&(V=bmSqrt(V),R+=V),le.percents[C]=T,le.lengths[C]=R;}return le.addedLength=R,le;};}();function r(f){var m=segmentsLengthPool.newElement(),_=f.c,y=f.v,E=f.o,C=f.i,b,x=f._length,w=m.lengths,T=0;for(b=0;b<x-1;b+=1)w[b]=i(y[b],y[b+1],E[b],C[b+1]),T+=w[b].addedLength;return _&&x&&(w[b]=i(y[b],y[0],E[b],C[0]),T+=w[b].addedLength),m.totalLength=T,m;}function o(f){this.segmentLength=0,this.points=new Array(f);}function s(f,m){this.partialLength=f,this.point=m;}var l=function(){var f={};return function(m,_,y,E){var C=(m[0]+"_"+m[1]+"_"+_[0]+"_"+_[1]+"_"+y[0]+"_"+y[1]+"_"+E[0]+"_"+E[1]).replace(/\./g,"p");if(!f[C]){var b=getDefaultCurveSegments(),x,w,T,R,V,B=0,Y,le,ae=null;m.length===2&&(m[0]!==_[0]||m[1]!==_[1])&&e(m[0],m[1],_[0],_[1],m[0]+y[0],m[1]+y[1])&&e(m[0],m[1],_[0],_[1],_[0]+E[0],_[1]+E[1])&&(b=2);var ee=new o(b);for(T=y.length,x=0;x<b;x+=1){for(le=createSizedArray(T),V=x/(b-1),Y=0,w=0;w<T;w+=1)R=bmPow(1-V,3)*m[w]+3*bmPow(1-V,2)*V*(m[w]+y[w])+3*(1-V)*bmPow(V,2)*(_[w]+E[w])+bmPow(V,3)*_[w],le[w]=R,ae!==null&&(Y+=bmPow(le[w]-ae[w],2));Y=bmSqrt(Y),B+=Y,ee.points[x]=new s(Y,le),ae=le;}ee.segmentLength=B,f[C]=ee;}return f[C];};}();function c(f,m){var _=m.percents,y=m.lengths,E=_.length,C=bmFloor((E-1)*f),b=f*m.addedLength,x=0;if(C===E-1||C===0||b===y[C])return _[C];for(var w=y[C]>b?-1:1,T=!0;T;)if(y[C]<=b&&y[C+1]>b?(x=(b-y[C])/(y[C+1]-y[C]),T=!1):C+=w,C<0||C>=E-1){if(C===E-1)return _[C];T=!1;}return _[C]+(_[C+1]-_[C])*x;}function d(f,m,_,y,E,C){var b=c(E,C),x=1-b,w=n.round((x*x*x*f[0]+(b*x*x+x*b*x+x*x*b)*_[0]+(b*b*x+x*b*b+b*x*b)*y[0]+b*b*b*m[0])*1e3)/1e3,T=n.round((x*x*x*f[1]+(b*x*x+x*b*x+x*x*b)*_[1]+(b*b*x+x*b*b+b*x*b)*y[1]+b*b*b*m[1])*1e3)/1e3;return[w,T];}var u=createTypedArray("float32",8);function g(f,m,_,y,E,C,b){E<0?E=0:E>1&&(E=1);var x=c(E,b);C=C>1?1:C;var w=c(C,b),T,R=f.length,V=1-x,B=1-w,Y=V*V*V,le=x*V*V*3,ae=x*x*V*3,ee=x*x*x,ce=V*V*B,oe=x*V*B+V*x*B+V*V*w,re=x*x*B+V*x*w+x*V*w,A=x*x*w,z=V*B*B,O=x*B*B+V*w*B+V*B*w,k=x*w*B+V*w*w+x*B*w,H=x*w*w,U=B*B*B,pe=w*B*B+B*w*B+B*B*w,me=w*w*B+B*w*w+w*B*w,fe=w*w*w;for(T=0;T<R;T+=1)u[T*4]=n.round((Y*f[T]+le*_[T]+ae*y[T]+ee*m[T])*1e3)/1e3,u[T*4+1]=n.round((ce*f[T]+oe*_[T]+re*y[T]+A*m[T])*1e3)/1e3,u[T*4+2]=n.round((z*f[T]+O*_[T]+k*y[T]+H*m[T])*1e3)/1e3,u[T*4+3]=n.round((U*f[T]+pe*_[T]+me*y[T]+fe*m[T])*1e3)/1e3;return u;}return{getSegmentsLength:r,getNewSegment:g,getPointInSegment:d,buildBezierData:l,pointOnLine2D:e,pointOnLine3D:t};}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(n,e){var t=this.offsetTime,i;this.propType==="multidimensional"&&(i=createTypedArray("float32",this.pv.length));for(var r=e.lastIndex,o=r,s=this.keyframes.length-1,l=!0,c,d,u;l;){if(c=this.keyframes[o],d=this.keyframes[o+1],o===s-1&&n>=d.t-t){c.h&&(c=d),r=0;break;}if(d.t-t>n){r=o;break;}o<s-1?o+=1:(r=0,l=!1);}u=this.keyframesMetadata[o]||{};var g,f,m,_,y,E,C=d.t-t,b=c.t-t,x;if(c.to){u.bezierData||(u.bezierData=bez.buildBezierData(c.s,d.s||c.e,c.to,c.ti));var w=u.bezierData;if(n>=C||n<b){var T=n>=C?w.points.length-1:0;for(f=w.points[T].point.length,g=0;g<f;g+=1)i[g]=w.points[T].point[g];}else{u.__fnct?E=u.__fnct:(E=BezierFactory.getBezierEasing(c.o.x,c.o.y,c.i.x,c.i.y,c.n).get,u.__fnct=E),m=E((n-b)/(C-b));var R=w.segmentLength*m,V,B=e.lastFrame<n&&e._lastKeyframeIndex===o?e._lastAddedLength:0;for(y=e.lastFrame<n&&e._lastKeyframeIndex===o?e._lastPoint:0,l=!0,_=w.points.length;l;){if(B+=w.points[y].partialLength,R===0||m===0||y===w.points.length-1){for(f=w.points[y].point.length,g=0;g<f;g+=1)i[g]=w.points[y].point[g];break;}else if(R>=B&&R<B+w.points[y+1].partialLength){for(V=(R-B)/w.points[y+1].partialLength,f=w.points[y].point.length,g=0;g<f;g+=1)i[g]=w.points[y].point[g]+(w.points[y+1].point[g]-w.points[y].point[g])*V;break;}y<_-1?y+=1:l=!1;}e._lastPoint=y,e._lastAddedLength=B-w.points[y].partialLength,e._lastKeyframeIndex=o;}}else{var Y,le,ae,ee,ce;if(s=c.s.length,x=d.s||c.e,this.sh&&c.h!==1){if(n>=C)i[0]=x[0],i[1]=x[1],i[2]=x[2];else if(n<=b)i[0]=c.s[0],i[1]=c.s[1],i[2]=c.s[2];else{var oe=createQuaternion(c.s),re=createQuaternion(x),A=(n-b)/(C-b);quaternionToEuler(i,slerp(oe,re,A));}}else for(o=0;o<s;o+=1)c.h!==1&&(n>=C?m=1:n<b?m=0:(c.o.x.constructor===Array?(u.__fnct||(u.__fnct=[]),u.__fnct[o]?E=u.__fnct[o]:(Y=c.o.x[o]===void 0?c.o.x[0]:c.o.x[o],le=c.o.y[o]===void 0?c.o.y[0]:c.o.y[o],ae=c.i.x[o]===void 0?c.i.x[0]:c.i.x[o],ee=c.i.y[o]===void 0?c.i.y[0]:c.i.y[o],E=BezierFactory.getBezierEasing(Y,le,ae,ee).get,u.__fnct[o]=E)):u.__fnct?E=u.__fnct:(Y=c.o.x,le=c.o.y,ae=c.i.x,ee=c.i.y,E=BezierFactory.getBezierEasing(Y,le,ae,ee).get,c.keyframeMetadata=E),m=E((n-b)/(C-b)))),x=d.s||c.e,ce=c.h===1?c.s[o]:c.s[o]+(x[o]-c.s[o])*m,this.propType==="multidimensional"?i[o]=ce:i=ce;}return e.lastIndex=r,i;}function slerp(n,e,t){var i=[],r=n[0],o=n[1],s=n[2],l=n[3],c=e[0],d=e[1],u=e[2],g=e[3],f,m,_,y,E;return m=r*c+o*d+s*u+l*g,m<0&&(m=-m,c=-c,d=-d,u=-u,g=-g),1-m>1e-6?(f=Math.acos(m),_=Math.sin(f),y=Math.sin((1-t)*f)/_,E=Math.sin(t*f)/_):(y=1-t,E=t),i[0]=y*r+E*c,i[1]=y*o+E*d,i[2]=y*s+E*u,i[3]=y*l+E*g,i;}function quaternionToEuler(n,e){var t=e[0],i=e[1],r=e[2],o=e[3],s=Math.atan2(2*i*o-2*t*r,1-2*i*i-2*r*r),l=Math.asin(2*t*i+2*r*o),c=Math.atan2(2*t*o-2*i*r,1-2*t*t-2*r*r);n[0]=s/degToRads,n[1]=l/degToRads,n[2]=c/degToRads;}function createQuaternion(n){var e=n[0]*degToRads,t=n[1]*degToRads,i=n[2]*degToRads,r=Math.cos(e/2),o=Math.cos(t/2),s=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),d=Math.sin(i/2),u=r*o*s-l*c*d,g=l*c*s+r*o*d,f=l*o*s+r*c*d,m=r*c*s-l*o*d;return[g,f,m,u];}function getValueAtCurrentTime(){var n=this.comp.renderedFrame-this.offsetTime,e=this.keyframes[0].t-this.offsetTime,t=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(n===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=t&&n>=t||this._caching.lastFrame<e&&n<e))){this._caching.lastFrame>=n&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var i=this.interpolateValue(n,this._caching);this.pv=i;}return this._caching.lastFrame=n,this.pv;}function setVValue(n){var e;if(this.propType==="unidimensional")e=n*this.mult,mathAbs(this.v-e)>1e-5&&(this.v=e,this._mdf=!0);else for(var t=0,i=this.v.length;t<i;)e=n[t]*this.mult,mathAbs(this.v[t]-e)>1e-5&&(this.v[t]=e,this._mdf=!0),t+=1;}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return;}this.lock=!0,this._mdf=this._isFirstFrame;var n,e=this.effectsSequence.length,t=this.kf?this.pv:this.data.k;for(n=0;n<e;n+=1)t=this.effectsSequence[n](t);this.setVValue(t),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId;}}function addEffect(n){this.effectsSequence.push(n),this.container.addDynamicProperty(this);}function ValueProperty(n,e,t,i){this.propType="unidimensional",this.mult=t||1,this.data=e,this.v=t?e.k*t:e.k,this.pv=e.k,this._mdf=!1,this.elem=n,this.container=i,this.comp=n.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect;}function MultiDimensionalProperty(n,e,t,i){this.propType="multidimensional",this.mult=t||1,this.data=e,this._mdf=!1,this.elem=n,this.container=i,this.comp=n.comp,this.k=!1,this.kf=!1,this.frameId=-1;var r,o=e.k.length;for(this.v=createTypedArray("float32",o),this.pv=createTypedArray("float32",o),this.vel=createTypedArray("float32",o),r=0;r<o;r+=1)this.v[r]=e.k[r]*this.mult,this.pv[r]=e.k[r];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect;}function KeyframedValueProperty(n,e,t,i){this.propType="unidimensional",this.keyframes=e.k,this.keyframesMetadata=[],this.offsetTime=n.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=e,this.mult=t||1,this.elem=n,this.container=i,this.comp=n.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect;}function KeyframedMultidimensionalProperty(n,e,t,i){this.propType="multidimensional";var r,o=e.k.length,s,l,c,d;for(r=0;r<o-1;r+=1)e.k[r].to&&e.k[r].s&&e.k[r+1]&&e.k[r+1].s&&(s=e.k[r].s,l=e.k[r+1].s,c=e.k[r].to,d=e.k[r].ti,(s.length===2&&!(s[0]===l[0]&&s[1]===l[1])&&bez.pointOnLine2D(s[0],s[1],l[0],l[1],s[0]+c[0],s[1]+c[1])&&bez.pointOnLine2D(s[0],s[1],l[0],l[1],l[0]+d[0],l[1]+d[1])||s.length===3&&!(s[0]===l[0]&&s[1]===l[1]&&s[2]===l[2])&&bez.pointOnLine3D(s[0],s[1],s[2],l[0],l[1],l[2],s[0]+c[0],s[1]+c[1],s[2]+c[2])&&bez.pointOnLine3D(s[0],s[1],s[2],l[0],l[1],l[2],l[0]+d[0],l[1]+d[1],l[2]+d[2]))&&(e.k[r].to=null,e.k[r].ti=null),s[0]===l[0]&&s[1]===l[1]&&c[0]===0&&c[1]===0&&d[0]===0&&d[1]===0&&(s.length===2||s[2]===l[2]&&c[2]===0&&d[2]===0)&&(e.k[r].to=null,e.k[r].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=e,this.keyframes=e.k,this.keyframesMetadata=[],this.offsetTime=n.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=t||1,this.elem=n,this.container=i,this.comp=n.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var u=e.k[0].s.length;for(this.v=createTypedArray("float32",u),this.pv=createTypedArray("float32",u),r=0;r<u;r+=1)this.v[r]=initFrame,this.pv[r]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",u)},this.addEffect=addEffect;}var PropertyFactory=function(){function n(t,i,r,o,s){i.sid&&(i=t.globalData.slotManager.getProp(i));var l;if(!i.k.length)l=new ValueProperty(t,i,o,s);else if(typeof i.k[0]=="number")l=new MultiDimensionalProperty(t,i,o,s);else switch(r){case 0:l=new KeyframedValueProperty(t,i,o,s);break;case 1:l=new KeyframedMultidimensionalProperty(t,i,o,s);break;default:break;}return l.effectsSequence.length&&s.addDynamicProperty(l),l;}var e={getProp:n};return e;}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(e){this.dynamicProperties.indexOf(e)===-1&&(this.dynamicProperties.push(e),this.container.addDynamicProperty(this),this._isAnimated=!0);},iterateDynamicProperties:function(){this._mdf=!1;var e,t=this.dynamicProperties.length;for(e=0;e<t;e+=1)this.dynamicProperties[e].getValue(),this.dynamicProperties[e]._mdf&&(this._mdf=!0);},initDynamicPropertyContainer:function(e){this.container=e,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1;}};var pointPool=function(){function n(){return createTypedArray("float32",2);}return poolFactory(8,n);}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength);}ShapePath.prototype.setPathData=function(n,e){this.c=n,this.setLength(e);for(var t=0;t<e;)this.v[t]=pointPool.newElement(),this.o[t]=pointPool.newElement(),this.i[t]=pointPool.newElement(),t+=1;},ShapePath.prototype.setLength=function(n){for(;this._maxLength<n;)this.doubleArrayLength();this._length=n;},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2;},ShapePath.prototype.setXYAt=function(n,e,t,i,r){var o;switch(this._length=Math.max(this._length,i+1),this._length>=this._maxLength&&this.doubleArrayLength(),t){case"v":o=this.v;break;case"i":o=this.i;break;case"o":o=this.o;break;default:o=[];break;}(!o[i]||o[i]&&!r)&&(o[i]=pointPool.newElement()),o[i][0]=n,o[i][1]=e;},ShapePath.prototype.setTripleAt=function(n,e,t,i,r,o,s,l){this.setXYAt(n,e,"v",s,l),this.setXYAt(t,i,"o",s,l),this.setXYAt(r,o,"i",s,l);},ShapePath.prototype.reverse=function(){var n=new ShapePath();n.setPathData(this.c,this._length);var e=this.v,t=this.o,i=this.i,r=0;this.c&&(n.setTripleAt(e[0][0],e[0][1],i[0][0],i[0][1],t[0][0],t[0][1],0,!1),r=1);var o=this._length-1,s=this._length,l;for(l=r;l<s;l+=1)n.setTripleAt(e[o][0],e[o][1],i[o][0],i[o][1],t[o][0],t[o][1],l,!1),o-=1;return n;},ShapePath.prototype.length=function(){return this._length;};var shapePool=function(){function n(){return new ShapePath();}function e(r){var o=r._length,s;for(s=0;s<o;s+=1)pointPool.release(r.v[s]),pointPool.release(r.i[s]),pointPool.release(r.o[s]),r.v[s]=null,r.i[s]=null,r.o[s]=null;r._length=0,r.c=!1;}function t(r){var o=i.newElement(),s,l=r._length===void 0?r.v.length:r._length;for(o.setLength(l),o.c=r.c,s=0;s<l;s+=1)o.setTripleAt(r.v[s][0],r.v[s][1],r.o[s][0],r.o[s][1],r.i[s][0],r.i[s][1],s);return o;}var i=poolFactory(4,n,e);return i.clone=t,i;}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength);}ShapeCollection.prototype.addShape=function(n){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=n,this._length+=1;},ShapeCollection.prototype.releaseShapes=function(){var n;for(n=0;n<this._length;n+=1)shapePool.release(this.shapes[n]);this._length=0;};var shapeCollectionPool=function(){var n={newShapeCollection:r,release:o},e=0,t=4,i=createSizedArray(t);function r(){var s;return e?(e-=1,s=i[e]):s=new ShapeCollection(),s;}function o(s){var l,c=s._length;for(l=0;l<c;l+=1)shapePool.release(s.shapes[l]);s._length=0,e===t&&(i=pooling.double(i),t*=2),i[e]=s,e+=1;}return n;}(),ShapePropertyFactory=function(){var n=-999999;function e(C,b,x){var w=x.lastIndex,T,R,V,B,Y,le,ae,ee,ce,oe=this.keyframes;if(C<oe[0].t-this.offsetTime)T=oe[0].s[0],V=!0,w=0;else if(C>=oe[oe.length-1].t-this.offsetTime)T=oe[oe.length-1].s?oe[oe.length-1].s[0]:oe[oe.length-2].e[0],V=!0;else{for(var re=w,A=oe.length-1,z=!0,O,k,H;z&&(O=oe[re],k=oe[re+1],!(k.t-this.offsetTime>C));)re<A-1?re+=1:z=!1;if(H=this.keyframesMetadata[re]||{},V=O.h===1,w=re,!V){if(C>=k.t-this.offsetTime)ee=1;else if(C<O.t-this.offsetTime)ee=0;else{var U;H.__fnct?U=H.__fnct:(U=BezierFactory.getBezierEasing(O.o.x,O.o.y,O.i.x,O.i.y).get,H.__fnct=U),ee=U((C-(O.t-this.offsetTime))/(k.t-this.offsetTime-(O.t-this.offsetTime)));}R=k.s?k.s[0]:O.e[0];}T=O.s[0];}for(le=b._length,ae=T.i[0].length,x.lastIndex=w,B=0;B<le;B+=1)for(Y=0;Y<ae;Y+=1)ce=V?T.i[B][Y]:T.i[B][Y]+(R.i[B][Y]-T.i[B][Y])*ee,b.i[B][Y]=ce,ce=V?T.o[B][Y]:T.o[B][Y]+(R.o[B][Y]-T.o[B][Y])*ee,b.o[B][Y]=ce,ce=V?T.v[B][Y]:T.v[B][Y]+(R.v[B][Y]-T.v[B][Y])*ee,b.v[B][Y]=ce;}function t(){var C=this.comp.renderedFrame-this.offsetTime,b=this.keyframes[0].t-this.offsetTime,x=this.keyframes[this.keyframes.length-1].t-this.offsetTime,w=this._caching.lastFrame;return w!==n&&(w<b&&C<b||w>x&&C>x)||(this._caching.lastIndex=w<C?this._caching.lastIndex:0,this.interpolateShape(C,this.pv,this._caching)),this._caching.lastFrame=C,this.pv;}function i(){this.paths=this.localShapeCollection;}function r(C,b){if(C._length!==b._length||C.c!==b.c)return!1;var x,w=C._length;for(x=0;x<w;x+=1)if(C.v[x][0]!==b.v[x][0]||C.v[x][1]!==b.v[x][1]||C.o[x][0]!==b.o[x][0]||C.o[x][1]!==b.o[x][1]||C.i[x][0]!==b.i[x][0]||C.i[x][1]!==b.i[x][1])return!1;return!0;}function o(C){r(this.v,C)||(this.v=shapePool.clone(C),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection);}function s(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return;}if(this.lock){this.setVValue(this.pv);return;}this.lock=!0,this._mdf=!1;var C;this.kf?C=this.pv:this.data.ks?C=this.data.ks.k:C=this.data.pt.k;var b,x=this.effectsSequence.length;for(b=0;b<x;b+=1)C=this.effectsSequence[b](C);this.setVValue(C),this.lock=!1,this.frameId=this.elem.globalData.frameId;}}function l(C,b,x){this.propType="shape",this.comp=C.comp,this.container=C,this.elem=C,this.data=b,this.k=!1,this.kf=!1,this._mdf=!1;var w=x===3?b.pt.k:b.ks.k;this.v=shapePool.clone(w),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=i,this.effectsSequence=[];}function c(C){this.effectsSequence.push(C),this.container.addDynamicProperty(this);}l.prototype.interpolateShape=e,l.prototype.getValue=s,l.prototype.setVValue=o,l.prototype.addEffect=c;function d(C,b,x){this.propType="shape",this.comp=C.comp,this.elem=C,this.container=C,this.offsetTime=C.data.st,this.keyframes=x===3?b.pt.k:b.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var w=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,w),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=n,this.reset=i,this._caching={lastFrame:n,lastIndex:0},this.effectsSequence=[t.bind(this)];}d.prototype.getValue=s,d.prototype.interpolateShape=e,d.prototype.setVValue=o,d.prototype.addEffect=c;var u=function(){var C=roundCorner;function b(x,w){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=w.d,this.elem=x,this.comp=x.comp,this.frameId=-1,this.initDynamicPropertyContainer(x),this.p=PropertyFactory.getProp(x,w.p,1,0,this),this.s=PropertyFactory.getProp(x,w.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath());}return b.prototype={reset:i,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath());},convertEllToPath:function(){var w=this.p.v[0],T=this.p.v[1],R=this.s.v[0]/2,V=this.s.v[1]/2,B=this.d!==3,Y=this.v;Y.v[0][0]=w,Y.v[0][1]=T-V,Y.v[1][0]=B?w+R:w-R,Y.v[1][1]=T,Y.v[2][0]=w,Y.v[2][1]=T+V,Y.v[3][0]=B?w-R:w+R,Y.v[3][1]=T,Y.i[0][0]=B?w-R*C:w+R*C,Y.i[0][1]=T-V,Y.i[1][0]=B?w+R:w-R,Y.i[1][1]=T-V*C,Y.i[2][0]=B?w+R*C:w-R*C,Y.i[2][1]=T+V,Y.i[3][0]=B?w-R:w+R,Y.i[3][1]=T+V*C,Y.o[0][0]=B?w+R*C:w-R*C,Y.o[0][1]=T-V,Y.o[1][0]=B?w+R:w-R,Y.o[1][1]=T+V*C,Y.o[2][0]=B?w-R*C:w+R*C,Y.o[2][1]=T+V,Y.o[3][0]=B?w-R:w+R,Y.o[3][1]=T-V*C;}},extendPrototype([DynamicPropertyContainer],b),b;}(),g=function(){function C(b,x){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=b,this.comp=b.comp,this.data=x,this.frameId=-1,this.d=x.d,this.initDynamicPropertyContainer(b),x.sy===1?(this.ir=PropertyFactory.getProp(b,x.ir,0,0,this),this.is=PropertyFactory.getProp(b,x.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(b,x.pt,0,0,this),this.p=PropertyFactory.getProp(b,x.p,1,0,this),this.r=PropertyFactory.getProp(b,x.r,0,degToRads,this),this.or=PropertyFactory.getProp(b,x.or,0,0,this),this.os=PropertyFactory.getProp(b,x.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath());}return C.prototype={reset:i,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath());},convertStarToPath:function(){var x=Math.floor(this.pt.v)*2,w=Math.PI*2/x,T=!0,R=this.or.v,V=this.ir.v,B=this.os.v,Y=this.is.v,le=2*Math.PI*R/(x*2),ae=2*Math.PI*V/(x*2),ee,ce,oe,re,A=-Math.PI/2;A+=this.r.v;var z=this.data.d===3?-1:1;for(this.v._length=0,ee=0;ee<x;ee+=1){ce=T?R:V,oe=T?B:Y,re=T?le:ae;var O=ce*Math.cos(A),k=ce*Math.sin(A),H=O===0&&k===0?0:k/Math.sqrt(O*O+k*k),U=O===0&&k===0?0:-O/Math.sqrt(O*O+k*k);O+=+this.p.v[0],k+=+this.p.v[1],this.v.setTripleAt(O,k,O-H*re*oe*z,k-U*re*oe*z,O+H*re*oe*z,k+U*re*oe*z,ee,!0),T=!T,A+=w*z;}},convertPolygonToPath:function(){var x=Math.floor(this.pt.v),w=Math.PI*2/x,T=this.or.v,R=this.os.v,V=2*Math.PI*T/(x*4),B,Y=-Math.PI*.5,le=this.data.d===3?-1:1;for(Y+=this.r.v,this.v._length=0,B=0;B<x;B+=1){var ae=T*Math.cos(Y),ee=T*Math.sin(Y),ce=ae===0&&ee===0?0:ee/Math.sqrt(ae*ae+ee*ee),oe=ae===0&&ee===0?0:-ae/Math.sqrt(ae*ae+ee*ee);ae+=+this.p.v[0],ee+=+this.p.v[1],this.v.setTripleAt(ae,ee,ae-ce*V*R*le,ee-oe*V*R*le,ae+ce*V*R*le,ee+oe*V*R*le,B,!0),Y+=w*le;}this.paths.length=0,this.paths[0]=this.v;}},extendPrototype([DynamicPropertyContainer],C),C;}(),f=function(){function C(b,x){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=b,this.comp=b.comp,this.frameId=-1,this.d=x.d,this.initDynamicPropertyContainer(b),this.p=PropertyFactory.getProp(b,x.p,1,0,this),this.s=PropertyFactory.getProp(b,x.s,1,0,this),this.r=PropertyFactory.getProp(b,x.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath());}return C.prototype={convertRectToPath:function(){var x=this.p.v[0],w=this.p.v[1],T=this.s.v[0]/2,R=this.s.v[1]/2,V=bmMin(T,R,this.r.v),B=V*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(x+T,w-R+V,x+T,w-R+V,x+T,w-R+B,0,!0),this.v.setTripleAt(x+T,w+R-V,x+T,w+R-B,x+T,w+R-V,1,!0),V!==0?(this.v.setTripleAt(x+T-V,w+R,x+T-V,w+R,x+T-B,w+R,2,!0),this.v.setTripleAt(x-T+V,w+R,x-T+B,w+R,x-T+V,w+R,3,!0),this.v.setTripleAt(x-T,w+R-V,x-T,w+R-V,x-T,w+R-B,4,!0),this.v.setTripleAt(x-T,w-R+V,x-T,w-R+B,x-T,w-R+V,5,!0),this.v.setTripleAt(x-T+V,w-R,x-T+V,w-R,x-T+B,w-R,6,!0),this.v.setTripleAt(x+T-V,w-R,x+T-B,w-R,x+T-V,w-R,7,!0)):(this.v.setTripleAt(x-T,w+R,x-T+B,w+R,x-T,w+R,2),this.v.setTripleAt(x-T,w-R,x-T,w-R+B,x-T,w-R,3))):(this.v.setTripleAt(x+T,w-R+V,x+T,w-R+B,x+T,w-R+V,0,!0),V!==0?(this.v.setTripleAt(x+T-V,w-R,x+T-V,w-R,x+T-B,w-R,1,!0),this.v.setTripleAt(x-T+V,w-R,x-T+B,w-R,x-T+V,w-R,2,!0),this.v.setTripleAt(x-T,w-R+V,x-T,w-R+V,x-T,w-R+B,3,!0),this.v.setTripleAt(x-T,w+R-V,x-T,w+R-B,x-T,w+R-V,4,!0),this.v.setTripleAt(x-T+V,w+R,x-T+V,w+R,x-T+B,w+R,5,!0),this.v.setTripleAt(x+T-V,w+R,x+T-B,w+R,x+T-V,w+R,6,!0),this.v.setTripleAt(x+T,w+R-V,x+T,w+R-V,x+T,w+R-B,7,!0)):(this.v.setTripleAt(x-T,w-R,x-T+B,w-R,x-T,w-R,1,!0),this.v.setTripleAt(x-T,w+R,x-T,w+R-B,x-T,w+R,2,!0),this.v.setTripleAt(x+T,w+R,x+T-B,w+R,x+T,w+R,3,!0)));},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath());},reset:i},extendPrototype([DynamicPropertyContainer],C),C;}();function m(C,b,x){var w;if(x===3||x===4){var T=x===3?b.pt:b.ks,R=T.k;R.length?w=new d(C,b,x):w=new l(C,b,x);}else x===5?w=new f(C,b):x===6?w=new u(C,b):x===7&&(w=new g(C,b));return w.k&&C.addDynamicProperty(w),w;}function _(){return l;}function y(){return d;}var E={};return E.getShapeProp=m,E.getConstructorFunction=_,E.getKeyframedConstructorFunction=y,E;}();var Matrix=function(){var n=Math.cos,e=Math.sin,t=Math.tan,i=Math.round;function r(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this;}function o(O){if(O===0)return this;var k=n(O),H=e(O);return this._t(k,-H,0,0,H,k,0,0,0,0,1,0,0,0,0,1);}function s(O){if(O===0)return this;var k=n(O),H=e(O);return this._t(1,0,0,0,0,k,-H,0,0,H,k,0,0,0,0,1);}function l(O){if(O===0)return this;var k=n(O),H=e(O);return this._t(k,0,H,0,0,1,0,0,-H,0,k,0,0,0,0,1);}function c(O){if(O===0)return this;var k=n(O),H=e(O);return this._t(k,-H,0,0,H,k,0,0,0,0,1,0,0,0,0,1);}function d(O,k){return this._t(1,k,O,1,0,0);}function u(O,k){return this.shear(t(O),t(k));}function g(O,k){var H=n(k),U=e(k);return this._t(H,U,0,0,-U,H,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,t(O),1,0,0,0,0,1,0,0,0,0,1)._t(H,-U,0,0,U,H,0,0,0,0,1,0,0,0,0,1);}function f(O,k,H){return!H&&H!==0&&(H=1),O===1&&k===1&&H===1?this:this._t(O,0,0,0,0,k,0,0,0,0,H,0,0,0,0,1);}function m(O,k,H,U,pe,me,fe,Fe,Te,qe,bt,It,We,_t,Rt,Je){return this.props[0]=O,this.props[1]=k,this.props[2]=H,this.props[3]=U,this.props[4]=pe,this.props[5]=me,this.props[6]=fe,this.props[7]=Fe,this.props[8]=Te,this.props[9]=qe,this.props[10]=bt,this.props[11]=It,this.props[12]=We,this.props[13]=_t,this.props[14]=Rt,this.props[15]=Je,this;}function _(O,k,H){return H=H||0,O!==0||k!==0||H!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,O,k,H,1):this;}function y(O,k,H,U,pe,me,fe,Fe,Te,qe,bt,It,We,_t,Rt,Je){var we=this.props;if(O===1&&k===0&&H===0&&U===0&&pe===0&&me===1&&fe===0&&Fe===0&&Te===0&&qe===0&&bt===1&&It===0)return we[12]=we[12]*O+we[15]*We,we[13]=we[13]*me+we[15]*_t,we[14]=we[14]*bt+we[15]*Rt,we[15]*=Je,this._identityCalculated=!1,this;var Nn=we[0],Bn=we[1],pi=we[2],Vn=we[3],zn=we[4],Qn=we[5],Zt=we[6],Li=we[7],Di=we[8],hn=we[9],fi=we[10],Mn=we[11],hr=we[12],vo=we[13],yo=we[14],Ss=we[15];return we[0]=Nn*O+Bn*pe+pi*Te+Vn*We,we[1]=Nn*k+Bn*me+pi*qe+Vn*_t,we[2]=Nn*H+Bn*fe+pi*bt+Vn*Rt,we[3]=Nn*U+Bn*Fe+pi*It+Vn*Je,we[4]=zn*O+Qn*pe+Zt*Te+Li*We,we[5]=zn*k+Qn*me+Zt*qe+Li*_t,we[6]=zn*H+Qn*fe+Zt*bt+Li*Rt,we[7]=zn*U+Qn*Fe+Zt*It+Li*Je,we[8]=Di*O+hn*pe+fi*Te+Mn*We,we[9]=Di*k+hn*me+fi*qe+Mn*_t,we[10]=Di*H+hn*fe+fi*bt+Mn*Rt,we[11]=Di*U+hn*Fe+fi*It+Mn*Je,we[12]=hr*O+vo*pe+yo*Te+Ss*We,we[13]=hr*k+vo*me+yo*qe+Ss*_t,we[14]=hr*H+vo*fe+yo*bt+Ss*Rt,we[15]=hr*U+vo*Fe+yo*It+Ss*Je,this._identityCalculated=!1,this;}function E(O){var k=O.props;return this.transform(k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],k[8],k[9],k[10],k[11],k[12],k[13],k[14],k[15]);}function C(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity;}function b(O){for(var k=0;k<16;){if(O.props[k]!==this.props[k])return!1;k+=1;}return!0;}function x(O){var k;for(k=0;k<16;k+=1)O.props[k]=this.props[k];return O;}function w(O){var k;for(k=0;k<16;k+=1)this.props[k]=O[k];}function T(O,k,H){return{x:O*this.props[0]+k*this.props[4]+H*this.props[8]+this.props[12],y:O*this.props[1]+k*this.props[5]+H*this.props[9]+this.props[13],z:O*this.props[2]+k*this.props[6]+H*this.props[10]+this.props[14]};}function R(O,k,H){return O*this.props[0]+k*this.props[4]+H*this.props[8]+this.props[12];}function V(O,k,H){return O*this.props[1]+k*this.props[5]+H*this.props[9]+this.props[13];}function B(O,k,H){return O*this.props[2]+k*this.props[6]+H*this.props[10]+this.props[14];}function Y(){var O=this.props[0]*this.props[5]-this.props[1]*this.props[4],k=this.props[5]/O,H=-this.props[1]/O,U=-this.props[4]/O,pe=this.props[0]/O,me=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/O,fe=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/O,Fe=new Matrix();return Fe.props[0]=k,Fe.props[1]=H,Fe.props[4]=U,Fe.props[5]=pe,Fe.props[12]=me,Fe.props[13]=fe,Fe;}function le(O){var k=this.getInverseMatrix();return k.applyToPointArray(O[0],O[1],O[2]||0);}function ae(O){var k,H=O.length,U=[];for(k=0;k<H;k+=1)U[k]=le(O[k]);return U;}function ee(O,k,H){var U=createTypedArray("float32",6);if(this.isIdentity())U[0]=O[0],U[1]=O[1],U[2]=k[0],U[3]=k[1],U[4]=H[0],U[5]=H[1];else{var pe=this.props[0],me=this.props[1],fe=this.props[4],Fe=this.props[5],Te=this.props[12],qe=this.props[13];U[0]=O[0]*pe+O[1]*fe+Te,U[1]=O[0]*me+O[1]*Fe+qe,U[2]=k[0]*pe+k[1]*fe+Te,U[3]=k[0]*me+k[1]*Fe+qe,U[4]=H[0]*pe+H[1]*fe+Te,U[5]=H[0]*me+H[1]*Fe+qe;}return U;}function ce(O,k,H){var U;return this.isIdentity()?U=[O,k,H]:U=[O*this.props[0]+k*this.props[4]+H*this.props[8]+this.props[12],O*this.props[1]+k*this.props[5]+H*this.props[9]+this.props[13],O*this.props[2]+k*this.props[6]+H*this.props[10]+this.props[14]],U;}function oe(O,k){if(this.isIdentity())return O+","+k;var H=this.props;return Math.round((O*H[0]+k*H[4]+H[12])*100)/100+","+Math.round((O*H[1]+k*H[5]+H[13])*100)/100;}function re(){for(var O=0,k=this.props,H="matrix3d(",U=1e4;O<16;)H+=i(k[O]*U)/U,H+=O===15?")":",",O+=1;return H;}function A(O){var k=1e4;return O<1e-6&&O>0||O>-1e-6&&O<0?i(O*k)/k:O;}function z(){var O=this.props,k=A(O[0]),H=A(O[1]),U=A(O[4]),pe=A(O[5]),me=A(O[12]),fe=A(O[13]);return"matrix("+k+","+H+","+U+","+pe+","+me+","+fe+")";}return function(){this.reset=r,this.rotate=o,this.rotateX=s,this.rotateY=l,this.rotateZ=c,this.skew=u,this.skewFromAxis=g,this.shear=d,this.scale=f,this.setTransform=m,this.translate=_,this.transform=y,this.multiply=E,this.applyToPoint=T,this.applyToX=R,this.applyToY=V,this.applyToZ=B,this.applyToPointArray=ce,this.applyToTriplePoints=ee,this.applyToPointStringified=oe,this.toCSS=re,this.to2dCSS=z,this.clone=x,this.cloneFromProps=w,this.equals=b,this.inversePoints=ae,this.inversePoint=le,this.getInverseMatrix=Y,this._t=this.transform,this.isIdentity=C,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset();};}();function _typeof$3(n){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e;}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_typeof$3(n);}var lottie={},standalone="__[STANDALONE]__",animationData="__[ANIMATIONDATA]__",renderer="";function setLocation(n){setLocationHref(n);}function searchAnimations(){standalone===!0?animationManager.searchAnimations(animationData,standalone,renderer):animationManager.searchAnimations();}function setSubframeRendering(n){setSubframeEnabled(n);}function setPrefix(n){setIdPrefix(n);}function loadAnimation(n){return standalone===!0&&(n.animationData=JSON.parse(animationData)),animationManager.loadAnimation(n);}function setQuality(n){if(typeof n=="string")switch(n){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break;}else!isNaN(n)&&n>1&&setDefaultCurveSegments(n);getDefaultCurveSegments()>=50?roundValues(!1):roundValues(!0);}function inBrowser(){return typeof navigator<"u";}function installPlugin(n,e){n==="expressions"&&setExpressionsPlugin(e);}function getFactory(n){switch(n){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null;}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.13.0";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations());}function getQueryVariable(n){for(var e=queryString.split("&"),t=0;t<e.length;t+=1){var i=e[t].split("=");if(decodeURIComponent(i[0])==n)return decodeURIComponent(i[1]);}return null;}var queryString="";if(standalone){var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",renderer=getQueryVariable("renderer");}var readyStateCheckInterval=setInterval(checkReady,100);try{!((typeof exports>"u"?"undefined":_typeof$3(exports))==="object"&&typeof module<"u")&&!(typeof define=="function"&&define.amd)&&(window.bodymovin=lottie);}catch(n){}var ShapeModifiers=function(){var n={},e={};n.registerModifier=t,n.getModifier=i;function t(r,o){e[r]||(e[r]=o);}function i(r,o,s){return new e[r](o,s);}return n;}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(n){if(!this.closed){n.sh.container.addDynamicProperty(n.sh);var e={shape:n.sh,data:n,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(e),this.addShapeToModifier(e),this._isAnimated&&n.setAsAnimated();}},ShapeModifier.prototype.init=function(n,e){this.shapes=[],this.elem=n,this.initDynamicPropertyContainer(n),this.initModifierProperties(n,e),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0);},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties());},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(n,e){this.s=PropertyFactory.getProp(n,e.s,0,.01,this),this.e=PropertyFactory.getProp(n,e.e,0,.01,this),this.o=PropertyFactory.getProp(n,e.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=e.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length;},TrimModifier.prototype.addShapeToModifier=function(n){n.pathsData=[];},TrimModifier.prototype.calculateShapeEdges=function(n,e,t,i,r){var o=[];e<=1?o.push({s:n,e}):n>=1?o.push({s:n-1,e:e-1}):(o.push({s:n,e:1}),o.push({s:0,e:e-1}));var s=[],l,c=o.length,d;for(l=0;l<c;l+=1)if(d=o[l],!(d.e*r<i||d.s*r>i+t)){var u,g;d.s*r<=i?u=0:u=(d.s*r-i)/t,d.e*r>=i+t?g=1:g=(d.e*r-i)/t,s.push([u,g]);}return s.length||s.push([0,0]),s;},TrimModifier.prototype.releasePathsData=function(n){var e,t=n.length;for(e=0;e<t;e+=1)segmentsLengthPool.release(n[e]);return n.length=0,n;},TrimModifier.prototype.processShapes=function(n){var e,t;if(this._mdf||n){var i=this.o.v%360/360;if(i<0&&(i+=1),this.s.v>1?e=1+i:this.s.v<0?e=0+i:e=this.s.v+i,this.e.v>1?t=1+i:this.e.v<0?t=0+i:t=this.e.v+i,e>t){var r=e;e=t,t=r;}e=Math.round(e*1e4)*1e-4,t=Math.round(t*1e4)*1e-4,this.sValue=e,this.eValue=t;}else e=this.sValue,t=this.eValue;var o,s,l=this.shapes.length,c,d,u,g,f,m=0;if(t===e)for(s=0;s<l;s+=1)this.shapes[s].localShapeCollection.releaseShapes(),this.shapes[s].shape._mdf=!0,this.shapes[s].shape.paths=this.shapes[s].localShapeCollection,this._mdf&&(this.shapes[s].pathsData.length=0);else if(t===1&&e===0||t===0&&e===1){if(this._mdf)for(s=0;s<l;s+=1)this.shapes[s].pathsData.length=0,this.shapes[s].shape._mdf=!0;}else{var _=[],y,E;for(s=0;s<l;s+=1)if(y=this.shapes[s],!y.shape._mdf&&!this._mdf&&!n&&this.m!==2)y.shape.paths=y.localShapeCollection;else{if(o=y.shape.paths,d=o._length,f=0,!y.shape._mdf&&y.pathsData.length)f=y.totalShapeLength;else{for(u=this.releasePathsData(y.pathsData),c=0;c<d;c+=1)g=bez.getSegmentsLength(o.shapes[c]),u.push(g),f+=g.totalLength;y.totalShapeLength=f,y.pathsData=u;}m+=f,y.shape._mdf=!0;}var C=e,b=t,x=0,w;for(s=l-1;s>=0;s-=1)if(y=this.shapes[s],y.shape._mdf){for(E=y.localShapeCollection,E.releaseShapes(),this.m===2&&l>1?(w=this.calculateShapeEdges(e,t,y.totalShapeLength,x,m),x+=y.totalShapeLength):w=[[C,b]],d=w.length,c=0;c<d;c+=1){C=w[c][0],b=w[c][1],_.length=0,b<=1?_.push({s:y.totalShapeLength*C,e:y.totalShapeLength*b}):C>=1?_.push({s:y.totalShapeLength*(C-1),e:y.totalShapeLength*(b-1)}):(_.push({s:y.totalShapeLength*C,e:y.totalShapeLength}),_.push({s:0,e:y.totalShapeLength*(b-1)}));var T=this.addShapes(y,_[0]);if(_[0].s!==_[0].e){if(_.length>1){var R=y.shape.paths.shapes[y.shape.paths._length-1];if(R.c){var V=T.pop();this.addPaths(T,E),T=this.addShapes(y,_[1],V);}else this.addPaths(T,E),T=this.addShapes(y,_[1]);}this.addPaths(T,E);}}y.shape.paths=E;}}},TrimModifier.prototype.addPaths=function(n,e){var t,i=n.length;for(t=0;t<i;t+=1)e.addShape(n[t]);},TrimModifier.prototype.addSegment=function(n,e,t,i,r,o,s){r.setXYAt(e[0],e[1],"o",o),r.setXYAt(t[0],t[1],"i",o+1),s&&r.setXYAt(n[0],n[1],"v",o),r.setXYAt(i[0],i[1],"v",o+1);},TrimModifier.prototype.addSegmentFromArray=function(n,e,t,i){e.setXYAt(n[1],n[5],"o",t),e.setXYAt(n[2],n[6],"i",t+1),i&&e.setXYAt(n[0],n[4],"v",t),e.setXYAt(n[3],n[7],"v",t+1);},TrimModifier.prototype.addShapes=function(n,e,t){var i=n.pathsData,r=n.shape.paths.shapes,o,s=n.shape.paths._length,l,c,d=0,u,g,f,m,_=[],y,E=!0;for(t?(g=t._length,y=t._length):(t=shapePool.newElement(),g=0,y=0),_.push(t),o=0;o<s;o+=1){for(f=i[o].lengths,t.c=r[o].c,c=r[o].c?f.length:f.length+1,l=1;l<c;l+=1)if(u=f[l-1],d+u.addedLength<e.s)d+=u.addedLength,t.c=!1;else if(d>e.e){t.c=!1;break;}else e.s<=d&&e.e>=d+u.addedLength?(this.addSegment(r[o].v[l-1],r[o].o[l-1],r[o].i[l],r[o].v[l],t,g,E),E=!1):(m=bez.getNewSegment(r[o].v[l-1],r[o].v[l],r[o].o[l-1],r[o].i[l],(e.s-d)/u.addedLength,(e.e-d)/u.addedLength,f[l-1]),this.addSegmentFromArray(m,t,g,E),E=!1,t.c=!1),d+=u.addedLength,g+=1;if(r[o].c&&f.length){if(u=f[l-1],d<=e.e){var C=f[l-1].addedLength;e.s<=d&&e.e>=d+C?(this.addSegment(r[o].v[l-1],r[o].o[l-1],r[o].i[0],r[o].v[0],t,g,E),E=!1):(m=bez.getNewSegment(r[o].v[l-1],r[o].v[0],r[o].o[l-1],r[o].i[0],(e.s-d)/C,(e.e-d)/C,f[l-1]),this.addSegmentFromArray(m,t,g,E),E=!1,t.c=!1);}else t.c=!1;d+=u.addedLength,g+=1;}if(t._length&&(t.setXYAt(t.v[y][0],t.v[y][1],"i",y),t.setXYAt(t.v[t._length-1][0],t.v[t._length-1][1],"o",t._length-1)),d>e.e)break;o<s-1&&(t=shapePool.newElement(),E=!0,_.push(t),g=0);}return _;};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(n,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(n,e.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length;},PuckerAndBloatModifier.prototype.processPath=function(n,e){var t=e/100,i=[0,0],r=n._length,o=0;for(o=0;o<r;o+=1)i[0]+=n.v[o][0],i[1]+=n.v[o][1];i[0]/=r,i[1]/=r;var s=shapePool.newElement();s.c=n.c;var l,c,d,u,g,f;for(o=0;o<r;o+=1)l=n.v[o][0]+(i[0]-n.v[o][0])*t,c=n.v[o][1]+(i[1]-n.v[o][1])*t,d=n.o[o][0]+(i[0]-n.o[o][0])*-t,u=n.o[o][1]+(i[1]-n.o[o][1])*-t,g=n.i[o][0]+(i[0]-n.i[o][0])*-t,f=n.i[o][1]+(i[1]-n.i[o][1])*-t,s.setTripleAt(l,c,d,u,g,f,o);return s;},PuckerAndBloatModifier.prototype.processShapes=function(n){var e,t,i=this.shapes.length,r,o,s=this.amount.v;if(s!==0){var l,c;for(t=0;t<i;t+=1){if(l=this.shapes[t],c=l.localShapeCollection,!(!l.shape._mdf&&!this._mdf&&!n))for(c.releaseShapes(),l.shape._mdf=!0,e=l.shape.paths.shapes,o=l.shape.paths._length,r=0;r<o;r+=1)c.addShape(this.processPath(e[r],s));l.shape.paths=l.localShapeCollection;}}this.dynamicProperties.length||(this._mdf=!1);};var TransformPropertyFactory=function(){var n=[0,0];function e(c){var d=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||d,this.a&&c.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&c.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&c.skewFromAxis(-this.sk.v,this.sa.v),this.r?c.rotate(-this.r.v):c.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?c.translate(this.px.v,this.py.v,-this.pz.v):c.translate(this.px.v,this.py.v,0):c.translate(this.p.v[0],this.p.v[1],-this.p.v[2]);}function t(c){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||c){var d;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var u,g;if(d=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(u=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/d,0),g=this.p.getValueAtTime(this.p.keyframes[0].t/d,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(u=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/d,0),g=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/d,0)):(u=this.p.pv,g=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/d,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){u=[],g=[];var f=this.px,m=this.py;f._caching.lastFrame+f.offsetTime<=f.keyframes[0].t?(u[0]=f.getValueAtTime((f.keyframes[0].t+.01)/d,0),u[1]=m.getValueAtTime((m.keyframes[0].t+.01)/d,0),g[0]=f.getValueAtTime(f.keyframes[0].t/d,0),g[1]=m.getValueAtTime(m.keyframes[0].t/d,0)):f._caching.lastFrame+f.offsetTime>=f.keyframes[f.keyframes.length-1].t?(u[0]=f.getValueAtTime(f.keyframes[f.keyframes.length-1].t/d,0),u[1]=m.getValueAtTime(m.keyframes[m.keyframes.length-1].t/d,0),g[0]=f.getValueAtTime((f.keyframes[f.keyframes.length-1].t-.01)/d,0),g[1]=m.getValueAtTime((m.keyframes[m.keyframes.length-1].t-.01)/d,0)):(u=[f.pv,m.pv],g[0]=f.getValueAtTime((f._caching.lastFrame+f.offsetTime-.01)/d,f.offsetTime),g[1]=m.getValueAtTime((m._caching.lastFrame+m.offsetTime-.01)/d,m.offsetTime));}else g=n,u=g;this.v.rotate(-Math.atan2(u[1]-g[1],u[0]-g[0]));}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2]);}this.frameId=this.elem.globalData.frameId;}}function i(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4);}function r(){}function o(c){this._addDynamicProperty(c),this.elem.addDynamicProperty(c),this._isDirty=!0;}function s(c,d,u){if(this.elem=c,this.frameId=-1,this.propType="transform",this.data=d,this.v=new Matrix(),this.pre=new Matrix(),this.appliedTransformations=0,this.initDynamicPropertyContainer(u||c),d.p&&d.p.s?(this.px=PropertyFactory.getProp(c,d.p.x,0,0,this),this.py=PropertyFactory.getProp(c,d.p.y,0,0,this),d.p.z&&(this.pz=PropertyFactory.getProp(c,d.p.z,0,0,this))):this.p=PropertyFactory.getProp(c,d.p||{k:[0,0,0]},1,0,this),d.rx){if(this.rx=PropertyFactory.getProp(c,d.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(c,d.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(c,d.rz,0,degToRads,this),d.or.k[0].ti){var g,f=d.or.k.length;for(g=0;g<f;g+=1)d.or.k[g].to=null,d.or.k[g].ti=null;}this.or=PropertyFactory.getProp(c,d.or,1,degToRads,this),this.or.sh=!0;}else this.r=PropertyFactory.getProp(c,d.r||{k:0},0,degToRads,this);d.sk&&(this.sk=PropertyFactory.getProp(c,d.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(c,d.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(c,d.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(c,d.s||{k:[100,100,100]},1,.01,this),d.o?this.o=PropertyFactory.getProp(c,d.o,0,.01,c):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0);}s.prototype={applyToMatrix:e,getValue:t,precalculateMatrix:i,autoOrient:r},extendPrototype([DynamicPropertyContainer],s),s.prototype.addDynamicProperty=o,s.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function l(c,d,u){return new s(c,d,u);}return{getTransformProperty:l};}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(n,e){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(n,e.c,0,null,this),this.o=PropertyFactory.getProp(n,e.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(n,e.tr,this),this.so=PropertyFactory.getProp(n,e.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(n,e.tr.eo,0,.01,this),this.data=e,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix(),this.rMatrix=new Matrix(),this.sMatrix=new Matrix(),this.tMatrix=new Matrix(),this.matrix=new Matrix();},RepeaterModifier.prototype.applyTransforms=function(n,e,t,i,r,o){var s=o?-1:1,l=i.s.v[0]+(1-i.s.v[0])*(1-r),c=i.s.v[1]+(1-i.s.v[1])*(1-r);n.translate(i.p.v[0]*s*r,i.p.v[1]*s*r,i.p.v[2]),e.translate(-i.a.v[0],-i.a.v[1],i.a.v[2]),e.rotate(-i.r.v*s*r),e.translate(i.a.v[0],i.a.v[1],i.a.v[2]),t.translate(-i.a.v[0],-i.a.v[1],i.a.v[2]),t.scale(o?1/l:l,o?1/c:c),t.translate(i.a.v[0],i.a.v[1],i.a.v[2]);},RepeaterModifier.prototype.init=function(n,e,t,i){for(this.elem=n,this.arr=e,this.pos=t,this.elemsData=i,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(n),this.initModifierProperties(n,e[t]);t>0;)t-=1,this._elements.unshift(e[t]);this.dynamicProperties.length?this.k=!0:this.getValue(!0);},RepeaterModifier.prototype.resetElements=function(n){var e,t=n.length;for(e=0;e<t;e+=1)n[e]._processed=!1,n[e].ty==="gr"&&this.resetElements(n[e].it);},RepeaterModifier.prototype.cloneElements=function(n){var e=JSON.parse(JSON.stringify(n));return this.resetElements(e),e;},RepeaterModifier.prototype.changeGroupRender=function(n,e){var t,i=n.length;for(t=0;t<i;t+=1)n[t]._render=e,n[t].ty==="gr"&&this.changeGroupRender(n[t].it,e);},RepeaterModifier.prototype.processShapes=function(n){var e,t,i,r,o,s=!1;if(this._mdf||n){var l=Math.ceil(this.c.v);if(this._groups.length<l){for(;this._groups.length<l;){var c={it:this.cloneElements(this._elements),ty:"gr"};c.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,c),this._groups.splice(0,0,c),this._currentCopies+=1;}this.elem.reloadShapes(),s=!0;}o=0;var d;for(i=0;i<=this._groups.length-1;i+=1){if(d=o<l,this._groups[i]._render=d,this.changeGroupRender(this._groups[i].it,d),!d){var u=this.elemsData[i].it,g=u[u.length-1];g.transform.op.v!==0?(g.transform.op._mdf=!0,g.transform.op.v=0):g.transform.op._mdf=!1;}o+=1;}this._currentCopies=l;var f=this.o.v,m=f%1,_=f>0?Math.floor(f):Math.ceil(f),y=this.pMatrix.props,E=this.rMatrix.props,C=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var b=0;if(f>0){for(;b<_;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),b+=1;m&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,m,!1),b+=m);}else if(f<0){for(;b>_;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),b-=1;m&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-m,!0),b-=m);}i=this.data.m===1?0:this._currentCopies-1,r=this.data.m===1?1:-1,o=this._currentCopies;for(var x,w;o;){if(e=this.elemsData[i].it,t=e[e.length-1].transform.mProps.v.props,w=t.length,e[e.length-1].transform.mProps._mdf=!0,e[e.length-1].transform.op._mdf=!0,e[e.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(i/(this._currentCopies-1)),b!==0){for((i!==0&&r===1||i!==this._currentCopies-1&&r===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15]),this.matrix.transform(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15]),this.matrix.transform(y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8],y[9],y[10],y[11],y[12],y[13],y[14],y[15]),x=0;x<w;x+=1)t[x]=this.matrix.props[x];this.matrix.reset();}else for(this.matrix.reset(),x=0;x<w;x+=1)t[x]=this.matrix.props[x];b+=1,o-=1,i+=r;}}else for(o=this._currentCopies,i=0,r=1;o;)e=this.elemsData[i].it,t=e[e.length-1].transform.mProps.v.props,e[e.length-1].transform.mProps._mdf=!1,e[e.length-1].transform.op._mdf=!1,o-=1,i+=r;return s;},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(n,e){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(n,e.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length;},RoundCornersModifier.prototype.processPath=function(n,e){var t=shapePool.newElement();t.c=n.c;var i,r=n._length,o,s,l,c,d,u,g=0,f,m,_,y,E,C;for(i=0;i<r;i+=1)o=n.v[i],l=n.o[i],s=n.i[i],o[0]===l[0]&&o[1]===l[1]&&o[0]===s[0]&&o[1]===s[1]?(i===0||i===r-1)&&!n.c?(t.setTripleAt(o[0],o[1],l[0],l[1],s[0],s[1],g),g+=1):(i===0?c=n.v[r-1]:c=n.v[i-1],d=Math.sqrt(Math.pow(o[0]-c[0],2)+Math.pow(o[1]-c[1],2)),u=d?Math.min(d/2,e)/d:0,E=o[0]+(c[0]-o[0])*u,f=E,C=o[1]-(o[1]-c[1])*u,m=C,_=f-(f-o[0])*roundCorner,y=m-(m-o[1])*roundCorner,t.setTripleAt(f,m,_,y,E,C,g),g+=1,i===r-1?c=n.v[0]:c=n.v[i+1],d=Math.sqrt(Math.pow(o[0]-c[0],2)+Math.pow(o[1]-c[1],2)),u=d?Math.min(d/2,e)/d:0,_=o[0]+(c[0]-o[0])*u,f=_,y=o[1]+(c[1]-o[1])*u,m=y,E=f-(f-o[0])*roundCorner,C=m-(m-o[1])*roundCorner,t.setTripleAt(f,m,_,y,E,C,g),g+=1):(t.setTripleAt(n.v[i][0],n.v[i][1],n.o[i][0],n.o[i][1],n.i[i][0],n.i[i][1],g),g+=1);return t;},RoundCornersModifier.prototype.processShapes=function(n){var e,t,i=this.shapes.length,r,o,s=this.rd.v;if(s!==0){var l,c;for(t=0;t<i;t+=1){if(l=this.shapes[t],c=l.localShapeCollection,!(!l.shape._mdf&&!this._mdf&&!n))for(c.releaseShapes(),l.shape._mdf=!0,e=l.shape.paths.shapes,o=l.shape.paths._length,r=0;r<o;r+=1)c.addShape(this.processPath(e[r],s));l.shape.paths=l.localShapeCollection;}}this.dynamicProperties.length||(this._mdf=!1);};function floatEqual(n,e){return Math.abs(n-e)*1e5<=Math.min(Math.abs(n),Math.abs(e));}function floatZero(n){return Math.abs(n)<=1e-5;}function lerp(n,e,t){return n*(1-t)+e*t;}function lerpPoint(n,e,t){return[lerp(n[0],e[0],t),lerp(n[1],e[1],t)];}function quadRoots(n,e,t){if(n===0)return[];var i=e*e-4*n*t;if(i<0)return[];var r=-e/(2*n);if(i===0)return[r];var o=Math.sqrt(i)/(2*n);return[r-o,r+o];}function polynomialCoefficients(n,e,t,i){return[-n+3*e-3*t+i,3*n-6*e+3*t,-3*n+3*e,n];}function singlePoint(n){return new PolynomialBezier(n,n,n,n,!1);}function PolynomialBezier(n,e,t,i,r){r&&pointEqual(n,e)&&(e=lerpPoint(n,i,1/3)),r&&pointEqual(t,i)&&(t=lerpPoint(n,i,2/3));var o=polynomialCoefficients(n[0],e[0],t[0],i[0]),s=polynomialCoefficients(n[1],e[1],t[1],i[1]);this.a=[o[0],s[0]],this.b=[o[1],s[1]],this.c=[o[2],s[2]],this.d=[o[3],s[3]],this.points=[n,e,t,i];}PolynomialBezier.prototype.point=function(n){return[((this.a[0]*n+this.b[0])*n+this.c[0])*n+this.d[0],((this.a[1]*n+this.b[1])*n+this.c[1])*n+this.d[1]];},PolynomialBezier.prototype.derivative=function(n){return[(3*n*this.a[0]+2*this.b[0])*n+this.c[0],(3*n*this.a[1]+2*this.b[1])*n+this.c[1]];},PolynomialBezier.prototype.tangentAngle=function(n){var e=this.derivative(n);return Math.atan2(e[1],e[0]);},PolynomialBezier.prototype.normalAngle=function(n){var e=this.derivative(n);return Math.atan2(e[0],e[1]);},PolynomialBezier.prototype.inflectionPoints=function(){var n=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(n))return[];var e=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/n,t=e*e-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/n;if(t<0)return[];var i=Math.sqrt(t);return floatZero(i)?i>0&&i<1?[e]:[]:[e-i,e+i].filter(function(r){return r>0&&r<1;});},PolynomialBezier.prototype.split=function(n){if(n<=0)return[singlePoint(this.points[0]),this];if(n>=1)return[this,singlePoint(this.points[this.points.length-1])];var e=lerpPoint(this.points[0],this.points[1],n),t=lerpPoint(this.points[1],this.points[2],n),i=lerpPoint(this.points[2],this.points[3],n),r=lerpPoint(e,t,n),o=lerpPoint(t,i,n),s=lerpPoint(r,o,n);return[new PolynomialBezier(this.points[0],e,r,s,!0),new PolynomialBezier(s,o,i,this.points[3],!0)];};function extrema(n,e){var t=n.points[0][e],i=n.points[n.points.length-1][e];if(t>i){var r=i;i=t,t=r;}for(var o=quadRoots(3*n.a[e],2*n.b[e],n.c[e]),s=0;s<o.length;s+=1)if(o[s]>0&&o[s]<1){var l=n.point(o[s])[e];l<t?t=l:l>i&&(i=l);}return{min:t,max:i};}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)};},PolynomialBezier.prototype.boundingBox=function(){var n=this.bounds();return{left:n.x.min,right:n.x.max,top:n.y.min,bottom:n.y.max,width:n.x.max-n.x.min,height:n.y.max-n.y.min,cx:(n.x.max+n.x.min)/2,cy:(n.y.max+n.y.min)/2};};function intersectData(n,e,t){var i=n.boundingBox();return{cx:i.cx,cy:i.cy,width:i.width,height:i.height,bez:n,t:(e+t)/2,t1:e,t2:t};}function splitData(n){var e=n.bez.split(.5);return[intersectData(e[0],n.t1,n.t),intersectData(e[1],n.t,n.t2)];}function boxIntersect(n,e){return Math.abs(n.cx-e.cx)*2<n.width+e.width&&Math.abs(n.cy-e.cy)*2<n.height+e.height;}function intersectsImpl(n,e,t,i,r,o){if(boxIntersect(n,e)){if(t>=o||n.width<=i&&n.height<=i&&e.width<=i&&e.height<=i){r.push([n.t,e.t]);return;}var s=splitData(n),l=splitData(e);intersectsImpl(s[0],l[0],t+1,i,r,o),intersectsImpl(s[0],l[1],t+1,i,r,o),intersectsImpl(s[1],l[0],t+1,i,r,o),intersectsImpl(s[1],l[1],t+1,i,r,o);}}PolynomialBezier.prototype.intersections=function(n,e,t){e===void 0&&(e=2),t===void 0&&(t=7);var i=[];return intersectsImpl(intersectData(this,0,1),intersectData(n,0,1),0,e,i,t),i;},PolynomialBezier.shapeSegment=function(n,e){var t=(e+1)%n.length();return new PolynomialBezier(n.v[e],n.o[e],n.i[t],n.v[t],!0);},PolynomialBezier.shapeSegmentInverted=function(n,e){var t=(e+1)%n.length();return new PolynomialBezier(n.v[t],n.i[t],n.o[e],n.v[e],!0);};function crossProduct(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]];}function lineIntersection(n,e,t,i){var r=[n[0],n[1],1],o=[e[0],e[1],1],s=[t[0],t[1],1],l=[i[0],i[1],1],c=crossProduct(crossProduct(r,o),crossProduct(s,l));return floatZero(c[2])?null:[c[0]/c[2],c[1]/c[2]];}function polarOffset(n,e,t){return[n[0]+Math.cos(e)*t,n[1]-Math.sin(e)*t];}function pointDistance(n,e){return Math.hypot(n[0]-e[0],n[1]-e[1]);}function pointEqual(n,e){return floatEqual(n[0],e[0])&&floatEqual(n[1],e[1]);}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(n,e){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(n,e.s,0,null,this),this.frequency=PropertyFactory.getProp(n,e.r,0,null,this),this.pointsType=PropertyFactory.getProp(n,e.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0;};function setPoint(n,e,t,i,r,o,s){var l=t-Math.PI/2,c=t+Math.PI/2,d=e[0]+Math.cos(t)*i*r,u=e[1]-Math.sin(t)*i*r;n.setTripleAt(d,u,d+Math.cos(l)*o,u-Math.sin(l)*o,d+Math.cos(c)*s,u-Math.sin(c)*s,n.length());}function getPerpendicularVector(n,e){var t=[e[0]-n[0],e[1]-n[1]],i=-Math.PI*.5,r=[Math.cos(i)*t[0]-Math.sin(i)*t[1],Math.sin(i)*t[0]+Math.cos(i)*t[1]];return r;}function getProjectingAngle(n,e){var t=e===0?n.length()-1:e-1,i=(e+1)%n.length(),r=n.v[t],o=n.v[i],s=getPerpendicularVector(r,o);return Math.atan2(0,1)-Math.atan2(s[1],s[0]);}function zigZagCorner(n,e,t,i,r,o,s){var l=getProjectingAngle(e,t),c=e.v[t%e._length],d=e.v[t===0?e._length-1:t-1],u=e.v[(t+1)%e._length],g=o===2?Math.sqrt(Math.pow(c[0]-d[0],2)+Math.pow(c[1]-d[1],2)):0,f=o===2?Math.sqrt(Math.pow(c[0]-u[0],2)+Math.pow(c[1]-u[1],2)):0;setPoint(n,e.v[t%e._length],l,s,i,f/((r+1)*2),g/((r+1)*2),o);}function zigZagSegment(n,e,t,i,r,o){for(var s=0;s<i;s+=1){var l=(s+1)/(i+1),c=r===2?Math.sqrt(Math.pow(e.points[3][0]-e.points[0][0],2)+Math.pow(e.points[3][1]-e.points[0][1],2)):0,d=e.normalAngle(l),u=e.point(l);setPoint(n,u,d,o,t,c/((i+1)*2),c/((i+1)*2),r),o=-o;}return o;}ZigZagModifier.prototype.processPath=function(n,e,t,i){var r=n._length,o=shapePool.newElement();if(o.c=n.c,n.c||(r-=1),r===0)return o;var s=-1,l=PolynomialBezier.shapeSegment(n,0);zigZagCorner(o,n,0,e,t,i,s);for(var c=0;c<r;c+=1)s=zigZagSegment(o,l,e,t,i,-s),c===r-1&&!n.c?l=null:l=PolynomialBezier.shapeSegment(n,(c+1)%r),zigZagCorner(o,n,c+1,e,t,i,s);return o;},ZigZagModifier.prototype.processShapes=function(n){var e,t,i=this.shapes.length,r,o,s=this.amplitude.v,l=Math.max(0,Math.round(this.frequency.v)),c=this.pointsType.v;if(s!==0){var d,u;for(t=0;t<i;t+=1){if(d=this.shapes[t],u=d.localShapeCollection,!(!d.shape._mdf&&!this._mdf&&!n))for(u.releaseShapes(),d.shape._mdf=!0,e=d.shape.paths.shapes,o=d.shape.paths._length,r=0;r<o;r+=1)u.addShape(this.processPath(e[r],s,l,c));d.shape.paths=d.localShapeCollection;}}this.dynamicProperties.length||(this._mdf=!1);};function linearOffset(n,e,t){var i=Math.atan2(e[0]-n[0],e[1]-n[1]);return[polarOffset(n,i,t),polarOffset(e,i,t)];}function offsetSegment(n,e){var t,i,r,o,s,l,c;c=linearOffset(n.points[0],n.points[1],e),t=c[0],i=c[1],c=linearOffset(n.points[1],n.points[2],e),r=c[0],o=c[1],c=linearOffset(n.points[2],n.points[3],e),s=c[0],l=c[1];var d=lineIntersection(t,i,r,o);d===null&&(d=i);var u=lineIntersection(s,l,r,o);return u===null&&(u=s),new PolynomialBezier(t,d,u,l);}function joinLines(n,e,t,i,r){var o=e.points[3],s=t.points[0];if(i===3||pointEqual(o,s))return o;if(i===2){var l=-e.tangentAngle(1),c=-t.tangentAngle(0)+Math.PI,d=lineIntersection(o,polarOffset(o,l+Math.PI/2,100),s,polarOffset(s,l+Math.PI/2,100)),u=d?pointDistance(d,o):pointDistance(o,s)/2,g=polarOffset(o,l,2*u*roundCorner);return n.setXYAt(g[0],g[1],"o",n.length()-1),g=polarOffset(s,c,2*u*roundCorner),n.setTripleAt(s[0],s[1],s[0],s[1],g[0],g[1],n.length()),s;}var f=pointEqual(o,e.points[2])?e.points[0]:e.points[2],m=pointEqual(s,t.points[1])?t.points[3]:t.points[1],_=lineIntersection(f,o,s,m);return _&&pointDistance(_,o)<r?(n.setTripleAt(_[0],_[1],_[0],_[1],_[0],_[1],n.length()),_):o;}function getIntersection(n,e){var t=n.intersections(e);return t.length&&floatEqual(t[0][0],1)&&t.shift(),t.length?t[0]:null;}function pruneSegmentIntersection(n,e){var t=n.slice(),i=e.slice(),r=getIntersection(n[n.length-1],e[0]);return r&&(t[n.length-1]=n[n.length-1].split(r[0])[0],i[0]=e[0].split(r[1])[1]),n.length>1&&e.length>1&&(r=getIntersection(n[0],e[e.length-1]),r)?[[n[0].split(r[0])[0]],[e[e.length-1].split(r[1])[1]]]:[t,i];}function pruneIntersections(n){for(var e,t=1;t<n.length;t+=1)e=pruneSegmentIntersection(n[t-1],n[t]),n[t-1]=e[0],n[t]=e[1];return n.length>1&&(e=pruneSegmentIntersection(n[n.length-1],n[0]),n[n.length-1]=e[0],n[0]=e[1]),n;}function offsetSegmentSplit(n,e){var t=n.inflectionPoints(),i,r,o,s;if(t.length===0)return[offsetSegment(n,e)];if(t.length===1||floatEqual(t[1],1))return o=n.split(t[0]),i=o[0],r=o[1],[offsetSegment(i,e),offsetSegment(r,e)];o=n.split(t[0]),i=o[0];var l=(t[1]-t[0])/(1-t[0]);return o=o[1].split(l),s=o[0],r=o[1],[offsetSegment(i,e),offsetSegment(s,e),offsetSegment(r,e)];}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(n,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(n,e.a,0,null,this),this.miterLimit=PropertyFactory.getProp(n,e.ml,0,null,this),this.lineJoin=e.lj,this._isAnimated=this.amount.effectsSequence.length!==0;},OffsetPathModifier.prototype.processPath=function(n,e,t,i){var r=shapePool.newElement();r.c=n.c;var o=n.length();n.c||(o-=1);var s,l,c,d=[];for(s=0;s<o;s+=1)c=PolynomialBezier.shapeSegment(n,s),d.push(offsetSegmentSplit(c,e));if(!n.c)for(s=o-1;s>=0;s-=1)c=PolynomialBezier.shapeSegmentInverted(n,s),d.push(offsetSegmentSplit(c,e));d=pruneIntersections(d);var u=null,g=null;for(s=0;s<d.length;s+=1){var f=d[s];for(g&&(u=joinLines(r,g,f[0],t,i)),g=f[f.length-1],l=0;l<f.length;l+=1)c=f[l],u&&pointEqual(c.points[0],u)?r.setXYAt(c.points[1][0],c.points[1][1],"o",r.length()-1):r.setTripleAt(c.points[0][0],c.points[0][1],c.points[1][0],c.points[1][1],c.points[0][0],c.points[0][1],r.length()),r.setTripleAt(c.points[3][0],c.points[3][1],c.points[3][0],c.points[3][1],c.points[2][0],c.points[2][1],r.length()),u=c.points[3];}return d.length&&joinLines(r,g,d[0][0],t,i),r;},OffsetPathModifier.prototype.processShapes=function(n){var e,t,i=this.shapes.length,r,o,s=this.amount.v,l=this.miterLimit.v,c=this.lineJoin;if(s!==0){var d,u;for(t=0;t<i;t+=1){if(d=this.shapes[t],u=d.localShapeCollection,!(!d.shape._mdf&&!this._mdf&&!n))for(u.releaseShapes(),d.shape._mdf=!0,e=d.shape.paths.shapes,o=d.shape.paths._length,r=0;r<o;r+=1)u.addShape(this.processPath(e[r],s,c,l));d.shape.paths=d.localShapeCollection;}}this.dynamicProperties.length||(this._mdf=!1);};function getFontProperties(n){for(var e=n.fStyle?n.fStyle.split(" "):[],t="normal",i="normal",r=e.length,o,s=0;s<r;s+=1)switch(o=e[s].toLowerCase(),o){case"italic":i="italic";break;case"bold":t="700";break;case"black":t="900";break;case"medium":t="500";break;case"regular":case"normal":t="400";break;case"light":case"thin":t="200";break;default:break;}return{style:i,weight:n.fWeight||t};}var FontManager=function(){var n=5e3,e={w:0,size:0,shapes:[],data:{shapes:[]}},t=[];t=t.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var i=127988,r=917631,o=917601,s=917626,l=65039,c=8205,d=127462,u=127487,g=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function f(A){var z=A.split(","),O,k=z.length,H=[];for(O=0;O<k;O+=1)z[O]!=="sans-serif"&&z[O]!=="monospace"&&H.push(z[O]);return H.join(",");}function m(A,z){var O=createTag("span");O.setAttribute("aria-hidden",!0),O.style.fontFamily=z;var k=createTag("span");k.innerText="giItT1WQy@!-/#",O.style.position="absolute",O.style.left="-10000px",O.style.top="-10000px",O.style.fontSize="300px",O.style.fontVariant="normal",O.style.fontStyle="normal",O.style.fontWeight="normal",O.style.letterSpacing="0",O.appendChild(k),document.body.appendChild(O);var H=k.offsetWidth;return k.style.fontFamily=f(A)+", "+z,{node:k,w:H,parent:O};}function _(){var A,z=this.fonts.length,O,k,H=z;for(A=0;A<z;A+=1)this.fonts[A].loaded?H-=1:this.fonts[A].fOrigin==="n"||this.fonts[A].origin===0?this.fonts[A].loaded=!0:(O=this.fonts[A].monoCase.node,k=this.fonts[A].monoCase.w,O.offsetWidth!==k?(H-=1,this.fonts[A].loaded=!0):(O=this.fonts[A].sansCase.node,k=this.fonts[A].sansCase.w,O.offsetWidth!==k&&(H-=1,this.fonts[A].loaded=!0)),this.fonts[A].loaded&&(this.fonts[A].sansCase.parent.parentNode.removeChild(this.fonts[A].sansCase.parent),this.fonts[A].monoCase.parent.parentNode.removeChild(this.fonts[A].monoCase.parent)));H!==0&&Date.now()-this.initTime<n?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10);}function y(A,z){var O=document.body&&z?"svg":"canvas",k,H=getFontProperties(A);if(O==="svg"){var U=createNS("text");U.style.fontSize="100px",U.setAttribute("font-family",A.fFamily),U.setAttribute("font-style",H.style),U.setAttribute("font-weight",H.weight),U.textContent="1",A.fClass?(U.style.fontFamily="inherit",U.setAttribute("class",A.fClass)):U.style.fontFamily=A.fFamily,z.appendChild(U),k=U;}else{var pe=new OffscreenCanvas(500,500).getContext("2d");pe.font=H.style+" "+H.weight+" 100px "+A.fFamily,k=pe;}function me(fe){return O==="svg"?(k.textContent=fe,k.getComputedTextLength()):k.measureText(fe).width;}return{measureText:me};}function E(A,z){if(!A){this.isLoaded=!0;return;}if(this.chars){this.isLoaded=!0,this.fonts=A.list;return;}if(!document.body){this.isLoaded=!0,A.list.forEach(function(bt){bt.helper=y(bt),bt.cache={};}),this.fonts=A.list;return;}var O=A.list,k,H=O.length,U=H;for(k=0;k<H;k+=1){var pe=!0,me,fe;if(O[k].loaded=!1,O[k].monoCase=m(O[k].fFamily,"monospace"),O[k].sansCase=m(O[k].fFamily,"sans-serif"),!O[k].fPath)O[k].loaded=!0,U-=1;else if(O[k].fOrigin==="p"||O[k].origin===3){if(me=document.querySelectorAll('style[f-forigin="p"][f-family="'+O[k].fFamily+'"], style[f-origin="3"][f-family="'+O[k].fFamily+'"]'),me.length>0&&(pe=!1),pe){var Fe=createTag("style");Fe.setAttribute("f-forigin",O[k].fOrigin),Fe.setAttribute("f-origin",O[k].origin),Fe.setAttribute("f-family",O[k].fFamily),Fe.type="text/css",Fe.innerText="@font-face {font-family: "+O[k].fFamily+"; font-style: normal; src: url('"+O[k].fPath+"');}",z.appendChild(Fe);}}else if(O[k].fOrigin==="g"||O[k].origin===1){for(me=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),fe=0;fe<me.length;fe+=1)me[fe].href.indexOf(O[k].fPath)!==-1&&(pe=!1);if(pe){var Te=createTag("link");Te.setAttribute("f-forigin",O[k].fOrigin),Te.setAttribute("f-origin",O[k].origin),Te.type="text/css",Te.rel="stylesheet",Te.href=O[k].fPath,document.body.appendChild(Te);}}else if(O[k].fOrigin==="t"||O[k].origin===2){for(me=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),fe=0;fe<me.length;fe+=1)O[k].fPath===me[fe].src&&(pe=!1);if(pe){var qe=createTag("link");qe.setAttribute("f-forigin",O[k].fOrigin),qe.setAttribute("f-origin",O[k].origin),qe.setAttribute("rel","stylesheet"),qe.setAttribute("href",O[k].fPath),z.appendChild(qe);}}O[k].helper=y(O[k],z),O[k].cache={},this.fonts.push(O[k]);}U===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100);}function C(A){if(A){this.chars||(this.chars=[]);var z,O=A.length,k,H=this.chars.length,U;for(z=0;z<O;z+=1){for(k=0,U=!1;k<H;)this.chars[k].style===A[z].style&&this.chars[k].fFamily===A[z].fFamily&&this.chars[k].ch===A[z].ch&&(U=!0),k+=1;U||(this.chars.push(A[z]),H+=1);}}}function b(A,z,O){for(var k=0,H=this.chars.length;k<H;){if(this.chars[k].ch===A&&this.chars[k].style===z&&this.chars[k].fFamily===O)return this.chars[k];k+=1;}return(typeof A=="string"&&A.charCodeAt(0)!==13||!A)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",A,z,O)),e;}function x(A,z,O){var k=this.getFontByName(z),H=A;if(!k.cache[H]){var U=k.helper;if(A===" "){var pe=U.measureText("|"+A+"|"),me=U.measureText("||");k.cache[H]=(pe-me)/100;}else k.cache[H]=U.measureText(A)/100;}return k.cache[H]*O;}function w(A){for(var z=0,O=this.fonts.length;z<O;){if(this.fonts[z].fName===A)return this.fonts[z];z+=1;}return this.fonts[0];}function T(A){var z=0,O=A.charCodeAt(0);if(O>=55296&&O<=56319){var k=A.charCodeAt(1);k>=56320&&k<=57343&&(z=(O-55296)*1024+k-56320+65536);}return z;}function R(A,z){var O=A.toString(16)+z.toString(16);return g.indexOf(O)!==-1;}function V(A){return A===c;}function B(A){return A===l;}function Y(A){var z=T(A);return z>=d&&z<=u;}function le(A){return Y(A.substr(0,2))&&Y(A.substr(2,2));}function ae(A){return t.indexOf(A)!==-1;}function ee(A,z){var O=T(A.substr(z,2));if(O!==i)return!1;var k=0;for(z+=2;k<5;){if(O=T(A.substr(z,2)),O<o||O>s)return!1;k+=1,z+=2;}return T(A.substr(z,2))===r;}function ce(){this.isLoaded=!0;}var oe=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this);};oe.isModifier=R,oe.isZeroWidthJoiner=V,oe.isFlagEmoji=le,oe.isRegionalCode=Y,oe.isCombinedCharacter=ae,oe.isRegionalFlag=ee,oe.isVariationSelector=B,oe.BLACK_FLAG_CODE_POINT=i;var re={addChars:C,addFonts:E,getCharData:b,getFontByName:w,measureText:x,checkLoadedFonts:_,setIsLoaded:ce};return oe.prototype=re,oe;}();function SlotManager(n){this.animationData=n;}SlotManager.prototype.getProp=function(n){return this.animationData.slots&&this.animationData.slots[n.sid]?Object.assign(n,this.animationData.slots[n.sid].p):n;};function slotFactory(n){return new SlotManager(n);}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[];},addRenderableComponent:function(e){this.renderableComponents.indexOf(e)===-1&&this.renderableComponents.push(e);},removeRenderableComponent:function(e){this.renderableComponents.indexOf(e)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(e),1);},prepareRenderableFrame:function(e){this.checkLayerLimits(e);},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show());},checkLayerLimits:function(e){this.data.ip-this.data.st<=e&&this.data.op-this.data.st>e?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide());},renderRenderable:function(){var e,t=this.renderableComponents.length;for(e=0;e<t;e+=1)this.renderableComponents[e].renderFrame(this._isFirstFrame);},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100};},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height};}};var getBlendMode=function(){var n={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(e){return n[e]||"";};}();function SliderEffect(n,e,t){this.p=PropertyFactory.getProp(e,n.v,0,0,t);}function AngleEffect(n,e,t){this.p=PropertyFactory.getProp(e,n.v,0,0,t);}function ColorEffect(n,e,t){this.p=PropertyFactory.getProp(e,n.v,1,0,t);}function PointEffect(n,e,t){this.p=PropertyFactory.getProp(e,n.v,1,0,t);}function LayerIndexEffect(n,e,t){this.p=PropertyFactory.getProp(e,n.v,0,0,t);}function MaskIndexEffect(n,e,t){this.p=PropertyFactory.getProp(e,n.v,0,0,t);}function CheckboxEffect(n,e,t){this.p=PropertyFactory.getProp(e,n.v,0,0,t);}function NoValueEffect(){this.p={};}function EffectsManager(n,e){var t=n.ef||[];this.effectElements=[];var i,r=t.length,o;for(i=0;i<r;i+=1)o=new GroupEffect(t[i],e),this.effectElements.push(o);}function GroupEffect(n,e){this.init(n,e);}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(n,e){this.data=n,this.effectElements=[],this.initDynamicPropertyContainer(e);var t,i=this.data.ef.length,r,o=this.data.ef;for(t=0;t<i;t+=1){switch(r=null,o[t].ty){case 0:r=new SliderEffect(o[t],e,this);break;case 1:r=new AngleEffect(o[t],e,this);break;case 2:r=new ColorEffect(o[t],e,this);break;case 3:r=new PointEffect(o[t],e,this);break;case 4:case 7:r=new CheckboxEffect(o[t],e,this);break;case 10:r=new LayerIndexEffect(o[t],e,this);break;case 11:r=new MaskIndexEffect(o[t],e,this);break;case 5:r=new EffectsManager(o[t],e,this);break;default:r=new NoValueEffect(o[t],e,this);break;}r&&this.effectElements.push(r);}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var e=0,t=this.data.masksProperties.length;e<t;){if(this.data.masksProperties[e].mode!=="n"&&this.data.masksProperties[e].cl!==!1)return!0;e+=1;}return!1;},initExpressions:function(){var e=getExpressionInterfaces();if(e){var t=e("layer"),i=e("effects"),r=e("shape"),o=e("text"),s=e("comp");this.layerInterface=t(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var l=i.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(l),this.data.ty===0||this.data.xt?this.compInterface=s(this):this.data.ty===4?(this.layerInterface.shapeInterface=r(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=o(this),this.layerInterface.text=this.layerInterface.textInterface);}},setBlendMode:function(){var e=getBlendMode(this.data.bm),t=this.baseElement||this.layerElement;t.style["mix-blend-mode"]=e;},initBaseData:function(e,t,i){this.globalData=t,this.comp=i,this.data=e,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties);},getType:function(){return this.type;},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1;},prepareProperties:function(e,t){var i,r=this.dynamicProperties.length;for(i=0;i<r;i+=1)(t||this._isParent&&this.dynamicProperties[i].propType==="transform")&&(this.dynamicProperties[i].getValue(),this.dynamicProperties[i]._mdf&&(this.globalData._mdf=!0,this._mdf=!0));},addDynamicProperty:function(e){this.dynamicProperties.indexOf(e)===-1&&this.dynamicProperties.push(e);}};function FootageElement(n,e,t){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(n.refId),this.footageData=e.imageLoader.getAsset(this.assetData),this.initBaseData(n,e,t);}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null;},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var n=getExpressionInterfaces();if(n){var e=n("footage");this.layerInterface=e(this);}},FootageElement.prototype.getFootageData=function(){return this.footageData;};function AudioElement(n,e,t){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(n.refId),this.initBaseData(n,e,t),this._isPlaying=!1,this._canPlay=!1;var i=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(i),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=n.tm?PropertyFactory.getProp(this,n.tm,0,e.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,n.au&&n.au.lv?n.au.lv:{k:[100]},1,.01,this);}AudioElement.prototype.prepareFrame=function(n){if(this.prepareRenderableFrame(n,!0),this.prepareProperties(n,!0),this.tm._placeholder)this._currentTime=n/this.data.sr;else{var e=this.tm.v;this._currentTime=e;}this._volume=this.lv.v[0];var t=this._volume*this._volumeMultiplier;this._previousVolume!==t&&(this._previousVolume=t,this.audio.volume(t));},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0));},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1;},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1;},AudioElement.prototype.resume=function(){this._canPlay=!0;},AudioElement.prototype.setRate=function(n){this.audio.rate(n);},AudioElement.prototype.volume=function(n){this._volumeMultiplier=n,this._previousVolume=n*this._volume,this.audio.volume(this._previousVolume);},AudioElement.prototype.getBaseElement=function(){return null;},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(n){var e,t=this.layers.length,i;for(this.completeLayers=!0,e=t-1;e>=0;e-=1)this.elements[e]||(i=this.layers[e],i.ip-i.st<=n-this.layers[e].st&&i.op-i.st>n-this.layers[e].st&&this.buildItem(e)),this.completeLayers=this.elements[e]?this.completeLayers:!1;this.checkPendingElements();},BaseRenderer.prototype.createItem=function(n){switch(n.ty){case 2:return this.createImage(n);case 0:return this.createComp(n);case 1:return this.createSolid(n);case 3:return this.createNull(n);case 4:return this.createShape(n);case 5:return this.createText(n);case 6:return this.createAudio(n);case 13:return this.createCamera(n);case 15:return this.createFootage(n);default:return this.createNull(n);}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.");},BaseRenderer.prototype.createAudio=function(n){return new AudioElement(n,this.globalData,this);},BaseRenderer.prototype.createFootage=function(n){return new FootageElement(n,this.globalData,this);},BaseRenderer.prototype.buildAllItems=function(){var n,e=this.layers.length;for(n=0;n<e;n+=1)this.buildItem(n);this.checkPendingElements();},BaseRenderer.prototype.includeLayers=function(n){this.completeLayers=!1;var e,t=n.length,i,r=this.layers.length;for(e=0;e<t;e+=1)for(i=0;i<r;){if(this.layers[i].id===n[e].id){this.layers[i]=n[e];break;}i+=1;}},BaseRenderer.prototype.setProjectInterface=function(n){this.globalData.projectInterface=n;},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems();},BaseRenderer.prototype.buildElementParenting=function(n,e,t){for(var i=this.elements,r=this.layers,o=0,s=r.length;o<s;)r[o].ind==e&&(!i[o]||i[o]===!0?(this.buildItem(o),this.addPendingElement(n)):(t.push(i[o]),i[o].setAsParent(),r[o].parent!==void 0?this.buildElementParenting(n,r[o].parent,t):n.setHierarchy(t))),o+=1;},BaseRenderer.prototype.addPendingElement=function(n){this.pendingElements.push(n);},BaseRenderer.prototype.searchExtraCompositions=function(n){var e,t=n.length;for(e=0;e<t;e+=1)if(n[e].xt){var i=this.createComp(n[e]);i.initExpressions(),this.globalData.projectInterface.registerComposition(i);}},BaseRenderer.prototype.getElementById=function(n){var e,t=this.elements.length;for(e=0;e<t;e+=1)if(this.elements[e].data.ind===n)return this.elements[e];return null;},BaseRenderer.prototype.getElementByPath=function(n){var e=n.shift(),t;if(typeof e=="number")t=this.elements[e];else{var i,r=this.elements.length;for(i=0;i<r;i+=1)if(this.elements[i].data.nm===e){t=this.elements[i];break;}}return n.length===0?t:t.getElementByPath(n);},BaseRenderer.prototype.setupGlobalData=function(n,e){this.globalData.fontManager=new FontManager(),this.globalData.slotManager=slotFactory(n),this.globalData.fontManager.addChars(n.chars),this.globalData.fontManager.addFonts(n.fonts,e),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=n.fr,this.globalData.nm=n.nm,this.globalData.compSize={w:n.w,h:n.h};};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var e=new Matrix();this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:e,localMat:e,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty;},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var e,t=this.finalTransform.mat,i=0,r=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;i<r;){if(this.hierarchy[i].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break;}i+=1;}if(this.finalTransform._matMdf)for(e=this.finalTransform.mProp.v.props,t.cloneFromProps(e),i=0;i<r;i+=1)t.multiply(this.hierarchy[i].finalTransform.mProp.v);}(!this.localTransforms||this.finalTransform._matMdf)&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v);},renderLocalTransform:function(){if(this.localTransforms){var e=0,t=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;e<t;)this.localTransforms[e]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[e]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),e+=1;if(this.finalTransform._localMatMdf){var i=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(i),e=1;e<t;e+=1){var r=this.localTransforms[e].matrix;i.multiply(r);}i.multiply(this.finalTransform.mat);}if(this.finalTransform._opMdf){var o=this.finalTransform.localOpacity;for(e=0;e<t;e+=1)o*=this.localTransforms[e].opacity*.01;this.finalTransform.localOpacity=o;}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var e=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(e.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix();var t=0,i=e.length;for(t=0;t<i;t+=1)this.localTransforms.push(e[t]);}}},globalToLocal:function(e){var t=[];t.push(this.finalTransform);for(var i=!0,r=this.comp;i;)r.finalTransform?(r.data.hasMask&&t.splice(0,0,r.finalTransform),r=r.comp):i=!1;var o,s=t.length,l;for(o=0;o<s;o+=1)l=t[o].mat.applyToPointArray(0,0,0),e=[e[0]-l[0],e[1]-l[1],0];return e;},mHelper:new Matrix()};function MaskElement(n,e,t){this.data=n,this.element=e,this.globalData=t,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var i=this.globalData.defs,r,o=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(o),this.solidPath="";var s,l=this.masksProperties,c=0,d=[],u,g,f=createElementID(),m,_,y,E,C="clipPath",b="clip-path";for(r=0;r<o;r+=1)if((l[r].mode!=="a"&&l[r].mode!=="n"||l[r].inv||l[r].o.k!==100||l[r].o.x)&&(C="mask",b="mask"),(l[r].mode==="s"||l[r].mode==="i")&&c===0?(m=createNS("rect"),m.setAttribute("fill","#ffffff"),m.setAttribute("width",this.element.comp.data.w||0),m.setAttribute("height",this.element.comp.data.h||0),d.push(m)):m=null,s=createNS("path"),l[r].mode==="n")this.viewData[r]={op:PropertyFactory.getProp(this.element,l[r].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,l[r],3),elem:s,lastPath:""},i.appendChild(s);else{c+=1,s.setAttribute("fill",l[r].mode==="s"?"#000000":"#ffffff"),s.setAttribute("clip-rule","nonzero");var x;if(l[r].x.k!==0?(C="mask",b="mask",E=PropertyFactory.getProp(this.element,l[r].x,0,null,this.element),x=createElementID(),_=createNS("filter"),_.setAttribute("id",x),y=createNS("feMorphology"),y.setAttribute("operator","erode"),y.setAttribute("in","SourceGraphic"),y.setAttribute("radius","0"),_.appendChild(y),i.appendChild(_),s.setAttribute("stroke",l[r].mode==="s"?"#000000":"#ffffff")):(y=null,E=null),this.storedData[r]={elem:s,x:E,expan:y,lastPath:"",lastOperator:"",filterId:x,lastRadius:0},l[r].mode==="i"){g=d.length;var w=createNS("g");for(u=0;u<g;u+=1)w.appendChild(d[u]);var T=createNS("mask");T.setAttribute("mask-type","alpha"),T.setAttribute("id",f+"_"+c),T.appendChild(s),i.appendChild(T),w.setAttribute("mask","url("+getLocationHref()+"#"+f+"_"+c+")"),d.length=0,d.push(w);}else d.push(s);l[r].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[r]={elem:s,lastPath:"",op:PropertyFactory.getProp(this.element,l[r].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,l[r],3),invRect:m},this.viewData[r].prop.k||this.drawPath(l[r],this.viewData[r].prop.v,this.viewData[r]);}for(this.maskElement=createNS(C),o=d.length,r=0;r<o;r+=1)this.maskElement.appendChild(d[r]);c>0&&(this.maskElement.setAttribute("id",f),this.element.maskedElement.setAttribute(b,"url("+getLocationHref()+"#"+f+")"),i.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this);}MaskElement.prototype.getMaskProperty=function(n){return this.viewData[n].prop;},MaskElement.prototype.renderFrame=function(n){var e=this.element.finalTransform.mat,t,i=this.masksProperties.length;for(t=0;t<i;t+=1)if((this.viewData[t].prop._mdf||n)&&this.drawPath(this.masksProperties[t],this.viewData[t].prop.v,this.viewData[t]),(this.viewData[t].op._mdf||n)&&this.viewData[t].elem.setAttribute("fill-opacity",this.viewData[t].op.v),this.masksProperties[t].mode!=="n"&&(this.viewData[t].invRect&&(this.element.finalTransform.mProp._mdf||n)&&this.viewData[t].invRect.setAttribute("transform",e.getInverseMatrix().to2dCSS()),this.storedData[t].x&&(this.storedData[t].x._mdf||n))){var r=this.storedData[t].expan;this.storedData[t].x.v<0?(this.storedData[t].lastOperator!=="erode"&&(this.storedData[t].lastOperator="erode",this.storedData[t].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[t].filterId+")")),r.setAttribute("radius",-this.storedData[t].x.v)):(this.storedData[t].lastOperator!=="dilate"&&(this.storedData[t].lastOperator="dilate",this.storedData[t].elem.setAttribute("filter",null)),this.storedData[t].elem.setAttribute("stroke-width",this.storedData[t].x.v*2));}},MaskElement.prototype.getMaskelement=function(){return this.maskElement;},MaskElement.prototype.createLayerSolidPath=function(){var n="M0,0 ";return n+=" h"+this.globalData.compSize.w,n+=" v"+this.globalData.compSize.h,n+=" h-"+this.globalData.compSize.w,n+=" v-"+this.globalData.compSize.h+" ",n;},MaskElement.prototype.drawPath=function(n,e,t){var i=" M"+e.v[0][0]+","+e.v[0][1],r,o;for(o=e._length,r=1;r<o;r+=1)i+=" C"+e.o[r-1][0]+","+e.o[r-1][1]+" "+e.i[r][0]+","+e.i[r][1]+" "+e.v[r][0]+","+e.v[r][1];if(e.c&&o>1&&(i+=" C"+e.o[r-1][0]+","+e.o[r-1][1]+" "+e.i[0][0]+","+e.i[0][1]+" "+e.v[0][0]+","+e.v[0][1]),t.lastPath!==i){var s="";t.elem&&(e.c&&(s=n.inv?this.solidPath+i:i),t.elem.setAttribute("d",s)),t.lastPath=i;}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null;};var filtersFactory=function(){var n={};n.createFilter=e,n.createAlphaToLuminanceFilter=t;function e(i,r){var o=createNS("filter");return o.setAttribute("id",i),r!==!0&&(o.setAttribute("filterUnits","objectBoundingBox"),o.setAttribute("x","0%"),o.setAttribute("y","0%"),o.setAttribute("width","100%"),o.setAttribute("height","100%")),o;}function t(){var i=createNS("feColorMatrix");return i.setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),i;}return n;}(),featureSupport=function(){var n={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(n.maskType=!1),/firefox/i.test(navigator.userAgent)&&(n.svgLumaHidden=!1),n;}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(n){var e,t="SourceGraphic",i=n.data.ef?n.data.ef.length:0,r=createElementID(),o=filtersFactory.createFilter(r,!0),s=0;this.filters=[];var l;for(e=0;e<i;e+=1){l=null;var c=n.data.ef[e].ty;if(registeredEffects$1[c]){var d=registeredEffects$1[c].effect;l=new d(o,n.effectsManager.effectElements[e],n,idPrefix+s,t),t=idPrefix+s,registeredEffects$1[c].countsAsEffect&&(s+=1);}l&&this.filters.push(l);}s&&(n.globalData.defs.appendChild(o),n.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+r+")")),this.filters.length&&n.addRenderableComponent(this);}SVGEffects.prototype.renderFrame=function(n){var e,t=this.filters.length;for(e=0;e<t;e+=1)this.filters[e].renderFrame(n);},SVGEffects.prototype.getEffects=function(n){var e,t=this.filters.length,i=[];for(e=0;e<t;e+=1)this.filters[e].type===n&&i.push(this.filters[e]);return i;};function registerEffect$1(n,e,t){registeredEffects$1[n]={effect:e,countsAsEffect:t};}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g");},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var e=null;if(this.data.td){this.matteMasks={};var t=createNS("g");t.setAttribute("id",this.layerId),t.appendChild(this.layerElement),e=t,this.globalData.defs.appendChild(t);}else this.data.tt?(this.matteElement.appendChild(this.layerElement),e=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var i=createNS("clipPath"),r=createNS("path");r.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var o=createElementID();if(i.setAttribute("id",o),i.appendChild(r),this.globalData.defs.appendChild(i),this.checkMasks()){var s=createNS("g");s.setAttribute("clip-path","url("+getLocationHref()+"#"+o+")"),s.appendChild(this.layerElement),this.transformedElement=s,e?e.appendChild(this.transformedElement):this.baseElement=this.transformedElement;}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+o+")");}this.data.bm!==0&&this.setBlendMode();},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity);},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy();},getBaseElement:function(){return this.data.hd?null:this.baseElement;},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms();},getMatte:function(e){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[e]){var t=this.layerId+"_"+e,i,r,o,s;if(e===1||e===3){var l=createNS("mask");l.setAttribute("id",t),l.setAttribute("mask-type",e===3?"luminance":"alpha"),o=createNS("use"),o.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),l.appendChild(o),this.globalData.defs.appendChild(l),!featureSupport.maskType&&e===1&&(l.setAttribute("mask-type","luminance"),i=createElementID(),r=filtersFactory.createFilter(i),this.globalData.defs.appendChild(r),r.appendChild(filtersFactory.createAlphaToLuminanceFilter()),s=createNS("g"),s.appendChild(o),l.appendChild(s),s.setAttribute("filter","url("+getLocationHref()+"#"+i+")"));}else if(e===2){var c=createNS("mask");c.setAttribute("id",t),c.setAttribute("mask-type","alpha");var d=createNS("g");c.appendChild(d),i=createElementID(),r=filtersFactory.createFilter(i);var u=createNS("feComponentTransfer");u.setAttribute("in","SourceGraphic"),r.appendChild(u);var g=createNS("feFuncA");g.setAttribute("type","table"),g.setAttribute("tableValues","1.0 0.0"),u.appendChild(g),this.globalData.defs.appendChild(r);var f=createNS("rect");f.setAttribute("width",this.comp.data.w),f.setAttribute("height",this.comp.data.h),f.setAttribute("x","0"),f.setAttribute("y","0"),f.setAttribute("fill","#ffffff"),f.setAttribute("opacity","0"),d.setAttribute("filter","url("+getLocationHref()+"#"+i+")"),d.appendChild(f),o=createNS("use"),o.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),d.appendChild(o),featureSupport.maskType||(c.setAttribute("mask-type","luminance"),r.appendChild(filtersFactory.createAlphaToLuminanceFilter()),s=createNS("g"),d.appendChild(f),s.appendChild(this.layerElement),d.appendChild(s)),this.globalData.defs.appendChild(c);}this.matteMasks[e]=t;}return this.matteMasks[e];},setMatte:function(e){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+e+")");}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting();},setHierarchy:function(e){this.hierarchy=e;},setAsParent:function(){this._isParent=!0;},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[]);}};function RenderableDOMElement(){}(function(){var n={initElement:function(t,i,r){this.initFrame(),this.initBaseData(t,i,r),this.initTransform(t,i,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide();},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var t=this.baseElement||this.layerElement;t.style.display="none",this.hidden=!0;}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var t=this.baseElement||this.layerElement;t.style.display="block";}this.hidden=!1,this._isFirstFrame=!0;}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1));},renderInnerContent:function(){},prepareFrame:function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.checkTransparency();},destroy:function(){this.innerElem=null,this.destroyBaseElement();}};extendPrototype([RenderableElement,createProxyFunction(n)],RenderableDOMElement);})();function IImageElement(n,e,t){this.assetData=e.getAssetData(n.refId),this.assetData&&this.assetData.sid&&(this.assetData=e.slotManager.getProp(this.assetData)),this.initElement(n,e,t),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h};}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var n=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",n),this.layerElement.appendChild(this.innerElem);},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect;};function ProcessedElement(n,e){this.elem=n,this.pos=e;}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(e){var t,i=this.shapeModifiers.length;for(t=0;t<i;t+=1)this.shapeModifiers[t].addShape(e);},isShapeInAnimatedModifiers:function(e){for(var t=0,i=this.shapeModifiers.length;t<i;)if(this.shapeModifiers[t].isAnimatedWithShape(e))return!0;return!1;},renderModifiers:function(){if(this.shapeModifiers.length){var e,t=this.shapes.length;for(e=0;e<t;e+=1)this.shapes[e].sh.reset();t=this.shapeModifiers.length;var i;for(e=t-1;e>=0&&(i=this.shapeModifiers[e].processShapes(this._isFirstFrame),!i);e-=1);}},searchProcessedElement:function(e){for(var t=this.processedElements,i=0,r=t.length;i<r;){if(t[i].elem===e)return t[i].pos;i+=1;}return 0;},addProcessedElement:function(e,t){for(var i=this.processedElements,r=i.length;r;)if(r-=1,i[r].elem===e){i[r].pos=t;return;}i.push(new ProcessedElement(e,t));},prepareFrame:function(e){this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange);}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(n,e,t){this.caches=[],this.styles=[],this.transformers=n,this.lStr="",this.sh=t,this.lvl=e,this._isAnimated=!!t.k;for(var i=0,r=n.length;i<r;){if(n[i].mProps.dynamicProperties.length){this._isAnimated=!0;break;}i+=1;}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0;};function SVGStyleData(n,e){this.data=n,this.type=n.ty,this.d="",this.lvl=e,this._mdf=!1,this.closed=n.hd===!0,this.pElem=createNS("path"),this.msElem=null;}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1;};function DashProperty(n,e,t,i){this.elem=n,this.frameId=-1,this.dataProps=createSizedArray(e.length),this.renderer=t,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",e.length?e.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(i);var r,o=e.length||0,s;for(r=0;r<o;r+=1)s=PropertyFactory.getProp(n,e[r].v,0,0,this),this.k=s.k||this.k,this.dataProps[r]={n:e[r].n,p:s};this.k||this.getValue(!0),this._isAnimated=this.k;}DashProperty.prototype.getValue=function(n){if(!(this.elem.globalData.frameId===this.frameId&&!n)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||n,this._mdf)){var e=0,t=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),e=0;e<t;e+=1)this.dataProps[e].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[e].p.v:this.dashArray[e]=this.dataProps[e].p.v:this.dashoffset[0]=this.dataProps[e].p.v;}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(n,e,t){this.initDynamicPropertyContainer(n),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(n,e.o,0,.01,this),this.w=PropertyFactory.getProp(n,e.w,0,null,this),this.d=new DashProperty(n,e.d||{},"svg",this),this.c=PropertyFactory.getProp(n,e.c,1,255,this),this.style=t,this._isAnimated=!!this._isAnimated;}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(n,e,t){this.initDynamicPropertyContainer(n),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(n,e.o,0,.01,this),this.c=PropertyFactory.getProp(n,e.c,1,255,this),this.style=t;}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(n,e,t){this.initDynamicPropertyContainer(n),this.getValue=this.iterateDynamicProperties,this.style=t;}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(n,e,t){this.data=e,this.c=createTypedArray("uint8c",e.p*4);var i=e.k.k[0].s?e.k.k[0].s.length-e.p*4:e.k.k.length-e.p*4;this.o=createTypedArray("float32",i),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=i,this.initDynamicPropertyContainer(t),this.prop=PropertyFactory.getProp(n,e.k,1,null,this),this.k=this.prop.k,this.getValue(!0);}GradientProperty.prototype.comparePoints=function(n,e){for(var t=0,i=this.o.length/2,r;t<i;){if(r=Math.abs(n[t*4]-n[e*4+t*2]),r>.01)return!1;t+=1;}return!0;},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var n=0,e=this.data.k.k.length;n<e;){if(!this.comparePoints(this.data.k.k[n].s,this.data.p))return!1;n+=1;}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0;},GradientProperty.prototype.getValue=function(n){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||n){var e,t=this.data.p*4,i,r;for(e=0;e<t;e+=1)i=e%4===0?100:255,r=Math.round(this.prop.v[e]*i),this.c[e]!==r&&(this.c[e]=r,this._cmdf=!n);if(this.o.length)for(t=this.prop.v.length,e=this.data.p*4;e<t;e+=1)i=e%2===0?100:1,r=e%2===0?Math.round(this.prop.v[e]*100):this.prop.v[e],this.o[e-this.data.p*4]!==r&&(this.o[e-this.data.p*4]=r,this._omdf=!n);this._mdf=!n;}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(n,e,t){this.initDynamicPropertyContainer(n),this.getValue=this.iterateDynamicProperties,this.initGradientData(n,e,t);}SVGGradientFillStyleData.prototype.initGradientData=function(n,e,t){this.o=PropertyFactory.getProp(n,e.o,0,.01,this),this.s=PropertyFactory.getProp(n,e.s,1,null,this),this.e=PropertyFactory.getProp(n,e.e,1,null,this),this.h=PropertyFactory.getProp(n,e.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(n,e.a||{k:0},0,degToRads,this),this.g=new GradientProperty(n,e.g,this),this.style=t,this.stops=[],this.setGradientData(t.pElem,e),this.setGradientOpacity(e,t),this._isAnimated=!!this._isAnimated;},SVGGradientFillStyleData.prototype.setGradientData=function(n,e){var t=createElementID(),i=createNS(e.t===1?"linearGradient":"radialGradient");i.setAttribute("id",t),i.setAttribute("spreadMethod","pad"),i.setAttribute("gradientUnits","userSpaceOnUse");var r=[],o,s,l;for(l=e.g.p*4,s=0;s<l;s+=4)o=createNS("stop"),i.appendChild(o),r.push(o);n.setAttribute(e.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+t+")"),this.gf=i,this.cst=r;},SVGGradientFillStyleData.prototype.setGradientOpacity=function(n,e){if(this.g._hasOpacity&&!this.g._collapsable){var t,i,r,o=createNS("mask"),s=createNS("path");o.appendChild(s);var l=createElementID(),c=createElementID();o.setAttribute("id",c);var d=createNS(n.t===1?"linearGradient":"radialGradient");d.setAttribute("id",l),d.setAttribute("spreadMethod","pad"),d.setAttribute("gradientUnits","userSpaceOnUse"),r=n.g.k.k[0].s?n.g.k.k[0].s.length:n.g.k.k.length;var u=this.stops;for(i=n.g.p*4;i<r;i+=2)t=createNS("stop"),t.setAttribute("stop-color","rgb(255,255,255)"),d.appendChild(t),u.push(t);s.setAttribute(n.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+l+")"),n.ty==="gs"&&(s.setAttribute("stroke-linecap",lineCapEnum[n.lc||2]),s.setAttribute("stroke-linejoin",lineJoinEnum[n.lj||2]),n.lj===1&&s.setAttribute("stroke-miterlimit",n.ml)),this.of=d,this.ms=o,this.ost=u,this.maskId=c,e.msElem=s;}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(n,e,t){this.initDynamicPropertyContainer(n),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(n,e.w,0,null,this),this.d=new DashProperty(n,e.d||{},"svg",this),this.initGradientData(n,e,t),this._isAnimated=!!this._isAnimated;}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g");}function SVGTransformData(n,e,t){this.transform={mProps:n,op:e,container:t},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length;}var buildShapeString=function(e,t,i,r){if(t===0)return"";var o=e.o,s=e.i,l=e.v,c,d=" M"+r.applyToPointStringified(l[0][0],l[0][1]);for(c=1;c<t;c+=1)d+=" C"+r.applyToPointStringified(o[c-1][0],o[c-1][1])+" "+r.applyToPointStringified(s[c][0],s[c][1])+" "+r.applyToPointStringified(l[c][0],l[c][1]);return i&&t&&(d+=" C"+r.applyToPointStringified(o[c-1][0],o[c-1][1])+" "+r.applyToPointStringified(s[0][0],s[0][1])+" "+r.applyToPointStringified(l[0][0],l[0][1]),d+="z"),d;},SVGElementsRenderer=function(){var n=new Matrix(),e=new Matrix(),t={createRenderFunction:i};function i(g){switch(g.ty){case"fl":return l;case"gf":return d;case"gs":return c;case"st":return u;case"sh":case"el":case"rc":case"sr":return s;case"tr":return r;case"no":return o;default:return null;}}function r(g,f,m){(m||f.transform.op._mdf)&&f.transform.container.setAttribute("opacity",f.transform.op.v),(m||f.transform.mProps._mdf)&&f.transform.container.setAttribute("transform",f.transform.mProps.v.to2dCSS());}function o(){}function s(g,f,m){var _,y,E,C,b,x,w=f.styles.length,T=f.lvl,R,V,B,Y;for(x=0;x<w;x+=1){if(C=f.sh._mdf||m,f.styles[x].lvl<T){for(V=e.reset(),B=T-f.styles[x].lvl,Y=f.transformers.length-1;!C&&B>0;)C=f.transformers[Y].mProps._mdf||C,B-=1,Y-=1;if(C)for(B=T-f.styles[x].lvl,Y=f.transformers.length-1;B>0;)V.multiply(f.transformers[Y].mProps.v),B-=1,Y-=1;}else V=n;if(R=f.sh.paths,y=R._length,C){for(E="",_=0;_<y;_+=1)b=R.shapes[_],b&&b._length&&(E+=buildShapeString(b,b._length,b.c,V));f.caches[x]=E;}else E=f.caches[x];f.styles[x].d+=g.hd===!0?"":E,f.styles[x]._mdf=C||f.styles[x]._mdf;}}function l(g,f,m){var _=f.style;(f.c._mdf||m)&&_.pElem.setAttribute("fill","rgb("+bmFloor(f.c.v[0])+","+bmFloor(f.c.v[1])+","+bmFloor(f.c.v[2])+")"),(f.o._mdf||m)&&_.pElem.setAttribute("fill-opacity",f.o.v);}function c(g,f,m){d(g,f,m),u(g,f,m);}function d(g,f,m){var _=f.gf,y=f.g._hasOpacity,E=f.s.v,C=f.e.v;if(f.o._mdf||m){var b=g.ty==="gf"?"fill-opacity":"stroke-opacity";f.style.pElem.setAttribute(b,f.o.v);}if(f.s._mdf||m){var x=g.t===1?"x1":"cx",w=x==="x1"?"y1":"cy";_.setAttribute(x,E[0]),_.setAttribute(w,E[1]),y&&!f.g._collapsable&&(f.of.setAttribute(x,E[0]),f.of.setAttribute(w,E[1]));}var T,R,V,B;if(f.g._cmdf||m){T=f.cst;var Y=f.g.c;for(V=T.length,R=0;R<V;R+=1)B=T[R],B.setAttribute("offset",Y[R*4]+"%"),B.setAttribute("stop-color","rgb("+Y[R*4+1]+","+Y[R*4+2]+","+Y[R*4+3]+")");}if(y&&(f.g._omdf||m)){var le=f.g.o;for(f.g._collapsable?T=f.cst:T=f.ost,V=T.length,R=0;R<V;R+=1)B=T[R],f.g._collapsable||B.setAttribute("offset",le[R*2]+"%"),B.setAttribute("stop-opacity",le[R*2+1]);}if(g.t===1)(f.e._mdf||m)&&(_.setAttribute("x2",C[0]),_.setAttribute("y2",C[1]),y&&!f.g._collapsable&&(f.of.setAttribute("x2",C[0]),f.of.setAttribute("y2",C[1])));else{var ae;if((f.s._mdf||f.e._mdf||m)&&(ae=Math.sqrt(Math.pow(E[0]-C[0],2)+Math.pow(E[1]-C[1],2)),_.setAttribute("r",ae),y&&!f.g._collapsable&&f.of.setAttribute("r",ae)),f.s._mdf||f.e._mdf||f.h._mdf||f.a._mdf||m){ae||(ae=Math.sqrt(Math.pow(E[0]-C[0],2)+Math.pow(E[1]-C[1],2)));var ee=Math.atan2(C[1]-E[1],C[0]-E[0]),ce=f.h.v;ce>=1?ce=.99:ce<=-1&&(ce=-.99);var oe=ae*ce,re=Math.cos(ee+f.a.v)*oe+E[0],A=Math.sin(ee+f.a.v)*oe+E[1];_.setAttribute("fx",re),_.setAttribute("fy",A),y&&!f.g._collapsable&&(f.of.setAttribute("fx",re),f.of.setAttribute("fy",A));}}}function u(g,f,m){var _=f.style,y=f.d;y&&(y._mdf||m)&&y.dashStr&&(_.pElem.setAttribute("stroke-dasharray",y.dashStr),_.pElem.setAttribute("stroke-dashoffset",y.dashoffset[0])),f.c&&(f.c._mdf||m)&&_.pElem.setAttribute("stroke","rgb("+bmFloor(f.c.v[0])+","+bmFloor(f.c.v[1])+","+bmFloor(f.c.v[2])+")"),(f.o._mdf||m)&&_.pElem.setAttribute("stroke-opacity",f.o.v),(f.w._mdf||m)&&(_.pElem.setAttribute("stroke-width",f.w.v),_.msElem&&_.msElem.setAttribute("stroke-width",f.w.v));}return t;}();function SVGShapeElement(n,e,t){this.shapes=[],this.shapesData=n.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(n,e,t),this.prevViewData=[];}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix(),SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes();},SVGShapeElement.prototype.filterUniqueShapes=function(){var n,e=this.shapes.length,t,i,r=this.stylesList.length,o,s=[],l=!1;for(i=0;i<r;i+=1){for(o=this.stylesList[i],l=!1,s.length=0,n=0;n<e;n+=1)t=this.shapes[n],t.styles.indexOf(o)!==-1&&(s.push(t),l=t._isAnimated||l);s.length>1&&l&&this.setShapesAsAnimated(s);}},SVGShapeElement.prototype.setShapesAsAnimated=function(n){var e,t=n.length;for(e=0;e<t;e+=1)n[e].setAsAnimated();},SVGShapeElement.prototype.createStyleElement=function(n,e){var t,i=new SVGStyleData(n,e),r=i.pElem;if(n.ty==="st")t=new SVGStrokeStyleData(this,n,i);else if(n.ty==="fl")t=new SVGFillStyleData(this,n,i);else if(n.ty==="gf"||n.ty==="gs"){var o=n.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;t=new o(this,n,i),this.globalData.defs.appendChild(t.gf),t.maskId&&(this.globalData.defs.appendChild(t.ms),this.globalData.defs.appendChild(t.of),r.setAttribute("mask","url("+getLocationHref()+"#"+t.maskId+")"));}else n.ty==="no"&&(t=new SVGNoStyleData(this,n,i));return(n.ty==="st"||n.ty==="gs")&&(r.setAttribute("stroke-linecap",lineCapEnum[n.lc||2]),r.setAttribute("stroke-linejoin",lineJoinEnum[n.lj||2]),r.setAttribute("fill-opacity","0"),n.lj===1&&r.setAttribute("stroke-miterlimit",n.ml)),n.r===2&&r.setAttribute("fill-rule","evenodd"),n.ln&&r.setAttribute("id",n.ln),n.cl&&r.setAttribute("class",n.cl),n.bm&&(r.style["mix-blend-mode"]=getBlendMode(n.bm)),this.stylesList.push(i),this.addToAnimatedContents(n,t),t;},SVGShapeElement.prototype.createGroupElement=function(n){var e=new ShapeGroupData();return n.ln&&e.gr.setAttribute("id",n.ln),n.cl&&e.gr.setAttribute("class",n.cl),n.bm&&(e.gr.style["mix-blend-mode"]=getBlendMode(n.bm)),e;},SVGShapeElement.prototype.createTransformElement=function(n,e){var t=TransformPropertyFactory.getTransformProperty(this,n,this),i=new SVGTransformData(t,t.o,e);return this.addToAnimatedContents(n,i),i;},SVGShapeElement.prototype.createShapeElement=function(n,e,t){var i=4;n.ty==="rc"?i=5:n.ty==="el"?i=6:n.ty==="sr"&&(i=7);var r=ShapePropertyFactory.getShapeProp(this,n,i,this),o=new SVGShapeData(e,t,r);return this.shapes.push(o),this.addShapeToModifiers(o),this.addToAnimatedContents(n,o),o;},SVGShapeElement.prototype.addToAnimatedContents=function(n,e){for(var t=0,i=this.animatedContents.length;t<i;){if(this.animatedContents[t].element===e)return;t+=1;}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(n),element:e,data:n});},SVGShapeElement.prototype.setElementStyles=function(n){var e=n.styles,t,i=this.stylesList.length;for(t=0;t<i;t+=1)e.indexOf(this.stylesList[t])===-1&&!this.stylesList[t].closed&&e.push(this.stylesList[t]);},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var n,e=this.itemsData.length;for(n=0;n<e;n+=1)this.prevViewData[n]=this.itemsData[n];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,n=0;n<e;n+=1)this.dynamicProperties[n].getValue();this.renderModifiers();},SVGShapeElement.prototype.searchShapes=function(n,e,t,i,r,o,s){var l=[].concat(o),c,d=n.length-1,u,g,f=[],m=[],_,y,E;for(c=d;c>=0;c-=1){if(E=this.searchProcessedElement(n[c]),E?e[c]=t[E-1]:n[c]._render=s,n[c].ty==="fl"||n[c].ty==="st"||n[c].ty==="gf"||n[c].ty==="gs"||n[c].ty==="no")E?e[c].style.closed=n[c].hd:e[c]=this.createStyleElement(n[c],r),n[c]._render&&e[c].style.pElem.parentNode!==i&&i.appendChild(e[c].style.pElem),f.push(e[c].style);else if(n[c].ty==="gr"){if(!E)e[c]=this.createGroupElement(n[c]);else for(g=e[c].it.length,u=0;u<g;u+=1)e[c].prevViewData[u]=e[c].it[u];this.searchShapes(n[c].it,e[c].it,e[c].prevViewData,e[c].gr,r+1,l,s),n[c]._render&&e[c].gr.parentNode!==i&&i.appendChild(e[c].gr);}else n[c].ty==="tr"?(E||(e[c]=this.createTransformElement(n[c],i)),_=e[c].transform,l.push(_)):n[c].ty==="sh"||n[c].ty==="rc"||n[c].ty==="el"||n[c].ty==="sr"?(E||(e[c]=this.createShapeElement(n[c],l,r)),this.setElementStyles(e[c])):n[c].ty==="tm"||n[c].ty==="rd"||n[c].ty==="ms"||n[c].ty==="pb"||n[c].ty==="zz"||n[c].ty==="op"?(E?(y=e[c],y.closed=!1):(y=ShapeModifiers.getModifier(n[c].ty),y.init(this,n[c]),e[c]=y,this.shapeModifiers.push(y)),m.push(y)):n[c].ty==="rp"&&(E?(y=e[c],y.closed=!0):(y=ShapeModifiers.getModifier(n[c].ty),e[c]=y,y.init(this,n,c,e),this.shapeModifiers.push(y),s=!1),m.push(y));this.addProcessedElement(n[c],c+1);}for(d=f.length,c=0;c<d;c+=1)f[c].closed=!0;for(d=m.length,c=0;c<d;c+=1)m[c].closed=!0;},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var n,e=this.stylesList.length;for(n=0;n<e;n+=1)this.stylesList[n].reset();for(this.renderShape(),n=0;n<e;n+=1)(this.stylesList[n]._mdf||this._isFirstFrame)&&(this.stylesList[n].msElem&&(this.stylesList[n].msElem.setAttribute("d",this.stylesList[n].d),this.stylesList[n].d="M0 0"+this.stylesList[n].d),this.stylesList[n].pElem.setAttribute("d",this.stylesList[n].d||"M0 0"));},SVGShapeElement.prototype.renderShape=function(){var n,e=this.animatedContents.length,t;for(n=0;n<e;n+=1)t=this.animatedContents[n],(this._isFirstFrame||t.element._isAnimated)&&t.data!==!0&&t.fn(t.data,t.element,this._isFirstFrame);},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null;};function LetterProps(n,e,t,i,r,o){this.o=n,this.sw=e,this.sc=t,this.fc=i,this.m=r,this.p=o,this._mdf={o:!0,sw:!!e,sc:!!t,fc:!!i,m:!0,p:!0};}LetterProps.prototype.update=function(n,e,t,i,r,o){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var s=!1;return this.o!==n&&(this.o=n,this._mdf.o=!0,s=!0),this.sw!==e&&(this.sw=e,this._mdf.sw=!0,s=!0),this.sc!==t&&(this.sc=t,this._mdf.sc=!0,s=!0),this.fc!==i&&(this.fc=i,this._mdf.fc=!0,s=!0),this.m!==r&&(this.m=r,this._mdf.m=!0,s=!0),o.length&&(this.p[0]!==o[0]||this.p[1]!==o[1]||this.p[4]!==o[4]||this.p[5]!==o[5]||this.p[12]!==o[12]||this.p[13]!==o[13])&&(this.p=o,this._mdf.p=!0,s=!0),s;};function TextProperty(n,e){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,e.d&&e.d.sid&&(e.d=n.globalData.slotManager.getProp(e.d)),this.data=e,this.elem=n,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData);}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n;},TextProperty.prototype.setCurrentData=function(n){n.__complete||this.completeTextData(n),this.currentData=n,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0;},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes();},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf;},TextProperty.prototype.addEffect=function(n){this.effectsSequence.push(n),this.elem.addDynamicProperty(this);},TextProperty.prototype.getValue=function(n){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!n)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var e=this.currentData,t=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return;}this.lock=!0,this._mdf=!1;var i,r=this.effectsSequence.length,o=n||this.data.d.k[this.keysIndex].s;for(i=0;i<r;i+=1)t!==this.keysIndex?o=this.effectsSequence[i](o,o.t):o=this.effectsSequence[i](this.currentData,o.t);e!==o&&this.setCurrentData(o),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId;}},TextProperty.prototype.getKeyframeValue=function(){for(var n=this.data.d.k,e=this.elem.comp.renderedFrame,t=0,i=n.length;t<=i-1&&!(t===i-1||n[t+1].t>e);)t+=1;return this.keysIndex!==t&&(this.keysIndex=t),this.data.d.k[this.keysIndex].s;},TextProperty.prototype.buildFinalText=function(n){for(var e=[],t=0,i=n.length,r,o,s=!1,l=!1,c="";t<i;)s=l,l=!1,r=n.charCodeAt(t),c=n.charAt(t),FontManager.isCombinedCharacter(r)?s=!0:r>=55296&&r<=56319?FontManager.isRegionalFlag(n,t)?c=n.substr(t,14):(o=n.charCodeAt(t+1),o>=56320&&o<=57343&&(FontManager.isModifier(r,o)?(c=n.substr(t,2),s=!0):FontManager.isFlagEmoji(n.substr(t,4))?c=n.substr(t,4):c=n.substr(t,2))):r>56319?(o=n.charCodeAt(t+1),FontManager.isVariationSelector(r)&&(s=!0)):FontManager.isZeroWidthJoiner(r)&&(s=!0,l=!0),s?(e[e.length-1]+=c,s=!1):e.push(c),t+=c.length;return e;},TextProperty.prototype.completeTextData=function(n){n.__complete=!0;var e=this.elem.globalData.fontManager,t=this.data,i=[],r,o,s,l=0,c,d=t.m.g,u=0,g=0,f=0,m=[],_=0,y=0,E,C,b=e.getFontByName(n.f),x,w=0,T=getFontProperties(b);n.fWeight=T.weight,n.fStyle=T.style,n.finalSize=n.s,n.finalText=this.buildFinalText(n.t),o=n.finalText.length,n.finalLineHeight=n.lh;var R=n.tr/1e3*n.finalSize,V;if(n.sz)for(var B=!0,Y=n.sz[0],le=n.sz[1],ae,ee;B;){ee=this.buildFinalText(n.t),ae=0,_=0,o=ee.length,R=n.tr/1e3*n.finalSize;var ce=-1;for(r=0;r<o;r+=1)V=ee[r].charCodeAt(0),s=!1,ee[r]===" "?ce=r:(V===13||V===3)&&(_=0,s=!0,ae+=n.finalLineHeight||n.finalSize*1.2),e.chars?(x=e.getCharData(ee[r],b.fStyle,b.fFamily),w=s?0:x.w*n.finalSize/100):w=e.measureText(ee[r],n.f,n.finalSize),_+w>Y&&ee[r]!==" "?(ce===-1?o+=1:r=ce,ae+=n.finalLineHeight||n.finalSize*1.2,ee.splice(r,ce===r?1:0,"\r"),ce=-1,_=0):(_+=w,_+=R);ae+=b.ascent*n.finalSize/100,this.canResize&&n.finalSize>this.minimumFontSize&&le<ae?(n.finalSize-=1,n.finalLineHeight=n.finalSize*n.lh/n.s):(n.finalText=ee,o=n.finalText.length,B=!1);}_=-R,w=0;var oe=0,re;for(r=0;r<o;r+=1)if(s=!1,re=n.finalText[r],V=re.charCodeAt(0),V===13||V===3?(oe=0,m.push(_),y=_>y?_:y,_=-2*R,c="",s=!0,f+=1):c=re,e.chars?(x=e.getCharData(re,b.fStyle,e.getFontByName(n.f).fFamily),w=s?0:x.w*n.finalSize/100):w=e.measureText(c,n.f,n.finalSize),re===" "?oe+=w+R:(_+=w+R+oe,oe=0),i.push({l:w,an:w,add:u,n:s,anIndexes:[],val:c,line:f,animatorJustifyOffset:0}),d==2){if(u+=w,c===""||c===" "||r===o-1){for((c===""||c===" ")&&(u-=w);g<=r;)i[g].an=u,i[g].ind=l,i[g].extra=w,g+=1;l+=1,u=0;}}else if(d==3){if(u+=w,c===""||r===o-1){for(c===""&&(u-=w);g<=r;)i[g].an=u,i[g].ind=l,i[g].extra=w,g+=1;u=0,l+=1;}}else i[l].ind=l,i[l].extra=0,l+=1;if(n.l=i,y=_>y?_:y,m.push(_),n.sz)n.boxWidth=n.sz[0],n.justifyOffset=0;else switch(n.boxWidth=y,n.j){case 1:n.justifyOffset=-n.boxWidth;break;case 2:n.justifyOffset=-n.boxWidth/2;break;default:n.justifyOffset=0;}n.lineWidths=m;var A=t.a,z,O;C=A.length;var k,H,U=[];for(E=0;E<C;E+=1){for(z=A[E],z.a.sc&&(n.strokeColorAnim=!0),z.a.sw&&(n.strokeWidthAnim=!0),(z.a.fc||z.a.fh||z.a.fs||z.a.fb)&&(n.fillColorAnim=!0),H=0,k=z.s.b,r=0;r<o;r+=1)O=i[r],O.anIndexes[E]=H,(k==1&&O.val!==""||k==2&&O.val!==""&&O.val!==" "||k==3&&(O.n||O.val==" "||r==o-1)||k==4&&(O.n||r==o-1))&&(z.s.rn===1&&U.push(H),H+=1);t.a[E].s.totalChars=H;var pe=-1,me;if(z.s.rn===1)for(r=0;r<o;r+=1)O=i[r],pe!=O.anIndexes[E]&&(pe=O.anIndexes[E],me=U.splice(Math.floor(Math.random()*U.length),1)[0]),O.anIndexes[E]=me;}n.yOffset=n.finalLineHeight||n.finalSize*1.2,n.ls=n.ls||0,n.ascent=b.ascent*n.finalSize/100;},TextProperty.prototype.updateDocumentData=function(n,e){e=e===void 0?this.keysIndex:e;var t=this.copyData({},this.data.d.k[e].s);t=this.copyData(t,n),this.data.d.k[e].s=t,this.recalculate(e),this.setCurrentData(t),this.elem.addDynamicProperty(this);},TextProperty.prototype.recalculate=function(n){var e=this.data.d.k[n].s;e.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(e);},TextProperty.prototype.canResizeFont=function(n){this.canResize=n,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this);},TextProperty.prototype.setMinimumFontSize=function(n){this.minimumFontSize=Math.floor(n)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this);};var TextSelectorProp=function(){var n=Math.max,e=Math.min,t=Math.floor;function i(o,s){this._currentTextLength=-1,this.k=!1,this.data=s,this.elem=o,this.comp=o.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(o),this.s=PropertyFactory.getProp(o,s.s||{k:0},0,0,this),"e"in s?this.e=PropertyFactory.getProp(o,s.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(o,s.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(o,s.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(o,s.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(o,s.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(o,s.a,0,.01,this),this.dynamicProperties.length||this.getValue();}i.prototype={getMult:function(s){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var l=0,c=0,d=1,u=1;this.ne.v>0?l=this.ne.v/100:c=-this.ne.v/100,this.xe.v>0?d=1-this.xe.v/100:u=1+this.xe.v/100;var g=BezierFactory.getBezierEasing(l,c,d,u).get,f=0,m=this.finalS,_=this.finalE,y=this.data.sh;if(y===2)_===m?f=s>=_?1:0:f=n(0,e(.5/(_-m)+(s-m)/(_-m),1)),f=g(f);else if(y===3)_===m?f=s>=_?0:1:f=1-n(0,e(.5/(_-m)+(s-m)/(_-m),1)),f=g(f);else if(y===4)_===m?f=0:(f=n(0,e(.5/(_-m)+(s-m)/(_-m),1)),f<.5?f*=2:f=1-2*(f-.5)),f=g(f);else if(y===5){if(_===m)f=0;else{var E=_-m;s=e(n(0,s+.5-m),_-m);var C=-E/2+s,b=E/2;f=Math.sqrt(1-C*C/(b*b));}f=g(f);}else y===6?(_===m?f=0:(s=e(n(0,s+.5-m),_-m),f=(1+Math.cos(Math.PI+Math.PI*2*s/(_-m)))/2),f=g(f)):(s>=t(m)&&(s-m<0?f=n(0,e(e(_,1)-(m-s),1)):f=n(0,e(_-s,1))),f=g(f));if(this.sm.v!==100){var x=this.sm.v*.01;x===0&&(x=1e-8);var w=.5-x*.5;f<w?f=0:(f=(f-w)/x,f>1&&(f=1));}return f*this.a.v;},getValue:function(s){this.iterateDynamicProperties(),this._mdf=s||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,s&&this.data.r===2&&(this.e.v=this._currentTextLength);var l=this.data.r===2?1:100/this.data.totalChars,c=this.o.v/l,d=this.s.v/l+c,u=this.e.v/l+c;if(d>u){var g=d;d=u,u=g;}this.finalS=d,this.finalE=u;}},extendPrototype([DynamicPropertyContainer],i);function r(o,s,l){return new i(o,s,l);}return{getTextSelectorProp:r};}();function TextAnimatorDataProperty(n,e,t){var i={propType:!1},r=PropertyFactory.getProp,o=e.a;this.a={r:o.r?r(n,o.r,0,degToRads,t):i,rx:o.rx?r(n,o.rx,0,degToRads,t):i,ry:o.ry?r(n,o.ry,0,degToRads,t):i,sk:o.sk?r(n,o.sk,0,degToRads,t):i,sa:o.sa?r(n,o.sa,0,degToRads,t):i,s:o.s?r(n,o.s,1,.01,t):i,a:o.a?r(n,o.a,1,0,t):i,o:o.o?r(n,o.o,0,.01,t):i,p:o.p?r(n,o.p,1,0,t):i,sw:o.sw?r(n,o.sw,0,0,t):i,sc:o.sc?r(n,o.sc,1,0,t):i,fc:o.fc?r(n,o.fc,1,0,t):i,fh:o.fh?r(n,o.fh,0,0,t):i,fs:o.fs?r(n,o.fs,0,.01,t):i,fb:o.fb?r(n,o.fb,0,.01,t):i,t:o.t?r(n,o.t,0,0,t):i},this.s=TextSelectorProp.getTextSelectorProp(n,e.s,t),this.s.t=e.s.t;}function TextAnimatorProperty(n,e,t){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=n,this._renderType=e,this._elem=t,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(t);}TextAnimatorProperty.prototype.searchProperties=function(){var n,e=this._textData.a.length,t,i=PropertyFactory.getProp;for(n=0;n<e;n+=1)t=this._textData.a[n],this._animatorsData[n]=new TextAnimatorDataProperty(this._elem,t,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:i(this._elem,this._textData.p.a,0,0,this),f:i(this._elem,this._textData.p.f,0,0,this),l:i(this._elem,this._textData.p.l,0,0,this),r:i(this._elem,this._textData.p.r,0,0,this),p:i(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=i(this._elem,this._textData.m.a,1,0,this);},TextAnimatorProperty.prototype.getMeasures=function(n,e){if(this.lettersChangedFlag=e,!(!this._mdf&&!this._isFirstFrame&&!e&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var t=this._moreOptions.alignment.v,i=this._animatorsData,r=this._textData,o=this.mHelper,s=this._renderType,l=this.renderedLetters.length,c,d,u,g,f=n.l,m,_,y,E,C,b,x,w,T,R,V,B,Y,le,ae;if(this._hasMaskedPath){if(ae=this._pathData.m,!this._pathData.n||this._pathData._mdf){var ee=ae.v;this._pathData.r.v&&(ee=ee.reverse()),m={tLength:0,segments:[]},g=ee._length-1;var ce;for(B=0,u=0;u<g;u+=1)ce=bez.buildBezierData(ee.v[u],ee.v[u+1],[ee.o[u][0]-ee.v[u][0],ee.o[u][1]-ee.v[u][1]],[ee.i[u+1][0]-ee.v[u+1][0],ee.i[u+1][1]-ee.v[u+1][1]]),m.tLength+=ce.segmentLength,m.segments.push(ce),B+=ce.segmentLength;u=g,ae.v.c&&(ce=bez.buildBezierData(ee.v[u],ee.v[0],[ee.o[u][0]-ee.v[u][0],ee.o[u][1]-ee.v[u][1]],[ee.i[0][0]-ee.v[0][0],ee.i[0][1]-ee.v[0][1]]),m.tLength+=ce.segmentLength,m.segments.push(ce),B+=ce.segmentLength),this._pathData.pi=m;}if(m=this._pathData.pi,_=this._pathData.f.v,x=0,b=1,E=0,C=!0,R=m.segments,_<0&&ae.v.c)for(m.tLength<Math.abs(_)&&(_=-Math.abs(_)%m.tLength),x=R.length-1,T=R[x].points,b=T.length-1;_<0;)_+=T[b].partialLength,b-=1,b<0&&(x-=1,T=R[x].points,b=T.length-1);T=R[x].points,w=T[b-1],y=T[b],V=y.partialLength;}g=f.length,c=0,d=0;var oe=n.finalSize*1.2*.714,re=!0,A,z,O,k,H;k=i.length;var U,pe=-1,me,fe,Fe,Te=_,qe=x,bt=b,It=-1,We,_t,Rt,Je,we,Nn,Bn,pi,Vn="",zn=this.defaultPropsArray,Qn;if(n.j===2||n.j===1){var Zt=0,Li=0,Di=n.j===2?-.5:-1,hn=0,fi=!0;for(u=0;u<g;u+=1)if(f[u].n){for(Zt&&(Zt+=Li);hn<u;)f[hn].animatorJustifyOffset=Zt,hn+=1;Zt=0,fi=!0;}else{for(O=0;O<k;O+=1)A=i[O].a,A.t.propType&&(fi&&n.j===2&&(Li+=A.t.v*Di),z=i[O].s,U=z.getMult(f[u].anIndexes[O],r.a[O].s.totalChars),U.length?Zt+=A.t.v*U[0]*Di:Zt+=A.t.v*U*Di);fi=!1;}for(Zt&&(Zt+=Li);hn<u;)f[hn].animatorJustifyOffset=Zt,hn+=1;}for(u=0;u<g;u+=1){if(o.reset(),We=1,f[u].n)c=0,d+=n.yOffset,d+=re?1:0,_=Te,re=!1,this._hasMaskedPath&&(x=qe,b=bt,T=R[x].points,w=T[b-1],y=T[b],V=y.partialLength,E=0),Vn="",pi="",Nn="",Qn="",zn=this.defaultPropsArray;else{if(this._hasMaskedPath){if(It!==f[u].line){switch(n.j){case 1:_+=B-n.lineWidths[f[u].line];break;case 2:_+=(B-n.lineWidths[f[u].line])/2;break;default:break;}It=f[u].line;}pe!==f[u].ind&&(f[pe]&&(_+=f[pe].extra),_+=f[u].an/2,pe=f[u].ind),_+=t[0]*f[u].an*.005;var Mn=0;for(O=0;O<k;O+=1)A=i[O].a,A.p.propType&&(z=i[O].s,U=z.getMult(f[u].anIndexes[O],r.a[O].s.totalChars),U.length?Mn+=A.p.v[0]*U[0]:Mn+=A.p.v[0]*U),A.a.propType&&(z=i[O].s,U=z.getMult(f[u].anIndexes[O],r.a[O].s.totalChars),U.length?Mn+=A.a.v[0]*U[0]:Mn+=A.a.v[0]*U);for(C=!0,this._pathData.a.v&&(_=f[0].an*.5+(B-this._pathData.f.v-f[0].an*.5-f[f.length-1].an*.5)*pe/(g-1),_+=this._pathData.f.v);C;)E+V>=_+Mn||!T?(Y=(_+Mn-E)/y.partialLength,fe=w.point[0]+(y.point[0]-w.point[0])*Y,Fe=w.point[1]+(y.point[1]-w.point[1])*Y,o.translate(-t[0]*f[u].an*.005,-(t[1]*oe)*.01),C=!1):T&&(E+=y.partialLength,b+=1,b>=T.length&&(b=0,x+=1,R[x]?T=R[x].points:ae.v.c?(b=0,x=0,T=R[x].points):(E-=y.partialLength,T=null)),T&&(w=y,y=T[b],V=y.partialLength));me=f[u].an/2-f[u].add,o.translate(-me,0,0);}else me=f[u].an/2-f[u].add,o.translate(-me,0,0),o.translate(-t[0]*f[u].an*.005,-t[1]*oe*.01,0);for(O=0;O<k;O+=1)A=i[O].a,A.t.propType&&(z=i[O].s,U=z.getMult(f[u].anIndexes[O],r.a[O].s.totalChars),(c!==0||n.j!==0)&&(this._hasMaskedPath?U.length?_+=A.t.v*U[0]:_+=A.t.v*U:U.length?c+=A.t.v*U[0]:c+=A.t.v*U));for(n.strokeWidthAnim&&(Rt=n.sw||0),n.strokeColorAnim&&(n.sc?_t=[n.sc[0],n.sc[1],n.sc[2]]:_t=[0,0,0]),n.fillColorAnim&&n.fc&&(Je=[n.fc[0],n.fc[1],n.fc[2]]),O=0;O<k;O+=1)A=i[O].a,A.a.propType&&(z=i[O].s,U=z.getMult(f[u].anIndexes[O],r.a[O].s.totalChars),U.length?o.translate(-A.a.v[0]*U[0],-A.a.v[1]*U[1],A.a.v[2]*U[2]):o.translate(-A.a.v[0]*U,-A.a.v[1]*U,A.a.v[2]*U));for(O=0;O<k;O+=1)A=i[O].a,A.s.propType&&(z=i[O].s,U=z.getMult(f[u].anIndexes[O],r.a[O].s.totalChars),U.length?o.scale(1+(A.s.v[0]-1)*U[0],1+(A.s.v[1]-1)*U[1],1):o.scale(1+(A.s.v[0]-1)*U,1+(A.s.v[1]-1)*U,1));for(O=0;O<k;O+=1){if(A=i[O].a,z=i[O].s,U=z.getMult(f[u].anIndexes[O],r.a[O].s.totalChars),A.sk.propType&&(U.length?o.skewFromAxis(-A.sk.v*U[0],A.sa.v*U[1]):o.skewFromAxis(-A.sk.v*U,A.sa.v*U)),A.r.propType&&(U.length?o.rotateZ(-A.r.v*U[2]):o.rotateZ(-A.r.v*U)),A.ry.propType&&(U.length?o.rotateY(A.ry.v*U[1]):o.rotateY(A.ry.v*U)),A.rx.propType&&(U.length?o.rotateX(A.rx.v*U[0]):o.rotateX(A.rx.v*U)),A.o.propType&&(U.length?We+=(A.o.v*U[0]-We)*U[0]:We+=(A.o.v*U-We)*U),n.strokeWidthAnim&&A.sw.propType&&(U.length?Rt+=A.sw.v*U[0]:Rt+=A.sw.v*U),n.strokeColorAnim&&A.sc.propType)for(we=0;we<3;we+=1)U.length?_t[we]+=(A.sc.v[we]-_t[we])*U[0]:_t[we]+=(A.sc.v[we]-_t[we])*U;if(n.fillColorAnim&&n.fc){if(A.fc.propType)for(we=0;we<3;we+=1)U.length?Je[we]+=(A.fc.v[we]-Je[we])*U[0]:Je[we]+=(A.fc.v[we]-Je[we])*U;A.fh.propType&&(U.length?Je=addHueToRGB(Je,A.fh.v*U[0]):Je=addHueToRGB(Je,A.fh.v*U)),A.fs.propType&&(U.length?Je=addSaturationToRGB(Je,A.fs.v*U[0]):Je=addSaturationToRGB(Je,A.fs.v*U)),A.fb.propType&&(U.length?Je=addBrightnessToRGB(Je,A.fb.v*U[0]):Je=addBrightnessToRGB(Je,A.fb.v*U));}}for(O=0;O<k;O+=1)A=i[O].a,A.p.propType&&(z=i[O].s,U=z.getMult(f[u].anIndexes[O],r.a[O].s.totalChars),this._hasMaskedPath?U.length?o.translate(0,A.p.v[1]*U[0],-A.p.v[2]*U[1]):o.translate(0,A.p.v[1]*U,-A.p.v[2]*U):U.length?o.translate(A.p.v[0]*U[0],A.p.v[1]*U[1],-A.p.v[2]*U[2]):o.translate(A.p.v[0]*U,A.p.v[1]*U,-A.p.v[2]*U));if(n.strokeWidthAnim&&(Nn=Rt<0?0:Rt),n.strokeColorAnim&&(Bn="rgb("+Math.round(_t[0]*255)+","+Math.round(_t[1]*255)+","+Math.round(_t[2]*255)+")"),n.fillColorAnim&&n.fc&&(pi="rgb("+Math.round(Je[0]*255)+","+Math.round(Je[1]*255)+","+Math.round(Je[2]*255)+")"),this._hasMaskedPath){if(o.translate(0,-n.ls),o.translate(0,t[1]*oe*.01+d,0),this._pathData.p.v){le=(y.point[1]-w.point[1])/(y.point[0]-w.point[0]);var hr=Math.atan(le)*180/Math.PI;y.point[0]<w.point[0]&&(hr+=180),o.rotate(-hr*Math.PI/180);}o.translate(fe,Fe,0),_-=t[0]*f[u].an*.005,f[u+1]&&pe!==f[u+1].ind&&(_+=f[u].an/2,_+=n.tr*.001*n.finalSize);}else{switch(o.translate(c,d,0),n.ps&&o.translate(n.ps[0],n.ps[1]+n.ascent,0),n.j){case 1:o.translate(f[u].animatorJustifyOffset+n.justifyOffset+(n.boxWidth-n.lineWidths[f[u].line]),0,0);break;case 2:o.translate(f[u].animatorJustifyOffset+n.justifyOffset+(n.boxWidth-n.lineWidths[f[u].line])/2,0,0);break;default:break;}o.translate(0,-n.ls),o.translate(me,0,0),o.translate(t[0]*f[u].an*.005,t[1]*oe*.01,0),c+=f[u].l+n.tr*.001*n.finalSize;}s==="html"?Vn=o.toCSS():s==="svg"?Vn=o.to2dCSS():zn=[o.props[0],o.props[1],o.props[2],o.props[3],o.props[4],o.props[5],o.props[6],o.props[7],o.props[8],o.props[9],o.props[10],o.props[11],o.props[12],o.props[13],o.props[14],o.props[15]],Qn=We;}l<=u?(H=new LetterProps(Qn,Nn,Bn,pi,Vn,zn),this.renderedLetters.push(H),l+=1,this.lettersChangedFlag=!0):(H=this.renderedLetters[u],this.lettersChangedFlag=H.update(Qn,Nn,Bn,pi,Vn,zn)||this.lettersChangedFlag);}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties());},TextAnimatorProperty.prototype.mHelper=new Matrix(),TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(n,e,t){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(n,e,t),this.textProperty=new TextProperty(this,n.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(n.t,this.renderType,this),this.initTransform(n,e,t),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties);},ITextElement.prototype.prepareFrame=function(n){this._mdf=!1,this.prepareRenderableFrame(n),this.prepareProperties(n,this.isInRange);},ITextElement.prototype.createPathShape=function(n,e){var t,i=e.length,r,o="";for(t=0;t<i;t+=1)e[t].ty==="sh"&&(r=e[t].ks.k,o+=buildShapeString(r,r.i.length,!0,n));return o;},ITextElement.prototype.updateDocumentData=function(n,e){this.textProperty.updateDocumentData(n,e);},ITextElement.prototype.canResizeFont=function(n){this.textProperty.canResizeFont(n);},ITextElement.prototype.setMinimumFontSize=function(n){this.textProperty.setMinimumFontSize(n);},ITextElement.prototype.applyTextPropertiesToMatrix=function(n,e,t,i,r){switch(n.ps&&e.translate(n.ps[0],n.ps[1]+n.ascent,0),e.translate(0,-n.ls,0),n.j){case 1:e.translate(n.justifyOffset+(n.boxWidth-n.lineWidths[t]),0,0);break;case 2:e.translate(n.justifyOffset+(n.boxWidth-n.lineWidths[t])/2,0,0);break;default:break;}e.translate(i,r,0);},ITextElement.prototype.buildColor=function(n){return"rgb("+Math.round(n[0]*255)+","+Math.round(n[1]*255)+","+Math.round(n[2]*255)+")";},ITextElement.prototype.emptyProp=new LetterProps(),ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1);};var emptyShapeData={shapes:[]};function SVGTextLottieElement(n,e,t){this.textSpans=[],this.renderType="svg",this.initElement(n,e,t);}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"));},SVGTextLottieElement.prototype.buildTextContents=function(n){for(var e=0,t=n.length,i=[],r="";e<t;)n[e]==="\r"||n[e]===""?(i.push(r),r=""):r+=n[e],e+=1;return i.push(r),i;},SVGTextLottieElement.prototype.buildShapeData=function(n,e){if(n.shapes&&n.shapes.length){var t=n.shapes[0];if(t.it){var i=t.it[t.it.length-1];i.s&&(i.s.k[0]=e,i.s.k[1]=e);}}return n;},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var n,e,t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t?t.l.length:0),t.fc?this.layerElement.setAttribute("fill",this.buildColor(t.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),t.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(t.sc)),this.layerElement.setAttribute("stroke-width",t.sw)),this.layerElement.setAttribute("font-size",t.finalSize);var i=this.globalData.fontManager.getFontByName(t.f);if(i.fClass)this.layerElement.setAttribute("class",i.fClass);else{this.layerElement.setAttribute("font-family",i.fFamily);var r=t.fWeight,o=t.fStyle;this.layerElement.setAttribute("font-style",o),this.layerElement.setAttribute("font-weight",r);}this.layerElement.setAttribute("aria-label",t.t);var s=t.l||[],l=!!this.globalData.fontManager.chars;e=s.length;var c,d=this.mHelper,u="",g=this.data.singleShape,f=0,m=0,_=!0,y=t.tr*.001*t.finalSize;if(g&&!l&&!t.sz){var E=this.textContainer,C="start";switch(t.j){case 1:C="end";break;case 2:C="middle";break;default:C="start";break;}E.setAttribute("text-anchor",C),E.setAttribute("letter-spacing",y);var b=this.buildTextContents(t.finalText);for(e=b.length,m=t.ps?t.ps[1]+t.ascent:0,n=0;n<e;n+=1)c=this.textSpans[n].span||createNS("tspan"),c.textContent=b[n],c.setAttribute("x",0),c.setAttribute("y",m),c.style.display="inherit",E.appendChild(c),this.textSpans[n]||(this.textSpans[n]={span:null,glyph:null}),this.textSpans[n].span=c,m+=t.finalLineHeight;this.layerElement.appendChild(E);}else{var x=this.textSpans.length,w;for(n=0;n<e;n+=1){if(this.textSpans[n]||(this.textSpans[n]={span:null,childSpan:null,glyph:null}),!l||!g||n===0){if(c=x>n?this.textSpans[n].span:createNS(l?"g":"text"),x<=n){if(c.setAttribute("stroke-linecap","butt"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit","4"),this.textSpans[n].span=c,l){var T=createNS("g");c.appendChild(T),this.textSpans[n].childSpan=T;}this.textSpans[n].span=c,this.layerElement.appendChild(c);}c.style.display="inherit";}if(d.reset(),g&&(s[n].n&&(f=-y,m+=t.yOffset,m+=_?1:0,_=!1),this.applyTextPropertiesToMatrix(t,d,s[n].line,f,m),f+=s[n].l||0,f+=y),l){w=this.globalData.fontManager.getCharData(t.finalText[n],i.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily);var R;if(w.t===1)R=new SVGCompElement(w.data,this.globalData,this);else{var V=emptyShapeData;w.data&&w.data.shapes&&(V=this.buildShapeData(w.data,t.finalSize)),R=new SVGShapeElement(V,this.globalData,this);}if(this.textSpans[n].glyph){var B=this.textSpans[n].glyph;this.textSpans[n].childSpan.removeChild(B.layerElement),B.destroy();}this.textSpans[n].glyph=R,R._debug=!0,R.prepareFrame(0),R.renderFrame(),this.textSpans[n].childSpan.appendChild(R.layerElement),w.t===1&&this.textSpans[n].childSpan.setAttribute("transform","scale("+t.finalSize/100+","+t.finalSize/100+")");}else g&&c.setAttribute("transform","translate("+d.props[12]+","+d.props[13]+")"),c.textContent=s[n].val,c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve");}g&&c&&c.setAttribute("d",u);}for(;n<this.textSpans.length;)this.textSpans[n].span.style.display="none",n+=1;this._sizeChanged=!0;},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var n=this.layerElement.getBBox();this.bbox={top:n.y,left:n.x,width:n.width,height:n.height};}return this.bbox;},SVGTextLottieElement.prototype.getValue=function(){var n,e=this.textSpans.length,t;for(this.renderedFrame=this.comp.renderedFrame,n=0;n<e;n+=1)t=this.textSpans[n].glyph,t&&(t.prepareFrame(this.comp.renderedFrame-this.data.st),t._mdf&&(this._mdf=!0));},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var n,e,t=this.textAnimator.renderedLetters,i=this.textProperty.currentData.l;e=i.length;var r,o,s;for(n=0;n<e;n+=1)i[n].n||(r=t[n],o=this.textSpans[n].span,s=this.textSpans[n].glyph,s&&s.renderFrame(),r._mdf.m&&o.setAttribute("transform",r.m),r._mdf.o&&o.setAttribute("opacity",r.o),r._mdf.sw&&o.setAttribute("stroke-width",r.sw),r._mdf.sc&&o.setAttribute("stroke",r.sc),r._mdf.fc&&o.setAttribute("fill",r.fc));}};function ISolidElement(n,e,t){this.initElement(n,e,t);}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var n=createNS("rect");n.setAttribute("width",this.data.sw),n.setAttribute("height",this.data.sh),n.setAttribute("fill",this.data.sc),this.layerElement.appendChild(n);};function NullElement(n,e,t){this.initFrame(),this.initBaseData(n,e,t),this.initFrame(),this.initTransform(n,e,t),this.initHierarchy();}NullElement.prototype.prepareFrame=function(n){this.prepareProperties(n,!0);},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null;},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(n){return new NullElement(n,this.globalData,this);},SVGRendererBase.prototype.createShape=function(n){return new SVGShapeElement(n,this.globalData,this);},SVGRendererBase.prototype.createText=function(n){return new SVGTextLottieElement(n,this.globalData,this);},SVGRendererBase.prototype.createImage=function(n){return new IImageElement(n,this.globalData,this);},SVGRendererBase.prototype.createSolid=function(n){return new ISolidElement(n,this.globalData,this);},SVGRendererBase.prototype.configAnimation=function(n){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+n.w+" "+n.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",n.w),this.svgElement.setAttribute("height",n.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var e=this.globalData.defs;this.setupGlobalData(n,e),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=n;var t=createNS("clipPath"),i=createNS("rect");i.setAttribute("width",n.w),i.setAttribute("height",n.h),i.setAttribute("x",0),i.setAttribute("y",0);var r=createElementID();t.setAttribute("id",r),t.appendChild(i),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+r+")"),e.appendChild(t),this.layers=n.layers,this.elements=createSizedArray(n.layers.length);},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var n,e=this.layers?this.layers.length:0;for(n=0;n<e;n+=1)this.elements[n]&&this.elements[n].destroy&&this.elements[n].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null;},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(n){var e=0,t=this.layers.length;for(e=0;e<t;e+=1)if(this.layers[e].ind===n)return e;return-1;},SVGRendererBase.prototype.buildItem=function(n){var e=this.elements;if(!(e[n]||this.layers[n].ty===99)){e[n]=!0;var t=this.createItem(this.layers[n]);if(e[n]=t,getExpressionsPlugin()&&(this.layers[n].ty===0&&this.globalData.projectInterface.registerComposition(t),t.initExpressions()),this.appendElementInPos(t,n),this.layers[n].tt){var i="tp"in this.layers[n]?this.findIndexByInd(this.layers[n].tp):n-1;if(i===-1)return;if(!this.elements[i]||this.elements[i]===!0)this.buildItem(i),this.addPendingElement(t);else{var r=e[i],o=r.getMatte(this.layers[n].tt);t.setMatte(o);}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var n=this.pendingElements.pop();if(n.checkParenting(),n.data.tt)for(var e=0,t=this.elements.length;e<t;){if(this.elements[e]===n){var i="tp"in n.data?this.findIndexByInd(n.data.tp):e-1,r=this.elements[i],o=r.getMatte(this.layers[e].tt);n.setMatte(o);break;}e+=1;}}},SVGRendererBase.prototype.renderFrame=function(n){if(!(this.renderedFrame===n||this.destroyed)){n===null?n=this.renderedFrame:this.renderedFrame=n,this.globalData.frameNum=n,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=n,this.globalData._mdf=!1;var e,t=this.layers.length;for(this.completeLayers||this.checkLayers(n),e=t-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].prepareFrame(n-this.layers[e].st);if(this.globalData._mdf)for(e=0;e<t;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame();}},SVGRendererBase.prototype.appendElementInPos=function(n,e){var t=n.getBaseElement();if(t){for(var i=0,r;i<e;)this.elements[i]&&this.elements[i]!==!0&&this.elements[i].getBaseElement()&&(r=this.elements[i].getBaseElement()),i+=1;r?this.layerElement.insertBefore(t,r):this.layerElement.appendChild(t);}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none";},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block";};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(n,e,t){this.initFrame(),this.initBaseData(n,e,t),this.initTransform(n,e,t),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!e.progressiveLoad)&&this.buildAllItems(),this.hide();},ICompElement.prototype.prepareFrame=function(n){if(this._mdf=!1,this.prepareRenderableFrame(n),this.prepareProperties(n,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=n/this.data.sr;else{var e=this.tm.v;e===this.data.op&&(e=this.data.op-1),this.renderedFrame=e;}var t,i=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),t=i-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&(this.elements[t].prepareFrame(this.renderedFrame-this.layers[t].st),this.elements[t]._mdf&&(this._mdf=!0));}},ICompElement.prototype.renderInnerContent=function(){var n,e=this.layers.length;for(n=0;n<e;n+=1)(this.completeLayers||this.elements[n])&&this.elements[n].renderFrame();},ICompElement.prototype.setElements=function(n){this.elements=n;},ICompElement.prototype.getElements=function(){return this.elements;},ICompElement.prototype.destroyElements=function(){var n,e=this.layers.length;for(n=0;n<e;n+=1)this.elements[n]&&this.elements[n].destroy();},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement();};function SVGCompElement(n,e,t){this.layers=n.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(n,e,t),this.tm=n.tm?PropertyFactory.getProp(this,n.tm,0,e.frameRate,this):{_placeholder:!0};}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(n){return new SVGCompElement(n,this.globalData,this);};function SVGRenderer(n,e){this.animationItem=n,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var t="";if(e&&e.title){var i=createNS("title"),r=createElementID();i.setAttribute("id",r),i.textContent=e.title,this.svgElement.appendChild(i),t+=r;}if(e&&e.description){var o=createNS("desc"),s=createElementID();o.setAttribute("id",s),o.textContent=e.description,this.svgElement.appendChild(o),t+=" "+s;}t&&this.svgElement.setAttribute("aria-labelledby",t);var l=createNS("defs");this.svgElement.appendChild(l);var c=createNS("g");this.svgElement.appendChild(c),this.layerElement=c,this.renderConfig={preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",progressiveLoad:e&&e.progressiveLoad||!1,hideOnTransparent:!(e&&e.hideOnTransparent===!1),viewBoxOnly:e&&e.viewBoxOnly||!1,viewBoxSize:e&&e.viewBoxSize||!1,className:e&&e.className||"",id:e&&e.id||"",focusable:e&&e.focusable,filterSize:{width:e&&e.filterSize&&e.filterSize.width||"100%",height:e&&e.filterSize&&e.filterSize.height||"100%",x:e&&e.filterSize&&e.filterSize.x||"0%",y:e&&e.filterSize&&e.filterSize.y||"0%"},width:e&&e.width,height:e&&e.height,runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:l,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg";}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(n){return new SVGCompElement(n,this.globalData,this);};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0;}ShapeTransformManager.prototype={addTransformSequence:function(e){var t,i=e.length,r="_";for(t=0;t<i;t+=1)r+=e[t].transform.key+"_";var o=this.sequences[r];return o||(o={transforms:[].concat(e),finalTransform:new Matrix(),_mdf:!1},this.sequences[r]=o,this.sequenceList.push(o)),o;},processSequence:function(e,t){for(var i=0,r=e.transforms.length,o=t;i<r&&!t;){if(e.transforms[i].transform.mProps._mdf){o=!0;break;}i+=1;}if(o)for(e.finalTransform.reset(),i=r-1;i>=0;i-=1)e.finalTransform.multiply(e.transforms[i].transform.mProps.v);e._mdf=o;},processSequences:function(e){var t,i=this.sequenceList.length;for(t=0;t<i;t+=1)this.processSequence(this.sequenceList[t],e);},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count;}};var lumaLoader=function(){var e="__lottie_element_luma_buffer",t=null,i=null,r=null;function o(){var c=createNS("svg"),d=createNS("filter"),u=createNS("feColorMatrix");return d.setAttribute("id",e),u.setAttribute("type","matrix"),u.setAttribute("color-interpolation-filters","sRGB"),u.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),d.appendChild(u),c.appendChild(d),c.setAttribute("id",e+"_svg"),featureSupport.svgLumaHidden&&(c.style.display="none"),c;}function s(){t||(r=o(),document.body.appendChild(r),t=createTag("canvas"),i=t.getContext("2d"),i.filter="url(#"+e+")",i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1));}function l(c){return t||s(),t.width=c.width,t.height=c.height,i.filter="url(#"+e+")",t;}return{load:s,get:l};};function createCanvas(n,e){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(n,e);var t=createTag("canvas");return t.width=n,t.height=e,t;}var assetLoader=function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas};}(),registeredEffects={};function CVEffects(n){var e,t=n.data.ef?n.data.ef.length:0;this.filters=[];var i;for(e=0;e<t;e+=1){i=null;var r=n.data.ef[e].ty;if(registeredEffects[r]){var o=registeredEffects[r].effect;i=new o(n.effectsManager.effectElements[e],n);}i&&this.filters.push(i);}this.filters.length&&n.addRenderableComponent(this);}CVEffects.prototype.renderFrame=function(n){var e,t=this.filters.length;for(e=0;e<t;e+=1)this.filters[e].renderFrame(n);},CVEffects.prototype.getEffects=function(n){var e,t=this.filters.length,i=[];for(e=0;e<t;e+=1)this.filters[e].type===n&&i.push(this.filters[e]);return i;};function registerEffect(n,e){registeredEffects[n]={effect:e};}function CVMaskElement(n,e){this.data=n,this.element=e,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var t,i=this.masksProperties.length,r=!1;for(t=0;t<i;t+=1)this.masksProperties[t].mode!=="n"&&(r=!0),this.viewData[t]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[t],3);this.hasMasks=r,r&&this.element.addRenderableComponent(this);}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var n=this.element.finalTransform.mat,e=this.element.canvasContext,t,i=this.masksProperties.length,r,o,s;for(e.beginPath(),t=0;t<i;t+=1)if(this.masksProperties[t].mode!=="n"){this.masksProperties[t].inv&&(e.moveTo(0,0),e.lineTo(this.element.globalData.compSize.w,0),e.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),e.lineTo(0,this.element.globalData.compSize.h),e.lineTo(0,0)),s=this.viewData[t].v,r=n.applyToPointArray(s.v[0][0],s.v[0][1],0),e.moveTo(r[0],r[1]);var l,c=s._length;for(l=1;l<c;l+=1)o=n.applyToTriplePoints(s.o[l-1],s.i[l],s.v[l]),e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);o=n.applyToTriplePoints(s.o[l-1],s.i[0],s.v[0]),e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);}this.element.globalData.renderer.save(!0),e.clip();}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null;};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var e=this.globalData.canvasContext,t=assetLoader.createCanvas(e.canvas.width,e.canvas.height);this.buffers.push(t);var i=assetLoader.createCanvas(e.canvas.width,e.canvas.height);this.buffers.push(i),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas();}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms();},createContent:function(){},setBlendMode:function(){var e=this.globalData;if(e.blendMode!==this.data.bm){e.blendMode=this.data.bm;var t=getBlendMode(this.data.bm);e.canvasContext.globalCompositeOperation=t;}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0);},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0);},clearCanvas:function(e){e.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy);},prepareLayer:function(){if(this.data.tt>=1){var e=this.buffers[0],t=e.getContext("2d");this.clearCanvas(t),t.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);}},exitLayer:function(){if(this.data.tt>=1){var e=this.buffers[1],t=e.getContext("2d");this.clearCanvas(t),t.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var i=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if(i.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var r=assetLoader.getLumaCanvas(this.canvasContext.canvas),o=r.getContext("2d");o.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(r,0,0);}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(e,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over";}},renderFrame:function(e){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!e)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var t=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(t),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(t),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1);}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy();},mHelper:new Matrix()},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(n,e,t,i){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var r=4;e.ty==="rc"?r=5:e.ty==="el"?r=6:e.ty==="sr"&&(r=7),this.sh=ShapePropertyFactory.getShapeProp(n,e,r,n);var o,s=t.length,l;for(o=0;o<s;o+=1)t[o].closed||(l={transforms:i.addTransformSequence(t[o].transforms),trNodes:[]},this.styledShapes.push(l),t[o].elements.push(l));}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(n,e,t){this.shapes=[],this.shapesData=n.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager(),this.initElement(n,e,t);}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]);},CVShapeElement.prototype.createStyleElement=function(n,e){var t={data:n,type:n.ty,preTransforms:this.transformsManager.addTransformSequence(e),transforms:[],elements:[],closed:n.hd===!0},i={};if(n.ty==="fl"||n.ty==="st"?(i.c=PropertyFactory.getProp(this,n.c,1,255,this),i.c.k||(t.co="rgb("+bmFloor(i.c.v[0])+","+bmFloor(i.c.v[1])+","+bmFloor(i.c.v[2])+")")):(n.ty==="gf"||n.ty==="gs")&&(i.s=PropertyFactory.getProp(this,n.s,1,null,this),i.e=PropertyFactory.getProp(this,n.e,1,null,this),i.h=PropertyFactory.getProp(this,n.h||{k:0},0,.01,this),i.a=PropertyFactory.getProp(this,n.a||{k:0},0,degToRads,this),i.g=new GradientProperty(this,n.g,this)),i.o=PropertyFactory.getProp(this,n.o,0,.01,this),n.ty==="st"||n.ty==="gs"){if(t.lc=lineCapEnum[n.lc||2],t.lj=lineJoinEnum[n.lj||2],n.lj==1&&(t.ml=n.ml),i.w=PropertyFactory.getProp(this,n.w,0,null,this),i.w.k||(t.wi=i.w.v),n.d){var r=new DashProperty(this,n.d,"canvas",this);i.d=r,i.d.k||(t.da=i.d.dashArray,t.do=i.d.dashoffset[0]);}}else t.r=n.r===2?"evenodd":"nonzero";return this.stylesList.push(t),i.style=t,i;},CVShapeElement.prototype.createGroupElement=function(){var n={it:[],prevViewData:[]};return n;},CVShapeElement.prototype.createTransformElement=function(n){var e={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,n.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,n,this)}};return e;},CVShapeElement.prototype.createShapeElement=function(n){var e=new CVShapeData(this,n,this.stylesList,this.transformsManager);return this.shapes.push(e),this.addShapeToModifiers(e),e;},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var n,e=this.itemsData.length;for(n=0;n<e;n+=1)this.prevViewData[n]=this.itemsData[n];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),e=this.dynamicProperties.length,n=0;n<e;n+=1)this.dynamicProperties[n].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame);},CVShapeElement.prototype.addTransformToStyleList=function(n){var e,t=this.stylesList.length;for(e=0;e<t;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.push(n);},CVShapeElement.prototype.removeTransformFromStyleList=function(){var n,e=this.stylesList.length;for(n=0;n<e;n+=1)this.stylesList[n].closed||this.stylesList[n].transforms.pop();},CVShapeElement.prototype.closeStyles=function(n){var e,t=n.length;for(e=0;e<t;e+=1)n[e].closed=!0;},CVShapeElement.prototype.searchShapes=function(n,e,t,i,r){var o,s=n.length-1,l,c,d=[],u=[],g,f,m,_=[].concat(r);for(o=s;o>=0;o-=1){if(g=this.searchProcessedElement(n[o]),g?e[o]=t[g-1]:n[o]._shouldRender=i,n[o].ty==="fl"||n[o].ty==="st"||n[o].ty==="gf"||n[o].ty==="gs")g?e[o].style.closed=!1:e[o]=this.createStyleElement(n[o],_),d.push(e[o].style);else if(n[o].ty==="gr"){if(!g)e[o]=this.createGroupElement(n[o]);else for(c=e[o].it.length,l=0;l<c;l+=1)e[o].prevViewData[l]=e[o].it[l];this.searchShapes(n[o].it,e[o].it,e[o].prevViewData,i,_);}else n[o].ty==="tr"?(g||(m=this.createTransformElement(n[o]),e[o]=m),_.push(e[o]),this.addTransformToStyleList(e[o])):n[o].ty==="sh"||n[o].ty==="rc"||n[o].ty==="el"||n[o].ty==="sr"?g||(e[o]=this.createShapeElement(n[o])):n[o].ty==="tm"||n[o].ty==="rd"||n[o].ty==="pb"||n[o].ty==="zz"||n[o].ty==="op"?(g?(f=e[o],f.closed=!1):(f=ShapeModifiers.getModifier(n[o].ty),f.init(this,n[o]),e[o]=f,this.shapeModifiers.push(f)),u.push(f)):n[o].ty==="rp"&&(g?(f=e[o],f.closed=!0):(f=ShapeModifiers.getModifier(n[o].ty),e[o]=f,f.init(this,n,o,e),this.shapeModifiers.push(f),i=!1),u.push(f));this.addProcessedElement(n[o],o+1);}for(this.removeTransformFromStyleList(),this.closeStyles(d),s=u.length,o=0;o<s;o+=1)u[o].closed=!0;},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0);},CVShapeElement.prototype.renderShapeTransform=function(n,e){(n._opMdf||e.op._mdf||this._isFirstFrame)&&(e.opacity=n.opacity,e.opacity*=e.op.v,e._opMdf=!0);},CVShapeElement.prototype.drawLayer=function(){var n,e=this.stylesList.length,t,i,r,o,s,l,c=this.globalData.renderer,d=this.globalData.canvasContext,u,g;for(n=0;n<e;n+=1)if(g=this.stylesList[n],u=g.type,!((u==="st"||u==="gs")&&g.wi===0||!g.data._shouldRender||g.coOp===0||this.globalData.currentGlobalAlpha===0)){for(c.save(),s=g.elements,u==="st"||u==="gs"?(c.ctxStrokeStyle(u==="st"?g.co:g.grd),c.ctxLineWidth(g.wi),c.ctxLineCap(g.lc),c.ctxLineJoin(g.lj),c.ctxMiterLimit(g.ml||0)):c.ctxFillStyle(u==="fl"?g.co:g.grd),c.ctxOpacity(g.coOp),u!=="st"&&u!=="gs"&&d.beginPath(),c.ctxTransform(g.preTransforms.finalTransform.props),i=s.length,t=0;t<i;t+=1){for((u==="st"||u==="gs")&&(d.beginPath(),g.da&&(d.setLineDash(g.da),d.lineDashOffset=g.do)),l=s[t].trNodes,o=l.length,r=0;r<o;r+=1)l[r].t==="m"?d.moveTo(l[r].p[0],l[r].p[1]):l[r].t==="c"?d.bezierCurveTo(l[r].pts[0],l[r].pts[1],l[r].pts[2],l[r].pts[3],l[r].pts[4],l[r].pts[5]):d.closePath();(u==="st"||u==="gs")&&(c.ctxStroke(),g.da&&d.setLineDash(this.dashResetter));}u!=="st"&&u!=="gs"&&this.globalData.renderer.ctxFill(g.r),c.restore();}},CVShapeElement.prototype.renderShape=function(n,e,t,i){var r,o=e.length-1,s;for(s=n,r=o;r>=0;r-=1)e[r].ty==="tr"?(s=t[r].transform,this.renderShapeTransform(n,s)):e[r].ty==="sh"||e[r].ty==="el"||e[r].ty==="rc"||e[r].ty==="sr"?this.renderPath(e[r],t[r]):e[r].ty==="fl"?this.renderFill(e[r],t[r],s):e[r].ty==="st"?this.renderStroke(e[r],t[r],s):e[r].ty==="gf"||e[r].ty==="gs"?this.renderGradientFill(e[r],t[r],s):e[r].ty==="gr"?this.renderShape(s,e[r].it,t[r].it):e[r].ty;i&&this.drawLayer();},CVShapeElement.prototype.renderStyledShape=function(n,e){if(this._isFirstFrame||e._mdf||n.transforms._mdf){var t=n.trNodes,i=e.paths,r,o,s,l=i._length;t.length=0;var c=n.transforms.finalTransform;for(s=0;s<l;s+=1){var d=i.shapes[s];if(d&&d.v){for(o=d._length,r=1;r<o;r+=1)r===1&&t.push({t:"m",p:c.applyToPointArray(d.v[0][0],d.v[0][1],0)}),t.push({t:"c",pts:c.applyToTriplePoints(d.o[r-1],d.i[r],d.v[r])});o===1&&t.push({t:"m",p:c.applyToPointArray(d.v[0][0],d.v[0][1],0)}),d.c&&o&&(t.push({t:"c",pts:c.applyToTriplePoints(d.o[r-1],d.i[0],d.v[0])}),t.push({t:"z"}));}}n.trNodes=t;}},CVShapeElement.prototype.renderPath=function(n,e){if(n.hd!==!0&&n._shouldRender){var t,i=e.styledShapes.length;for(t=0;t<i;t+=1)this.renderStyledShape(e.styledShapes[t],e.sh);}},CVShapeElement.prototype.renderFill=function(n,e,t){var i=e.style;(e.c._mdf||this._isFirstFrame)&&(i.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||t._opMdf||this._isFirstFrame)&&(i.coOp=e.o.v*t.opacity);},CVShapeElement.prototype.renderGradientFill=function(n,e,t){var i=e.style,r;if(!i.grd||e.g._mdf||e.s._mdf||e.e._mdf||n.t!==1&&(e.h._mdf||e.a._mdf)){var o=this.globalData.canvasContext,s=e.s.v,l=e.e.v;if(n.t===1)r=o.createLinearGradient(s[0],s[1],l[0],l[1]);else{var c=Math.sqrt(Math.pow(s[0]-l[0],2)+Math.pow(s[1]-l[1],2)),d=Math.atan2(l[1]-s[1],l[0]-s[0]),u=e.h.v;u>=1?u=.99:u<=-1&&(u=-.99);var g=c*u,f=Math.cos(d+e.a.v)*g+s[0],m=Math.sin(d+e.a.v)*g+s[1];r=o.createRadialGradient(f,m,0,s[0],s[1],c);}var _,y=n.g.p,E=e.g.c,C=1;for(_=0;_<y;_+=1)e.g._hasOpacity&&e.g._collapsable&&(C=e.g.o[_*2+1]),r.addColorStop(E[_*4]/100,"rgba("+E[_*4+1]+","+E[_*4+2]+","+E[_*4+3]+","+C+")");i.grd=r;}i.coOp=e.o.v*t.opacity;},CVShapeElement.prototype.renderStroke=function(n,e,t){var i=e.style,r=e.d;r&&(r._mdf||this._isFirstFrame)&&(i.da=r.dashArray,i.do=r.dashoffset[0]),(e.c._mdf||this._isFirstFrame)&&(i.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||t._opMdf||this._isFirstFrame)&&(i.coOp=e.o.v*t.opacity),(e.w._mdf||this._isFirstFrame)&&(i.wi=e.w.v);},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0;};function CVTextElement(n,e,t){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(n,e,t);}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var n=this.textProperty.currentData;this.renderedLetters=createSizedArray(n.l?n.l.length:0);var e=!1;n.fc?(e=!0,this.values.fill=this.buildColor(n.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=e;var t=!1;n.sc&&(t=!0,this.values.stroke=this.buildColor(n.sc),this.values.sWidth=n.sw);var i=this.globalData.fontManager.getFontByName(n.f),r,o,s=n.l,l=this.mHelper;this.stroke=t,this.values.fValue=n.finalSize+"px "+this.globalData.fontManager.getFontByName(n.f).fFamily,o=n.finalText.length;var c,d,u,g,f,m,_,y,E,C,b=this.data.singleShape,x=n.tr*.001*n.finalSize,w=0,T=0,R=!0,V=0;for(r=0;r<o;r+=1){c=this.globalData.fontManager.getCharData(n.finalText[r],i.fStyle,this.globalData.fontManager.getFontByName(n.f).fFamily),d=c&&c.data||{},l.reset(),b&&s[r].n&&(w=-x,T+=n.yOffset,T+=R?1:0,R=!1),f=d.shapes?d.shapes[0].it:[],_=f.length,l.scale(n.finalSize/100,n.finalSize/100),b&&this.applyTextPropertiesToMatrix(n,l,s[r].line,w,T),E=createSizedArray(_-1);var B=0;for(m=0;m<_;m+=1)if(f[m].ty==="sh"){for(g=f[m].ks.k.i.length,y=f[m].ks.k,C=[],u=1;u<g;u+=1)u===1&&C.push(l.applyToX(y.v[0][0],y.v[0][1],0),l.applyToY(y.v[0][0],y.v[0][1],0)),C.push(l.applyToX(y.o[u-1][0],y.o[u-1][1],0),l.applyToY(y.o[u-1][0],y.o[u-1][1],0),l.applyToX(y.i[u][0],y.i[u][1],0),l.applyToY(y.i[u][0],y.i[u][1],0),l.applyToX(y.v[u][0],y.v[u][1],0),l.applyToY(y.v[u][0],y.v[u][1],0));C.push(l.applyToX(y.o[u-1][0],y.o[u-1][1],0),l.applyToY(y.o[u-1][0],y.o[u-1][1],0),l.applyToX(y.i[0][0],y.i[0][1],0),l.applyToY(y.i[0][0],y.i[0][1],0),l.applyToX(y.v[0][0],y.v[0][1],0),l.applyToY(y.v[0][0],y.v[0][1],0)),E[B]=C,B+=1;}b&&(w+=s[r].l,w+=x),this.textSpans[V]?this.textSpans[V].elem=E:this.textSpans[V]={elem:E},V+=1;}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var n=this.canvasContext;n.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var e,t,i,r,o,s,l=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;t=c.length;var d,u=null,g=null,f=null,m,_,y=this.globalData.renderer;for(e=0;e<t;e+=1)if(!c[e].n){if(d=l[e],d&&(y.save(),y.ctxTransform(d.p),y.ctxOpacity(d.o)),this.fill){for(d&&d.fc?u!==d.fc&&(y.ctxFillStyle(d.fc),u=d.fc):u!==this.values.fill&&(u=this.values.fill,y.ctxFillStyle(this.values.fill)),m=this.textSpans[e].elem,r=m.length,this.globalData.canvasContext.beginPath(),i=0;i<r;i+=1)for(_=m[i],s=_.length,this.globalData.canvasContext.moveTo(_[0],_[1]),o=2;o<s;o+=6)this.globalData.canvasContext.bezierCurveTo(_[o],_[o+1],_[o+2],_[o+3],_[o+4],_[o+5]);this.globalData.canvasContext.closePath(),y.ctxFill();}if(this.stroke){for(d&&d.sw?f!==d.sw&&(f=d.sw,y.ctxLineWidth(d.sw)):f!==this.values.sWidth&&(f=this.values.sWidth,y.ctxLineWidth(this.values.sWidth)),d&&d.sc?g!==d.sc&&(g=d.sc,y.ctxStrokeStyle(d.sc)):g!==this.values.stroke&&(g=this.values.stroke,y.ctxStrokeStyle(this.values.stroke)),m=this.textSpans[e].elem,r=m.length,this.globalData.canvasContext.beginPath(),i=0;i<r;i+=1)for(_=m[i],s=_.length,this.globalData.canvasContext.moveTo(_[0],_[1]),o=2;o<s;o+=6)this.globalData.canvasContext.bezierCurveTo(_[o],_[o+1],_[o+2],_[o+3],_[o+4],_[o+5]);this.globalData.canvasContext.closePath(),y.ctxStroke();}d&&this.globalData.renderer.restore();}};function CVImageElement(n,e,t){this.assetData=e.getAssetData(n.refId),this.img=e.imageLoader.getAsset(this.assetData),this.initElement(n,e,t);}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var n=createTag("canvas");n.width=this.assetData.w,n.height=this.assetData.h;var e=n.getContext("2d"),t=this.img.width,i=this.img.height,r=t/i,o=this.assetData.w/this.assetData.h,s,l,c=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;r>o&&c==="xMidYMid slice"||r<o&&c!=="xMidYMid slice"?(l=i,s=l*o):(s=t,l=s/o),e.drawImage(this.img,(t-s)/2,(i-l)/2,s,l,0,0,this.assetData.w,this.assetData.h),this.img=n;}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0);},CVImageElement.prototype.destroy=function(){this.img=null;};function CVSolidElement(n,e,t){this.initElement(n,e,t);}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh);};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(n){return new CVShapeElement(n,this.globalData,this);},CanvasRendererBase.prototype.createText=function(n){return new CVTextElement(n,this.globalData,this);},CanvasRendererBase.prototype.createImage=function(n){return new CVImageElement(n,this.globalData,this);},CanvasRendererBase.prototype.createSolid=function(n){return new CVSolidElement(n,this.globalData,this);},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(n){n[0]===1&&n[1]===0&&n[4]===0&&n[5]===1&&n[12]===0&&n[13]===0||this.canvasContext.transform(n[0],n[1],n[4],n[5],n[12],n[13]);},CanvasRendererBase.prototype.ctxOpacity=function(n){this.canvasContext.globalAlpha*=n<0?0:n;},CanvasRendererBase.prototype.ctxFillStyle=function(n){this.canvasContext.fillStyle=n;},CanvasRendererBase.prototype.ctxStrokeStyle=function(n){this.canvasContext.strokeStyle=n;},CanvasRendererBase.prototype.ctxLineWidth=function(n){this.canvasContext.lineWidth=n;},CanvasRendererBase.prototype.ctxLineCap=function(n){this.canvasContext.lineCap=n;},CanvasRendererBase.prototype.ctxLineJoin=function(n){this.canvasContext.lineJoin=n;},CanvasRendererBase.prototype.ctxMiterLimit=function(n){this.canvasContext.miterLimit=n;},CanvasRendererBase.prototype.ctxFill=function(n){this.canvasContext.fill(n);},CanvasRendererBase.prototype.ctxFillRect=function(n,e,t,i){this.canvasContext.fillRect(n,e,t,i);},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke();},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return;}this.contextData.reset();},CanvasRendererBase.prototype.save=function(){this.canvasContext.save();},CanvasRendererBase.prototype.restore=function(n){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return;}n&&(this.globalData.blendMode="source-over"),this.contextData.restore(n);},CanvasRendererBase.prototype.configAnimation=function(n){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var e=this.animationItem.container.style;e.width="100%",e.height="100%";var t="0px 0px 0px";e.transformOrigin=t,e.mozTransformOrigin=t,e.webkitTransformOrigin=t,e["-webkit-transform"]=t,e.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id);}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=n,this.layers=n.layers,this.transformCanvas={w:n.w,h:n.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(n,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(n.layers.length),this.updateContainerSize();},CanvasRendererBase.prototype.updateContainerSize=function(n,e){this.reset();var t,i;n?(t=n,i=e,this.canvasContext.canvas.width=t,this.canvasContext.canvas.height=i):(this.animationItem.wrapper&&this.animationItem.container?(t=this.animationItem.wrapper.offsetWidth,i=this.animationItem.wrapper.offsetHeight):(t=this.canvasContext.canvas.width,i=this.canvasContext.canvas.height),this.canvasContext.canvas.width=t*this.renderConfig.dpr,this.canvasContext.canvas.height=i*this.renderConfig.dpr);var r,o;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var s=this.renderConfig.preserveAspectRatio.split(" "),l=s[1]||"meet",c=s[0]||"xMidYMid",d=c.substr(0,4),u=c.substr(4);r=t/i,o=this.transformCanvas.w/this.transformCanvas.h,o>r&&l==="meet"||o<r&&l==="slice"?(this.transformCanvas.sx=t/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=t/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=i/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=i/(this.transformCanvas.h/this.renderConfig.dpr)),d==="xMid"&&(o<r&&l==="meet"||o>r&&l==="slice")?this.transformCanvas.tx=(t-this.transformCanvas.w*(i/this.transformCanvas.h))/2*this.renderConfig.dpr:d==="xMax"&&(o<r&&l==="meet"||o>r&&l==="slice")?this.transformCanvas.tx=(t-this.transformCanvas.w*(i/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,u==="YMid"&&(o>r&&l==="meet"||o<r&&l==="slice")?this.transformCanvas.ty=(i-this.transformCanvas.h*(t/this.transformCanvas.w))/2*this.renderConfig.dpr:u==="YMax"&&(o>r&&l==="meet"||o<r&&l==="slice")?this.transformCanvas.ty=(i-this.transformCanvas.h*(t/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0;}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=t/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=i/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0);},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var n,e=this.layers?this.layers.length:0;for(n=e-1;n>=0;n-=1)this.elements[n]&&this.elements[n].destroy&&this.elements[n].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0;},CanvasRendererBase.prototype.renderFrame=function(n,e){if(!(this.renderedFrame===n&&this.renderConfig.clearCanvas===!0&&!e||this.destroyed||n===-1)){this.renderedFrame=n,this.globalData.frameNum=n-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||e,this.globalData.projectInterface.currentFrame=n;var t,i=this.layers.length;for(this.completeLayers||this.checkLayers(n),t=i-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].prepareFrame(n-this.layers[t].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),t=i-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore();}}},CanvasRendererBase.prototype.buildItem=function(n){var e=this.elements;if(!(e[n]||this.layers[n].ty===99)){var t=this.createItem(this.layers[n],this,this.globalData);e[n]=t,t.initExpressions();}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var n=this.pendingElements.pop();n.checkParenting();}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none";},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block";};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random();}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix();var n,e=15;for(n=0;n<e;n+=1){var t=new CanvasContext();this.stack[n]=t;}this._length=e,this.nativeContext=null,this.transformMat=new Matrix(),this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit="";}CVContextData.prototype.duplicate=function(){var n=this._length*2,e=0;for(e=this._length;e<n;e+=1)this.stack[e]=new CanvasContext();this._length=n;},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1;},CVContextData.prototype.restore=function(n){this.cArrPos-=1;var e=this.stack[this.cArrPos],t=e.transform,i,r=this.cTr.props;for(i=0;i<16;i+=1)r[i]=t[i];if(n){this.nativeContext.restore();var o=this.stack[this.cArrPos+1];this.appliedFillStyle=o.fillStyle,this.appliedStrokeStyle=o.strokeStyle,this.appliedLineWidth=o.lineWidth,this.appliedLineCap=o.lineCap,this.appliedLineJoin=o.lineJoin,this.appliedMiterLimit=o.miterLimit;}this.nativeContext.setTransform(t[0],t[1],t[4],t[5],t[12],t[13]),(n||e.opacity!==-1&&this.currentOpacity!==e.opacity)&&(this.nativeContext.globalAlpha=e.opacity,this.currentOpacity=e.opacity),this.currentFillStyle=e.fillStyle,this.currentStrokeStyle=e.strokeStyle,this.currentLineWidth=e.lineWidth,this.currentLineCap=e.lineCap,this.currentLineJoin=e.lineJoin,this.currentMiterLimit=e.miterLimit;},CVContextData.prototype.save=function(n){n&&this.nativeContext.save();var e=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var t=this.stack[this.cArrPos],i;for(i=0;i<16;i+=1)t.transform[i]=e[i];this.cArrPos+=1;var r=this.stack[this.cArrPos];r.opacity=t.opacity,r.fillStyle=t.fillStyle,r.strokeStyle=t.strokeStyle,r.lineWidth=t.lineWidth,r.lineCap=t.lineCap,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;},CVContextData.prototype.setOpacity=function(n){this.stack[this.cArrPos].opacity=n;},CVContextData.prototype.setContext=function(n){this.nativeContext=n;},CVContextData.prototype.fillStyle=function(n){this.stack[this.cArrPos].fillStyle!==n&&(this.currentFillStyle=n,this.stack[this.cArrPos].fillStyle=n);},CVContextData.prototype.strokeStyle=function(n){this.stack[this.cArrPos].strokeStyle!==n&&(this.currentStrokeStyle=n,this.stack[this.cArrPos].strokeStyle=n);},CVContextData.prototype.lineWidth=function(n){this.stack[this.cArrPos].lineWidth!==n&&(this.currentLineWidth=n,this.stack[this.cArrPos].lineWidth=n);},CVContextData.prototype.lineCap=function(n){this.stack[this.cArrPos].lineCap!==n&&(this.currentLineCap=n,this.stack[this.cArrPos].lineCap=n);},CVContextData.prototype.lineJoin=function(n){this.stack[this.cArrPos].lineJoin!==n&&(this.currentLineJoin=n,this.stack[this.cArrPos].lineJoin=n);},CVContextData.prototype.miterLimit=function(n){this.stack[this.cArrPos].miterLimit!==n&&(this.currentMiterLimit=n,this.stack[this.cArrPos].miterLimit=n);},CVContextData.prototype.transform=function(n){this.transformMat.cloneFromProps(n);var e=this.cTr;this.transformMat.multiply(e),e.cloneFromProps(this.transformMat.props);var t=e.props;this.nativeContext.setTransform(t[0],t[1],t[4],t[5],t[12],t[13]);},CVContextData.prototype.opacity=function(n){var e=this.stack[this.cArrPos].opacity;e*=n<0?0:n,this.stack[this.cArrPos].opacity!==e&&(this.currentOpacity!==n&&(this.nativeContext.globalAlpha=n,this.currentOpacity=n),this.stack[this.cArrPos].opacity=e);},CVContextData.prototype.fill=function(n){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(n);},CVContextData.prototype.fillRect=function(n,e,t,i){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(n,e,t,i);},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke();};function CVCompElement(n,e,t){this.completeLayers=!1,this.layers=n.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(n,e,t),this.tm=n.tm?PropertyFactory.getProp(this,n.tm,0,e.frameRate,this):{_placeholder:!0};}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var n=this.canvasContext;n.beginPath(),n.moveTo(0,0),n.lineTo(this.data.w,0),n.lineTo(this.data.w,this.data.h),n.lineTo(0,this.data.h),n.lineTo(0,0),n.clip();var e,t=this.layers.length;for(e=t-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame();},CVCompElement.prototype.destroy=function(){var n,e=this.layers.length;for(n=e-1;n>=0;n-=1)this.elements[n]&&this.elements[n].destroy();this.layers=null,this.elements=null;},CVCompElement.prototype.createComp=function(n){return new CVCompElement(n,this.globalData,this);};function CanvasRenderer(n,e){this.animationItem=n,this.renderConfig={clearCanvas:e&&e.clearCanvas!==void 0?e.clearCanvas:!0,context:e&&e.context||null,progressiveLoad:e&&e.progressiveLoad||!1,preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",className:e&&e.className||"",id:e&&e.id||"",runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.renderConfig.dpr=e&&e.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=e&&e.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData(),this.elements=[],this.pendingElements=[],this.transformMat=new Matrix(),this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData));}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(n){return new CVCompElement(n,this.globalData,this);};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement);},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode();},renderElement:function(){var e=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var t=this.finalTransform.mat.toCSS();e.transform=t,e.webkitTransform=t;}this.finalTransform._opMdf&&(e.opacity=this.finalTransform.mProp.o.v);},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1));},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null);},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData);},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(n,e,t){this.initElement(n,e,t);}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var n;this.data.hasMask?(n=createNS("rect"),n.setAttribute("width",this.data.sw),n.setAttribute("height",this.data.sh),n.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(n=createTag("div"),n.style.width=this.data.sw+"px",n.style.height=this.data.sh+"px",n.style.backgroundColor=this.data.sc),this.layerElement.appendChild(n);};function HShapeElement(n,e,t){this.shapes=[],this.shapesData=n.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(n,e,t),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0};}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var n;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),n=this.svgElement;else{n=createNS("svg");var e=this.comp.data?this.comp.data:this.globalData.compSize;n.setAttribute("width",e.w),n.setAttribute("height",e.h),n.appendChild(this.shapesContainer),this.layerElement.appendChild(n);}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=n;},HShapeElement.prototype.getTransformedPoint=function(n,e){var t,i=n.length;for(t=0;t<i;t+=1)e=n[t].mProps.v.applyToPointArray(e[0],e[1],0);return e;},HShapeElement.prototype.calculateShapeBoundingBox=function(n,e){var t=n.sh.v,i=n.transformers,r,o=t._length,s,l,c,d;if(!(o<=1)){for(r=0;r<o-1;r+=1)s=this.getTransformedPoint(i,t.v[r]),l=this.getTransformedPoint(i,t.o[r]),c=this.getTransformedPoint(i,t.i[r+1]),d=this.getTransformedPoint(i,t.v[r+1]),this.checkBounds(s,l,c,d,e);t.c&&(s=this.getTransformedPoint(i,t.v[r]),l=this.getTransformedPoint(i,t.o[r]),c=this.getTransformedPoint(i,t.i[0]),d=this.getTransformedPoint(i,t.v[0]),this.checkBounds(s,l,c,d,e));}},HShapeElement.prototype.checkBounds=function(n,e,t,i,r){this.getBoundsOfCurve(n,e,t,i);var o=this.shapeBoundingBox;r.x=bmMin(o.left,r.x),r.xMax=bmMax(o.right,r.xMax),r.y=bmMin(o.top,r.y),r.yMax=bmMax(o.bottom,r.yMax);},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(n,e,t,i){for(var r=[[n[0],i[0]],[n[1],i[1]]],o,s,l,c,d,u,g,f=0;f<2;++f)s=6*n[f]-12*e[f]+6*t[f],o=-3*n[f]+9*e[f]-9*t[f]+3*i[f],l=3*e[f]-3*n[f],s|=0,o|=0,l|=0,o===0&&s===0||(o===0?(c=-l/s,c>0&&c<1&&r[f].push(this.calculateF(c,n,e,t,i,f))):(d=s*s-4*l*o,d>=0&&(u=(-s+bmSqrt(d))/(2*o),u>0&&u<1&&r[f].push(this.calculateF(u,n,e,t,i,f)),g=(-s-bmSqrt(d))/(2*o),g>0&&g<1&&r[f].push(this.calculateF(g,n,e,t,i,f)))));this.shapeBoundingBox.left=bmMin.apply(null,r[0]),this.shapeBoundingBox.top=bmMin.apply(null,r[1]),this.shapeBoundingBox.right=bmMax.apply(null,r[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,r[1]);},HShapeElement.prototype.calculateF=function(n,e,t,i,r,o){return bmPow(1-n,3)*e[o]+3*bmPow(1-n,2)*n*t[o]+3*(1-n)*bmPow(n,2)*i[o]+bmPow(n,3)*r[o];},HShapeElement.prototype.calculateBoundingBox=function(n,e){var t,i=n.length;for(t=0;t<i;t+=1)n[t]&&n[t].sh?this.calculateShapeBoundingBox(n[t],e):n[t]&&n[t].it?this.calculateBoundingBox(n[t].it,e):n[t]&&n[t].style&&n[t].w&&this.expandStrokeBoundingBox(n[t].w,e);},HShapeElement.prototype.expandStrokeBoundingBox=function(n,e){var t=0;if(n.keyframes){for(var i=0;i<n.keyframes.length;i+=1){var r=n.keyframes[i].s;r>t&&(t=r);}t*=n.mult;}else t=n.v*n.mult;e.x-=t,e.xMax+=t,e.y-=t,e.yMax+=t;},HShapeElement.prototype.currentBoxContains=function(n){return this.currentBBox.x<=n.x&&this.currentBBox.y<=n.y&&this.currentBBox.width+this.currentBBox.x>=n.x+n.width&&this.currentBBox.height+this.currentBBox.y>=n.y+n.height;},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var n=this.tempBoundingBox,e=999999;if(n.x=e,n.xMax=-e,n.y=e,n.yMax=-e,this.calculateBoundingBox(this.itemsData,n),n.width=n.xMax<n.x?0:n.xMax-n.x,n.height=n.yMax<n.y?0:n.yMax-n.y,this.currentBoxContains(n))return;var t=!1;if(this.currentBBox.w!==n.width&&(this.currentBBox.w=n.width,this.shapeCont.setAttribute("width",n.width),t=!0),this.currentBBox.h!==n.height&&(this.currentBBox.h=n.height,this.shapeCont.setAttribute("height",n.height),t=!0),t||this.currentBBox.x!==n.x||this.currentBBox.y!==n.y){this.currentBBox.w=n.width,this.currentBBox.h=n.height,this.currentBBox.x=n.x,this.currentBBox.y=n.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var i=this.shapeCont.style,r="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";i.transform=r,i.webkitTransform=r;}}};function HTextElement(n,e,t){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(n,e,t);}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var n=createNS("g");this.maskedElement.appendChild(n),this.innerElem=n;}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting();},HTextElement.prototype.buildNewText=function(){var n=this.textProperty.currentData;this.renderedLetters=createSizedArray(n.l?n.l.length:0);var e=this.innerElem.style,t=n.fc?this.buildColor(n.fc):"rgba(0,0,0,0)";e.fill=t,e.color=t,n.sc&&(e.stroke=this.buildColor(n.sc),e.strokeWidth=n.sw+"px");var i=this.globalData.fontManager.getFontByName(n.f);if(!this.globalData.fontManager.chars)if(e.fontSize=n.finalSize+"px",e.lineHeight=n.finalSize+"px",i.fClass)this.innerElem.className=i.fClass;else{e.fontFamily=i.fFamily;var r=n.fWeight,o=n.fStyle;e.fontStyle=o,e.fontWeight=r;}var s,l,c=n.l;l=c.length;var d,u,g,f=this.mHelper,m,_="",y=0;for(s=0;s<l;s+=1){if(this.globalData.fontManager.chars?(this.textPaths[y]?d=this.textPaths[y]:(d=createNS("path"),d.setAttribute("stroke-linecap",lineCapEnum[1]),d.setAttribute("stroke-linejoin",lineJoinEnum[2]),d.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[y]?(u=this.textSpans[y],g=u.children[0]):(u=createTag("div"),u.style.lineHeight=0,g=createNS("svg"),g.appendChild(d),styleDiv(u)))):this.isMasked?d=this.textPaths[y]?this.textPaths[y]:createNS("text"):this.textSpans[y]?(u=this.textSpans[y],d=this.textPaths[y]):(u=createTag("span"),styleDiv(u),d=createTag("span"),styleDiv(d),u.appendChild(d)),this.globalData.fontManager.chars){var E=this.globalData.fontManager.getCharData(n.finalText[s],i.fStyle,this.globalData.fontManager.getFontByName(n.f).fFamily),C;if(E?C=E.data:C=null,f.reset(),C&&C.shapes&&C.shapes.length&&(m=C.shapes[0].it,f.scale(n.finalSize/100,n.finalSize/100),_=this.createPathShape(f,m),d.setAttribute("d",_)),this.isMasked)this.innerElem.appendChild(d);else{if(this.innerElem.appendChild(u),C&&C.shapes){document.body.appendChild(g);var b=g.getBBox();g.setAttribute("width",b.width+2),g.setAttribute("height",b.height+2),g.setAttribute("viewBox",b.x-1+" "+(b.y-1)+" "+(b.width+2)+" "+(b.height+2));var x=g.style,w="translate("+(b.x-1)+"px,"+(b.y-1)+"px)";x.transform=w,x.webkitTransform=w,c[s].yOffset=b.y-1;}else g.setAttribute("width",1),g.setAttribute("height",1);u.appendChild(g);}}else if(d.textContent=c[s].val,d.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(d);else{this.innerElem.appendChild(u);var T=d.style,R="translate3d(0,"+-n.finalSize/1.2+"px,0)";T.transform=R,T.webkitTransform=R;}this.isMasked?this.textSpans[y]=d:this.textSpans[y]=u,this.textSpans[y].style.display="block",this.textPaths[y]=d,y+=1;}for(;y<this.textSpans.length;)this.textSpans[y].style.display="none",y+=1;},HTextElement.prototype.renderInnerContent=function(){this.validateText();var n;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),n=this.svgElement.style;var e="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";n.transform=e,n.webkitTransform=e;}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var t,i,r=0,o=this.textAnimator.renderedLetters,s=this.textProperty.currentData.l;i=s.length;var l,c,d;for(t=0;t<i;t+=1)s[t].n?r+=1:(c=this.textSpans[t],d=this.textPaths[t],l=o[r],r+=1,l._mdf.m&&(this.isMasked?c.setAttribute("transform",l.m):(c.style.webkitTransform=l.m,c.style.transform=l.m)),c.style.opacity=l.o,l.sw&&l._mdf.sw&&d.setAttribute("stroke-width",l.sw),l.sc&&l._mdf.sc&&d.setAttribute("stroke",l.sc),l.fc&&l._mdf.fc&&(d.setAttribute("fill",l.fc),d.style.color=l.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var u=this.innerElem.getBBox();this.currentBBox.w!==u.width&&(this.currentBBox.w=u.width,this.svgElement.setAttribute("width",u.width)),this.currentBBox.h!==u.height&&(this.currentBBox.h=u.height,this.svgElement.setAttribute("height",u.height));var g=1;if(this.currentBBox.w!==u.width+g*2||this.currentBBox.h!==u.height+g*2||this.currentBBox.x!==u.x-g||this.currentBBox.y!==u.y-g){this.currentBBox.w=u.width+g*2,this.currentBBox.h=u.height+g*2,this.currentBBox.x=u.x-g,this.currentBBox.y=u.y-g,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),n=this.svgElement.style;var f="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";n.transform=f,n.webkitTransform=f;}}}};function HCameraElement(n,e,t){this.initFrame(),this.initBaseData(n,e,t),this.initHierarchy();var i=PropertyFactory.getProp;if(this.pe=i(this,n.pe,0,0,this),n.ks.p.s?(this.px=i(this,n.ks.p.x,1,0,this),this.py=i(this,n.ks.p.y,1,0,this),this.pz=i(this,n.ks.p.z,1,0,this)):this.p=i(this,n.ks.p,1,0,this),n.ks.a&&(this.a=i(this,n.ks.a,1,0,this)),n.ks.or.k.length&&n.ks.or.k[0].to){var r,o=n.ks.or.k.length;for(r=0;r<o;r+=1)n.ks.or.k[r].to=null,n.ks.or.k[r].ti=null;}this.or=i(this,n.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=i(this,n.ks.rx,0,degToRads,this),this.ry=i(this,n.ks.ry,0,degToRads,this),this.rz=i(this,n.ks.rz,0,degToRads,this),this.mat=new Matrix(),this._prevMat=new Matrix(),this._isFirstFrame=!0,this.finalTransform={mProp:this};}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var n,e=this.comp.threeDElements.length,t,i,r;for(n=0;n<e;n+=1)if(t=this.comp.threeDElements[n],t.type==="3d"){i=t.perspectiveElem.style,r=t.container.style;var o=this.pe.v+"px",s="0px 0px 0px",l="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";i.perspective=o,i.webkitPerspective=o,r.transformOrigin=s,r.mozTransformOrigin=s,r.webkitTransformOrigin=s,i.transform=l,i.webkitTransform=l;}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var n=this._isFirstFrame,e,t;if(this.hierarchy)for(t=this.hierarchy.length,e=0;e<t;e+=1)n=this.hierarchy[e].finalTransform.mProp._mdf||n;if(n||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(t=this.hierarchy.length-1,e=t;e>=0;e-=1){var i=this.hierarchy[e].finalTransform.mProp;this.mat.translate(-i.p.v[0],-i.p.v[1],i.p.v[2]),this.mat.rotateX(-i.or.v[0]).rotateY(-i.or.v[1]).rotateZ(i.or.v[2]),this.mat.rotateX(-i.rx.v).rotateY(-i.ry.v).rotateZ(i.rz.v),this.mat.scale(1/i.s.v[0],1/i.s.v[1],1/i.s.v[2]),this.mat.translate(i.a.v[0],i.a.v[1],i.a.v[2]);}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var r;this.p?r=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:r=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var o=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)),s=[r[0]/o,r[1]/o,r[2]/o],l=Math.sqrt(s[2]*s[2]+s[0]*s[0]),c=Math.atan2(s[1],l),d=Math.atan2(s[0],-s[2]);this.mat.rotateY(d).rotateX(-c);}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var u=!this._prevMat.equals(this.mat);if((u||this.pe._mdf)&&this.comp.threeDElements){t=this.comp.threeDElements.length;var g,f,m;for(e=0;e<t;e+=1)if(g=this.comp.threeDElements[e],g.type==="3d"){if(u){var _=this.mat.toCSS();m=g.container.style,m.transform=_,m.webkitTransform=_;}this.pe._mdf&&(f=g.perspectiveElem.style,f.perspective=this.pe.v+"px",f.webkitPerspective=this.pe.v+"px");}this.mat.clone(this._prevMat);}}this._isFirstFrame=!1;},HCameraElement.prototype.prepareFrame=function(n){this.prepareProperties(n,!0);},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null;};function HImageElement(n,e,t){this.assetData=e.getAssetData(n.refId),this.initElement(n,e,t);}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var n=this.globalData.getAssetsPath(this.assetData),e=new Image();this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",n),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(e),e.crossOrigin="anonymous",e.src=n,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln);};function HybridRendererBase(n,e){this.animationItem=n,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&e.hideOnTransparent===!1),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html";}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var n=this.pendingElements.pop();n.checkParenting();}},HybridRendererBase.prototype.appendElementInPos=function(n,e){var t=n.getBaseElement();if(t){var i=this.layers[e];if(!i.ddd||!this.supports3d){if(this.threeDElements)this.addTo3dContainer(t,e);else{for(var r=0,o,s,l;r<e;)this.elements[r]&&this.elements[r]!==!0&&this.elements[r].getBaseElement&&(s=this.elements[r],l=this.layers[r].ddd?this.getThreeDContainerByPos(r):s.getBaseElement(),o=l||o),r+=1;o?(!i.ddd||!this.supports3d)&&this.layerElement.insertBefore(t,o):(!i.ddd||!this.supports3d)&&this.layerElement.appendChild(t);}}else this.addTo3dContainer(t,e);}},HybridRendererBase.prototype.createShape=function(n){return this.supports3d?new HShapeElement(n,this.globalData,this):new SVGShapeElement(n,this.globalData,this);},HybridRendererBase.prototype.createText=function(n){return this.supports3d?new HTextElement(n,this.globalData,this):new SVGTextLottieElement(n,this.globalData,this);},HybridRendererBase.prototype.createCamera=function(n){return this.camera=new HCameraElement(n,this.globalData,this),this.camera;},HybridRendererBase.prototype.createImage=function(n){return this.supports3d?new HImageElement(n,this.globalData,this):new IImageElement(n,this.globalData,this);},HybridRendererBase.prototype.createSolid=function(n){return this.supports3d?new HSolidElement(n,this.globalData,this):new ISolidElement(n,this.globalData,this);},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(n){for(var e=0,t=this.threeDElements.length;e<t;){if(this.threeDElements[e].startPos<=n&&this.threeDElements[e].endPos>=n)return this.threeDElements[e].perspectiveElem;e+=1;}return null;},HybridRendererBase.prototype.createThreeDContainer=function(n,e){var t=createTag("div"),i,r;styleDiv(t);var o=createTag("div");if(styleDiv(o),e==="3d"){i=t.style,i.width=this.globalData.compSize.w+"px",i.height=this.globalData.compSize.h+"px";var s="50% 50%";i.webkitTransformOrigin=s,i.mozTransformOrigin=s,i.transformOrigin=s,r=o.style;var l="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";r.transform=l,r.webkitTransform=l;}t.appendChild(o);var c={container:o,perspectiveElem:t,startPos:n,endPos:n,type:e};return this.threeDElements.push(c),c;},HybridRendererBase.prototype.build3dContainers=function(){var n,e=this.layers.length,t,i="";for(n=0;n<e;n+=1)this.layers[n].ddd&&this.layers[n].ty!==3?(i!=="3d"&&(i="3d",t=this.createThreeDContainer(n,"3d")),t.endPos=Math.max(t.endPos,n)):(i!=="2d"&&(i="2d",t=this.createThreeDContainer(n,"2d")),t.endPos=Math.max(t.endPos,n));for(e=this.threeDElements.length,n=e-1;n>=0;n-=1)this.resizerElem.appendChild(this.threeDElements[n].perspectiveElem);},HybridRendererBase.prototype.addTo3dContainer=function(n,e){for(var t=0,i=this.threeDElements.length;t<i;){if(e<=this.threeDElements[t].endPos){for(var r=this.threeDElements[t].startPos,o;r<e;)this.elements[r]&&this.elements[r].getBaseElement&&(o=this.elements[r].getBaseElement()),r+=1;o?this.threeDElements[t].container.insertBefore(n,o):this.threeDElements[t].container.appendChild(n);break;}t+=1;}},HybridRendererBase.prototype.configAnimation=function(n){var e=createTag("div"),t=this.animationItem.wrapper,i=e.style;i.width=n.w+"px",i.height=n.h+"px",this.resizerElem=e,styleDiv(e),i.transformStyle="flat",i.mozTransformStyle="flat",i.webkitTransformStyle="flat",this.renderConfig.className&&e.setAttribute("class",this.renderConfig.className),t.appendChild(e),i.overflow="hidden";var r=createNS("svg");r.setAttribute("width","1"),r.setAttribute("height","1"),styleDiv(r),this.resizerElem.appendChild(r);var o=createNS("defs");r.appendChild(o),this.data=n,this.setupGlobalData(n,r),this.globalData.defs=o,this.layers=n.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize();},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var n,e=this.layers?this.layers.length:0;for(n=0;n<e;n+=1)this.elements[n]&&this.elements[n].destroy&&this.elements[n].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null;},HybridRendererBase.prototype.updateContainerSize=function(){var n=this.animationItem.wrapper.offsetWidth,e=this.animationItem.wrapper.offsetHeight,t=n/e,i=this.globalData.compSize.w/this.globalData.compSize.h,r,o,s,l;i>t?(r=n/this.globalData.compSize.w,o=n/this.globalData.compSize.w,s=0,l=(e-this.globalData.compSize.h*(n/this.globalData.compSize.w))/2):(r=e/this.globalData.compSize.h,o=e/this.globalData.compSize.h,s=(n-this.globalData.compSize.w*(e/this.globalData.compSize.h))/2,l=0);var c=this.resizerElem.style;c.webkitTransform="matrix3d("+r+",0,0,0,0,"+o+",0,0,0,0,1,0,"+s+","+l+",0,1)",c.transform=c.webkitTransform;},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none";},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block";},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var n=this.globalData.compSize.w,e=this.globalData.compSize.h,t,i=this.threeDElements.length;for(t=0;t<i;t+=1){var r=this.threeDElements[t].perspectiveElem.style;r.webkitPerspective=Math.sqrt(Math.pow(n,2)+Math.pow(e,2))+"px",r.perspective=r.webkitPerspective;}}},HybridRendererBase.prototype.searchExtraCompositions=function(n){var e,t=n.length,i=createTag("div");for(e=0;e<t;e+=1)if(n[e].xt){var r=this.createComp(n[e],i,this.globalData.comp,null);r.initExpressions(),this.globalData.projectInterface.registerComposition(r);}};function HCompElement(n,e,t){this.layers=n.layers,this.supports3d=!n.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(n,e,t),this.tm=n.tm?PropertyFactory.getProp(this,n.tm,0,e.frameRate,this):{_placeholder:!0};}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement;},HCompElement.prototype.addTo3dContainer=function(n,e){for(var t=0,i;t<e;)this.elements[t]&&this.elements[t].getBaseElement&&(i=this.elements[t].getBaseElement()),t+=1;i?this.layerElement.insertBefore(n,i):this.layerElement.appendChild(n);},HCompElement.prototype.createComp=function(n){return this.supports3d?new HCompElement(n,this.globalData,this):new SVGCompElement(n,this.globalData,this);};function HybridRenderer(n,e){this.animationItem=n,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&e.hideOnTransparent===!1),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"},runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html";}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(n){return this.supports3d?new HCompElement(n,this.globalData,this):new SVGCompElement(n,this.globalData,this);};var CompExpressionInterface=function(){return function(n){function e(t){for(var i=0,r=n.layers.length;i<r;){if(n.layers[i].nm===t||n.layers[i].ind===t)return n.elements[i].layerInterface;i+=1;}return null;}return Object.defineProperty(e,"_name",{value:n.data.nm}),e.layer=e,e.pixelAspect=1,e.height=n.data.h||n.globalData.compSize.h,e.width=n.data.w||n.globalData.compSize.w,e.pixelAspect=1,e.frameDuration=1/n.globalData.frameRate,e.displayStartTime=0,e.numLayers=n.layers.length,e;};}();function _typeof$2(n){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e;}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_typeof$2(n);}function seedRandom(n,e){var t=this,i=256,r=6,o=52,s="random",l=e.pow(i,r),c=e.pow(2,o),d=c*2,u=i-1,g;function f(x,w,T){var R=[];w=w===!0?{entropy:!0}:w||{};var V=E(y(w.entropy?[x,b(n)]:x===null?C():x,3),R),B=new m(R),Y=function(){for(var ae=B.g(r),ee=l,ce=0;ae<c;)ae=(ae+ce)*i,ee*=i,ce=B.g(1);for(;ae>=d;)ae/=2,ee/=2,ce>>>=1;return(ae+ce)/ee;};return Y.int32=function(){return B.g(4)|0;},Y.quick=function(){return B.g(4)/4294967296;},Y.double=Y,E(b(B.S),n),(w.pass||T||function(le,ae,ee,ce){return ce&&(ce.S&&_(ce,B),le.state=function(){return _(B,{});}),ee?(e[s]=le,ae):le;})(Y,V,"global"in w?w.global:this==e,w.state);}e["seed"+s]=f;function m(x){var w,T=x.length,R=this,V=0,B=R.i=R.j=0,Y=R.S=[];for(T||(x=[T++]);V<i;)Y[V]=V++;for(V=0;V<i;V++)Y[V]=Y[B=u&B+x[V%T]+(w=Y[V])],Y[B]=w;R.g=function(le){for(var ae,ee=0,ce=R.i,oe=R.j,re=R.S;le--;)ae=re[ce=u&ce+1],ee=ee*i+re[u&(re[ce]=re[oe=u&oe+ae])+(re[oe]=ae)];return R.i=ce,R.j=oe,ee;};}function _(x,w){return w.i=x.i,w.j=x.j,w.S=x.S.slice(),w;}function y(x,w){var T=[],R=_typeof$2(x),V;if(w&&R=="object")for(V in x)try{T.push(y(x[V],w-1));}catch{}return T.length?T:R=="string"?x:x+"\0";}function E(x,w){for(var T=x+"",R,V=0;V<T.length;)w[u&V]=u&(R^=w[u&V]*19)+T.charCodeAt(V++);return b(w);}function C(){try{if(g)return b(g.randomBytes(i));var x=new Uint8Array(i);return(t.crypto||t.msCrypto).getRandomValues(x),b(x);}catch{var w=t.navigator,T=w&&w.plugins;return[+new Date(),t,T,t.screen,b(n)];}}function b(x){return String.fromCharCode.apply(0,x);}E(e.random(),n);}function initialize$2(n){seedRandom([],n);}var propTypes={SHAPE:"shape"};function _typeof$1(n){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e;}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_typeof$1(n);}var ExpressionManager=function(){"use strict";var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={};}function $bm_isInstanceOfArray(n){return n.constructor===Array||n.constructor===Float32Array;}function isNumerable(n,e){return n==="number"||e instanceof Number||n==="boolean"||n==="string";}function $bm_neg(n){var e=_typeof$1(n);if(e==="number"||n instanceof Number||e==="boolean")return-n;if($bm_isInstanceOfArray(n)){var t,i=n.length,r=[];for(t=0;t<i;t+=1)r[t]=-n[t];return r;}return n.propType?n.v:-n;}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(n,e){var t=_typeof$1(n),i=_typeof$1(e);if(isNumerable(t,n)&&isNumerable(i,e)||t==="string"||i==="string")return n+e;if($bm_isInstanceOfArray(n)&&isNumerable(i,e))return n=n.slice(0),n[0]+=e,n;if(isNumerable(t,n)&&$bm_isInstanceOfArray(e))return e=e.slice(0),e[0]=n+e[0],e;if($bm_isInstanceOfArray(n)&&$bm_isInstanceOfArray(e)){for(var r=0,o=n.length,s=e.length,l=[];r<o||r<s;)(typeof n[r]=="number"||n[r]instanceof Number)&&(typeof e[r]=="number"||e[r]instanceof Number)?l[r]=n[r]+e[r]:l[r]=e[r]===void 0?n[r]:n[r]||e[r],r+=1;return l;}return 0;}var add=sum;function sub(n,e){var t=_typeof$1(n),i=_typeof$1(e);if(isNumerable(t,n)&&isNumerable(i,e))return t==="string"&&(n=parseInt(n,10)),i==="string"&&(e=parseInt(e,10)),n-e;if($bm_isInstanceOfArray(n)&&isNumerable(i,e))return n=n.slice(0),n[0]-=e,n;if(isNumerable(t,n)&&$bm_isInstanceOfArray(e))return e=e.slice(0),e[0]=n-e[0],e;if($bm_isInstanceOfArray(n)&&$bm_isInstanceOfArray(e)){for(var r=0,o=n.length,s=e.length,l=[];r<o||r<s;)(typeof n[r]=="number"||n[r]instanceof Number)&&(typeof e[r]=="number"||e[r]instanceof Number)?l[r]=n[r]-e[r]:l[r]=e[r]===void 0?n[r]:n[r]||e[r],r+=1;return l;}return 0;}function mul(n,e){var t=_typeof$1(n),i=_typeof$1(e),r;if(isNumerable(t,n)&&isNumerable(i,e))return n*e;var o,s;if($bm_isInstanceOfArray(n)&&isNumerable(i,e)){for(s=n.length,r=createTypedArray("float32",s),o=0;o<s;o+=1)r[o]=n[o]*e;return r;}if(isNumerable(t,n)&&$bm_isInstanceOfArray(e)){for(s=e.length,r=createTypedArray("float32",s),o=0;o<s;o+=1)r[o]=n*e[o];return r;}return 0;}function div(n,e){var t=_typeof$1(n),i=_typeof$1(e),r;if(isNumerable(t,n)&&isNumerable(i,e))return n/e;var o,s;if($bm_isInstanceOfArray(n)&&isNumerable(i,e)){for(s=n.length,r=createTypedArray("float32",s),o=0;o<s;o+=1)r[o]=n[o]/e;return r;}if(isNumerable(t,n)&&$bm_isInstanceOfArray(e)){for(s=e.length,r=createTypedArray("float32",s),o=0;o<s;o+=1)r[o]=n/e[o];return r;}return 0;}function mod(n,e){return typeof n=="string"&&(n=parseInt(n,10)),typeof e=="string"&&(e=parseInt(e,10)),n%e;}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(n,e,t){if(e>t){var i=t;t=e,e=i;}return Math.min(Math.max(n,e),t);}function radiansToDegrees(n){return n/degToRads;}var radians_to_degrees=radiansToDegrees;function degreesToRadians(n){return n*degToRads;}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(n,e){if(typeof n=="number"||n instanceof Number)return e=e||0,Math.abs(n-e);e||(e=helperLengthArray);var t,i=Math.min(n.length,e.length),r=0;for(t=0;t<i;t+=1)r+=Math.pow(e[t]-n[t],2);return Math.sqrt(r);}function normalize(n){return div(n,length(n));}function rgbToHsl(n){var e=n[0],t=n[1],i=n[2],r=Math.max(e,t,i),o=Math.min(e,t,i),s,l,c=(r+o)/2;if(r===o)s=0,l=0;else{var d=r-o;switch(l=c>.5?d/(2-r-o):d/(r+o),r){case e:s=(t-i)/d+(t<i?6:0);break;case t:s=(i-e)/d+2;break;case i:s=(e-t)/d+4;break;default:break;}s/=6;}return[s,l,c,n[3]];}function hue2rgb(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n;}function hslToRgb(n){var e=n[0],t=n[1],i=n[2],r,o,s;if(t===0)r=i,s=i,o=i;else{var l=i<.5?i*(1+t):i+t-i*t,c=2*i-l;r=hue2rgb(c,l,e+1/3),o=hue2rgb(c,l,e),s=hue2rgb(c,l,e-1/3);}return[r,o,s,n[3]];}function linear(n,e,t,i,r){if((i===void 0||r===void 0)&&(i=e,r=t,e=0,t=1),t<e){var o=t;t=e,e=o;}if(n<=e)return i;if(n>=t)return r;var s=t===e?0:(n-e)/(t-e);if(!i.length)return i+(r-i)*s;var l,c=i.length,d=createTypedArray("float32",c);for(l=0;l<c;l+=1)d[l]=i[l]+(r[l]-i[l])*s;return d;}function random(n,e){if(e===void 0&&(n===void 0?(n=0,e=1):(e=n,n=void 0)),e.length){var t,i=e.length;n||(n=createTypedArray("float32",i));var r=createTypedArray("float32",i),o=BMMath.random();for(t=0;t<i;t+=1)r[t]=n[t]+o*(e[t]-n[t]);return r;}n===void 0&&(n=0);var s=BMMath.random();return n+s*(e-n);}function createPath(n,e,t,i){var r,o=n.length,s=shapePool.newElement();s.setPathData(!!i,o);var l=[0,0],c,d;for(r=0;r<o;r+=1)c=e&&e[r]?e[r]:l,d=t&&t[r]?t[r]:l,s.setTripleAt(n[r][0],n[r][1],d[0]+n[r][0],d[1]+n[r][1],c[0]+n[r][0],c[1]+n[r][1],r,!0);return s;}function initiateExpression(elem,data,property){function noOp(n){return n;}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty._name=elem.data.nm,thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v;}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=function n(e,t){var i,r,o=this.pv.length?this.pv.length:1,s=createTypedArray("float32",o);e=5;var l=Math.floor(time*e);for(i=0,r=0;i<l;){for(r=0;r<o;r+=1)s[r]+=-t+t*2*BMMath.random();i+=1;}var c=time*e,d=c-Math.floor(c),u=createTypedArray("float32",o);if(o>1){for(r=0;r<o;r+=1)u[r]=this.pv[r]+s[r]+(-t+t*2*BMMath.random())*d;return u;}return this.pv+s[0]+(-t+t*2*BMMath.random())*d;}.bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(n,e){return loopIn(n,e,!0);}function loopOutDuration(n,e){return loopOut(n,e,!0);}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(n,e){var t=[e[0]-n[0],e[1]-n[1],e[2]-n[2]],i=Math.atan2(t[0],Math.sqrt(t[1]*t[1]+t[2]*t[2]))/degToRads,r=-Math.atan2(t[1],t[2])/degToRads;return[r,i,0];}function easeOut(n,e,t,i,r){return applyEase(easeOutBez,n,e,t,i,r);}function easeIn(n,e,t,i,r){return applyEase(easeInBez,n,e,t,i,r);}function ease(n,e,t,i,r){return applyEase(easeInOutBez,n,e,t,i,r);}function applyEase(n,e,t,i,r,o){r===void 0?(r=t,o=i):e=(e-t)/(i-t),e>1?e=1:e<0&&(e=0);var s=n(e);if($bm_isInstanceOfArray(r)){var l,c=r.length,d=createTypedArray("float32",c);for(l=0;l<c;l+=1)d[l]=(o[l]-r[l])*s+r[l];return d;}return(o-r)*s+r;}function nearestKey(n){var e,t=data.k.length,i,r;if(!data.k.length||typeof data.k[0]=="number")i=0,r=0;else if(i=-1,n*=elem.comp.globalData.frameRate,n<data.k[0].t)i=1,r=data.k[0].t;else{for(e=0;e<t-1;e+=1)if(n===data.k[e].t){i=e+1,r=data.k[e].t;break;}else if(n>data.k[e].t&&n<data.k[e+1].t){n-data.k[e].t>data.k[e+1].t-n?(i=e+2,r=data.k[e+1].t):(i=e+1,r=data.k[e].t);break;}i===-1&&(i=e+1,r=data.k[e].t);}var o={};return o.index=i,o.time=r/elem.comp.globalData.frameRate,o;}function key(n){var e,t,i;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+n);n-=1,e={time:data.k[n].t/elem.comp.globalData.frameRate,value:[]};var r=Object.prototype.hasOwnProperty.call(data.k[n],"s")?data.k[n].s:data.k[n-1].e;for(i=r.length,t=0;t<i;t+=1)e[t]=r[t],e.value[t]=r[t];return e;}function framesToTime(n,e){return e||(e=elem.comp.globalData.frameRate),n/e;}function timeToFrames(n,e){return!n&&n!==0&&(n=time),e||(e=elem.comp.globalData.frameRate),n*e;}function seedRandom(n){BMMath.seedrandom(randSeed+n);}function sourceRectAtTime(){return elem.sourceRectAtTime();}function substring(n,e){return typeof value=="string"?e===void 0?value.substring(n):value.substring(n,e):"";}function substr(n,e){return typeof value=="string"?e===void 0?value.substr(n):value.substr(n,e):"";}function posterizeTime(n){time=n===0?0:Math.floor(time*n)/n,value=valueAtTime(time);}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(n){return value=n,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt);}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression;}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob;}(),Expressions=function(){var n={};n.initExpressions=e,n.resetFrame=ExpressionManager.resetFrame;function e(t){var i=0,r=[];function o(){i+=1;}function s(){i-=1,i===0&&c();}function l(d){r.indexOf(d)===-1&&r.push(d);}function c(){var d,u=r.length;for(d=0;d<u;d+=1)r[d].release();r.length=0;}t.renderer.compInterface=CompExpressionInterface(t.renderer),t.renderer.globalData.projectInterface.registerComposition(t.renderer),t.renderer.globalData.pushExpression=o,t.renderer.globalData.popExpression=s,t.renderer.globalData.registerExpressionProperty=l;}return n;}(),MaskManagerInterface=function(){function n(t,i){this._mask=t,this._data=i;}Object.defineProperty(n.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop;}}),Object.defineProperty(n.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100;}});var e=function(i){var r=createSizedArray(i.viewData.length),o,s=i.viewData.length;for(o=0;o<s;o+=1)r[o]=new n(i.viewData[o],i.masksProperties[o]);var l=function(d){for(o=0;o<s;){if(i.masksProperties[o].nm===d)return r[o];o+=1;}return null;};return l;};return e;}(),ExpressionPropertyInterface=function(){var n={pv:0,v:0,mult:1},e={pv:[0,0,0],v:[0,0,0],mult:1};function t(s,l,c){Object.defineProperty(s,"velocity",{get:function(){return l.getVelocityAtTime(l.comp.currentFrame);}}),s.numKeys=l.keyframes?l.keyframes.length:0,s.key=function(d){if(!s.numKeys)return 0;var u="";"s"in l.keyframes[d-1]?u=l.keyframes[d-1].s:"e"in l.keyframes[d-2]?u=l.keyframes[d-2].e:u=l.keyframes[d-2].s;var g=c==="unidimensional"?new Number(u):Object.assign({},u);return g.time=l.keyframes[d-1].t/l.elem.comp.globalData.frameRate,g.value=c==="unidimensional"?u[0]:u,g;},s.valueAtTime=l.getValueAtTime,s.speedAtTime=l.getSpeedAtTime,s.velocityAtTime=l.getVelocityAtTime,s.propertyGroup=l.propertyGroup;}function i(s){(!s||!("pv"in s))&&(s=n);var l=1/s.mult,c=s.pv*l,d=new Number(c);return d.value=c,t(d,s,"unidimensional"),function(){return s.k&&s.getValue(),c=s.v*l,d.value!==c&&(d=new Number(c),d.value=c,d[0]=c,t(d,s,"unidimensional")),d;};}function r(s){(!s||!("pv"in s))&&(s=e);var l=1/s.mult,c=s.data&&s.data.l||s.pv.length,d=createTypedArray("float32",c),u=createTypedArray("float32",c);return d.value=u,t(d,s,"multidimensional"),function(){s.k&&s.getValue();for(var g=0;g<c;g+=1)u[g]=s.v[g]*l,d[g]=u[g];return d;};}function o(){return n;}return function(s){return s?s.propType==="unidimensional"?i(s):r(s):o;};}(),TransformExpressionInterface=function(){return function(n){function e(s){switch(s){case"scale":case"Scale":case"ADBE Scale":case 6:return e.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return e.rotation;case"ADBE Rotate X":return e.xRotation;case"ADBE Rotate Y":return e.yRotation;case"position":case"Position":case"ADBE Position":case 2:return e.position;case"ADBE Position_0":return e.xPosition;case"ADBE Position_1":return e.yPosition;case"ADBE Position_2":return e.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return e.anchorPoint;case"opacity":case"Opacity":case 11:return e.opacity;default:return null;}}Object.defineProperty(e,"rotation",{get:ExpressionPropertyInterface(n.r||n.rz)}),Object.defineProperty(e,"zRotation",{get:ExpressionPropertyInterface(n.rz||n.r)}),Object.defineProperty(e,"xRotation",{get:ExpressionPropertyInterface(n.rx)}),Object.defineProperty(e,"yRotation",{get:ExpressionPropertyInterface(n.ry)}),Object.defineProperty(e,"scale",{get:ExpressionPropertyInterface(n.s)});var t,i,r,o;return n.p?o=ExpressionPropertyInterface(n.p):(t=ExpressionPropertyInterface(n.px),i=ExpressionPropertyInterface(n.py),n.pz&&(r=ExpressionPropertyInterface(n.pz))),Object.defineProperty(e,"position",{get:function(){return n.p?o():[t(),i(),r?r():0];}}),Object.defineProperty(e,"xPosition",{get:ExpressionPropertyInterface(n.px)}),Object.defineProperty(e,"yPosition",{get:ExpressionPropertyInterface(n.py)}),Object.defineProperty(e,"zPosition",{get:ExpressionPropertyInterface(n.pz)}),Object.defineProperty(e,"anchorPoint",{get:ExpressionPropertyInterface(n.a)}),Object.defineProperty(e,"opacity",{get:ExpressionPropertyInterface(n.o)}),Object.defineProperty(e,"skew",{get:ExpressionPropertyInterface(n.sk)}),Object.defineProperty(e,"skewAxis",{get:ExpressionPropertyInterface(n.sa)}),Object.defineProperty(e,"orientation",{get:ExpressionPropertyInterface(n.or)}),e;};}(),LayerExpressionInterface=function(){function n(d){var u=new Matrix();if(d!==void 0){var g=this._elem.finalTransform.mProp.getValueAtTime(d);g.clone(u);}else{var f=this._elem.finalTransform.mProp;f.applyToMatrix(u);}return u;}function e(d,u){var g=this.getMatrix(u);return g.props[12]=0,g.props[13]=0,g.props[14]=0,this.applyPoint(g,d);}function t(d,u){var g=this.getMatrix(u);return this.applyPoint(g,d);}function i(d,u){var g=this.getMatrix(u);return g.props[12]=0,g.props[13]=0,g.props[14]=0,this.invertPoint(g,d);}function r(d,u){var g=this.getMatrix(u);return this.invertPoint(g,d);}function o(d,u){if(this._elem.hierarchy&&this._elem.hierarchy.length){var g,f=this._elem.hierarchy.length;for(g=0;g<f;g+=1)this._elem.hierarchy[g].finalTransform.mProp.applyToMatrix(d);}return d.applyToPointArray(u[0],u[1],u[2]||0);}function s(d,u){if(this._elem.hierarchy&&this._elem.hierarchy.length){var g,f=this._elem.hierarchy.length;for(g=0;g<f;g+=1)this._elem.hierarchy[g].finalTransform.mProp.applyToMatrix(d);}return d.inversePoint(u);}function l(d){var u=new Matrix();if(u.reset(),this._elem.finalTransform.mProp.applyToMatrix(u),this._elem.hierarchy&&this._elem.hierarchy.length){var g,f=this._elem.hierarchy.length;for(g=0;g<f;g+=1)this._elem.hierarchy[g].finalTransform.mProp.applyToMatrix(u);return u.inversePoint(d);}return u.inversePoint(d);}function c(){return[1,1,1,1];}return function(d){var u;function g(y){m.mask=new MaskManagerInterface(y,d);}function f(y){m.effect=y;}function m(y){switch(y){case"ADBE Root Vectors Group":case"Contents":case 2:return m.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return u;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return m.effect;case"ADBE Text Properties":return m.textInterface;default:return null;}}m.getMatrix=n,m.invertPoint=s,m.applyPoint=o,m.toWorld=t,m.toWorldVec=e,m.fromWorld=r,m.fromWorldVec=i,m.toComp=t,m.fromComp=l,m.sampleImage=c,m.sourceRectAtTime=d.sourceRectAtTime.bind(d),m._elem=d,u=TransformExpressionInterface(d.finalTransform.mProp);var _=getDescriptor(u,"anchorPoint");return Object.defineProperties(m,{hasParent:{get:function(){return d.hierarchy.length;}},parent:{get:function(){return d.hierarchy[0].layerInterface;}},rotation:getDescriptor(u,"rotation"),scale:getDescriptor(u,"scale"),position:getDescriptor(u,"position"),opacity:getDescriptor(u,"opacity"),anchorPoint:_,anchor_point:_,transform:{get:function(){return u;}},active:{get:function(){return d.isInRange;}}}),m.startTime=d.data.st,m.index=d.data.ind,m.source=d.data.refId,m.height=d.data.ty===0?d.data.h:100,m.width=d.data.ty===0?d.data.w:100,m.inPoint=d.data.ip/d.comp.globalData.frameRate,m.outPoint=d.data.op/d.comp.globalData.frameRate,m._name=d.data.nm,m.registerMaskInterface=g,m.registerEffectsInterface=f,m;};}(),propertyGroupFactory=function(){return function(n,e){return function(t){return t=t===void 0?1:t,t<=0?n:e(t-1);};};}(),PropertyInterface=function(){return function(n,e){var t={_name:n};function i(r){return r=r===void 0?1:r,r<=0?t:e(r-1);}return i;};}(),EffectsExpressionInterface=function(){var n={createEffectsInterface:e};function e(r,o){if(r.effectsManager){var s=[],l=r.data.ef,c,d=r.effectsManager.effectElements.length;for(c=0;c<d;c+=1)s.push(t(l[c],r.effectsManager.effectElements[c],o,r));var u=r.data.ef||[],g=function(m){for(c=0,d=u.length;c<d;){if(m===u[c].nm||m===u[c].mn||m===u[c].ix)return s[c];c+=1;}return null;};return Object.defineProperty(g,"numProperties",{get:function(){return u.length;}}),g;}return null;}function t(r,o,s,l){function c(m){for(var _=r.ef,y=0,E=_.length;y<E;){if(m===_[y].nm||m===_[y].mn||m===_[y].ix)return _[y].ty===5?u[y]:u[y]();y+=1;}throw new Error();}var d=propertyGroupFactory(c,s),u=[],g,f=r.ef.length;for(g=0;g<f;g+=1)r.ef[g].ty===5?u.push(t(r.ef[g],o.effectElements[g],o.effectElements[g].propertyGroup,l)):u.push(i(o.effectElements[g],r.ef[g].ty,l,d));return r.mn==="ADBE Color Control"&&Object.defineProperty(c,"color",{get:function(){return u[0]();}}),Object.defineProperties(c,{numProperties:{get:function(){return r.np;}},_name:{value:r.nm},propertyGroup:{value:d}}),c.enabled=r.en!==0,c.active=c.enabled,c;}function i(r,o,s,l){var c=ExpressionPropertyInterface(r.p);function d(){return o===10?s.comp.compInterface(r.p.v):c();}return r.p.setGroupProperty&&r.p.setGroupProperty(PropertyInterface("",l)),d;}return n;}(),ShapePathInterface=function(){return function(e,t,i){var r=t.sh;function o(l){return l==="Shape"||l==="shape"||l==="Path"||l==="path"||l==="ADBE Vector Shape"||l===2?o.path:null;}var s=propertyGroupFactory(o,i);return r.setGroupProperty(PropertyInterface("Path",s)),Object.defineProperties(o,{path:{get:function(){return r.k&&r.getValue(),r;}},shape:{get:function(){return r.k&&r.getValue(),r;}},_name:{value:e.nm},ix:{value:e.ix},propertyIndex:{value:e.ix},mn:{value:e.mn},propertyGroup:{value:i}}),o;};}(),ShapeExpressionInterface=function(){function n(_,y,E){var C=[],b,x=_?_.length:0;for(b=0;b<x;b+=1)_[b].ty==="gr"?C.push(t(_[b],y[b],E)):_[b].ty==="fl"?C.push(i(_[b],y[b],E)):_[b].ty==="st"?C.push(s(_[b],y[b],E)):_[b].ty==="tm"?C.push(l(_[b],y[b],E)):_[b].ty==="tr"||(_[b].ty==="el"?C.push(d(_[b],y[b],E)):_[b].ty==="sr"?C.push(u(_[b],y[b],E)):_[b].ty==="sh"?C.push(ShapePathInterface(_[b],y[b],E)):_[b].ty==="rc"?C.push(g(_[b],y[b],E)):_[b].ty==="rd"?C.push(f(_[b],y[b],E)):_[b].ty==="rp"?C.push(m(_[b],y[b],E)):_[b].ty==="gf"?C.push(r(_[b],y[b],E)):C.push(o(_[b],y[b],E)));return C;}function e(_,y,E){var C,b=function(T){for(var R=0,V=C.length;R<V;){if(C[R]._name===T||C[R].mn===T||C[R].propertyIndex===T||C[R].ix===T||C[R].ind===T)return C[R];R+=1;}return typeof T=="number"?C[T-1]:null;};b.propertyGroup=propertyGroupFactory(b,E),C=n(_.it,y.it,b.propertyGroup),b.numProperties=C.length;var x=c(_.it[_.it.length-1],y.it[y.it.length-1],b.propertyGroup);return b.transform=x,b.propertyIndex=_.cix,b._name=_.nm,b;}function t(_,y,E){var C=function(T){switch(T){case"ADBE Vectors Group":case"Contents":case 2:return C.content;default:return C.transform;}};C.propertyGroup=propertyGroupFactory(C,E);var b=e(_,y,C.propertyGroup),x=c(_.it[_.it.length-1],y.it[y.it.length-1],C.propertyGroup);return C.content=b,C.transform=x,Object.defineProperty(C,"_name",{get:function(){return _.nm;}}),C.numProperties=_.np,C.propertyIndex=_.ix,C.nm=_.nm,C.mn=_.mn,C;}function i(_,y,E){function C(b){return b==="Color"||b==="color"?C.color:b==="Opacity"||b==="opacity"?C.opacity:null;}return Object.defineProperties(C,{color:{get:ExpressionPropertyInterface(y.c)},opacity:{get:ExpressionPropertyInterface(y.o)},_name:{value:_.nm},mn:{value:_.mn}}),y.c.setGroupProperty(PropertyInterface("Color",E)),y.o.setGroupProperty(PropertyInterface("Opacity",E)),C;}function r(_,y,E){function C(b){return b==="Start Point"||b==="start point"?C.startPoint:b==="End Point"||b==="end point"?C.endPoint:b==="Opacity"||b==="opacity"?C.opacity:null;}return Object.defineProperties(C,{startPoint:{get:ExpressionPropertyInterface(y.s)},endPoint:{get:ExpressionPropertyInterface(y.e)},opacity:{get:ExpressionPropertyInterface(y.o)},type:{get:function(){return"a";}},_name:{value:_.nm},mn:{value:_.mn}}),y.s.setGroupProperty(PropertyInterface("Start Point",E)),y.e.setGroupProperty(PropertyInterface("End Point",E)),y.o.setGroupProperty(PropertyInterface("Opacity",E)),C;}function o(){function _(){return null;}return _;}function s(_,y,E){var C=propertyGroupFactory(V,E),b=propertyGroupFactory(R,C);function x(B){Object.defineProperty(R,_.d[B].nm,{get:ExpressionPropertyInterface(y.d.dataProps[B].p)});}var w,T=_.d?_.d.length:0,R={};for(w=0;w<T;w+=1)x(w),y.d.dataProps[w].p.setGroupProperty(b);function V(B){return B==="Color"||B==="color"?V.color:B==="Opacity"||B==="opacity"?V.opacity:B==="Stroke Width"||B==="stroke width"?V.strokeWidth:null;}return Object.defineProperties(V,{color:{get:ExpressionPropertyInterface(y.c)},opacity:{get:ExpressionPropertyInterface(y.o)},strokeWidth:{get:ExpressionPropertyInterface(y.w)},dash:{get:function(){return R;}},_name:{value:_.nm},mn:{value:_.mn}}),y.c.setGroupProperty(PropertyInterface("Color",C)),y.o.setGroupProperty(PropertyInterface("Opacity",C)),y.w.setGroupProperty(PropertyInterface("Stroke Width",C)),V;}function l(_,y,E){function C(x){return x===_.e.ix||x==="End"||x==="end"?C.end:x===_.s.ix?C.start:x===_.o.ix?C.offset:null;}var b=propertyGroupFactory(C,E);return C.propertyIndex=_.ix,y.s.setGroupProperty(PropertyInterface("Start",b)),y.e.setGroupProperty(PropertyInterface("End",b)),y.o.setGroupProperty(PropertyInterface("Offset",b)),C.propertyIndex=_.ix,C.propertyGroup=E,Object.defineProperties(C,{start:{get:ExpressionPropertyInterface(y.s)},end:{get:ExpressionPropertyInterface(y.e)},offset:{get:ExpressionPropertyInterface(y.o)},_name:{value:_.nm}}),C.mn=_.mn,C;}function c(_,y,E){function C(x){return _.a.ix===x||x==="Anchor Point"?C.anchorPoint:_.o.ix===x||x==="Opacity"?C.opacity:_.p.ix===x||x==="Position"?C.position:_.r.ix===x||x==="Rotation"||x==="ADBE Vector Rotation"?C.rotation:_.s.ix===x||x==="Scale"?C.scale:_.sk&&_.sk.ix===x||x==="Skew"?C.skew:_.sa&&_.sa.ix===x||x==="Skew Axis"?C.skewAxis:null;}var b=propertyGroupFactory(C,E);return y.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",b)),y.transform.mProps.p.setGroupProperty(PropertyInterface("Position",b)),y.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",b)),y.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",b)),y.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",b)),y.transform.mProps.sk&&(y.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",b)),y.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",b))),y.transform.op.setGroupProperty(PropertyInterface("Opacity",b)),Object.defineProperties(C,{opacity:{get:ExpressionPropertyInterface(y.transform.mProps.o)},position:{get:ExpressionPropertyInterface(y.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(y.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(y.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(y.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(y.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(y.transform.mProps.sa)},_name:{value:_.nm}}),C.ty="tr",C.mn=_.mn,C.propertyGroup=E,C;}function d(_,y,E){function C(w){return _.p.ix===w?C.position:_.s.ix===w?C.size:null;}var b=propertyGroupFactory(C,E);C.propertyIndex=_.ix;var x=y.sh.ty==="tm"?y.sh.prop:y.sh;return x.s.setGroupProperty(PropertyInterface("Size",b)),x.p.setGroupProperty(PropertyInterface("Position",b)),Object.defineProperties(C,{size:{get:ExpressionPropertyInterface(x.s)},position:{get:ExpressionPropertyInterface(x.p)},_name:{value:_.nm}}),C.mn=_.mn,C;}function u(_,y,E){function C(w){return _.p.ix===w?C.position:_.r.ix===w?C.rotation:_.pt.ix===w?C.points:_.or.ix===w||w==="ADBE Vector Star Outer Radius"?C.outerRadius:_.os.ix===w?C.outerRoundness:_.ir&&(_.ir.ix===w||w==="ADBE Vector Star Inner Radius")?C.innerRadius:_.is&&_.is.ix===w?C.innerRoundness:null;}var b=propertyGroupFactory(C,E),x=y.sh.ty==="tm"?y.sh.prop:y.sh;return C.propertyIndex=_.ix,x.or.setGroupProperty(PropertyInterface("Outer Radius",b)),x.os.setGroupProperty(PropertyInterface("Outer Roundness",b)),x.pt.setGroupProperty(PropertyInterface("Points",b)),x.p.setGroupProperty(PropertyInterface("Position",b)),x.r.setGroupProperty(PropertyInterface("Rotation",b)),_.ir&&(x.ir.setGroupProperty(PropertyInterface("Inner Radius",b)),x.is.setGroupProperty(PropertyInterface("Inner Roundness",b))),Object.defineProperties(C,{position:{get:ExpressionPropertyInterface(x.p)},rotation:{get:ExpressionPropertyInterface(x.r)},points:{get:ExpressionPropertyInterface(x.pt)},outerRadius:{get:ExpressionPropertyInterface(x.or)},outerRoundness:{get:ExpressionPropertyInterface(x.os)},innerRadius:{get:ExpressionPropertyInterface(x.ir)},innerRoundness:{get:ExpressionPropertyInterface(x.is)},_name:{value:_.nm}}),C.mn=_.mn,C;}function g(_,y,E){function C(w){return _.p.ix===w?C.position:_.r.ix===w?C.roundness:_.s.ix===w||w==="Size"||w==="ADBE Vector Rect Size"?C.size:null;}var b=propertyGroupFactory(C,E),x=y.sh.ty==="tm"?y.sh.prop:y.sh;return C.propertyIndex=_.ix,x.p.setGroupProperty(PropertyInterface("Position",b)),x.s.setGroupProperty(PropertyInterface("Size",b)),x.r.setGroupProperty(PropertyInterface("Rotation",b)),Object.defineProperties(C,{position:{get:ExpressionPropertyInterface(x.p)},roundness:{get:ExpressionPropertyInterface(x.r)},size:{get:ExpressionPropertyInterface(x.s)},_name:{value:_.nm}}),C.mn=_.mn,C;}function f(_,y,E){function C(w){return _.r.ix===w||w==="Round Corners 1"?C.radius:null;}var b=propertyGroupFactory(C,E),x=y;return C.propertyIndex=_.ix,x.rd.setGroupProperty(PropertyInterface("Radius",b)),Object.defineProperties(C,{radius:{get:ExpressionPropertyInterface(x.rd)},_name:{value:_.nm}}),C.mn=_.mn,C;}function m(_,y,E){function C(w){return _.c.ix===w||w==="Copies"?C.copies:_.o.ix===w||w==="Offset"?C.offset:null;}var b=propertyGroupFactory(C,E),x=y;return C.propertyIndex=_.ix,x.c.setGroupProperty(PropertyInterface("Copies",b)),x.o.setGroupProperty(PropertyInterface("Offset",b)),Object.defineProperties(C,{copies:{get:ExpressionPropertyInterface(x.c)},offset:{get:ExpressionPropertyInterface(x.o)},_name:{value:_.nm}}),C.mn=_.mn,C;}return function(_,y,E){var C;function b(w){if(typeof w=="number")return w=w===void 0?1:w,w===0?E:C[w-1];for(var T=0,R=C.length;T<R;){if(C[T]._name===w)return C[T];T+=1;}return null;}function x(){return E;}return b.propertyGroup=propertyGroupFactory(b,x),C=n(_,y,b.propertyGroup),b.numProperties=C.length,b._name="Contents",b;};}(),TextExpressionInterface=function(){return function(n){var e;function t(i){switch(i){case"ADBE Text Document":return t.sourceText;default:return null;}}return Object.defineProperty(t,"sourceText",{get:function(){n.textProperty.getValue();var r=n.textProperty.currentData.t;return(!e||r!==e.value)&&(e=new String(r),e.value=r||new String(r),Object.defineProperty(e,"style",{get:function(){return{fillColor:n.textProperty.currentData.fc};}})),e;}}),t;};}();function _typeof(n){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e;}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;},_typeof(n);}var FootageInterface=function(){var n=function(i){var r="",o=i.getFootageData();function s(){return r="",o=i.getFootageData(),l;}function l(c){if(o[c])return r=c,o=o[c],_typeof(o)==="object"?l:o;var d=c.indexOf(r);if(d!==-1){var u=parseInt(c.substr(d+r.length),10);return o=o[u],_typeof(o)==="object"?l:o;}return"";}return s;},e=function(i){function r(o){return o==="Outline"?r.outlineInterface():null;}return r._name="Outline",r.outlineInterface=n(i),r;};return function(t){function i(r){return r==="Data"?i.dataInterface:null;}return i._name="Data",i.dataInterface=e(t),i;};}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(n){return interfaces[n]||null;}var expressionHelpers=function(){function n(s,l,c){l.x&&(c.k=!0,c.x=!0,c.initiateExpression=ExpressionManager.initiateExpression,c.effectsSequence.push(c.initiateExpression(s,l,c).bind(c)));}function e(s){return s*=this.elem.globalData.frameRate,s-=this.offsetTime,s!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<s?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(s,this._cachingAtTime),this._cachingAtTime.lastFrame=s),this._cachingAtTime.value;}function t(s){var l=-.01,c=this.getValueAtTime(s),d=this.getValueAtTime(s+l),u=0;if(c.length){var g;for(g=0;g<c.length;g+=1)u+=Math.pow(d[g]-c[g],2);u=Math.sqrt(u)*100;}else u=0;return u;}function i(s){if(this.vel!==void 0)return this.vel;var l=-.001,c=this.getValueAtTime(s),d=this.getValueAtTime(s+l),u;if(c.length){u=createTypedArray("float32",c.length);var g;for(g=0;g<c.length;g+=1)u[g]=(d[g]-c[g])/l;}else u=(d-c)/l;return u;}function r(){return this.pv;}function o(s){this.propertyGroup=s;}return{searchExpressions:n,getSpeedAtTime:t,getVelocityAtTime:i,getValueAtTime:e,getStaticValueAtTime:r,setGroupProperty:o};}();function addPropertyDecorator(){function n(f,m,_){if(!this.k||!this.keyframes)return this.pv;f=f?f.toLowerCase():"";var y=this.comp.renderedFrame,E=this.keyframes,C=E[E.length-1].t;if(y<=C)return this.pv;var b,x;_?(m?b=Math.abs(C-this.elem.comp.globalData.frameRate*m):b=Math.max(0,C-this.elem.data.ip),x=C-b):((!m||m>E.length-1)&&(m=E.length-1),x=E[E.length-1-m].t,b=C-x);var w,T,R;if(f==="pingpong"){var V=Math.floor((y-x)/b);if(V%2!==0)return this.getValueAtTime((b-(y-x)%b+x)/this.comp.globalData.frameRate,0);}else if(f==="offset"){var B=this.getValueAtTime(x/this.comp.globalData.frameRate,0),Y=this.getValueAtTime(C/this.comp.globalData.frameRate,0),le=this.getValueAtTime(((y-x)%b+x)/this.comp.globalData.frameRate,0),ae=Math.floor((y-x)/b);if(this.pv.length){for(R=new Array(B.length),T=R.length,w=0;w<T;w+=1)R[w]=(Y[w]-B[w])*ae+le[w];return R;}return(Y-B)*ae+le;}else if(f==="continue"){var ee=this.getValueAtTime(C/this.comp.globalData.frameRate,0),ce=this.getValueAtTime((C-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(R=new Array(ee.length),T=R.length,w=0;w<T;w+=1)R[w]=ee[w]+(ee[w]-ce[w])*((y-C)/this.comp.globalData.frameRate)/5e-4;return R;}return ee+(ee-ce)*((y-C)/.001);}return this.getValueAtTime(((y-x)%b+x)/this.comp.globalData.frameRate,0);}function e(f,m,_){if(!this.k)return this.pv;f=f?f.toLowerCase():"";var y=this.comp.renderedFrame,E=this.keyframes,C=E[0].t;if(y>=C)return this.pv;var b,x;_?(m?b=Math.abs(this.elem.comp.globalData.frameRate*m):b=Math.max(0,this.elem.data.op-C),x=C+b):((!m||m>E.length-1)&&(m=E.length-1),x=E[m].t,b=x-C);var w,T,R;if(f==="pingpong"){var V=Math.floor((C-y)/b);if(V%2===0)return this.getValueAtTime(((C-y)%b+C)/this.comp.globalData.frameRate,0);}else if(f==="offset"){var B=this.getValueAtTime(C/this.comp.globalData.frameRate,0),Y=this.getValueAtTime(x/this.comp.globalData.frameRate,0),le=this.getValueAtTime((b-(C-y)%b+C)/this.comp.globalData.frameRate,0),ae=Math.floor((C-y)/b)+1;if(this.pv.length){for(R=new Array(B.length),T=R.length,w=0;w<T;w+=1)R[w]=le[w]-(Y[w]-B[w])*ae;return R;}return le-(Y-B)*ae;}else if(f==="continue"){var ee=this.getValueAtTime(C/this.comp.globalData.frameRate,0),ce=this.getValueAtTime((C+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(R=new Array(ee.length),T=R.length,w=0;w<T;w+=1)R[w]=ee[w]+(ee[w]-ce[w])*(C-y)/.001;return R;}return ee+(ee-ce)*(C-y)/.001;}return this.getValueAtTime((b-((C-y)%b+C))/this.comp.globalData.frameRate,0);}function t(f,m){if(!this.k)return this.pv;if(f=(f||.4)*.5,m=Math.floor(m||5),m<=1)return this.pv;var _=this.comp.renderedFrame/this.comp.globalData.frameRate,y=_-f,E=_+f,C=m>1?(E-y)/(m-1):1,b=0,x=0,w;this.pv.length?w=createTypedArray("float32",this.pv.length):w=0;for(var T;b<m;){if(T=this.getValueAtTime(y+b*C),this.pv.length)for(x=0;x<this.pv.length;x+=1)w[x]+=T[x];else w+=T;b+=1;}if(this.pv.length)for(x=0;x<this.pv.length;x+=1)w[x]/=m;else w/=m;return w;}function i(f){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix()});var m=this._transformCachingAtTime.v;if(m.cloneFromProps(this.pre.props),this.appliedTransformations<1){var _=this.a.getValueAtTime(f);m.translate(-_[0]*this.a.mult,-_[1]*this.a.mult,_[2]*this.a.mult);}if(this.appliedTransformations<2){var y=this.s.getValueAtTime(f);m.scale(y[0]*this.s.mult,y[1]*this.s.mult,y[2]*this.s.mult);}if(this.sk&&this.appliedTransformations<3){var E=this.sk.getValueAtTime(f),C=this.sa.getValueAtTime(f);m.skewFromAxis(-E*this.sk.mult,C*this.sa.mult);}if(this.r&&this.appliedTransformations<4){var b=this.r.getValueAtTime(f);m.rotate(-b*this.r.mult);}else if(!this.r&&this.appliedTransformations<4){var x=this.rz.getValueAtTime(f),w=this.ry.getValueAtTime(f),T=this.rx.getValueAtTime(f),R=this.or.getValueAtTime(f);m.rotateZ(-x*this.rz.mult).rotateY(w*this.ry.mult).rotateX(T*this.rx.mult).rotateZ(-R[2]*this.or.mult).rotateY(R[1]*this.or.mult).rotateX(R[0]*this.or.mult);}if(this.data.p&&this.data.p.s){var V=this.px.getValueAtTime(f),B=this.py.getValueAtTime(f);if(this.data.p.z){var Y=this.pz.getValueAtTime(f);m.translate(V*this.px.mult,B*this.py.mult,-Y*this.pz.mult);}else m.translate(V*this.px.mult,B*this.py.mult,0);}else{var le=this.p.getValueAtTime(f);m.translate(le[0]*this.p.mult,le[1]*this.p.mult,-le[2]*this.p.mult);}return m;}function r(){return this.v.clone(new Matrix());}var o=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(f,m,_){var y=o(f,m,_);return y.dynamicProperties.length?y.getValueAtTime=i.bind(y):y.getValueAtTime=r.bind(y),y.setGroupProperty=expressionHelpers.setGroupProperty,y;};var s=PropertyFactory.getProp;PropertyFactory.getProp=function(f,m,_,y,E){var C=s(f,m,_,y,E);C.kf?C.getValueAtTime=expressionHelpers.getValueAtTime.bind(C):C.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(C),C.setGroupProperty=expressionHelpers.setGroupProperty,C.loopOut=n,C.loopIn=e,C.smooth=t,C.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(C),C.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(C),C.numKeys=m.a===1?m.k.length:0,C.propertyIndex=m.ix;var b=0;return _!==0&&(b=createTypedArray("float32",m.a===1?m.k[0].s.length:m.k.length)),C._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:b},expressionHelpers.searchExpressions(f,m,C),C.k&&E.addDynamicProperty(C),C;};function l(f){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),f*=this.elem.globalData.frameRate,f-=this.offsetTime,f!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<f?this._caching.lastIndex:0,this._cachingAtTime.lastTime=f,this.interpolateShape(f,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue;}var c=ShapePropertyFactory.getConstructorFunction(),d=ShapePropertyFactory.getKeyframedConstructorFunction();function u(){}u.prototype={vertices:function(m,_){this.k&&this.getValue();var y=this.v;_!==void 0&&(y=this.getValueAtTime(_,0));var E,C=y._length,b=y[m],x=y.v,w=createSizedArray(C);for(E=0;E<C;E+=1)m==="i"||m==="o"?w[E]=[b[E][0]-x[E][0],b[E][1]-x[E][1]]:w[E]=[b[E][0],b[E][1]];return w;},points:function(m){return this.vertices("v",m);},inTangents:function(m){return this.vertices("i",m);},outTangents:function(m){return this.vertices("o",m);},isClosed:function(){return this.v.c;},pointOnPath:function(m,_){var y=this.v;_!==void 0&&(y=this.getValueAtTime(_,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(y));for(var E=this._segmentsLength,C=E.lengths,b=E.totalLength*m,x=0,w=C.length,T=0,R;x<w;){if(T+C[x].addedLength>b){var V=x,B=y.c&&x===w-1?0:x+1,Y=(b-T)/C[x].addedLength;R=bez.getPointInSegment(y.v[V],y.v[B],y.o[V],y.i[B],Y,C[x]);break;}else T+=C[x].addedLength;x+=1;}return R||(R=y.c?[y.v[0][0],y.v[0][1]]:[y.v[y._length-1][0],y.v[y._length-1][1]]),R;},vectorOnPath:function(m,_,y){m==1?m=this.v.c:m==0&&(m=.999);var E=this.pointOnPath(m,_),C=this.pointOnPath(m+.001,_),b=C[0]-E[0],x=C[1]-E[1],w=Math.sqrt(Math.pow(b,2)+Math.pow(x,2));if(w===0)return[0,0];var T=y==="tangent"?[b/w,x/w]:[-x/w,b/w];return T;},tangentOnPath:function(m,_){return this.vectorOnPath(m,_,"tangent");},normalOnPath:function(m,_){return this.vectorOnPath(m,_,"normal");},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([u],c),extendPrototype([u],d),d.prototype.getValueAtTime=l,d.prototype.initiateExpression=ExpressionManager.initiateExpression;var g=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(f,m,_,y,E){var C=g(f,m,_,y,E);return C.propertyIndex=m.ix,C.lock=!1,_===3?expressionHelpers.searchExpressions(f,m.pt,C):_===4&&expressionHelpers.searchExpressions(f,m.ks,C),C.k&&f.addDynamicProperty(C),C;};}function initialize$1(){addPropertyDecorator();}function addDecorator(){function n(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null;}TextProperty.prototype.getExpressionValue=function(e,t){var i=this.calculateExpression(t);if(e.t!==i){var r={};return this.copyData(r,e),r.t=i.toString(),r.__complete=!1,r;}return e;},TextProperty.prototype.searchProperty=function(){var e=this.searchKeyframes(),t=this.searchExpressions();return this.kf=e||t,this.kf;},TextProperty.prototype.searchExpressions=n;}function initialize(){addDecorator();}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function n(e,t){var i=createNS("feMerge");i.setAttribute("result",e);var r,o;for(o=0;o<t.length;o+=1)r=createNS("feMergeNode"),r.setAttribute("in",t[o]),i.appendChild(r),i.appendChild(r);return i;}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(n,e,t,i,r){this.filterManager=e;var o=createNS("feColorMatrix");o.setAttribute("type","matrix"),o.setAttribute("color-interpolation-filters","linearRGB"),o.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=o,o.setAttribute("result",i+"_tint_1"),n.appendChild(o),o=createNS("feColorMatrix"),o.setAttribute("type","matrix"),o.setAttribute("color-interpolation-filters","sRGB"),o.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),o.setAttribute("result",i+"_tint_2"),n.appendChild(o),this.matrixFilter=o;var s=this.createMergeNode(i,[r,i+"_tint_1",i+"_tint_2"]);n.appendChild(s);}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(n){if(n||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,t=this.filterManager.effectElements[1].p.v,i=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+i+" 0"),this.matrixFilter.setAttribute("values",t[0]-e[0]+" 0 0 0 "+e[0]+" "+(t[1]-e[1])+" 0 0 0 "+e[1]+" "+(t[2]-e[2])+" 0 0 0 "+e[2]+" 0 0 0 1 0");}};function SVGFillFilter(n,e,t,i){this.filterManager=e;var r=createNS("feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),r.setAttribute("result",i),n.appendChild(r),this.matrixFilter=r;}SVGFillFilter.prototype.renderFrame=function(n){if(n||this.filterManager._mdf){var e=this.filterManager.effectElements[2].p.v,t=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+e[0]+" 0 0 0 0 "+e[1]+" 0 0 0 0 "+e[2]+" 0 0 0 "+t+" 0");}};function SVGStrokeEffect(n,e,t){this.initialized=!1,this.filterManager=e,this.elem=t,this.paths=[];}SVGStrokeEffect.prototype.initialize=function(){var n=this.elem.layerElement.children||this.elem.layerElement.childNodes,e,t,i,r;for(this.filterManager.effectElements[1].p.v===1?(r=this.elem.maskManager.masksProperties.length,i=0):(i=this.filterManager.effectElements[0].p.v-1,r=i+1),t=createNS("g"),t.setAttribute("fill","none"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-dashoffset",1),i;i<r;i+=1)e=createNS("path"),t.appendChild(e),this.paths.push({p:e,m:i});if(this.filterManager.effectElements[10].p.v===3){var o=createNS("mask"),s=createElementID();o.setAttribute("id",s),o.setAttribute("mask-type","alpha"),o.appendChild(t),this.elem.globalData.defs.appendChild(o);var l=createNS("g");for(l.setAttribute("mask","url("+getLocationHref()+"#"+s+")");n[0];)l.appendChild(n[0]);this.elem.layerElement.appendChild(l),this.masker=o,t.setAttribute("stroke","#fff");}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(n=this.elem.layerElement.children||this.elem.layerElement.childNodes;n.length;)this.elem.layerElement.removeChild(n[0]);this.elem.layerElement.appendChild(t),this.elem.layerElement.removeAttribute("mask"),t.setAttribute("stroke","#fff");}this.initialized=!0,this.pathMasker=t;},SVGStrokeEffect.prototype.renderFrame=function(n){this.initialized||this.initialize();var e,t=this.paths.length,i,r;for(e=0;e<t;e+=1)if(this.paths[e].m!==-1&&(i=this.elem.maskManager.viewData[this.paths[e].m],r=this.paths[e].p,(n||this.filterManager._mdf||i.prop._mdf)&&r.setAttribute("d",i.lastPath),n||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||i.prop._mdf)){var o;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var s=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,l=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,c=r.getTotalLength();o="0 0 0 "+c*s+" ";var d=c*(l-s),u=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,g=Math.floor(d/u),f;for(f=0;f<g;f+=1)o+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";o+="0 "+c*10+" 0 0";}else o="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;r.setAttribute("stroke-dasharray",o);}if((n||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(n||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(n||this.filterManager.effectElements[3].p._mdf)){var m=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(m[0]*255)+","+bmFloor(m[1]*255)+","+bmFloor(m[2]*255)+")");}};function SVGTritoneFilter(n,e,t,i){this.filterManager=e;var r=createNS("feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","linearRGB"),r.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),n.appendChild(r);var o=createNS("feComponentTransfer");o.setAttribute("color-interpolation-filters","sRGB"),o.setAttribute("result",i),this.matrixFilter=o;var s=createNS("feFuncR");s.setAttribute("type","table"),o.appendChild(s),this.feFuncR=s;var l=createNS("feFuncG");l.setAttribute("type","table"),o.appendChild(l),this.feFuncG=l;var c=createNS("feFuncB");c.setAttribute("type","table"),o.appendChild(c),this.feFuncB=c,n.appendChild(o);}SVGTritoneFilter.prototype.renderFrame=function(n){if(n||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,t=this.filterManager.effectElements[1].p.v,i=this.filterManager.effectElements[2].p.v,r=i[0]+" "+t[0]+" "+e[0],o=i[1]+" "+t[1]+" "+e[1],s=i[2]+" "+t[2]+" "+e[2];this.feFuncR.setAttribute("tableValues",r),this.feFuncG.setAttribute("tableValues",o),this.feFuncB.setAttribute("tableValues",s);}};function SVGProLevelsFilter(n,e,t,i){this.filterManager=e;var r=this.filterManager.effectElements,o=createNS("feComponentTransfer");(r[10].p.k||r[10].p.v!==0||r[11].p.k||r[11].p.v!==1||r[12].p.k||r[12].p.v!==1||r[13].p.k||r[13].p.v!==0||r[14].p.k||r[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",o)),(r[17].p.k||r[17].p.v!==0||r[18].p.k||r[18].p.v!==1||r[19].p.k||r[19].p.v!==1||r[20].p.k||r[20].p.v!==0||r[21].p.k||r[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",o)),(r[24].p.k||r[24].p.v!==0||r[25].p.k||r[25].p.v!==1||r[26].p.k||r[26].p.v!==1||r[27].p.k||r[27].p.v!==0||r[28].p.k||r[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",o)),(r[31].p.k||r[31].p.v!==0||r[32].p.k||r[32].p.v!==1||r[33].p.k||r[33].p.v!==1||r[34].p.k||r[34].p.v!==0||r[35].p.k||r[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",o)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(o.setAttribute("color-interpolation-filters","sRGB"),n.appendChild(o)),(r[3].p.k||r[3].p.v!==0||r[4].p.k||r[4].p.v!==1||r[5].p.k||r[5].p.v!==1||r[6].p.k||r[6].p.v!==0||r[7].p.k||r[7].p.v!==1)&&(o=createNS("feComponentTransfer"),o.setAttribute("color-interpolation-filters","sRGB"),o.setAttribute("result",i),n.appendChild(o),this.feFuncRComposed=this.createFeFunc("feFuncR",o),this.feFuncGComposed=this.createFeFunc("feFuncG",o),this.feFuncBComposed=this.createFeFunc("feFuncB",o));}SVGProLevelsFilter.prototype.createFeFunc=function(n,e){var t=createNS(n);return t.setAttribute("type","table"),e.appendChild(t),t;},SVGProLevelsFilter.prototype.getTableValue=function(n,e,t,i,r){for(var o=0,s=256,l,c=Math.min(n,e),d=Math.max(n,e),u=Array.call(null,{length:s}),g,f=0,m=r-i,_=e-n;o<=256;)l=o/256,l<=c?g=_<0?r:i:l>=d?g=_<0?i:r:g=i+m*Math.pow((l-n)/_,1/t),u[f]=g,f+=1,o+=256/(s-1);return u.join(" ");},SVGProLevelsFilter.prototype.renderFrame=function(n){if(n||this.filterManager._mdf){var e,t=this.filterManager.effectElements;this.feFuncRComposed&&(n||t[3].p._mdf||t[4].p._mdf||t[5].p._mdf||t[6].p._mdf||t[7].p._mdf)&&(e=this.getTableValue(t[3].p.v,t[4].p.v,t[5].p.v,t[6].p.v,t[7].p.v),this.feFuncRComposed.setAttribute("tableValues",e),this.feFuncGComposed.setAttribute("tableValues",e),this.feFuncBComposed.setAttribute("tableValues",e)),this.feFuncR&&(n||t[10].p._mdf||t[11].p._mdf||t[12].p._mdf||t[13].p._mdf||t[14].p._mdf)&&(e=this.getTableValue(t[10].p.v,t[11].p.v,t[12].p.v,t[13].p.v,t[14].p.v),this.feFuncR.setAttribute("tableValues",e)),this.feFuncG&&(n||t[17].p._mdf||t[18].p._mdf||t[19].p._mdf||t[20].p._mdf||t[21].p._mdf)&&(e=this.getTableValue(t[17].p.v,t[18].p.v,t[19].p.v,t[20].p.v,t[21].p.v),this.feFuncG.setAttribute("tableValues",e)),this.feFuncB&&(n||t[24].p._mdf||t[25].p._mdf||t[26].p._mdf||t[27].p._mdf||t[28].p._mdf)&&(e=this.getTableValue(t[24].p.v,t[25].p.v,t[26].p.v,t[27].p.v,t[28].p.v),this.feFuncB.setAttribute("tableValues",e)),this.feFuncA&&(n||t[31].p._mdf||t[32].p._mdf||t[33].p._mdf||t[34].p._mdf||t[35].p._mdf)&&(e=this.getTableValue(t[31].p.v,t[32].p.v,t[33].p.v,t[34].p.v,t[35].p.v),this.feFuncA.setAttribute("tableValues",e));}};function SVGDropShadowEffect(n,e,t,i,r){var o=e.container.globalData.renderConfig.filterSize,s=e.data.fs||o;n.setAttribute("x",s.x||o.x),n.setAttribute("y",s.y||o.y),n.setAttribute("width",s.width||o.width),n.setAttribute("height",s.height||o.height),this.filterManager=e;var l=createNS("feGaussianBlur");l.setAttribute("in","SourceAlpha"),l.setAttribute("result",i+"_drop_shadow_1"),l.setAttribute("stdDeviation","0"),this.feGaussianBlur=l,n.appendChild(l);var c=createNS("feOffset");c.setAttribute("dx","25"),c.setAttribute("dy","0"),c.setAttribute("in",i+"_drop_shadow_1"),c.setAttribute("result",i+"_drop_shadow_2"),this.feOffset=c,n.appendChild(c);var d=createNS("feFlood");d.setAttribute("flood-color","#00ff00"),d.setAttribute("flood-opacity","1"),d.setAttribute("result",i+"_drop_shadow_3"),this.feFlood=d,n.appendChild(d);var u=createNS("feComposite");u.setAttribute("in",i+"_drop_shadow_3"),u.setAttribute("in2",i+"_drop_shadow_2"),u.setAttribute("operator","in"),u.setAttribute("result",i+"_drop_shadow_4"),n.appendChild(u);var g=this.createMergeNode(i,[i+"_drop_shadow_4",r]);n.appendChild(g);}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(n){if(n||this.filterManager._mdf){if((n||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),n||this.filterManager.effectElements[0].p._mdf){var e=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(e[0]*255),Math.round(e[1]*255),Math.round(e[2]*255)));}if((n||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),n||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var t=this.filterManager.effectElements[3].p.v,i=(this.filterManager.effectElements[2].p.v-90)*degToRads,r=t*Math.cos(i),o=t*Math.sin(i);this.feOffset.setAttribute("dx",r),this.feOffset.setAttribute("dy",o);}}};var _svgMatteSymbols=[];function SVGMatte3Effect(n,e,t){this.initialized=!1,this.filterManager=e,this.filterElem=n,this.elem=t,t.matteElement=createNS("g"),t.matteElement.appendChild(t.layerElement),t.matteElement.appendChild(t.transformedElement),t.baseElement=t.matteElement;}SVGMatte3Effect.prototype.findSymbol=function(n){for(var e=0,t=_svgMatteSymbols.length;e<t;){if(_svgMatteSymbols[e]===n)return _svgMatteSymbols[e];e+=1;}return null;},SVGMatte3Effect.prototype.replaceInParent=function(n,e){var t=n.layerElement.parentNode;if(t){for(var i=t.children,r=0,o=i.length;r<o&&i[r]!==n.layerElement;)r+=1;var s;r<=o-2&&(s=i[r+1]);var l=createNS("use");l.setAttribute("href","#"+e),s?t.insertBefore(l,s):t.appendChild(l);}},SVGMatte3Effect.prototype.setElementAsMask=function(n,e){if(!this.findSymbol(e)){var t=createElementID(),i=createNS("mask");i.setAttribute("id",e.layerId),i.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(e);var r=n.globalData.defs;r.appendChild(i);var o=createNS("symbol");o.setAttribute("id",t),this.replaceInParent(e,t),o.appendChild(e.layerElement),r.appendChild(o);var s=createNS("use");s.setAttribute("href","#"+t),i.appendChild(s),e.data.hd=!1,e.show();}n.setMatte(e.layerId);},SVGMatte3Effect.prototype.initialize=function(){for(var n=this.filterManager.effectElements[0].p.v,e=this.elem.comp.elements,t=0,i=e.length;t<i;)e[t]&&e[t].data.ind===n&&this.setElementAsMask(this.elem,e[t]),t+=1;this.initialized=!0;},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize();};function SVGGaussianBlurEffect(n,e,t,i){n.setAttribute("x","-100%"),n.setAttribute("y","-100%"),n.setAttribute("width","300%"),n.setAttribute("height","300%"),this.filterManager=e;var r=createNS("feGaussianBlur");r.setAttribute("result",i),n.appendChild(r),this.feGaussianBlur=r;}SVGGaussianBlurEffect.prototype.renderFrame=function(n){if(n||this.filterManager._mdf){var e=.3,t=this.filterManager.effectElements[0].p.v*e,i=this.filterManager.effectElements[1].p.v,r=i==3?0:t,o=i==2?0:t;this.feGaussianBlur.setAttribute("stdDeviation",r+" "+o);var s=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",s);}};function TransformEffect(){}TransformEffect.prototype.init=function(n){this.effectsManager=n,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix(),this.opacity=-1,this._mdf=!1,this._opMdf=!1;},TransformEffect.prototype.renderFrame=function(n){if(this._opMdf=!1,this._mdf=!1,n||this.effectsManager._mdf){var e=this.effectsManager.effectElements,t=e[0].p.v,i=e[1].p.v,r=e[2].p.v===1,o=e[3].p.v,s=r?o:e[4].p.v,l=e[5].p.v,c=e[6].p.v,d=e[7].p.v;this.matrix.reset(),this.matrix.translate(-t[0],-t[1],t[2]),this.matrix.scale(s*.01,o*.01,1),this.matrix.rotate(-d*degToRads),this.matrix.skewFromAxis(-l*degToRads,(c+90)*degToRads),this.matrix.translate(i[0],i[1],0),this._mdf=!0,this.opacity!==e[8].p.v&&(this.opacity=e[8].p.v,this._opMdf=!0);}};function SVGTransformEffect(n,e){this.init(e);}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(n){this.init(n);}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie;});});var Qy=s0((wh,Jy)=>{"use strict";(function(n,e){typeof wh=="object"&&typeof Jy<"u"?e(wh):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.leaflet={}));})(wh,function(n){"use strict";var e="1.9.4";function t(a){var h,p,v,M;for(p=1,v=arguments.length;p<v;p++){M=arguments[p];for(h in M)a[h]=M[h];}return a;}var i=Object.create||function(){function a(){}return function(h){return a.prototype=h,new a();};}();function r(a,h){var p=Array.prototype.slice;if(a.bind)return a.bind.apply(a,p.call(arguments,1));var v=p.call(arguments,2);return function(){return a.apply(h,v.length?v.concat(p.call(arguments)):arguments);};}var o=0;function s(a){return"_leaflet_id"in a||(a._leaflet_id=++o),a._leaflet_id;}function l(a,h,p){var v,M,F,$;return $=function(){v=!1,M&&(F.apply(p,M),M=!1);},F=function(){v?M=arguments:(a.apply(p,arguments),setTimeout($,h),v=!0);},F;}function c(a,h,p){var v=h[1],M=h[0],F=v-M;return a===v&&p?a:((a-M)%F+F)%F+M;}function d(){return!1;}function u(a,h){if(h===!1)return a;var p=Math.pow(10,h===void 0?6:h);return Math.round(a*p)/p;}function g(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");}function f(a){return g(a).split(/\s+/);}function m(a,h){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?i(a.options):{});for(var p in h)a.options[p]=h[p];return a.options;}function _(a,h,p){var v=[];for(var M in a)v.push(encodeURIComponent(p?M.toUpperCase():M)+"="+encodeURIComponent(a[M]));return(!h||h.indexOf("?")===-1?"?":"&")+v.join("&");}var y=/\{ *([\w_ -]+) *\}/g;function E(a,h){return a.replace(y,function(p,v){var M=h[v];if(M===void 0)throw new Error("No value provided for variable "+p);return typeof M=="function"&&(M=M(h)),M;});}var C=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]";};function b(a,h){for(var p=0;p<a.length;p++)if(a[p]===h)return p;return-1;}var x="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function w(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a];}var T=0;function R(a){var h=+new Date(),p=Math.max(0,16-(h-T));return T=h+p,window.setTimeout(a,p);}var V=window.requestAnimationFrame||w("RequestAnimationFrame")||R,B=window.cancelAnimationFrame||w("CancelAnimationFrame")||w("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a);};function Y(a,h,p){if(p&&V===R)a.call(h);else return V.call(window,r(a,h));}function le(a){a&&B.call(window,a);}var ae={__proto__:null,extend:t,create:i,bind:r,get lastId(){return o;},stamp:s,throttle:l,wrapNum:c,falseFn:d,formatNum:u,trim:g,splitWords:f,setOptions:m,getParamString:_,template:E,isArray:C,indexOf:b,emptyImageUrl:x,requestFn:V,cancelFn:B,requestAnimFrame:Y,cancelAnimFrame:le};function ee(){}ee.extend=function(a){var h=function(){m(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks();},p=h.__super__=this.prototype,v=i(p);v.constructor=h,h.prototype=v;for(var M in this)Object.prototype.hasOwnProperty.call(this,M)&&M!=="prototype"&&M!=="__super__"&&(h[M]=this[M]);return a.statics&&t(h,a.statics),a.includes&&(ce(a.includes),t.apply(null,[v].concat(a.includes))),t(v,a),delete v.statics,delete v.includes,v.options&&(v.options=p.options?i(p.options):{},t(v.options,a.options)),v._initHooks=[],v.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var F=0,$=v._initHooks.length;F<$;F++)v._initHooks[F].call(this);}},h;},ee.include=function(a){var h=this.prototype.options;return t(this.prototype,a),a.options&&(this.prototype.options=h,this.mergeOptions(a.options)),this;},ee.mergeOptions=function(a){return t(this.prototype.options,a),this;},ee.addInitHook=function(a){var h=Array.prototype.slice.call(arguments,1),p=typeof a=="function"?a:function(){this[a].apply(this,h);};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this;};function ce(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=C(a)?a:[a];for(var h=0;h<a.length;h++)a[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack);}}var oe={on:function(a,h,p){if(typeof a=="object")for(var v in a)this._on(v,a[v],h);else{a=f(a);for(var M=0,F=a.length;M<F;M++)this._on(a[M],h,p);}return this;},off:function(a,h,p){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var v in a)this._off(v,a[v],h);else{a=f(a);for(var M=arguments.length===1,F=0,$=a.length;F<$;F++)M?this._off(a[F]):this._off(a[F],h,p);}return this;},_on:function(a,h,p,v){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return;}if(this._listens(a,h,p)===!1){p===this&&(p=void 0);var M={fn:h,ctx:p};v&&(M.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(M);}},_off:function(a,h,p){var v,M,F;if(this._events&&(v=this._events[a],!!v)){if(arguments.length===1){if(this._firingCount)for(M=0,F=v.length;M<F;M++)v[M].fn=d;delete this._events[a];return;}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return;}var $=this._listens(a,h,p);if($!==!1){var Q=v[$];this._firingCount&&(Q.fn=d,this._events[a]=v=v.slice()),v.splice($,1);}}},fire:function(a,h,p){if(!this.listens(a,p))return this;var v=t({},h,{type:a,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var M=this._events[a];if(M){this._firingCount=this._firingCount+1||1;for(var F=0,$=M.length;F<$;F++){var Q=M[F],ie=Q.fn;Q.once&&this.off(a,ie,Q.ctx),ie.call(Q.ctx||this,v);}this._firingCount--;}}return p&&this._propagateEvent(v),this;},listens:function(a,h,p,v){typeof a!="string"&&console.warn('"string" type argument expected');var M=h;typeof h!="function"&&(v=!!h,M=void 0,p=void 0);var F=this._events&&this._events[a];if(F&&F.length&&this._listens(a,M,p)!==!1)return!0;if(v){for(var $ in this._eventParents)if(this._eventParents[$].listens(a,h,p,v))return!0;}return!1;},_listens:function(a,h,p){if(!this._events)return!1;var v=this._events[a]||[];if(!h)return!!v.length;p===this&&(p=void 0);for(var M=0,F=v.length;M<F;M++)if(v[M].fn===h&&v[M].ctx===p)return M;return!1;},once:function(a,h,p){if(typeof a=="object")for(var v in a)this._on(v,a[v],h,!0);else{a=f(a);for(var M=0,F=a.length;M<F;M++)this._on(a[M],h,p,!0);}return this;},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[s(a)]=a,this;},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[s(a)],this;},_propagateEvent:function(a){for(var h in this._eventParents)this._eventParents[h].fire(a.type,t({layer:a.target,propagatedFrom:a.target},a),!0);}};oe.addEventListener=oe.on,oe.removeEventListener=oe.clearAllEventListeners=oe.off,oe.addOneTimeEventListener=oe.once,oe.fireEvent=oe.fire,oe.hasEventListeners=oe.listens;var re=ee.extend(oe);function A(a,h,p){this.x=p?Math.round(a):a,this.y=p?Math.round(h):h;}var z=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a);};A.prototype={clone:function(){return new A(this.x,this.y);},add:function(a){return this.clone()._add(O(a));},_add:function(a){return this.x+=a.x,this.y+=a.y,this;},subtract:function(a){return this.clone()._subtract(O(a));},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this;},divideBy:function(a){return this.clone()._divideBy(a);},_divideBy:function(a){return this.x/=a,this.y/=a,this;},multiplyBy:function(a){return this.clone()._multiplyBy(a);},_multiplyBy:function(a){return this.x*=a,this.y*=a,this;},scaleBy:function(a){return new A(this.x*a.x,this.y*a.y);},unscaleBy:function(a){return new A(this.x/a.x,this.y/a.y);},round:function(){return this.clone()._round();},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this;},floor:function(){return this.clone()._floor();},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this;},ceil:function(){return this.clone()._ceil();},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this;},trunc:function(){return this.clone()._trunc();},_trunc:function(){return this.x=z(this.x),this.y=z(this.y),this;},distanceTo:function(a){a=O(a);var h=a.x-this.x,p=a.y-this.y;return Math.sqrt(h*h+p*p);},equals:function(a){return a=O(a),a.x===this.x&&a.y===this.y;},contains:function(a){return a=O(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y);},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")";}};function O(a,h,p){return a instanceof A?a:C(a)?new A(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new A(a.x,a.y):new A(a,h,p);}function k(a,h){if(a)for(var p=h?[a,h]:a,v=0,M=p.length;v<M;v++)this.extend(p[v]);}k.prototype={extend:function(a){var h,p;if(!a)return this;if(a instanceof A||typeof a[0]=="number"||"x"in a)h=p=O(a);else if(a=H(a),h=a.min,p=a.max,!h||!p)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=p.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this;},getCenter:function(a){return O((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a);},getBottomLeft:function(){return O(this.min.x,this.max.y);},getTopRight:function(){return O(this.max.x,this.min.y);},getTopLeft:function(){return this.min;},getBottomRight:function(){return this.max;},getSize:function(){return this.max.subtract(this.min);},contains:function(a){var h,p;return typeof a[0]=="number"||a instanceof A?a=O(a):a=H(a),a instanceof k?(h=a.min,p=a.max):h=p=a,h.x>=this.min.x&&p.x<=this.max.x&&h.y>=this.min.y&&p.y<=this.max.y;},intersects:function(a){a=H(a);var h=this.min,p=this.max,v=a.min,M=a.max,F=M.x>=h.x&&v.x<=p.x,$=M.y>=h.y&&v.y<=p.y;return F&&$;},overlaps:function(a){a=H(a);var h=this.min,p=this.max,v=a.min,M=a.max,F=M.x>h.x&&v.x<p.x,$=M.y>h.y&&v.y<p.y;return F&&$;},isValid:function(){return!!(this.min&&this.max);},pad:function(a){var h=this.min,p=this.max,v=Math.abs(h.x-p.x)*a,M=Math.abs(h.y-p.y)*a;return H(O(h.x-v,h.y-M),O(p.x+v,p.y+M));},equals:function(a){return a?(a=H(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1;}};function H(a,h){return!a||a instanceof k?a:new k(a,h);}function U(a,h){if(a)for(var p=h?[a,h]:a,v=0,M=p.length;v<M;v++)this.extend(p[v]);}U.prototype={extend:function(a){var h=this._southWest,p=this._northEast,v,M;if(a instanceof me)v=a,M=a;else if(a instanceof U){if(v=a._southWest,M=a._northEast,!v||!M)return this;}else return a?this.extend(fe(a)||pe(a)):this;return!h&&!p?(this._southWest=new me(v.lat,v.lng),this._northEast=new me(M.lat,M.lng)):(h.lat=Math.min(v.lat,h.lat),h.lng=Math.min(v.lng,h.lng),p.lat=Math.max(M.lat,p.lat),p.lng=Math.max(M.lng,p.lng)),this;},pad:function(a){var h=this._southWest,p=this._northEast,v=Math.abs(h.lat-p.lat)*a,M=Math.abs(h.lng-p.lng)*a;return new U(new me(h.lat-v,h.lng-M),new me(p.lat+v,p.lng+M));},getCenter:function(){return new me((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2);},getSouthWest:function(){return this._southWest;},getNorthEast:function(){return this._northEast;},getNorthWest:function(){return new me(this.getNorth(),this.getWest());},getSouthEast:function(){return new me(this.getSouth(),this.getEast());},getWest:function(){return this._southWest.lng;},getSouth:function(){return this._southWest.lat;},getEast:function(){return this._northEast.lng;},getNorth:function(){return this._northEast.lat;},contains:function(a){typeof a[0]=="number"||a instanceof me||"lat"in a?a=fe(a):a=pe(a);var h=this._southWest,p=this._northEast,v,M;return a instanceof U?(v=a.getSouthWest(),M=a.getNorthEast()):v=M=a,v.lat>=h.lat&&M.lat<=p.lat&&v.lng>=h.lng&&M.lng<=p.lng;},intersects:function(a){a=pe(a);var h=this._southWest,p=this._northEast,v=a.getSouthWest(),M=a.getNorthEast(),F=M.lat>=h.lat&&v.lat<=p.lat,$=M.lng>=h.lng&&v.lng<=p.lng;return F&&$;},overlaps:function(a){a=pe(a);var h=this._southWest,p=this._northEast,v=a.getSouthWest(),M=a.getNorthEast(),F=M.lat>h.lat&&v.lat<p.lat,$=M.lng>h.lng&&v.lng<p.lng;return F&&$;},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",");},equals:function(a,h){return a?(a=pe(a),this._southWest.equals(a.getSouthWest(),h)&&this._northEast.equals(a.getNorthEast(),h)):!1;},isValid:function(){return!!(this._southWest&&this._northEast);}};function pe(a,h){return a instanceof U?a:new U(a,h);}function me(a,h,p){if(isNaN(a)||isNaN(h))throw new Error("Invalid LatLng object: ("+a+", "+h+")");this.lat=+a,this.lng=+h,p!==void 0&&(this.alt=+p);}me.prototype={equals:function(a,h){if(!a)return!1;a=fe(a);var p=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return p<=(h===void 0?1e-9:h);},toString:function(a){return"LatLng("+u(this.lat,a)+", "+u(this.lng,a)+")";},distanceTo:function(a){return Te.distance(this,fe(a));},wrap:function(){return Te.wrapLatLng(this);},toBounds:function(a){var h=180*a/40075017,p=h/Math.cos(Math.PI/180*this.lat);return pe([this.lat-h,this.lng-p],[this.lat+h,this.lng+p]);},clone:function(){return new me(this.lat,this.lng,this.alt);}};function fe(a,h,p){return a instanceof me?a:C(a)&&typeof a[0]!="object"?a.length===3?new me(a[0],a[1],a[2]):a.length===2?new me(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new me(a.lat,"lng"in a?a.lng:a.lon,a.alt):h===void 0?null:new me(a,h,p);}var Fe={latLngToPoint:function(a,h){var p=this.projection.project(a),v=this.scale(h);return this.transformation._transform(p,v);},pointToLatLng:function(a,h){var p=this.scale(h),v=this.transformation.untransform(a,p);return this.projection.unproject(v);},project:function(a){return this.projection.project(a);},unproject:function(a){return this.projection.unproject(a);},scale:function(a){return 256*Math.pow(2,a);},zoom:function(a){return Math.log(a/256)/Math.LN2;},getProjectedBounds:function(a){if(this.infinite)return null;var h=this.projection.bounds,p=this.scale(a),v=this.transformation.transform(h.min,p),M=this.transformation.transform(h.max,p);return new k(v,M);},infinite:!1,wrapLatLng:function(a){var h=this.wrapLng?c(a.lng,this.wrapLng,!0):a.lng,p=this.wrapLat?c(a.lat,this.wrapLat,!0):a.lat,v=a.alt;return new me(p,h,v);},wrapLatLngBounds:function(a){var h=a.getCenter(),p=this.wrapLatLng(h),v=h.lat-p.lat,M=h.lng-p.lng;if(v===0&&M===0)return a;var F=a.getSouthWest(),$=a.getNorthEast(),Q=new me(F.lat-v,F.lng-M),ie=new me($.lat-v,$.lng-M);return new U(Q,ie);}},Te=t({},Fe,{wrapLng:[-180,180],R:6371e3,distance:function(a,h){var p=Math.PI/180,v=a.lat*p,M=h.lat*p,F=Math.sin((h.lat-a.lat)*p/2),$=Math.sin((h.lng-a.lng)*p/2),Q=F*F+Math.cos(v)*Math.cos(M)*$*$,ie=2*Math.atan2(Math.sqrt(Q),Math.sqrt(1-Q));return this.R*ie;}}),qe=6378137,bt={R:qe,MAX_LATITUDE:85.0511287798,project:function(a){var h=Math.PI/180,p=this.MAX_LATITUDE,v=Math.max(Math.min(p,a.lat),-p),M=Math.sin(v*h);return new A(this.R*a.lng*h,this.R*Math.log((1+M)/(1-M))/2);},unproject:function(a){var h=180/Math.PI;return new me((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*h,a.x*h/this.R);},bounds:function(){var a=qe*Math.PI;return new k([-a,-a],[a,a]);}()};function It(a,h,p,v){if(C(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return;}this._a=a,this._b=h,this._c=p,this._d=v;}It.prototype={transform:function(a,h){return this._transform(a.clone(),h);},_transform:function(a,h){return h=h||1,a.x=h*(this._a*a.x+this._b),a.y=h*(this._c*a.y+this._d),a;},untransform:function(a,h){return h=h||1,new A((a.x/h-this._b)/this._a,(a.y/h-this._d)/this._c);}};function We(a,h,p,v){return new It(a,h,p,v);}var _t=t({},Te,{code:"EPSG:3857",projection:bt,transformation:function(){var a=.5/(Math.PI*bt.R);return We(a,.5,-a,.5);}()}),Rt=t({},_t,{code:"EPSG:900913"});function Je(a){return document.createElementNS("http://www.w3.org/2000/svg",a);}function we(a,h){var p="",v,M,F,$,Q,ie;for(v=0,F=a.length;v<F;v++){for(Q=a[v],M=0,$=Q.length;M<$;M++)ie=Q[M],p+=(M?"L":"M")+ie.x+" "+ie.y;p+=h?Oe.svg?"z":"x":"";}return p||"M0 0";}var Nn=document.documentElement.style,Bn="ActiveXObject"in window,pi=Bn&&!document.addEventListener,Vn="msLaunchUri"in navigator&&!("documentMode"in document),zn=Ni("webkit"),Qn=Ni("android"),Zt=Ni("android 2")||Ni("android 3"),Li=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Di=Qn&&Ni("Google")&&Li<537&&!("AudioNode"in window),hn=!!window.opera,fi=!Vn&&Ni("chrome"),Mn=Ni("gecko")&&!zn&&!hn&&!Bn,hr=!fi&&Ni("safari"),vo=Ni("phantom"),yo="OTransition"in Nn,Ss=navigator.platform.indexOf("Win")===0,s_=Bn&&"transition"in Nn,Mu="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix()&&!Zt,a_="MozPerspective"in Nn,qx=!window.L_DISABLE_3D&&(s_||Mu||a_)&&!yo&&!vo,ka=typeof orientation<"u"||Ni("mobile"),Zx=ka&&zn,Kx=ka&&Mu,l_=!window.PointerEvent&&window.MSPointerEvent,c_=!!(window.PointerEvent||l_),h_="ontouchstart"in window||!!window.TouchEvent,Jx=!window.L_NO_TOUCH&&(h_||c_),Qx=ka&&hn,eP=ka&&Mn,tP=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,nP=function(){var a=!1;try{var h=Object.defineProperty({},"passive",{get:function(){a=!0;}});window.addEventListener("testPassiveEventSupport",d,h),window.removeEventListener("testPassiveEventSupport",d,h);}catch{}return a;}(),iP=function(){return!!document.createElement("canvas").getContext;}(),Su=!!(document.createElementNS&&Je("svg").createSVGRect),rP=!!Su&&function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg";}(),oP=!Su&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var h=a.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object";}catch{return!1;}}(),sP=navigator.platform.indexOf("Mac")===0,aP=navigator.platform.indexOf("Linux")===0;function Ni(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0;}var Oe={ie:Bn,ielt9:pi,edge:Vn,webkit:zn,android:Qn,android23:Zt,androidStock:Di,opera:hn,chrome:fi,gecko:Mn,safari:hr,phantom:vo,opera12:yo,win:Ss,ie3d:s_,webkit3d:Mu,gecko3d:a_,any3d:qx,mobile:ka,mobileWebkit:Zx,mobileWebkit3d:Kx,msPointer:l_,pointer:c_,touch:Jx,touchNative:h_,mobileOpera:Qx,mobileGecko:eP,retina:tP,passiveEvents:nP,canvas:iP,svg:Su,vml:oP,inlineSvg:rP,mac:sP,linux:aP},d_=Oe.msPointer?"MSPointerDown":"pointerdown",u_=Oe.msPointer?"MSPointerMove":"pointermove",p_=Oe.msPointer?"MSPointerUp":"pointerup",f_=Oe.msPointer?"MSPointerCancel":"pointercancel",Eu={touchstart:d_,touchmove:u_,touchend:p_,touchcancel:f_},g_={touchstart:pP,touchmove:tc,touchend:tc,touchcancel:tc},Es={},m_=!1;function lP(a,h,p){return h==="touchstart"&&uP(),g_[h]?(p=g_[h].bind(this,p),a.addEventListener(Eu[h],p,!1),p):(console.warn("wrong event specified:",h),d);}function cP(a,h,p){if(!Eu[h]){console.warn("wrong event specified:",h);return;}a.removeEventListener(Eu[h],p,!1);}function hP(a){Es[a.pointerId]=a;}function dP(a){Es[a.pointerId]&&(Es[a.pointerId]=a);}function __(a){delete Es[a.pointerId];}function uP(){m_||(document.addEventListener(d_,hP,!0),document.addEventListener(u_,dP,!0),document.addEventListener(p_,__,!0),document.addEventListener(f_,__,!0),m_=!0);}function tc(a,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var p in Es)h.touches.push(Es[p]);h.changedTouches=[h],a(h);}}function pP(a,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&Kt(h),tc(a,h);}function fP(a){var h={},p,v;for(v in a)p=a[v],h[v]=p&&p.bind?p.bind(a):p;return a=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h;}var gP=200;function mP(a,h){a.addEventListener("dblclick",h);var p=0,v;function M(F){if(F.detail!==1){v=F.detail;return;}if(!(F.pointerType==="mouse"||F.sourceCapabilities&&!F.sourceCapabilities.firesTouchEvents)){var $=x_(F);if(!($.some(function(ie){return ie instanceof HTMLLabelElement&&ie.attributes.for;})&&!$.some(function(ie){return ie instanceof HTMLInputElement||ie instanceof HTMLSelectElement;}))){var Q=Date.now();Q-p<=gP?(v++,v===2&&h(fP(F))):v=1,p=Q;}}}return a.addEventListener("click",M),{dblclick:h,simDblclick:M};}function _P(a,h){a.removeEventListener("dblclick",h.dblclick),a.removeEventListener("click",h.simDblclick);}var Ou=rc(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ia=rc(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),v_=Ia==="webkitTransition"||Ia==="OTransition"?Ia+"End":"transitionend";function y_(a){return typeof a=="string"?document.getElementById(a):a;}function Aa(a,h){var p=a.style[h]||a.currentStyle&&a.currentStyle[h];if((!p||p==="auto")&&document.defaultView){var v=document.defaultView.getComputedStyle(a,null);p=v?v[h]:null;}return p==="auto"?null:p;}function Ke(a,h,p){var v=document.createElement(a);return v.className=h||"",p&&p.appendChild(v),v;}function xt(a){var h=a.parentNode;h&&h.removeChild(a);}function nc(a){for(;a.firstChild;)a.removeChild(a.firstChild);}function Os(a){var h=a.parentNode;h&&h.lastChild!==a&&h.appendChild(a);}function Ts(a){var h=a.parentNode;h&&h.firstChild!==a&&h.insertBefore(a,h.firstChild);}function Tu(a,h){if(a.classList!==void 0)return a.classList.contains(h);var p=ic(a);return p.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(p);}function $e(a,h){if(a.classList!==void 0)for(var p=f(h),v=0,M=p.length;v<M;v++)a.classList.add(p[v]);else if(!Tu(a,h)){var F=ic(a);ku(a,(F?F+" ":"")+h);}}function At(a,h){a.classList!==void 0?a.classList.remove(h):ku(a,g((" "+ic(a)+" ").replace(" "+h+" "," ")));}function ku(a,h){a.className.baseVal===void 0?a.className=h:a.className.baseVal=h;}function ic(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal;}function ei(a,h){"opacity"in a.style?a.style.opacity=h:"filter"in a.style&&vP(a,h);}function vP(a,h){var p=!1,v="DXImageTransform.Microsoft.Alpha";try{p=a.filters.item(v);}catch{if(h===1)return;}h=Math.round(h*100),p?(p.Enabled=h!==100,p.Opacity=h):a.style.filter+=" progid:"+v+"(opacity="+h+")";}function rc(a){for(var h=document.documentElement.style,p=0;p<a.length;p++)if(a[p]in h)return a[p];return!1;}function Co(a,h,p){var v=h||new A(0,0);a.style[Ou]=(Oe.ie3d?"translate("+v.x+"px,"+v.y+"px)":"translate3d("+v.x+"px,"+v.y+"px,0)")+(p?" scale("+p+")":"");}function Lt(a,h){a._leaflet_pos=h,Oe.any3d?Co(a,h):(a.style.left=h.x+"px",a.style.top=h.y+"px");}function bo(a){return a._leaflet_pos||new A(0,0);}var Fa,Ra,Iu;if("onselectstart"in document)Fa=function(){Be(window,"selectstart",Kt);},Ra=function(){ft(window,"selectstart",Kt);};else{var La=rc(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Fa=function(){if(La){var a=document.documentElement.style;Iu=a[La],a[La]="none";}},Ra=function(){La&&(document.documentElement.style[La]=Iu,Iu=void 0);};}function Au(){Be(window,"dragstart",Kt);}function Fu(){ft(window,"dragstart",Kt);}var oc,Ru;function Lu(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(sc(),oc=a,Ru=a.style.outlineStyle,a.style.outlineStyle="none",Be(window,"keydown",sc));}function sc(){oc&&(oc.style.outlineStyle=Ru,oc=void 0,Ru=void 0,ft(window,"keydown",sc));}function C_(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a;}function Du(a){var h=a.getBoundingClientRect();return{x:h.width/a.offsetWidth||1,y:h.height/a.offsetHeight||1,boundingClientRect:h};}var yP={__proto__:null,TRANSFORM:Ou,TRANSITION:Ia,TRANSITION_END:v_,get:y_,getStyle:Aa,create:Ke,remove:xt,empty:nc,toFront:Os,toBack:Ts,hasClass:Tu,addClass:$e,removeClass:At,setClass:ku,getClass:ic,setOpacity:ei,testProp:rc,setTransform:Co,setPosition:Lt,getPosition:bo,get disableTextSelection(){return Fa;},get enableTextSelection(){return Ra;},disableImageDrag:Au,enableImageDrag:Fu,preventOutline:Lu,restoreOutline:sc,getSizedParentNode:C_,getScale:Du};function Be(a,h,p,v){if(h&&typeof h=="object")for(var M in h)Bu(a,M,h[M],p);else{h=f(h);for(var F=0,$=h.length;F<$;F++)Bu(a,h[F],p,v);}return this;}var Bi="_leaflet_events";function ft(a,h,p,v){if(arguments.length===1)b_(a),delete a[Bi];else if(h&&typeof h=="object")for(var M in h)Vu(a,M,h[M],p);else if(h=f(h),arguments.length===2)b_(a,function(Q){return b(h,Q)!==-1;});else for(var F=0,$=h.length;F<$;F++)Vu(a,h[F],p,v);return this;}function b_(a,h){for(var p in a[Bi]){var v=p.split(/\d/)[0];(!h||h(v))&&Vu(a,v,null,null,p);}}var Nu={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Bu(a,h,p,v){var M=h+s(p)+(v?"_"+s(v):"");if(a[Bi]&&a[Bi][M])return this;var F=function(Q){return p.call(v||a,Q||window.event);},$=F;!Oe.touchNative&&Oe.pointer&&h.indexOf("touch")===0?F=lP(a,h,F):Oe.touch&&h==="dblclick"?F=mP(a,F):"addEventListener"in a?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?a.addEventListener(Nu[h]||h,F,Oe.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(F=function(Q){Q=Q||window.event,ju(a,Q)&&$(Q);},a.addEventListener(Nu[h],F,!1)):a.addEventListener(h,$,!1):a.attachEvent("on"+h,F),a[Bi]=a[Bi]||{},a[Bi][M]=F;}function Vu(a,h,p,v,M){M=M||h+s(p)+(v?"_"+s(v):"");var F=a[Bi]&&a[Bi][M];if(!F)return this;!Oe.touchNative&&Oe.pointer&&h.indexOf("touch")===0?cP(a,h,F):Oe.touch&&h==="dblclick"?_P(a,F):"removeEventListener"in a?a.removeEventListener(Nu[h]||h,F,!1):a.detachEvent("on"+h,F),a[Bi][M]=null;}function xo(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this;}function zu(a){return Bu(a,"wheel",xo),this;}function Da(a){return Be(a,"mousedown touchstart dblclick contextmenu",xo),a._leaflet_disable_click=!0,this;}function Kt(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this;}function Po(a){return Kt(a),xo(a),this;}function x_(a){if(a.composedPath)return a.composedPath();for(var h=[],p=a.target;p;)h.push(p),p=p.parentNode;return h;}function P_(a,h){if(!h)return new A(a.clientX,a.clientY);var p=Du(h),v=p.boundingClientRect;return new A((a.clientX-v.left)/p.x-h.clientLeft,(a.clientY-v.top)/p.y-h.clientTop);}var CP=Oe.linux&&Oe.chrome?window.devicePixelRatio:Oe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function w_(a){return Oe.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/CP:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0;}function ju(a,h){var p=h.relatedTarget;if(!p)return!0;try{for(;p&&p!==a;)p=p.parentNode;}catch{return!1;}return p!==a;}var bP={__proto__:null,on:Be,off:ft,stopPropagation:xo,disableScrollPropagation:zu,disableClickPropagation:Da,preventDefault:Kt,stop:Po,getPropagationPath:x_,getMousePosition:P_,getWheelDelta:w_,isExternalTarget:ju,addListener:Be,removeListener:ft},M_=re.extend({run:function(a,h,p,v){this.stop(),this._el=a,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(v||.5,.2),this._startPos=bo(a),this._offset=h.subtract(this._startPos),this._startTime=+new Date(),this.fire("start"),this._animate();},stop:function(){this._inProgress&&(this._step(!0),this._complete());},_animate:function(){this._animId=Y(this._animate,this),this._step();},_step:function(a){var h=+new Date()-this._startTime,p=this._duration*1e3;h<p?this._runFrame(this._easeOut(h/p),a):(this._runFrame(1),this._complete());},_runFrame:function(a,h){var p=this._startPos.add(this._offset.multiplyBy(a));h&&p._round(),Lt(this._el,p),this.fire("step");},_complete:function(){le(this._animId),this._inProgress=!1,this.fire("end");},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower);}}),Xe=re.extend({options:{crs:_t,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,h){h=m(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(fe(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ia&&Oe.any3d&&!Oe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Be(this._proxy,v_,this._catchTransitionEnd,this)),this._addLayers(this.options.layers);},setView:function(a,h,p){if(h=h===void 0?this._zoom:this._limitZoom(h),a=this._limitCenter(fe(a),h,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=t({animate:p.animate},p.zoom),p.pan=t({animate:p.animate,duration:p.duration},p.pan));var v=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,h,p.zoom):this._tryAnimatedPan(a,p.pan);if(v)return clearTimeout(this._sizeTimer),this;}return this._resetView(a,h,p.pan&&p.pan.noMoveStart),this;},setZoom:function(a,h){return this._loaded?this.setView(this.getCenter(),a,{zoom:h}):(this._zoom=a,this);},zoomIn:function(a,h){return a=a||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,h);},zoomOut:function(a,h){return a=a||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,h);},setZoomAround:function(a,h,p){var v=this.getZoomScale(h),M=this.getSize().divideBy(2),F=a instanceof A?a:this.latLngToContainerPoint(a),$=F.subtract(M).multiplyBy(1-1/v),Q=this.containerPointToLatLng(M.add($));return this.setView(Q,h,{zoom:p});},_getBoundsCenterZoom:function(a,h){h=h||{},a=a.getBounds?a.getBounds():pe(a);var p=O(h.paddingTopLeft||h.padding||[0,0]),v=O(h.paddingBottomRight||h.padding||[0,0]),M=this.getBoundsZoom(a,!1,p.add(v));if(M=typeof h.maxZoom=="number"?Math.min(h.maxZoom,M):M,M===1/0)return{center:a.getCenter(),zoom:M};var F=v.subtract(p).divideBy(2),$=this.project(a.getSouthWest(),M),Q=this.project(a.getNorthEast(),M),ie=this.unproject($.add(Q).divideBy(2).add(F),M);return{center:ie,zoom:M};},fitBounds:function(a,h){if(a=pe(a),!a.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(a,h);return this.setView(p.center,p.zoom,h);},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a);},panTo:function(a,h){return this.setView(a,this._zoom,{pan:h});},panBy:function(a,h){if(a=O(a).round(),h=h||{},!a.x&&!a.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new M_(),this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){$e(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,p,h.duration||.25,h.easeLinearity);}else this._rawPanBy(a),this.fire("move").fire("moveend");return this;},flyTo:function(a,h,p){if(p=p||{},p.animate===!1||!Oe.any3d)return this.setView(a,h,p);this._stop();var v=this.project(this.getCenter()),M=this.project(a),F=this.getSize(),$=this._zoom;a=fe(a),h=h===void 0?$:h;var Q=Math.max(F.x,F.y),ie=Q*this.getZoomScale($,h),de=M.distanceTo(v)||1,ye=1.42,Re=ye*ye;function Ge(Dt){var vc=Dt?-1:1,cw=Dt?ie:Q,hw=ie*ie-Q*Q+vc*Re*Re*de*de,dw=2*cw*Re*de,Ju=hw/dw,o0=Math.sqrt(Ju*Ju+1)-Ju,uw=o0<1e-9?-18:Math.log(o0);return uw;}function dn(Dt){return(Math.exp(Dt)-Math.exp(-Dt))/2;}function Yt(Dt){return(Math.exp(Dt)+Math.exp(-Dt))/2;}function ni(Dt){return dn(Dt)/Yt(Dt);}var Sn=Ge(0);function Ls(Dt){return Q*(Yt(Sn)/Yt(Sn+ye*Dt));}function ow(Dt){return Q*(Yt(Sn)*ni(Sn+ye*Dt)-dn(Sn))/Re;}function sw(Dt){return 1-Math.pow(1-Dt,1.5);}var aw=Date.now(),i0=(Ge(1)-Sn)/ye,lw=p.duration?1e3*p.duration:1e3*i0*.8;function r0(){var Dt=(Date.now()-aw)/lw,vc=sw(Dt)*i0;Dt<=1?(this._flyToFrame=Y(r0,this),this._move(this.unproject(v.add(M.subtract(v).multiplyBy(ow(vc)/de)),$),this.getScaleZoom(Q/Ls(vc),$),{flyTo:!0})):this._move(a,h)._moveEnd(!0);}return this._moveStart(!0,p.noMoveStart),r0.call(this),this;},flyToBounds:function(a,h){var p=this._getBoundsCenterZoom(a,h);return this.flyTo(p.center,p.zoom,h);},setMaxBounds:function(a){return a=pe(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this);},setMinZoom:function(a){var h=this.options.minZoom;return this.options.minZoom=a,this._loaded&&h!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this;},setMaxZoom:function(a){var h=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&h!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this;},panInsideBounds:function(a,h){this._enforcingBounds=!0;var p=this.getCenter(),v=this._limitCenter(p,this._zoom,pe(a));return p.equals(v)||this.panTo(v,h),this._enforcingBounds=!1,this;},panInside:function(a,h){h=h||{};var p=O(h.paddingTopLeft||h.padding||[0,0]),v=O(h.paddingBottomRight||h.padding||[0,0]),M=this.project(this.getCenter()),F=this.project(a),$=this.getPixelBounds(),Q=H([$.min.add(p),$.max.subtract(v)]),ie=Q.getSize();if(!Q.contains(F)){this._enforcingBounds=!0;var de=F.subtract(Q.getCenter()),ye=Q.extend(F).getSize().subtract(ie);M.x+=de.x<0?-ye.x:ye.x,M.y+=de.y<0?-ye.y:ye.y,this.panTo(this.unproject(M),h),this._enforcingBounds=!1;}return this;},invalidateSize:function(a){if(!this._loaded)return this;a=t({animate:!1,pan:!0},a===!0?{animate:!0}:a);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),v=h.divideBy(2).round(),M=p.divideBy(2).round(),F=v.subtract(M);return!F.x&&!F.y?this:(a.animate&&a.pan?this.panBy(F):(a.pan&&this._rawPanBy(F),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:p}));},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop();},locate:function(a){if(a=this._locateOptions=t({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=r(this._handleGeolocationResponse,this),p=r(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,p,a):navigator.geolocation.getCurrentPosition(h,p,a),this;},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this;},_handleGeolocationError:function(a){if(this._container._leaflet_id){var h=a.code,p=a.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+p+"."});}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var h=a.coords.latitude,p=a.coords.longitude,v=new me(h,p),M=v.toBounds(a.coords.accuracy*2),F=this._locateOptions;if(F.setView){var $=this.getBoundsZoom(M);this.setView(v,F.maxZoom?Math.min($,F.maxZoom):$);}var Q={latlng:v,bounds:M,timestamp:a.timestamp};for(var ie in a.coords)typeof a.coords[ie]=="number"&&(Q[ie]=a.coords[ie]);this.fire("locationfound",Q);}},addHandler:function(a,h){if(!h)return this;var p=this[a]=new h(this);return this._handlers.push(p),this.options[a]&&p.enable(),this;},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId;}catch{this._container._leaflet_id=void 0,this._containerId=void 0;}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),xt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(le(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)xt(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this;},createPane:function(a,h){var p="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),v=Ke("div",p,h||this._mapPane);return a&&(this._panes[a]=v),v;},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint());},getZoom:function(){return this._zoom;},getBounds:function(){var a=this.getPixelBounds(),h=this.unproject(a.getBottomLeft()),p=this.unproject(a.getTopRight());return new U(h,p);},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom;},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom;},getBoundsZoom:function(a,h,p){a=pe(a),p=O(p||[0,0]);var v=this.getZoom()||0,M=this.getMinZoom(),F=this.getMaxZoom(),$=a.getNorthWest(),Q=a.getSouthEast(),ie=this.getSize().subtract(p),de=H(this.project(Q,v),this.project($,v)).getSize(),ye=Oe.any3d?this.options.zoomSnap:1,Re=ie.x/de.x,Ge=ie.y/de.y,dn=h?Math.max(Re,Ge):Math.min(Re,Ge);return v=this.getScaleZoom(dn,v),ye&&(v=Math.round(v/(ye/100))*(ye/100),v=h?Math.ceil(v/ye)*ye:Math.floor(v/ye)*ye),Math.max(M,Math.min(F,v));},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new A(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone();},getPixelBounds:function(a,h){var p=this._getTopLeftPoint(a,h);return new k(p,p.add(this.getSize()));},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin;},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a);},getPane:function(a){return typeof a=="string"?this._panes[a]:a;},getPanes:function(){return this._panes;},getContainer:function(){return this._container;},getZoomScale:function(a,h){var p=this.options.crs;return h=h===void 0?this._zoom:h,p.scale(a)/p.scale(h);},getScaleZoom:function(a,h){var p=this.options.crs;h=h===void 0?this._zoom:h;var v=p.zoom(a*p.scale(h));return isNaN(v)?1/0:v;},project:function(a,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(fe(a),h);},unproject:function(a,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(O(a),h);},layerPointToLatLng:function(a){var h=O(a).add(this.getPixelOrigin());return this.unproject(h);},latLngToLayerPoint:function(a){var h=this.project(fe(a))._round();return h._subtract(this.getPixelOrigin());},wrapLatLng:function(a){return this.options.crs.wrapLatLng(fe(a));},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(pe(a));},distance:function(a,h){return this.options.crs.distance(fe(a),fe(h));},containerPointToLayerPoint:function(a){return O(a).subtract(this._getMapPanePos());},layerPointToContainerPoint:function(a){return O(a).add(this._getMapPanePos());},containerPointToLatLng:function(a){var h=this.containerPointToLayerPoint(O(a));return this.layerPointToLatLng(h);},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(fe(a)));},mouseEventToContainerPoint:function(a){return P_(a,this._container);},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a));},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a));},_initContainer:function(a){var h=this._container=y_(a);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.");}else throw new Error("Map container not found.");Be(h,"scroll",this._onScroll,this),this._containerId=s(h);},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&Oe.any3d,$e(a,"leaflet-container"+(Oe.touch?" leaflet-touch":"")+(Oe.retina?" leaflet-retina":"")+(Oe.ielt9?" leaflet-oldie":"")+(Oe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=Aa(a,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos();},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Lt(this._mapPane,new A(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||($e(a.markerPane,"leaflet-zoom-hide"),$e(a.shadowPane,"leaflet-zoom-hide"));},_resetView:function(a,h,p){Lt(this._mapPane,new A(0,0));var v=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var M=this._zoom!==h;this._moveStart(M,p)._move(a,h)._moveEnd(M),this.fire("viewreset"),v&&this.fire("load");},_moveStart:function(a,h){return a&&this.fire("zoomstart"),h||this.fire("movestart"),this;},_move:function(a,h,p,v){h===void 0&&(h=this._zoom);var M=this._zoom!==h;return this._zoom=h,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),v?p&&p.pinch&&this.fire("zoom",p):((M||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this;},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend");},_stop:function(){return le(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this;},_rawPanBy:function(a){Lt(this._mapPane,this._getMapPanePos().subtract(a));},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom();},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds);},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.");},_initEvents:function(a){this._targets={},this._targets[s(this._container)]=this;var h=a?ft:Be;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),Oe.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd);},_onResize:function(){le(this._resizeRequest),this._resizeRequest=Y(function(){this.invalidateSize({debounceMoveend:!0});},this);},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0;},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom());},_findEventTargets:function(a,h){for(var p=[],v,M=h==="mouseout"||h==="mouseover",F=a.target||a.srcElement,$=!1;F;){if(v=this._targets[s(F)],v&&(h==="click"||h==="preclick")&&this._draggableMoved(v)){$=!0;break;}if(v&&v.listens(h,!0)&&(M&&!ju(F,a)||(p.push(v),M))||F===this._container)break;F=F.parentNode;}return!p.length&&!$&&!M&&this.listens(h,!0)&&(p=[this]),p;},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode;}},_handleDOMEvent:function(a){var h=a.target||a.srcElement;if(!(!this._loaded||h._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(h))){var p=a.type;p==="mousedown"&&Lu(h),this._fireDOMEvent(a,p);}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,h,p){if(a.type==="click"){var v=t({},a);v.type="preclick",this._fireDOMEvent(v,v.type,p);}var M=this._findEventTargets(a,h);if(p){for(var F=[],$=0;$<p.length;$++)p[$].listens(h,!0)&&F.push(p[$]);M=F.concat(M);}if(M.length){h==="contextmenu"&&Kt(a);var Q=M[0],ie={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var de=Q.getLatLng&&(!Q._radius||Q._radius<=10);ie.containerPoint=de?this.latLngToContainerPoint(Q.getLatLng()):this.mouseEventToContainerPoint(a),ie.layerPoint=this.containerPointToLayerPoint(ie.containerPoint),ie.latlng=de?Q.getLatLng():this.layerPointToLatLng(ie.layerPoint);}for($=0;$<M.length;$++)if(M[$].fire(h,ie,!0),ie.originalEvent._stopped||M[$].options.bubblingMouseEvents===!1&&b(this._mouseEvents,h)!==-1)return;}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved();},_clearHandlers:function(){for(var a=0,h=this._handlers.length;a<h;a++)this._handlers[a].disable();},whenReady:function(a,h){return this._loaded?a.call(h||this,{target:this}):this.on("load",a,h),this;},_getMapPanePos:function(){return bo(this._mapPane)||new A(0,0);},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0]);},_getTopLeftPoint:function(a,h){var p=a&&h!==void 0?this._getNewPixelOrigin(a,h):this.getPixelOrigin();return p.subtract(this._getMapPanePos());},_getNewPixelOrigin:function(a,h){var p=this.getSize()._divideBy(2);return this.project(a,h)._subtract(p)._add(this._getMapPanePos())._round();},_latLngToNewLayerPoint:function(a,h,p){var v=this._getNewPixelOrigin(p,h);return this.project(a,h)._subtract(v);},_latLngBoundsToNewLayerBounds:function(a,h,p){var v=this._getNewPixelOrigin(p,h);return H([this.project(a.getSouthWest(),h)._subtract(v),this.project(a.getNorthWest(),h)._subtract(v),this.project(a.getSouthEast(),h)._subtract(v),this.project(a.getNorthEast(),h)._subtract(v)]);},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2));},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint());},_limitCenter:function(a,h,p){if(!p)return a;var v=this.project(a,h),M=this.getSize().divideBy(2),F=new k(v.subtract(M),v.add(M)),$=this._getBoundsOffset(F,p,h);return Math.abs($.x)<=1&&Math.abs($.y)<=1?a:this.unproject(v.add($),h);},_limitOffset:function(a,h){if(!h)return a;var p=this.getPixelBounds(),v=new k(p.min.add(a),p.max.add(a));return a.add(this._getBoundsOffset(v,h));},_getBoundsOffset:function(a,h,p){var v=H(this.project(h.getNorthEast(),p),this.project(h.getSouthWest(),p)),M=v.min.subtract(a.min),F=v.max.subtract(a.max),$=this._rebound(M.x,-F.x),Q=this._rebound(M.y,-F.y);return new A($,Q);},_rebound:function(a,h){return a+h>0?Math.round(a-h)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(h));},_limitZoom:function(a){var h=this.getMinZoom(),p=this.getMaxZoom(),v=Oe.any3d?this.options.zoomSnap:1;return v&&(a=Math.round(a/v)*v),Math.max(h,Math.min(p,a));},_onPanTransitionStep:function(){this.fire("move");},_onPanTransitionEnd:function(){At(this._mapPane,"leaflet-pan-anim"),this.fire("moveend");},_tryAnimatedPan:function(a,h){var p=this._getCenterOffset(a)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,h),!0);},_createAnimProxy:function(){var a=this._proxy=Ke("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(h){var p=Ou,v=this._proxy.style[p];Co(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),v===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd();},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this);},_destroyAnimProxy:function(){xt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy;},_animMoveEnd:function(){var a=this.getCenter(),h=this.getZoom();Co(this._proxy,this.project(a,h),this.getZoomScale(h,1));},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd();},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length;},_tryAnimatedZoom:function(a,h,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var v=this.getZoomScale(h),M=this._getCenterOffset(a)._divideBy(1-1/v);return p.animate!==!0&&!this.getSize().contains(M)?!1:(Y(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(a,h,!0);},this),!0);},_animateZoom:function(a,h,p,v){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=h,$e(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:h,noUpdate:v}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(r(this._onZoomTransitionEnd,this),250));},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&At(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0));}});function xP(a,h){return new Xe(a,h);}var gi=ee.extend({options:{position:"topright"},initialize:function(a){m(this,a);},getPosition:function(){return this.options.position;},setPosition:function(a){var h=this._map;return h&&h.removeControl(this),this.options.position=a,h&&h.addControl(this),this;},getContainer:function(){return this._container;},addTo:function(a){this.remove(),this._map=a;var h=this._container=this.onAdd(a),p=this.getPosition(),v=a._controlCorners[p];return $e(h,"leaflet-control"),p.indexOf("bottom")!==-1?v.insertBefore(h,v.firstChild):v.appendChild(h),this._map.on("unload",this.remove,this),this;},remove:function(){return this._map?(xt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this;},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus();}}),Na=function(a){return new gi(a);};Xe.include({addControl:function(a){return a.addTo(this),this;},removeControl:function(a){return a.remove(),this;},_initControlPos:function(){var a=this._controlCorners={},h="leaflet-",p=this._controlContainer=Ke("div",h+"control-container",this._container);function v(M,F){var $=h+M+" "+h+F;a[M+F]=Ke("div",$,p);}v("top","left"),v("top","right"),v("bottom","left"),v("bottom","right");},_clearControlPos:function(){for(var a in this._controlCorners)xt(this._controlCorners[a]);xt(this._controlContainer),delete this._controlCorners,delete this._controlContainer;}});var S_=gi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,h,p,v){return p<v?-1:v<p?1:0;}},initialize:function(a,h,p){m(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var v in a)this._addLayer(a[v],v);for(v in h)this._addLayer(h[v],v,!0);},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container;},addTo:function(a){return gi.prototype.addTo.call(this,a),this._expandIfNotCollapsed();},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this);},addBaseLayer:function(a,h){return this._addLayer(a,h),this._map?this._update():this;},addOverlay:function(a,h){return this._addLayer(a,h,!0),this._map?this._update():this;},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var h=this._getLayer(s(a));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this;},expand:function(){$e(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?($e(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):At(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this;},collapse:function(){return At(this._container,"leaflet-control-layers-expanded"),this;},_initLayout:function(){var a="leaflet-control-layers",h=this._container=Ke("div",a),p=this.options.collapsed;h.setAttribute("aria-haspopup",!0),Da(h),zu(h);var v=this._section=Ke("section",a+"-list");p&&(this._map.on("click",this.collapse,this),Be(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var M=this._layersLink=Ke("a",a+"-toggle",h);M.href="#",M.title="Layers",M.setAttribute("role","button"),Be(M,{keydown:function(F){F.keyCode===13&&this._expandSafely();},click:function(F){Kt(F),this._expandSafely();}},this),p||this.expand(),this._baseLayersList=Ke("div",a+"-base",v),this._separator=Ke("div",a+"-separator",v),this._overlaysList=Ke("div",a+"-overlays",v),h.appendChild(v);},_getLayer:function(a){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&s(this._layers[h].layer)===a)return this._layers[h];},_addLayer:function(a,h,p){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:h,overlay:p}),this.options.sortLayers&&this._layers.sort(r(function(v,M){return this.options.sortFunction(v.layer,M.layer,v.name,M.name);},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed();},_update:function(){if(!this._container)return this;nc(this._baseLayersList),nc(this._overlaysList),this._layerControlInputs=[];var a,h,p,v,M=0;for(p=0;p<this._layers.length;p++)v=this._layers[p],this._addItem(v),h=h||v.overlay,a=a||!v.overlay,M+=v.overlay?0:1;return this.options.hideSingleBase&&(a=a&&M>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=h&&a?"":"none",this;},_onLayerChange:function(a){this._handlingClick||this._update();var h=this._getLayer(s(a.target)),p=h.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;p&&this._map.fire(p,h);},_createRadioElement:function(a,h){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(h?' checked="checked"':"")+"/>",v=document.createElement("div");return v.innerHTML=p,v.firstChild;},_addItem:function(a){var h=document.createElement("label"),p=this._map.hasLayer(a.layer),v;a.overlay?(v=document.createElement("input"),v.type="checkbox",v.className="leaflet-control-layers-selector",v.defaultChecked=p):v=this._createRadioElement("leaflet-base-layers_"+s(this),p),this._layerControlInputs.push(v),v.layerId=s(a.layer),Be(v,"click",this._onInputClick,this);var M=document.createElement("span");M.innerHTML=" "+a.name;var F=document.createElement("span");h.appendChild(F),F.appendChild(v),F.appendChild(M);var $=a.overlay?this._overlaysList:this._baseLayersList;return $.appendChild(h),this._checkDisabledLayers(),h;},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,h,p,v=[],M=[];this._handlingClick=!0;for(var F=a.length-1;F>=0;F--)h=a[F],p=this._getLayer(h.layerId).layer,h.checked?v.push(p):h.checked||M.push(p);for(F=0;F<M.length;F++)this._map.hasLayer(M[F])&&this._map.removeLayer(M[F]);for(F=0;F<v.length;F++)this._map.hasLayer(v[F])||this._map.addLayer(v[F]);this._handlingClick=!1,this._refocusOnMap();}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,h,p,v=this._map.getZoom(),M=a.length-1;M>=0;M--)h=a[M],p=this._getLayer(h.layerId).layer,h.disabled=p.options.minZoom!==void 0&&v<p.options.minZoom||p.options.maxZoom!==void 0&&v>p.options.maxZoom;},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this;},_expandSafely:function(){var a=this._section;this._preventClick=!0,Be(a,"click",Kt),this.expand();var h=this;setTimeout(function(){ft(a,"click",Kt),h._preventClick=!1;});}}),PP=function(a,h,p){return new S_(a,h,p);},$u=gi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var h="leaflet-control-zoom",p=Ke("div",h+" leaflet-bar"),v=this.options;return this._zoomInButton=this._createButton(v.zoomInText,v.zoomInTitle,h+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(v.zoomOutText,v.zoomOutTitle,h+"-out",p,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),p;},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this);},disable:function(){return this._disabled=!0,this._updateDisabled(),this;},enable:function(){return this._disabled=!1,this._updateDisabled(),this;},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1));},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1));},_createButton:function(a,h,p,v,M){var F=Ke("a",p,v);return F.innerHTML=a,F.href="#",F.title=h,F.setAttribute("role","button"),F.setAttribute("aria-label",h),Da(F),Be(F,"click",Po),Be(F,"click",M,this),Be(F,"click",this._refocusOnMap,this),F;},_updateDisabled:function(){var a=this._map,h="leaflet-disabled";At(this._zoomInButton,h),At(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&($e(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&($e(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"));}});Xe.mergeOptions({zoomControl:!0}),Xe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new $u(),this.addControl(this.zoomControl));});var wP=function(a){return new $u(a);},E_=gi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var h="leaflet-control-scale",p=Ke("div",h),v=this.options;return this._addScales(v,h+"-line",p),a.on(v.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),p;},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this);},_addScales:function(a,h,p){a.metric&&(this._mScale=Ke("div",h,p)),a.imperial&&(this._iScale=Ke("div",h,p));},_update:function(){var a=this._map,h=a.getSize().y/2,p=a.distance(a.containerPointToLatLng([0,h]),a.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(p);},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a);},_updateMetric:function(a){var h=this._getRoundNum(a),p=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,p,h/a);},_updateImperial:function(a){var h=a*3.2808399,p,v,M;h>5280?(p=h/5280,v=this._getRoundNum(p),this._updateScale(this._iScale,v+" mi",v/p)):(M=this._getRoundNum(h),this._updateScale(this._iScale,M+" ft",M/h));},_updateScale:function(a,h,p){a.style.width=Math.round(this.options.maxWidth*p)+"px",a.innerHTML=h;},_getRoundNum:function(a){var h=Math.pow(10,(Math.floor(a)+"").length-1),p=a/h;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,h*p;}}),MP=function(a){return new E_(a);},SP='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Uu=gi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Oe.inlineSvg?SP+" ":"")+"Leaflet</a>"},initialize:function(a){m(this,a),this._attributions={};},onAdd:function(a){a.attributionControl=this,this._container=Ke("div","leaflet-control-attribution"),Da(this._container);for(var h in a._layers)a._layers[h].getAttribution&&this.addAttribution(a._layers[h].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container;},onRemove:function(a){a.off("layeradd",this._addAttribution,this);},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution());},this));},setPrefix:function(a){return this.options.prefix=a,this._update(),this;},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this;},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this;},_update:function(){if(this._map){var a=[];for(var h in this._attributions)this._attributions[h]&&a.push(h);var p=[];this.options.prefix&&p.push(this.options.prefix),a.length&&p.push(a.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ');}}});Xe.mergeOptions({attributionControl:!0}),Xe.addInitHook(function(){this.options.attributionControl&&new Uu().addTo(this);});var EP=function(a){return new Uu(a);};gi.Layers=S_,gi.Zoom=$u,gi.Scale=E_,gi.Attribution=Uu,Na.layers=PP,Na.zoom=wP,Na.scale=MP,Na.attribution=EP;var Vi=ee.extend({initialize:function(a){this._map=a;},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this);},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this;},enabled:function(){return!!this._enabled;}});Vi.addTo=function(a,h){return a.addHandler(h,this),this;};var OP={Events:oe},O_=Oe.touch?"touchstart mousedown":"mousedown",jr=re.extend({options:{clickTolerance:3},initialize:function(a,h,p,v){m(this,v),this._element=a,this._dragStartTarget=h||a,this._preventOutline=p;},enable:function(){this._enabled||(Be(this._dragStartTarget,O_,this._onDown,this),this._enabled=!0);},disable:function(){this._enabled&&(jr._dragging===this&&this.finishDrag(!0),ft(this._dragStartTarget,O_,this._onDown,this),this._enabled=!1,this._moved=!1);},_onDown:function(a){if(this._enabled&&(this._moved=!1,!Tu(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){jr._dragging===this&&this.finishDrag();return;}if(!(jr._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(jr._dragging=this,this._preventOutline&&Lu(this._element),Au(),Fa(),!this._moving)){this.fire("down");var h=a.touches?a.touches[0]:a,p=C_(this._element);this._startPoint=new A(h.clientX,h.clientY),this._startPos=bo(this._element),this._parentScale=Du(p);var v=a.type==="mousedown";Be(document,v?"mousemove":"touchmove",this._onMove,this),Be(document,v?"mouseup":"touchend touchcancel",this._onUp,this);}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return;}var h=a.touches&&a.touches.length===1?a.touches[0]:a,p=new A(h.clientX,h.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,Kt(a),this._moved||(this.fire("dragstart"),this._moved=!0,$e(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),$e(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=a,this._updatePosition());}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),Lt(this._element,this._newPos),this.fire("drag",a);},_onUp:function(){this._enabled&&this.finishDrag();},finishDrag:function(a){At(document.body,"leaflet-dragging"),this._lastTarget&&(At(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ft(document,"mousemove touchmove",this._onMove,this),ft(document,"mouseup touchend touchcancel",this._onUp,this),Fu(),Ra();var h=this._moved&&this._moving;this._moving=!1,jr._dragging=!1,h&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)});}});function T_(a,h,p){var v,M=[1,4,2,8],F,$,Q,ie,de,ye,Re,Ge;for(F=0,ye=a.length;F<ye;F++)a[F]._code=wo(a[F],h);for(Q=0;Q<4;Q++){for(Re=M[Q],v=[],F=0,ye=a.length,$=ye-1;F<ye;$=F++)ie=a[F],de=a[$],ie._code&Re?de._code&Re||(Ge=ac(de,ie,Re,h,p),Ge._code=wo(Ge,h),v.push(Ge)):(de._code&Re&&(Ge=ac(de,ie,Re,h,p),Ge._code=wo(Ge,h),v.push(Ge)),v.push(ie));a=v;}return a;}function k_(a,h){var p,v,M,F,$,Q,ie,de,ye;if(!a||a.length===0)throw new Error("latlngs not passed");ti(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Re=fe([0,0]),Ge=pe(a),dn=Ge.getNorthWest().distanceTo(Ge.getSouthWest())*Ge.getNorthEast().distanceTo(Ge.getNorthWest());dn<1700&&(Re=Hu(a));var Yt=a.length,ni=[];for(p=0;p<Yt;p++){var Sn=fe(a[p]);ni.push(h.project(fe([Sn.lat-Re.lat,Sn.lng-Re.lng])));}for(Q=ie=de=0,p=0,v=Yt-1;p<Yt;v=p++)M=ni[p],F=ni[v],$=M.y*F.x-F.y*M.x,ie+=(M.x+F.x)*$,de+=(M.y+F.y)*$,Q+=$*3;Q===0?ye=ni[0]:ye=[ie/Q,de/Q];var Ls=h.unproject(O(ye));return fe([Ls.lat+Re.lat,Ls.lng+Re.lng]);}function Hu(a){for(var h=0,p=0,v=0,M=0;M<a.length;M++){var F=fe(a[M]);h+=F.lat,p+=F.lng,v++;}return fe([h/v,p/v]);}var TP={__proto__:null,clipPolygon:T_,polygonCenter:k_,centroid:Hu};function I_(a,h){if(!h||!a.length)return a.slice();var p=h*h;return a=AP(a,p),a=IP(a,p),a;}function A_(a,h,p){return Math.sqrt(Ba(a,h,p,!0));}function kP(a,h,p){return Ba(a,h,p);}function IP(a,h){var p=a.length,v=typeof Uint8Array<"u"?Uint8Array:Array,M=new v(p);M[0]=M[p-1]=1,Wu(a,M,h,0,p-1);var F,$=[];for(F=0;F<p;F++)M[F]&&$.push(a[F]);return $;}function Wu(a,h,p,v,M){var F=0,$,Q,ie;for(Q=v+1;Q<=M-1;Q++)ie=Ba(a[Q],a[v],a[M],!0),ie>F&&($=Q,F=ie);F>p&&(h[$]=1,Wu(a,h,p,v,$),Wu(a,h,p,$,M));}function AP(a,h){for(var p=[a[0]],v=1,M=0,F=a.length;v<F;v++)FP(a[v],a[M])>h&&(p.push(a[v]),M=v);return M<F-1&&p.push(a[F-1]),p;}var F_;function R_(a,h,p,v,M){var F=v?F_:wo(a,p),$=wo(h,p),Q,ie,de;for(F_=$;;){if(!(F|$))return[a,h];if(F&$)return!1;Q=F||$,ie=ac(a,h,Q,p,M),de=wo(ie,p),Q===F?(a=ie,F=de):(h=ie,$=de);}}function ac(a,h,p,v,M){var F=h.x-a.x,$=h.y-a.y,Q=v.min,ie=v.max,de,ye;return p&8?(de=a.x+F*(ie.y-a.y)/$,ye=ie.y):p&4?(de=a.x+F*(Q.y-a.y)/$,ye=Q.y):p&2?(de=ie.x,ye=a.y+$*(ie.x-a.x)/F):p&1&&(de=Q.x,ye=a.y+$*(Q.x-a.x)/F),new A(de,ye,M);}function wo(a,h){var p=0;return a.x<h.min.x?p|=1:a.x>h.max.x&&(p|=2),a.y<h.min.y?p|=4:a.y>h.max.y&&(p|=8),p;}function FP(a,h){var p=h.x-a.x,v=h.y-a.y;return p*p+v*v;}function Ba(a,h,p,v){var M=h.x,F=h.y,$=p.x-M,Q=p.y-F,ie=$*$+Q*Q,de;return ie>0&&(de=((a.x-M)*$+(a.y-F)*Q)/ie,de>1?(M=p.x,F=p.y):de>0&&(M+=$*de,F+=Q*de)),$=a.x-M,Q=a.y-F,v?$*$+Q*Q:new A(M,F);}function ti(a){return!C(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u";}function L_(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ti(a);}function D_(a,h){var p,v,M,F,$,Q,ie,de;if(!a||a.length===0)throw new Error("latlngs not passed");ti(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var ye=fe([0,0]),Re=pe(a),Ge=Re.getNorthWest().distanceTo(Re.getSouthWest())*Re.getNorthEast().distanceTo(Re.getNorthWest());Ge<1700&&(ye=Hu(a));var dn=a.length,Yt=[];for(p=0;p<dn;p++){var ni=fe(a[p]);Yt.push(h.project(fe([ni.lat-ye.lat,ni.lng-ye.lng])));}for(p=0,v=0;p<dn-1;p++)v+=Yt[p].distanceTo(Yt[p+1])/2;if(v===0)de=Yt[0];else for(p=0,F=0;p<dn-1;p++)if($=Yt[p],Q=Yt[p+1],M=$.distanceTo(Q),F+=M,F>v){ie=(F-v)/M,de=[Q.x-ie*(Q.x-$.x),Q.y-ie*(Q.y-$.y)];break;}var Sn=h.unproject(O(de));return fe([Sn.lat+ye.lat,Sn.lng+ye.lng]);}var RP={__proto__:null,simplify:I_,pointToSegmentDistance:A_,closestPointOnSegment:kP,clipSegment:R_,_getEdgeIntersection:ac,_getBitCode:wo,_sqClosestPointOnSegment:Ba,isFlat:ti,_flat:L_,polylineCenter:D_},Gu={project:function(a){return new A(a.lng,a.lat);},unproject:function(a){return new me(a.y,a.x);},bounds:new k([-180,-90],[180,90])},Yu={R:6378137,R_MINOR:6356752314245179e-9,bounds:new k([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var h=Math.PI/180,p=this.R,v=a.lat*h,M=this.R_MINOR/p,F=Math.sqrt(1-M*M),$=F*Math.sin(v),Q=Math.tan(Math.PI/4-v/2)/Math.pow((1-$)/(1+$),F/2);return v=-p*Math.log(Math.max(Q,1e-10)),new A(a.lng*h*p,v);},unproject:function(a){for(var h=180/Math.PI,p=this.R,v=this.R_MINOR/p,M=Math.sqrt(1-v*v),F=Math.exp(-a.y/p),$=Math.PI/2-2*Math.atan(F),Q=0,ie=.1,de;Q<15&&Math.abs(ie)>1e-7;Q++)de=M*Math.sin($),de=Math.pow((1-de)/(1+de),M/2),ie=Math.PI/2-2*Math.atan(F*de)-$,$+=ie;return new me($*h,a.x*h/p);}},LP={__proto__:null,LonLat:Gu,Mercator:Yu,SphericalMercator:bt},DP=t({},Te,{code:"EPSG:3395",projection:Yu,transformation:function(){var a=.5/(Math.PI*Yu.R);return We(a,.5,-a,.5);}()}),N_=t({},Te,{code:"EPSG:4326",projection:Gu,transformation:We(1/180,1,-1/180,.5)}),NP=t({},Fe,{projection:Gu,transformation:We(1,0,-1,0),scale:function(a){return Math.pow(2,a);},zoom:function(a){return Math.log(a)/Math.LN2;},distance:function(a,h){var p=h.lng-a.lng,v=h.lat-a.lat;return Math.sqrt(p*p+v*v);},infinite:!0});Fe.Earth=Te,Fe.EPSG3395=DP,Fe.EPSG3857=_t,Fe.EPSG900913=Rt,Fe.EPSG4326=N_,Fe.Simple=NP;var mi=re.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this;},remove:function(){return this.removeFrom(this._map||this._mapToAdd);},removeFrom:function(a){return a&&a.removeLayer(this),this;},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane);},addInteractiveTarget:function(a){return this._map._targets[s(a)]=this,this;},removeInteractiveTarget:function(a){return delete this._map._targets[s(a)],this;},getAttribution:function(){return this.options.attribution;},_layerAdd:function(a){var h=a.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var p=this.getEvents();h.on(p,this),this.once("remove",function(){h.off(p,this);},this);}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this});}}});Xe.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var h=s(a);return this._layers[h]?this:(this._layers[h]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this);},removeLayer:function(a){var h=s(a);return this._layers[h]?(this._loaded&&a.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this;},hasLayer:function(a){return s(a)in this._layers;},eachLayer:function(a,h){for(var p in this._layers)a.call(h,this._layers[p]);return this;},_addLayers:function(a){a=a?C(a)?a:[a]:[];for(var h=0,p=a.length;h<p;h++)this.addLayer(a[h]);},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[s(a)]=a,this._updateZoomLevels());},_removeZoomLimit:function(a){var h=s(a);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels());},_updateZoomLevels:function(){var a=1/0,h=-1/0,p=this._getZoomSpan();for(var v in this._zoomBoundLayers){var M=this._zoomBoundLayers[v].options;a=M.minZoom===void 0?a:Math.min(a,M.minZoom),h=M.maxZoom===void 0?h:Math.max(h,M.maxZoom);}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=a===1/0?void 0:a,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom);}});var ks=mi.extend({initialize:function(a,h){m(this,h),this._layers={};var p,v;if(a)for(p=0,v=a.length;p<v;p++)this.addLayer(a[p]);},addLayer:function(a){var h=this.getLayerId(a);return this._layers[h]=a,this._map&&this._map.addLayer(a),this;},removeLayer:function(a){var h=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this;},hasLayer:function(a){var h=typeof a=="number"?a:this.getLayerId(a);return h in this._layers;},clearLayers:function(){return this.eachLayer(this.removeLayer,this);},invoke:function(a){var h=Array.prototype.slice.call(arguments,1),p,v;for(p in this._layers)v=this._layers[p],v[a]&&v[a].apply(v,h);return this;},onAdd:function(a){this.eachLayer(a.addLayer,a);},onRemove:function(a){this.eachLayer(a.removeLayer,a);},eachLayer:function(a,h){for(var p in this._layers)a.call(h,this._layers[p]);return this;},getLayer:function(a){return this._layers[a];},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a;},setZIndex:function(a){return this.invoke("setZIndex",a);},getLayerId:function(a){return s(a);}}),BP=function(a,h){return new ks(a,h);},dr=ks.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),ks.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}));},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),ks.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this;},setStyle:function(a){return this.invoke("setStyle",a);},bringToFront:function(){return this.invoke("bringToFront");},bringToBack:function(){return this.invoke("bringToBack");},getBounds:function(){var a=new U();for(var h in this._layers){var p=this._layers[h];a.extend(p.getBounds?p.getBounds():p.getLatLng());}return a;}}),VP=function(a,h){return new dr(a,h);},Is=ee.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){m(this,a);},createIcon:function(a){return this._createIcon("icon",a);},createShadow:function(a){return this._createIcon("shadow",a);},_createIcon:function(a,h){var p=this._getIconUrl(a);if(!p){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null;}var v=this._createImg(p,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(v,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),v;},_setIconStyles:function(a,h){var p=this.options,v=p[h+"Size"];typeof v=="number"&&(v=[v,v]);var M=O(v),F=O(h==="shadow"&&p.shadowAnchor||p.iconAnchor||M&&M.divideBy(2,!0));a.className="leaflet-marker-"+h+" "+(p.className||""),F&&(a.style.marginLeft=-F.x+"px",a.style.marginTop=-F.y+"px"),M&&(a.style.width=M.x+"px",a.style.height=M.y+"px");},_createImg:function(a,h){return h=h||document.createElement("img"),h.src=a,h;},_getIconUrl:function(a){return Oe.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"];}});function zP(a){return new Is(a);}var Va=Is.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof Va.imagePath!="string"&&(Va.imagePath=this._detectIconPath()),(this.options.imagePath||Va.imagePath)+Is.prototype._getIconUrl.call(this,a);},_stripUrl:function(a){var h=function(p,v,M){var F=v.exec(p);return F&&F[M];};return a=h(a,/^url\((['"])?(.+)\1\)$/,2),a&&h(a,/^(.*)marker-icon\.png$/,1);},_detectIconPath:function(){var a=Ke("div","leaflet-default-icon-path",document.body),h=Aa(a,"background-image")||Aa(a,"backgroundImage");if(document.body.removeChild(a),h=this._stripUrl(h),h)return h;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):"";}}),B_=Vi.extend({initialize:function(a){this._marker=a;},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new jr(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),$e(a,"leaflet-marker-draggable");},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&At(this._marker._icon,"leaflet-marker-draggable");},moved:function(){return this._draggable&&this._draggable._moved;},_adjustPan:function(a){var h=this._marker,p=h._map,v=this._marker.options.autoPanSpeed,M=this._marker.options.autoPanPadding,F=bo(h._icon),$=p.getPixelBounds(),Q=p.getPixelOrigin(),ie=H($.min._subtract(Q).add(M),$.max._subtract(Q).subtract(M));if(!ie.contains(F)){var de=O((Math.max(ie.max.x,F.x)-ie.max.x)/($.max.x-ie.max.x)-(Math.min(ie.min.x,F.x)-ie.min.x)/($.min.x-ie.min.x),(Math.max(ie.max.y,F.y)-ie.max.y)/($.max.y-ie.max.y)-(Math.min(ie.min.y,F.y)-ie.min.y)/($.min.y-ie.min.y)).multiplyBy(v);p.panBy(de,{animate:!1}),this._draggable._newPos._add(de),this._draggable._startPos._add(de),Lt(h._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=Y(this._adjustPan.bind(this,a));}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart");},_onPreDrag:function(a){this._marker.options.autoPan&&(le(this._panRequest),this._panRequest=Y(this._adjustPan.bind(this,a)));},_onDrag:function(a){var h=this._marker,p=h._shadow,v=bo(h._icon),M=h._map.layerPointToLatLng(v);p&&Lt(p,v),h._latlng=M,a.latlng=M,a.oldLatLng=this._oldLatLng,h.fire("move",a).fire("drag",a);},_onDragEnd:function(a){le(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a);}}),lc=mi.extend({options:{icon:new Va(),interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,h){m(this,h),this._latlng=fe(a);},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update();},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow();},getEvents:function(){return{zoom:this.update,viewreset:this.update};},getLatLng:function(){return this._latlng;},setLatLng:function(a){var h=this._latlng;return this._latlng=fe(a),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng});},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update();},getIcon:function(){return this.options.icon;},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this;},getElement:function(){return this._icon;},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a);}return this;},_initIcon:function(){var a=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=a.icon.createIcon(this._icon),v=!1;p!==this._icon&&(this._icon&&this._removeIcon(),v=!0,a.title&&(p.title=a.title),p.tagName==="IMG"&&(p.alt=a.alt||"")),$e(p,h),a.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Be(p,"focus",this._panOnFocus,this);var M=a.icon.createShadow(this._shadow),F=!1;M!==this._shadow&&(this._removeShadow(),F=!0),M&&($e(M,h),M.alt=""),this._shadow=M,a.opacity<1&&this._updateOpacity(),v&&this.getPane().appendChild(this._icon),this._initInteraction(),M&&F&&this.getPane(a.shadowPane).appendChild(this._shadow);},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ft(this._icon,"focus",this._panOnFocus,this),xt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null;},_removeShadow:function(){this._shadow&&xt(this._shadow),this._shadow=null;},_setPos:function(a){this._icon&&Lt(this._icon,a),this._shadow&&Lt(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex();},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a);},_animateZoom:function(a){var h=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(h);},_initInteraction:function(){if(this.options.interactive&&($e(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),B_)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new B_(this),a&&this.dragging.enable();}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this;},_updateOpacity:function(){var a=this.options.opacity;this._icon&&ei(this._icon,a),this._shadow&&ei(this._shadow,a);},_bringToFront:function(){this._updateZIndex(this.options.riseOffset);},_resetZIndex:function(){this._updateZIndex(0);},_panOnFocus:function(){var a=this._map;if(a){var h=this.options.icon.options,p=h.iconSize?O(h.iconSize):O(0,0),v=h.iconAnchor?O(h.iconAnchor):O(0,0);a.panInside(this._latlng,{paddingTopLeft:v,paddingBottomRight:p.subtract(v)});}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor;},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor;}});function jP(a,h){return new lc(a,h);}var $r=mi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this);},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this);},onRemove:function(){this._renderer._removePath(this);},redraw:function(){return this._map&&this._renderer._updatePath(this),this;},setStyle:function(a){return m(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this;},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this;},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this;},getElement:function(){return this._path;},_reset:function(){this._project(),this._update();},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0);}}),cc=$r.extend({options:{fill:!0,radius:10},initialize:function(a,h){m(this,h),this._latlng=fe(a),this._radius=this.options.radius;},setLatLng:function(a){var h=this._latlng;return this._latlng=fe(a),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng});},getLatLng:function(){return this._latlng;},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw();},getRadius:function(){return this._radius;},setStyle:function(a){var h=a&&a.radius||this._radius;return $r.prototype.setStyle.call(this,a),this.setRadius(h),this;},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds();},_updateBounds:function(){var a=this._radius,h=this._radiusY||a,p=this._clickTolerance(),v=[a+p,h+p];this._pxBounds=new k(this._point.subtract(v),this._point.add(v));},_update:function(){this._map&&this._updatePath();},_updatePath:function(){this._renderer._updateCircle(this);},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds);},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance();}});function $P(a,h){return new cc(a,h);}var Xu=cc.extend({initialize:function(a,h,p){if(typeof h=="number"&&(h=t({},p,{radius:h})),m(this,h),this._latlng=fe(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius;},setRadius:function(a){return this._mRadius=a,this.redraw();},getRadius:function(){return this._mRadius;},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new U(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)));},setStyle:$r.prototype.setStyle,_project:function(){var a=this._latlng.lng,h=this._latlng.lat,p=this._map,v=p.options.crs;if(v.distance===Te.distance){var M=Math.PI/180,F=this._mRadius/Te.R/M,$=p.project([h+F,a]),Q=p.project([h-F,a]),ie=$.add(Q).divideBy(2),de=p.unproject(ie).lat,ye=Math.acos((Math.cos(F*M)-Math.sin(h*M)*Math.sin(de*M))/(Math.cos(h*M)*Math.cos(de*M)))/M;(isNaN(ye)||ye===0)&&(ye=F/Math.cos(Math.PI/180*h)),this._point=ie.subtract(p.getPixelOrigin()),this._radius=isNaN(ye)?0:ie.x-p.project([de,a-ye]).x,this._radiusY=ie.y-$.y;}else{var Re=v.unproject(v.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(Re).x;}this._updateBounds();}});function UP(a,h,p){return new Xu(a,h,p);}var ur=$r.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,h){m(this,h),this._setLatLngs(a);},getLatLngs:function(){return this._latlngs;},setLatLngs:function(a){return this._setLatLngs(a),this.redraw();},isEmpty:function(){return!this._latlngs.length;},closestLayerPoint:function(a){for(var h=1/0,p=null,v=Ba,M,F,$=0,Q=this._parts.length;$<Q;$++)for(var ie=this._parts[$],de=1,ye=ie.length;de<ye;de++){M=ie[de-1],F=ie[de];var Re=v(a,M,F,!0);Re<h&&(h=Re,p=v(a,M,F));}return p&&(p.distance=Math.sqrt(h)),p;},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return D_(this._defaultShape(),this._map.options.crs);},getBounds:function(){return this._bounds;},addLatLng:function(a,h){return h=h||this._defaultShape(),a=fe(a),h.push(a),this._bounds.extend(a),this.redraw();},_setLatLngs:function(a){this._bounds=new U(),this._latlngs=this._convertLatLngs(a);},_defaultShape:function(){return ti(this._latlngs)?this._latlngs:this._latlngs[0];},_convertLatLngs:function(a){for(var h=[],p=ti(a),v=0,M=a.length;v<M;v++)p?(h[v]=fe(a[v]),this._bounds.extend(h[v])):h[v]=this._convertLatLngs(a[v]);return h;},_project:function(){var a=new k();this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds());},_updateBounds:function(){var a=this._clickTolerance(),h=new A(a,a);this._rawPxBounds&&(this._pxBounds=new k([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]));},_projectLatlngs:function(a,h,p){var v=a[0]instanceof me,M=a.length,F,$;if(v){for($=[],F=0;F<M;F++)$[F]=this._map.latLngToLayerPoint(a[F]),p.extend($[F]);h.push($);}else for(F=0;F<M;F++)this._projectLatlngs(a[F],h,p);},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return;}var h=this._parts,p,v,M,F,$,Q,ie;for(p=0,M=0,F=this._rings.length;p<F;p++)for(ie=this._rings[p],v=0,$=ie.length;v<$-1;v++)Q=R_(ie[v],ie[v+1],a,v,!0),Q&&(h[M]=h[M]||[],h[M].push(Q[0]),(Q[1]!==ie[v+1]||v===$-2)&&(h[M].push(Q[1]),M++));}},_simplifyPoints:function(){for(var a=this._parts,h=this.options.smoothFactor,p=0,v=a.length;p<v;p++)a[p]=I_(a[p],h);},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath());},_updatePath:function(){this._renderer._updatePoly(this);},_containsPoint:function(a,h){var p,v,M,F,$,Q,ie=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(p=0,F=this._parts.length;p<F;p++)for(Q=this._parts[p],v=0,$=Q.length,M=$-1;v<$;M=v++)if(!(!h&&v===0)&&A_(a,Q[M],Q[v])<=ie)return!0;return!1;}});function HP(a,h){return new ur(a,h);}ur._flat=L_;var As=ur.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length;},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return k_(this._defaultShape(),this._map.options.crs);},_convertLatLngs:function(a){var h=ur.prototype._convertLatLngs.call(this,a),p=h.length;return p>=2&&h[0]instanceof me&&h[0].equals(h[p-1])&&h.pop(),h;},_setLatLngs:function(a){ur.prototype._setLatLngs.call(this,a),ti(this._latlngs)&&(this._latlngs=[this._latlngs]);},_defaultShape:function(){return ti(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0];},_clipPoints:function(){var a=this._renderer._bounds,h=this.options.weight,p=new A(h,h);if(a=new k(a.min.subtract(p),a.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return;}for(var v=0,M=this._rings.length,F;v<M;v++)F=T_(this._rings[v],a,!0),F.length&&this._parts.push(F);}},_updatePath:function(){this._renderer._updatePoly(this,!0);},_containsPoint:function(a){var h=!1,p,v,M,F,$,Q,ie,de;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(F=0,ie=this._parts.length;F<ie;F++)for(p=this._parts[F],$=0,de=p.length,Q=de-1;$<de;Q=$++)v=p[$],M=p[Q],v.y>a.y!=M.y>a.y&&a.x<(M.x-v.x)*(a.y-v.y)/(M.y-v.y)+v.x&&(h=!h);return h||ur.prototype._containsPoint.call(this,a,!0);}});function WP(a,h){return new As(a,h);}var pr=dr.extend({initialize:function(a,h){m(this,h),this._layers={},a&&this.addData(a);},addData:function(a){var h=C(a)?a:a.features,p,v,M;if(h){for(p=0,v=h.length;p<v;p++)M=h[p],(M.geometries||M.geometry||M.features||M.coordinates)&&this.addData(M);return this;}var F=this.options;if(F.filter&&!F.filter(a))return this;var $=hc(a,F);return $?($.feature=pc(a),$.defaultOptions=$.options,this.resetStyle($),F.onEachFeature&&F.onEachFeature(a,$),this.addLayer($)):this;},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=t({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this);},setStyle:function(a){return this.eachLayer(function(h){this._setLayerStyle(h,a);},this);},_setLayerStyle:function(a,h){a.setStyle&&(typeof h=="function"&&(h=h(a.feature)),a.setStyle(h));}});function hc(a,h){var p=a.type==="Feature"?a.geometry:a,v=p?p.coordinates:null,M=[],F=h&&h.pointToLayer,$=h&&h.coordsToLatLng||qu,Q,ie,de,ye;if(!v&&!p)return null;switch(p.type){case"Point":return Q=$(v),V_(F,a,Q,h);case"MultiPoint":for(de=0,ye=v.length;de<ye;de++)Q=$(v[de]),M.push(V_(F,a,Q,h));return new dr(M);case"LineString":case"MultiLineString":return ie=dc(v,p.type==="LineString"?0:1,$),new ur(ie,h);case"Polygon":case"MultiPolygon":return ie=dc(v,p.type==="Polygon"?1:2,$),new As(ie,h);case"GeometryCollection":for(de=0,ye=p.geometries.length;de<ye;de++){var Re=hc({geometry:p.geometries[de],type:"Feature",properties:a.properties},h);Re&&M.push(Re);}return new dr(M);case"FeatureCollection":for(de=0,ye=p.features.length;de<ye;de++){var Ge=hc(p.features[de],h);Ge&&M.push(Ge);}return new dr(M);default:throw new Error("Invalid GeoJSON object.");}}function V_(a,h,p,v){return a?a(h,p):new lc(p,v&&v.markersInheritOptions&&v);}function qu(a){return new me(a[1],a[0],a[2]);}function dc(a,h,p){for(var v=[],M=0,F=a.length,$;M<F;M++)$=h?dc(a[M],h-1,p):(p||qu)(a[M]),v.push($);return v;}function Zu(a,h){return a=fe(a),a.alt!==void 0?[u(a.lng,h),u(a.lat,h),u(a.alt,h)]:[u(a.lng,h),u(a.lat,h)];}function uc(a,h,p,v){for(var M=[],F=0,$=a.length;F<$;F++)M.push(h?uc(a[F],ti(a[F])?0:h-1,p,v):Zu(a[F],v));return!h&&p&&M.length>0&&M.push(M[0].slice()),M;}function Fs(a,h){return a.feature?t({},a.feature,{geometry:h}):pc(h);}function pc(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a};}var Ku={toGeoJSON:function(a){return Fs(this,{type:"Point",coordinates:Zu(this.getLatLng(),a)});}};lc.include(Ku),Xu.include(Ku),cc.include(Ku),ur.include({toGeoJSON:function(a){var h=!ti(this._latlngs),p=uc(this._latlngs,h?1:0,!1,a);return Fs(this,{type:(h?"Multi":"")+"LineString",coordinates:p});}}),As.include({toGeoJSON:function(a){var h=!ti(this._latlngs),p=h&&!ti(this._latlngs[0]),v=uc(this._latlngs,p?2:h?1:0,!0,a);return h||(v=[v]),Fs(this,{type:(p?"Multi":"")+"Polygon",coordinates:v});}}),ks.include({toMultiPoint:function(a){var h=[];return this.eachLayer(function(p){h.push(p.toGeoJSON(a).geometry.coordinates);}),Fs(this,{type:"MultiPoint",coordinates:h});},toGeoJSON:function(a){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(a);var p=h==="GeometryCollection",v=[];return this.eachLayer(function(M){if(M.toGeoJSON){var F=M.toGeoJSON(a);if(p)v.push(F.geometry);else{var $=pc(F);$.type==="FeatureCollection"?v.push.apply(v,$.features):v.push($);}}}),p?Fs(this,{geometries:v,type:"GeometryCollection"}):{type:"FeatureCollection",features:v};}});function z_(a,h){return new pr(a,h);}var GP=z_,fc=mi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,h,p){this._url=a,this._bounds=pe(h),m(this,p);},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&($e(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset();},onRemove:function(){xt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image);},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this;},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this;},bringToFront:function(){return this._map&&Os(this._image),this;},bringToBack:function(){return this._map&&Ts(this._image),this;},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this;},setBounds:function(a){return this._bounds=pe(a),this._map&&this._reset(),this;},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a;},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this;},getBounds:function(){return this._bounds;},getElement:function(){return this._image;},_initImage:function(){var a=this._url.tagName==="IMG",h=this._image=a?this._url:Ke("img");if($e(h,"leaflet-image-layer"),this._zoomAnimated&&$e(h,"leaflet-zoom-animated"),this.options.className&&$e(h,this.options.className),h.onselectstart=d,h.onmousemove=d,h.onload=r(this.fire,this,"load"),h.onerror=r(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=h.src;return;}h.src=this._url,h.alt=this.options.alt;},_animateZoom:function(a){var h=this._map.getZoomScale(a.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;Co(this._image,p,h);},_reset:function(){var a=this._image,h=new k(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=h.getSize();Lt(a,h.min),a.style.width=p.x+"px",a.style.height=p.y+"px";},_updateOpacity:function(){ei(this._image,this.options.opacity);},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex);},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a);},getCenter:function(){return this._bounds.getCenter();}}),YP=function(a,h,p){return new fc(a,h,p);},j_=fc.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",h=this._image=a?this._url:Ke("video");if($e(h,"leaflet-image-layer"),this._zoomAnimated&&$e(h,"leaflet-zoom-animated"),this.options.className&&$e(h,this.options.className),h.onselectstart=d,h.onmousemove=d,h.onloadeddata=r(this.fire,this,"load"),a){for(var p=h.getElementsByTagName("source"),v=[],M=0;M<p.length;M++)v.push(p[M].src);this._url=p.length>0?v:[h.src];return;}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var F=0;F<this._url.length;F++){var $=Ke("source");$.src=this._url[F],h.appendChild($);}}});function XP(a,h,p){return new j_(a,h,p);}var $_=fc.extend({_initImage:function(){var a=this._image=this._url;$e(a,"leaflet-image-layer"),this._zoomAnimated&&$e(a,"leaflet-zoom-animated"),this.options.className&&$e(a,this.options.className),a.onselectstart=d,a.onmousemove=d;}});function qP(a,h,p){return new $_(a,h,p);}var zi=mi.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,h){a&&(a instanceof me||C(a))?(this._latlng=fe(a),m(this,h)):(m(this,a),this._source=h),this.options.content&&(this._content=this.options.content);},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this;},close:function(){return this._map&&this._map.removeLayer(this),this;},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this;},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&ei(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&ei(this._container,1),this.bringToFront(),this.options.interactive&&($e(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container));},onRemove:function(a){a._fadeAnimated?(ei(this._container,0),this._removeTimeout=setTimeout(r(xt,void 0,this._container),200)):xt(this._container),this.options.interactive&&(At(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container));},getLatLng:function(){return this._latlng;},setLatLng:function(a){return this._latlng=fe(a),this._map&&(this._updatePosition(),this._adjustPan()),this;},getContent:function(){return this._content;},setContent:function(a){return this._content=a,this.update(),this;},getElement:function(){return this._container;},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan());},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a;},isOpen:function(){return!!this._map&&this._map.hasLayer(this);},bringToFront:function(){return this._map&&Os(this._container),this;},bringToBack:function(){return this._map&&Ts(this._container),this;},_prepareOpen:function(a){var h=this._source;if(!h._map)return!1;if(h instanceof dr){h=null;var p=this._source._layers;for(var v in p)if(p[v]._map){h=p[v];break;}if(!h)return!1;this._source=h;}if(!a)if(h.getCenter)a=h.getCenter();else if(h.getLatLng)a=h.getLatLng();else if(h.getBounds)a=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0;},_updateContent:function(){if(this._content){var a=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")a.innerHTML=h;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(h);}this.fire("contentupdate");}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),h=O(this.options.offset),p=this._getAnchor();this._zoomAnimated?Lt(this._container,a.add(p)):h=h.add(a).add(p);var v=this._containerBottom=-h.y,M=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=v+"px",this._container.style.left=M+"px";}},_getAnchor:function(){return[0,0];}});Xe.include({_initOverlay:function(a,h,p,v){var M=h;return M instanceof a||(M=new a(v).setContent(h)),p&&M.setLatLng(p),M;}}),mi.include({_initOverlay:function(a,h,p,v){var M=p;return M instanceof a?(m(M,v),M._source=this):(M=h&&!v?h:new a(v,this),M.setContent(p)),M;}});var gc=zi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,zi.prototype.openOn.call(this,a);},onAdd:function(a){zi.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof $r||this._source.on("preclick",xo));},onRemove:function(a){zi.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof $r||this._source.off("preclick",xo));},getEvents:function(){var a=zi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a;},_initLayout:function(){var a="leaflet-popup",h=this._container=Ke("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=Ke("div",a+"-content-wrapper",h);if(this._contentNode=Ke("div",a+"-content",p),Da(h),zu(this._contentNode),Be(h,"contextmenu",xo),this._tipContainer=Ke("div",a+"-tip-container",h),this._tip=Ke("div",a+"-tip",this._tipContainer),this.options.closeButton){var v=this._closeButton=Ke("a",a+"-close-button",h);v.setAttribute("role","button"),v.setAttribute("aria-label","Close popup"),v.href="#close",v.innerHTML='<span aria-hidden="true">&#215;</span>',Be(v,"click",function(M){Kt(M),this.close();},this);}},_updateLayout:function(){var a=this._contentNode,h=a.style;h.width="",h.whiteSpace="nowrap";var p=a.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),h.width=p+1+"px",h.whiteSpace="",h.height="";var v=a.offsetHeight,M=this.options.maxHeight,F="leaflet-popup-scrolled";M&&v>M?(h.height=M+"px",$e(a,F)):At(a,F),this._containerWidth=this._container.offsetWidth;},_animateZoom:function(a){var h=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),p=this._getAnchor();Lt(this._container,h.add(p));},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return;}var a=this._map,h=parseInt(Aa(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+h,v=this._containerWidth,M=new A(this._containerLeft,-p-this._containerBottom);M._add(bo(this._container));var F=a.layerPointToContainerPoint(M),$=O(this.options.autoPanPadding),Q=O(this.options.autoPanPaddingTopLeft||$),ie=O(this.options.autoPanPaddingBottomRight||$),de=a.getSize(),ye=0,Re=0;F.x+v+ie.x>de.x&&(ye=F.x+v-de.x+ie.x),F.x-ye-Q.x<0&&(ye=F.x-Q.x),F.y+p+ie.y>de.y&&(Re=F.y+p-de.y+ie.y),F.y-Re-Q.y<0&&(Re=F.y-Q.y),(ye||Re)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([ye,Re]));}},_getAnchor:function(){return O(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0]);}}),ZP=function(a,h){return new gc(a,h);};Xe.mergeOptions({closePopupOnClick:!0}),Xe.include({openPopup:function(a,h,p){return this._initOverlay(gc,a,h,p).openOn(this),this;},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this;}}),mi.include({bindPopup:function(a,h){return this._popup=this._initOverlay(gc,this._popup,a,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this;},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this;},openPopup:function(a){return this._popup&&(this instanceof dr||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this;},closePopup:function(){return this._popup&&this._popup.close(),this;},togglePopup:function(){return this._popup&&this._popup.toggle(this),this;},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1;},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this;},getPopup:function(){return this._popup;},_openPopup:function(a){if(!(!this._popup||!this._map)){Po(a);var h=a.layer||a.target;if(this._popup._source===h&&!(h instanceof $r)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return;}this._popup._source=h,this.openPopup(a.latlng);}},_movePopup:function(a){this._popup.setLatLng(a.latlng);},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a);}});var mc=zi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){zi.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0));},onRemove:function(a){zi.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0));},getEvents:function(){var a=zi.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a;},_initLayout:function(){var a="leaflet-tooltip",h=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ke("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+s(this));},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var h,p,v=this._map,M=this._container,F=v.latLngToContainerPoint(v.getCenter()),$=v.layerPointToContainerPoint(a),Q=this.options.direction,ie=M.offsetWidth,de=M.offsetHeight,ye=O(this.options.offset),Re=this._getAnchor();Q==="top"?(h=ie/2,p=de):Q==="bottom"?(h=ie/2,p=0):Q==="center"?(h=ie/2,p=de/2):Q==="right"?(h=0,p=de/2):Q==="left"?(h=ie,p=de/2):$.x<F.x?(Q="right",h=0,p=de/2):(Q="left",h=ie+(ye.x+Re.x)*2,p=de/2),a=a.subtract(O(h,p,!0)).add(ye).add(Re),At(M,"leaflet-tooltip-right"),At(M,"leaflet-tooltip-left"),At(M,"leaflet-tooltip-top"),At(M,"leaflet-tooltip-bottom"),$e(M,"leaflet-tooltip-"+Q),Lt(M,a);},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a);},setOpacity:function(a){this.options.opacity=a,this._container&&ei(this._container,a);},_animateZoom:function(a){var h=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(h);},_getAnchor:function(){return O(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0]);}}),KP=function(a,h){return new mc(a,h);};Xe.include({openTooltip:function(a,h,p){return this._initOverlay(mc,a,h,p).openOn(this),this;},closeTooltip:function(a){return a.close(),this;}}),mi.include({bindTooltip:function(a,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(mc,this._tooltip,a,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this;},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this;},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var h=a?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[h](p),this._tooltipHandlersAdded=!a;}},openTooltip:function(a){return this._tooltip&&(this instanceof dr||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this;},closeTooltip:function(){if(this._tooltip)return this._tooltip.close();},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this;},isTooltipOpen:function(){return this._tooltip.isOpen();},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this;},getTooltip:function(){return this._tooltip;},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this);},_addFocusListenersOnLayer:function(a){var h=typeof a.getElement=="function"&&a.getElement();h&&(Be(h,"focus",function(){this._tooltip._source=a,this.openTooltip();},this),Be(h,"blur",this.closeTooltip,this));},_setAriaDescribedByOnLayer:function(a){var h=typeof a.getElement=="function"&&a.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id);},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(a);});return;}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0);}},_moveTooltip:function(a){var h=a.latlng,p,v;this._tooltip.options.sticky&&a.originalEvent&&(p=this._map.mouseEventToContainerPoint(a.originalEvent),v=this._map.containerPointToLayerPoint(p),h=this._map.layerPointToLatLng(v)),this._tooltip.setLatLng(h);}});var U_=Is.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var h=a&&a.tagName==="DIV"?a:document.createElement("div"),p=this.options;if(p.html instanceof Element?(nc(h),h.appendChild(p.html)):h.innerHTML=p.html!==!1?p.html:"",p.bgPos){var v=O(p.bgPos);h.style.backgroundPosition=-v.x+"px "+-v.y+"px";}return this._setIconStyles(h,"icon"),h;},createShadow:function(){return null;}});function JP(a){return new U_(a);}Is.Default=Va;var za=mi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Oe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){m(this,a);},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView();},beforeAdd:function(a){a._addZoomLimit(this);},onRemove:function(a){this._removeAllTiles(),xt(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0;},bringToFront:function(){return this._map&&(Os(this._container),this._setAutoZIndex(Math.max)),this;},bringToBack:function(){return this._map&&(Ts(this._container),this._setAutoZIndex(Math.min)),this;},getContainer:function(){return this._container;},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this;},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this;},isLoading:function(){return this._loading;},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update();}return this;},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=l(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a;},createTile:function(){return document.createElement("div");},getTileSize:function(){var a=this.options.tileSize;return a instanceof A?a:new A(a,a);},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex);},_setAutoZIndex:function(a){for(var h=this.getPane().children,p=-a(-1/0,1/0),v=0,M=h.length,F;v<M;v++)F=h[v].style.zIndex,h[v]!==this._container&&F&&(p=a(p,+F));isFinite(p)&&(this.options.zIndex=p+a(-1,1),this._updateZIndex());},_updateOpacity:function(){if(this._map&&!Oe.ielt9){ei(this._container,this.options.opacity);var a=+new Date(),h=!1,p=!1;for(var v in this._tiles){var M=this._tiles[v];if(!(!M.current||!M.loaded)){var F=Math.min(1,(a-M.loaded)/200);ei(M.el,F),F<1?h=!0:(M.active?p=!0:this._onOpaqueTile(M),M.active=!0);}}p&&!this._noPrune&&this._pruneTiles(),h&&(le(this._fadeFrame),this._fadeFrame=Y(this._updateOpacity,this));}},_onOpaqueTile:d,_initContainer:function(){this._container||(this._container=Ke("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container));},_updateLevels:function(){var a=this._tileZoom,h=this.options.maxZoom;if(a!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===a?(this._levels[p].el.style.zIndex=h-Math.abs(a-p),this._onUpdateLevel(p)):(xt(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var v=this._levels[a],M=this._map;return v||(v=this._levels[a]={},v.el=Ke("div","leaflet-tile-container leaflet-zoom-animated",this._container),v.el.style.zIndex=h,v.origin=M.project(M.unproject(M.getPixelOrigin()),a).round(),v.zoom=a,this._setZoomTransform(v,M.getCenter(),M.getZoom()),d(v.el.offsetWidth),this._onCreateLevel(v)),this._level=v,v;}},_onUpdateLevel:d,_onRemoveLevel:d,_onCreateLevel:d,_pruneTiles:function(){if(this._map){var a,h,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return;}for(a in this._tiles)h=this._tiles[a],h.retain=h.current;for(a in this._tiles)if(h=this._tiles[a],h.current&&!h.active){var v=h.coords;this._retainParent(v.x,v.y,v.z,v.z-5)||this._retainChildren(v.x,v.y,v.z,v.z+2);}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a);}},_removeTilesAtZoom:function(a){for(var h in this._tiles)this._tiles[h].coords.z===a&&this._removeTile(h);},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a);},_invalidateAll:function(){for(var a in this._levels)xt(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0;},_retainParent:function(a,h,p,v){var M=Math.floor(a/2),F=Math.floor(h/2),$=p-1,Q=new A(+M,+F);Q.z=+$;var ie=this._tileCoordsToKey(Q),de=this._tiles[ie];return de&&de.active?(de.retain=!0,!0):(de&&de.loaded&&(de.retain=!0),$>v?this._retainParent(M,F,$,v):!1);},_retainChildren:function(a,h,p,v){for(var M=2*a;M<2*a+2;M++)for(var F=2*h;F<2*h+2;F++){var $=new A(M,F);$.z=p+1;var Q=this._tileCoordsToKey($),ie=this._tiles[Q];if(ie&&ie.active){ie.retain=!0;continue;}else ie&&ie.loaded&&(ie.retain=!0);p+1<v&&this._retainChildren(M,F,p+1,v);}},_resetView:function(a){var h=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h);},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate);},_clampZoom:function(a){var h=this.options;return h.minNativeZoom!==void 0&&a<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<a?h.maxNativeZoom:a;},_setView:function(a,h,p,v){var M=Math.round(h);this.options.maxZoom!==void 0&&M>this.options.maxZoom||this.options.minZoom!==void 0&&M<this.options.minZoom?M=void 0:M=this._clampZoom(M);var F=this.options.updateWhenZooming&&M!==this._tileZoom;(!v||F)&&(this._tileZoom=M,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),M!==void 0&&this._update(a),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(a,h);},_setZoomTransforms:function(a,h){for(var p in this._levels)this._setZoomTransform(this._levels[p],a,h);},_setZoomTransform:function(a,h,p){var v=this._map.getZoomScale(p,a.zoom),M=a.origin.multiplyBy(v).subtract(this._map._getNewPixelOrigin(h,p)).round();Oe.any3d?Co(a.el,M,v):Lt(a.el,M);},_resetGrid:function(){var a=this._map,h=a.options.crs,p=this._tileSize=this.getTileSize(),v=this._tileZoom,M=this._map.getPixelWorldBounds(this._tileZoom);M&&(this._globalTileRange=this._pxBoundsToTileRange(M)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,h.wrapLng[0]],v).x/p.x),Math.ceil(a.project([0,h.wrapLng[1]],v).x/p.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([h.wrapLat[0],0],v).y/p.x),Math.ceil(a.project([h.wrapLat[1],0],v).y/p.y)];},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update();},_getTiledPixelBounds:function(a){var h=this._map,p=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),v=h.getZoomScale(p,this._tileZoom),M=h.project(a,this._tileZoom).floor(),F=h.getSize().divideBy(v*2);return new k(M.subtract(F),M.add(F));},_update:function(a){var h=this._map;if(h){var p=this._clampZoom(h.getZoom());if(a===void 0&&(a=h.getCenter()),this._tileZoom!==void 0){var v=this._getTiledPixelBounds(a),M=this._pxBoundsToTileRange(v),F=M.getCenter(),$=[],Q=this.options.keepBuffer,ie=new k(M.getBottomLeft().subtract([Q,-Q]),M.getTopRight().add([Q,-Q]));if(!(isFinite(M.min.x)&&isFinite(M.min.y)&&isFinite(M.max.x)&&isFinite(M.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var de in this._tiles){var ye=this._tiles[de].coords;(ye.z!==this._tileZoom||!ie.contains(new A(ye.x,ye.y)))&&(this._tiles[de].current=!1);}if(Math.abs(p-this._tileZoom)>1){this._setView(a,p);return;}for(var Re=M.min.y;Re<=M.max.y;Re++)for(var Ge=M.min.x;Ge<=M.max.x;Ge++){var dn=new A(Ge,Re);if(dn.z=this._tileZoom,!!this._isValidTile(dn)){var Yt=this._tiles[this._tileCoordsToKey(dn)];Yt?Yt.current=!0:$.push(dn);}}if($.sort(function(Sn,Ls){return Sn.distanceTo(F)-Ls.distanceTo(F);}),$.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ni=document.createDocumentFragment();for(Ge=0;Ge<$.length;Ge++)this._addTile($[Ge],ni);this._level.el.appendChild(ni);}}}},_isValidTile:function(a){var h=this._map.options.crs;if(!h.infinite){var p=this._globalTileRange;if(!h.wrapLng&&(a.x<p.min.x||a.x>p.max.x)||!h.wrapLat&&(a.y<p.min.y||a.y>p.max.y))return!1;}if(!this.options.bounds)return!0;var v=this._tileCoordsToBounds(a);return pe(this.options.bounds).overlaps(v);},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a));},_tileCoordsToNwSe:function(a){var h=this._map,p=this.getTileSize(),v=a.scaleBy(p),M=v.add(p),F=h.unproject(v,a.z),$=h.unproject(M,a.z);return[F,$];},_tileCoordsToBounds:function(a){var h=this._tileCoordsToNwSe(a),p=new U(h[0],h[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p;},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z;},_keyToTileCoords:function(a){var h=a.split(":"),p=new A(+h[0],+h[1]);return p.z=+h[2],p;},_removeTile:function(a){var h=this._tiles[a];h&&(xt(h.el),delete this._tiles[a],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(a)}));},_initTile:function(a){$e(a,"leaflet-tile");var h=this.getTileSize();a.style.width=h.x+"px",a.style.height=h.y+"px",a.onselectstart=d,a.onmousemove=d,Oe.ielt9&&this.options.opacity<1&&ei(a,this.options.opacity);},_addTile:function(a,h){var p=this._getTilePos(a),v=this._tileCoordsToKey(a),M=this.createTile(this._wrapCoords(a),r(this._tileReady,this,a));this._initTile(M),this.createTile.length<2&&Y(r(this._tileReady,this,a,null,M)),Lt(M,p),this._tiles[v]={el:M,coords:a,current:!0},h.appendChild(M),this.fire("tileloadstart",{tile:M,coords:a});},_tileReady:function(a,h,p){h&&this.fire("tileerror",{error:h,tile:p,coords:a});var v=this._tileCoordsToKey(a);p=this._tiles[v],p&&(p.loaded=+new Date(),this._map._fadeAnimated?(ei(p.el,0),le(this._fadeFrame),this._fadeFrame=Y(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),h||($e(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Oe.ielt9||!this._map._fadeAnimated?Y(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)));},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin);},_wrapCoords:function(a){var h=new A(this._wrapX?c(a.x,this._wrapX):a.x,this._wrapY?c(a.y,this._wrapY):a.y);return h.z=a.z,h;},_pxBoundsToTileRange:function(a){var h=this.getTileSize();return new k(a.min.unscaleBy(h).floor(),a.max.unscaleBy(h).ceil().subtract([1,1]));},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0;}});function QP(a){return new za(a);}var Rs=za.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,h){this._url=a,h=m(this,h),h.detectRetina&&Oe.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove);},setUrl:function(a,h){return this._url===a&&h===void 0&&(h=!0),this._url=a,h||this.redraw(),this;},createTile:function(a,h){var p=document.createElement("img");return Be(p,"load",r(this._tileOnLoad,this,h,p)),Be(p,"error",r(this._tileOnError,this,h,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(a),p;},getTileUrl:function(a){var h={r:Oe.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-a.y;this.options.tms&&(h.y=p),h["-y"]=p;}return E(this._url,t(h,this.options));},_tileOnLoad:function(a,h){Oe.ielt9?setTimeout(r(a,this,null,h),0):a(null,h);},_tileOnError:function(a,h,p){var v=this.options.errorTileUrl;v&&h.getAttribute("src")!==v&&(h.src=v),a(p,h);},_onTileRemove:function(a){a.tile.onload=null;},_getZoomForUrl:function(){var a=this._tileZoom,h=this.options.maxZoom,p=this.options.zoomReverse,v=this.options.zoomOffset;return p&&(a=h-a),a+v;},_getSubdomain:function(a){var h=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[h];},_abortLoading:function(){var a,h;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(h=this._tiles[a].el,h.onload=d,h.onerror=d,!h.complete)){h.src=x;var p=this._tiles[a].coords;xt(h),delete this._tiles[a],this.fire("tileabort",{tile:h,coords:p});}},_removeTile:function(a){var h=this._tiles[a];if(h)return h.el.setAttribute("src",x),za.prototype._removeTile.call(this,a);},_tileReady:function(a,h,p){if(!(!this._map||p&&p.getAttribute("src")===x))return za.prototype._tileReady.call(this,a,h,p);}});function H_(a,h){return new Rs(a,h);}var W_=Rs.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,h){this._url=a;var p=t({},this.defaultWmsParams);for(var v in h)v in this.options||(p[v]=h[v]);h=m(this,h);var M=h.detectRetina&&Oe.retina?2:1,F=this.getTileSize();p.width=F.x*M,p.height=F.y*M,this.wmsParams=p;},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,Rs.prototype.onAdd.call(this,a);},getTileUrl:function(a){var h=this._tileCoordsToNwSe(a),p=this._crs,v=H(p.project(h[0]),p.project(h[1])),M=v.min,F=v.max,$=(this._wmsVersion>=1.3&&this._crs===N_?[M.y,M.x,F.y,F.x]:[M.x,M.y,F.x,F.y]).join(","),Q=Rs.prototype.getTileUrl.call(this,a);return Q+_(this.wmsParams,Q,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+$;},setParams:function(a,h){return t(this.wmsParams,a),h||this.redraw(),this;}});function ew(a,h){return new W_(a,h);}Rs.WMS=W_,H_.wms=ew;var fr=mi.extend({options:{padding:.1},initialize:function(a){m(this,a),s(this),this._layers=this._layers||{};},onAdd:function(){this._container||(this._initContainer(),$e(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this);},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer();},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a;},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom);},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom());},_updateTransform:function(a,h){var p=this._map.getZoomScale(h,this._zoom),v=this._map.getSize().multiplyBy(.5+this.options.padding),M=this._map.project(this._center,h),F=v.multiplyBy(-p).add(M).subtract(this._map._getNewPixelOrigin(a,h));Oe.any3d?Co(this._container,F,p):Lt(this._container,F);},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset();},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project();},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update();},_update:function(){var a=this.options.padding,h=this._map.getSize(),p=this._map.containerPointToLayerPoint(h.multiplyBy(-a)).round();this._bounds=new k(p,p.add(h.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom();}}),G_=fr.extend({options:{tolerance:0},getEvents:function(){var a=fr.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a;},_onViewPreReset:function(){this._postponeUpdatePaths=!0;},onAdd:function(){fr.prototype.onAdd.call(this),this._draw();},_initContainer:function(){var a=this._container=document.createElement("canvas");Be(a,"mousemove",this._onMouseMove,this),Be(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Be(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d");},_destroyContainer:function(){le(this._redrawRequest),delete this._ctx,xt(this._container),ft(this._container),delete this._container;},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var h in this._layers)a=this._layers[h],a._update();this._redraw();}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fr.prototype._update.call(this);var a=this._bounds,h=this._container,p=a.getSize(),v=Oe.retina?2:1;Lt(h,a.min),h.width=v*p.x,h.height=v*p.y,h.style.width=p.x+"px",h.style.height=p.y+"px",Oe.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update");}},_reset:function(){fr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths());},_initPath:function(a){this._updateDashArray(a),this._layers[s(a)]=a;var h=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast;},_addPath:function(a){this._requestRedraw(a);},_removePath:function(a){var h=a._order,p=h.next,v=h.prev;p?p.prev=v:this._drawLast=v,v?v.next=p:this._drawFirst=p,delete a._order,delete this._layers[s(a)],this._requestRedraw(a);},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a);},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a);},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var h=a.options.dashArray.split(/[, ]+/),p=[],v,M;for(M=0;M<h.length;M++){if(v=Number(h[M]),isNaN(v))return;p.push(v);}a.options._dashArray=p;}else a.options._dashArray=a.options.dashArray;},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||Y(this._redraw,this));},_extendRedrawBounds:function(a){if(a._pxBounds){var h=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new k(),this._redrawBounds.extend(a._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(a._pxBounds.max.add([h,h]));}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null;},_clear:function(){var a=this._redrawBounds;if(a){var h=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,h.x,h.y);}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore();},_draw:function(){var a,h=this._redrawBounds;if(this._ctx.save(),h){var p=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,p.x,p.y),this._ctx.clip();}this._drawing=!0;for(var v=this._drawFirst;v;v=v.next)a=v.layer,(!h||a._pxBounds&&a._pxBounds.intersects(h))&&a._updatePath();this._drawing=!1,this._ctx.restore();},_updatePoly:function(a,h){if(this._drawing){var p,v,M,F,$=a._parts,Q=$.length,ie=this._ctx;if(Q){for(ie.beginPath(),p=0;p<Q;p++){for(v=0,M=$[p].length;v<M;v++)F=$[p][v],ie[v?"lineTo":"moveTo"](F.x,F.y);h&&ie.closePath();}this._fillStroke(ie,a);}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var h=a._point,p=this._ctx,v=Math.max(Math.round(a._radius),1),M=(Math.max(Math.round(a._radiusY),1)||v)/v;M!==1&&(p.save(),p.scale(1,M)),p.beginPath(),p.arc(h.x,h.y/M,v,0,Math.PI*2,!1),M!==1&&p.restore(),this._fillStroke(p,a);}},_fillStroke:function(a,h){var p=h.options;p.fill&&(a.globalAlpha=p.fillOpacity,a.fillStyle=p.fillColor||p.color,a.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(a.setLineDash&&a.setLineDash(h.options&&h.options._dashArray||[]),a.globalAlpha=p.opacity,a.lineWidth=p.weight,a.strokeStyle=p.color,a.lineCap=p.lineCap,a.lineJoin=p.lineJoin,a.stroke());},_onClick:function(a){for(var h=this._map.mouseEventToLayerPoint(a),p,v,M=this._drawFirst;M;M=M.next)p=M.layer,p.options.interactive&&p._containsPoint(h)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(p))&&(v=p);this._fireEvent(v?[v]:!1,a);},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,h);}},_handleMouseOut:function(a){var h=this._hoveredLayer;h&&(At(this._container,"leaflet-interactive"),this._fireEvent([h],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1);},_handleMouseHover:function(a,h){if(!this._mouseHoverThrottled){for(var p,v,M=this._drawFirst;M;M=M.next)p=M.layer,p.options.interactive&&p._containsPoint(h)&&(v=p);v!==this._hoveredLayer&&(this._handleMouseOut(a),v&&($e(this._container,"leaflet-interactive"),this._fireEvent([v],a,"mouseover"),this._hoveredLayer=v)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(r(function(){this._mouseHoverThrottled=!1;},this),32);}},_fireEvent:function(a,h,p){this._map._fireDOMEvent(h,p||h.type,a);},_bringToFront:function(a){var h=a._order;if(h){var p=h.next,v=h.prev;if(p)p.prev=v;else return;v?v.next=p:p&&(this._drawFirst=p),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(a);}},_bringToBack:function(a){var h=a._order;if(h){var p=h.next,v=h.prev;if(v)v.next=p;else return;p?p.prev=v:v&&(this._drawLast=v),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(a);}}});function Y_(a){return Oe.canvas?new G_(a):null;}var ja=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">');};}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">');};}(),tw={_initContainer:function(){this._container=Ke("div","leaflet-vml-container");},_update:function(){this._map._animatingZoom||(fr.prototype._update.call(this),this.fire("update"));},_initPath:function(a){var h=a._container=ja("shape");$e(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",a._path=ja("path"),h.appendChild(a._path),this._updateStyle(a),this._layers[s(a)]=a;},_addPath:function(a){var h=a._container;this._container.appendChild(h),a.options.interactive&&a.addInteractiveTarget(h);},_removePath:function(a){var h=a._container;xt(h),a.removeInteractiveTarget(h),delete this._layers[s(a)];},_updateStyle:function(a){var h=a._stroke,p=a._fill,v=a.options,M=a._container;M.stroked=!!v.stroke,M.filled=!!v.fill,v.stroke?(h||(h=a._stroke=ja("stroke")),M.appendChild(h),h.weight=v.weight+"px",h.color=v.color,h.opacity=v.opacity,v.dashArray?h.dashStyle=C(v.dashArray)?v.dashArray.join(" "):v.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=v.lineCap.replace("butt","flat"),h.joinstyle=v.lineJoin):h&&(M.removeChild(h),a._stroke=null),v.fill?(p||(p=a._fill=ja("fill")),M.appendChild(p),p.color=v.fillColor||v.color,p.opacity=v.fillOpacity):p&&(M.removeChild(p),a._fill=null);},_updateCircle:function(a){var h=a._point.round(),p=Math.round(a._radius),v=Math.round(a._radiusY||p);this._setPath(a,a._empty()?"M0 0":"AL "+h.x+","+h.y+" "+p+","+v+" 0,"+65535*360);},_setPath:function(a,h){a._path.v=h;},_bringToFront:function(a){Os(a._container);},_bringToBack:function(a){Ts(a._container);}},_c=Oe.vml?ja:Je,$a=fr.extend({_initContainer:function(){this._container=_c("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=_c("g"),this._container.appendChild(this._rootGroup);},_destroyContainer:function(){xt(this._container),ft(this._container),delete this._container,delete this._rootGroup,delete this._svgSize;},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fr.prototype._update.call(this);var a=this._bounds,h=a.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,p.setAttribute("width",h.x),p.setAttribute("height",h.y)),Lt(p,a.min),p.setAttribute("viewBox",[a.min.x,a.min.y,h.x,h.y].join(" ")),this.fire("update");}},_initPath:function(a){var h=a._path=_c("path");a.options.className&&$e(h,a.options.className),a.options.interactive&&$e(h,"leaflet-interactive"),this._updateStyle(a),this._layers[s(a)]=a;},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path);},_removePath:function(a){xt(a._path),a.removeInteractiveTarget(a._path),delete this._layers[s(a)];},_updatePath:function(a){a._project(),a._update();},_updateStyle:function(a){var h=a._path,p=a.options;h&&(p.stroke?(h.setAttribute("stroke",p.color),h.setAttribute("stroke-opacity",p.opacity),h.setAttribute("stroke-width",p.weight),h.setAttribute("stroke-linecap",p.lineCap),h.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?h.setAttribute("stroke-dasharray",p.dashArray):h.removeAttribute("stroke-dasharray"),p.dashOffset?h.setAttribute("stroke-dashoffset",p.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),p.fill?(h.setAttribute("fill",p.fillColor||p.color),h.setAttribute("fill-opacity",p.fillOpacity),h.setAttribute("fill-rule",p.fillRule||"evenodd")):h.setAttribute("fill","none"));},_updatePoly:function(a,h){this._setPath(a,we(a._parts,h));},_updateCircle:function(a){var h=a._point,p=Math.max(Math.round(a._radius),1),v=Math.max(Math.round(a._radiusY),1)||p,M="a"+p+","+v+" 0 1,0 ",F=a._empty()?"M0 0":"M"+(h.x-p)+","+h.y+M+p*2+",0 "+M+-p*2+",0 ";this._setPath(a,F);},_setPath:function(a,h){a._path.setAttribute("d",h);},_bringToFront:function(a){Os(a._path);},_bringToBack:function(a){Ts(a._path);}});Oe.vml&&$a.include(tw);function X_(a){return Oe.svg||Oe.vml?new $a(a):null;}Xe.include({getRenderer:function(a){var h=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h;},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var h=this._paneRenderers[a];return h===void 0&&(h=this._createRenderer({pane:a}),this._paneRenderers[a]=h),h;},_createRenderer:function(a){return this.options.preferCanvas&&Y_(a)||X_(a);}});var q_=As.extend({initialize:function(a,h){As.prototype.initialize.call(this,this._boundsToLatLngs(a),h);},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a));},_boundsToLatLngs:function(a){return a=pe(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()];}});function nw(a,h){return new q_(a,h);}$a.create=_c,$a.pointsToPath=we,pr.geometryToLayer=hc,pr.coordsToLatLng=qu,pr.coordsToLatLngs=dc,pr.latLngToCoords=Zu,pr.latLngsToCoords=uc,pr.getFeature=Fs,pr.asFeature=pc,Xe.mergeOptions({boxZoom:!0});var Z_=Vi.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this);},addHooks:function(){Be(this._container,"mousedown",this._onMouseDown,this);},removeHooks:function(){ft(this._container,"mousedown",this._onMouseDown,this);},moved:function(){return this._moved;},_destroy:function(){xt(this._pane),delete this._pane;},_resetState:function(){this._resetStateTimeout=0,this._moved=!1;},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0);},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Fa(),Au(),this._startPoint=this._map.mouseEventToContainerPoint(a),Be(document,{contextmenu:Po,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this);},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=Ke("div","leaflet-zoom-box",this._container),$e(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var h=new k(this._point,this._startPoint),p=h.getSize();Lt(this._box,h.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px";},_finish:function(){this._moved&&(xt(this._box),At(this._container,"leaflet-crosshair")),Ra(),Fu(),ft(document,{contextmenu:Po,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this);},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var h=new U(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h});}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState());}});Xe.addInitHook("addHandler","boxZoom",Z_),Xe.mergeOptions({doubleClickZoom:!0});var K_=Vi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this);},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this);},_onDoubleClick:function(a){var h=this._map,p=h.getZoom(),v=h.options.zoomDelta,M=a.originalEvent.shiftKey?p-v:p+v;h.options.doubleClickZoom==="center"?h.setZoom(M):h.setZoomAround(a.containerPoint,M);}});Xe.addInitHook("addHandler","doubleClickZoom",K_),Xe.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var J_=Vi.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new jr(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this));}$e(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[];},removeHooks:function(){At(this._map._container,"leaflet-grab"),At(this._map._container,"leaflet-touch-drag"),this._draggable.disable();},moved:function(){return this._draggable&&this._draggable._moved;},moving:function(){return this._draggable&&this._draggable._moving;},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=pe(this._map.options.maxBounds);this._offsetLimit=H(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity));}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[]);},_onDrag:function(a){if(this._map.options.inertia){var h=this._lastTime=+new Date(),p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(h),this._prunePositions(h);}this._map.fire("move",a).fire("drag",a);},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift();},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x;},_viscousLimit:function(a,h){return a-(a-h)*this._viscosity;},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;a.x<h.min.x&&(a.x=this._viscousLimit(a.x,h.min.x)),a.y<h.min.y&&(a.y=this._viscousLimit(a.y,h.min.y)),a.x>h.max.x&&(a.x=this._viscousLimit(a.x,h.max.x)),a.y>h.max.y&&(a.y=this._viscousLimit(a.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(a);}},_onPreDragWrap:function(){var a=this._worldWidth,h=Math.round(a/2),p=this._initialWorldOffset,v=this._draggable._newPos.x,M=(v-h+p)%a+h-p,F=(v+h+p)%a-h-p,$=Math.abs(M+p)<Math.abs(F+p)?M:F;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=$;},_onDragEnd:function(a){var h=this._map,p=h.options,v=!p.inertia||a.noInertia||this._times.length<2;if(h.fire("dragend",a),v)h.fire("moveend");else{this._prunePositions(+new Date());var M=this._lastPos.subtract(this._positions[0]),F=(this._lastTime-this._times[0])/1e3,$=p.easeLinearity,Q=M.multiplyBy($/F),ie=Q.distanceTo([0,0]),de=Math.min(p.inertiaMaxSpeed,ie),ye=Q.multiplyBy(de/ie),Re=de/(p.inertiaDeceleration*$),Ge=ye.multiplyBy(-Re/2).round();!Ge.x&&!Ge.y?h.fire("moveend"):(Ge=h._limitOffset(Ge,h.options.maxBounds),Y(function(){h.panBy(Ge,{duration:Re,easeLinearity:$,noMoveStart:!0,animate:!0});}));}}});Xe.addInitHook("addHandler","dragging",J_),Xe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Q_=Vi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta);},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),Be(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this);},removeHooks:function(){this._removeHooks(),ft(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this);},_onMouseDown:function(){if(!this._focused){var a=document.body,h=document.documentElement,p=a.scrollTop||h.scrollTop,v=a.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(v,p);}},_onFocus:function(){this._focused=!0,this._map.fire("focus");},_onBlur:function(){this._focused=!1,this._map.fire("blur");},_setPanDelta:function(a){var h=this._panKeys={},p=this.keyCodes,v,M;for(v=0,M=p.left.length;v<M;v++)h[p.left[v]]=[-1*a,0];for(v=0,M=p.right.length;v<M;v++)h[p.right[v]]=[a,0];for(v=0,M=p.down.length;v<M;v++)h[p.down[v]]=[0,a];for(v=0,M=p.up.length;v<M;v++)h[p.up[v]]=[0,-1*a];},_setZoomDelta:function(a){var h=this._zoomKeys={},p=this.keyCodes,v,M;for(v=0,M=p.zoomIn.length;v<M;v++)h[p.zoomIn[v]]=a;for(v=0,M=p.zoomOut.length;v<M;v++)h[p.zoomOut[v]]=-a;},_addHooks:function(){Be(document,"keydown",this._onKeyDown,this);},_removeHooks:function(){ft(document,"keydown",this._onKeyDown,this);},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var h=a.keyCode,p=this._map,v;if(h in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(v=this._panKeys[h],a.shiftKey&&(v=O(v).multiplyBy(3)),p.options.maxBounds&&(v=p._limitOffset(O(v),p.options.maxBounds)),p.options.worldCopyJump){var M=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(v)));p.panTo(M);}else p.panBy(v);}else if(h in this._zoomKeys)p.setZoom(p.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Po(a);}}});Xe.addInitHook("addHandler","keyboard",Q_),Xe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var e0=Vi.extend({addHooks:function(){Be(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0;},removeHooks:function(){ft(this._map._container,"wheel",this._onWheelScroll,this);},_onWheelScroll:function(a){var h=w_(a),p=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date());var v=Math.max(p-(+new Date()-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),v),Po(a);},_performZoom:function(){var a=this._map,h=a.getZoom(),p=this._map.options.zoomSnap||0;a._stop();var v=this._delta/(this._map.options.wheelPxPerZoomLevel*4),M=4*Math.log(2/(1+Math.exp(-Math.abs(v))))/Math.LN2,F=p?Math.ceil(M/p)*p:M,$=a._limitZoom(h+(this._delta>0?F:-F))-h;this._delta=0,this._startTime=null,$&&(a.options.scrollWheelZoom==="center"?a.setZoom(h+$):a.setZoomAround(this._lastMousePos,h+$));}});Xe.addInitHook("addHandler","scrollWheelZoom",e0);var iw=600;Xe.mergeOptions({tapHold:Oe.touchNative&&Oe.safari&&Oe.mobile,tapTolerance:15});var t0=Vi.extend({addHooks:function(){Be(this._map._container,"touchstart",this._onDown,this);},removeHooks:function(){ft(this._map._container,"touchstart",this._onDown,this);},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var h=a.touches[0];this._startPos=this._newPos=new A(h.clientX,h.clientY),this._holdTimeout=setTimeout(r(function(){this._cancel(),this._isTapValid()&&(Be(document,"touchend",Kt),Be(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h));},this),iw),Be(document,"touchend touchcancel contextmenu",this._cancel,this),Be(document,"touchmove",this._onMove,this);}},_cancelClickPrevent:function a(){ft(document,"touchend",Kt),ft(document,"touchend touchcancel",a);},_cancel:function(){clearTimeout(this._holdTimeout),ft(document,"touchend touchcancel contextmenu",this._cancel,this),ft(document,"touchmove",this._onMove,this);},_onMove:function(a){var h=a.touches[0];this._newPos=new A(h.clientX,h.clientY);},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance;},_simulateEvent:function(a,h){var p=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});p._simulated=!0,h.target.dispatchEvent(p);}});Xe.addInitHook("addHandler","tapHold",t0),Xe.mergeOptions({touchZoom:Oe.touch,bounceAtZoomLimits:!0});var n0=Vi.extend({addHooks:function(){$e(this._map._container,"leaflet-touch-zoom"),Be(this._map._container,"touchstart",this._onTouchStart,this);},removeHooks:function(){At(this._map._container,"leaflet-touch-zoom"),ft(this._map._container,"touchstart",this._onTouchStart,this);},_onTouchStart:function(a){var h=this._map;if(!(!a.touches||a.touches.length!==2||h._animatingZoom||this._zooming)){var p=h.mouseEventToContainerPoint(a.touches[0]),v=h.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(p.add(v)._divideBy(2))),this._startDist=p.distanceTo(v),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),Be(document,"touchmove",this._onTouchMove,this),Be(document,"touchend touchcancel",this._onTouchEnd,this),Kt(a);}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var h=this._map,p=h.mouseEventToContainerPoint(a.touches[0]),v=h.mouseEventToContainerPoint(a.touches[1]),M=p.distanceTo(v)/this._startDist;if(this._zoom=h.getScaleZoom(M,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&M<1||this._zoom>h.getMaxZoom()&&M>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,M===1)return;}else{var F=p._add(v)._divideBy(2)._subtract(this._centerPoint);if(M===1&&F.x===0&&F.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(F),this._zoom);}this._moved||(h._moveStart(!0,!1),this._moved=!0),le(this._animRequest);var $=r(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Y($,this,!0),Kt(a);}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return;}this._zooming=!1,le(this._animRequest),ft(document,"touchmove",this._onTouchMove,this),ft(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom));}});Xe.addInitHook("addHandler","touchZoom",n0),Xe.BoxZoom=Z_,Xe.DoubleClickZoom=K_,Xe.Drag=J_,Xe.Keyboard=Q_,Xe.ScrollWheelZoom=e0,Xe.TapHold=t0,Xe.TouchZoom=n0,n.Bounds=k,n.Browser=Oe,n.CRS=Fe,n.Canvas=G_,n.Circle=Xu,n.CircleMarker=cc,n.Class=ee,n.Control=gi,n.DivIcon=U_,n.DivOverlay=zi,n.DomEvent=bP,n.DomUtil=yP,n.Draggable=jr,n.Evented=re,n.FeatureGroup=dr,n.GeoJSON=pr,n.GridLayer=za,n.Handler=Vi,n.Icon=Is,n.ImageOverlay=fc,n.LatLng=me,n.LatLngBounds=U,n.Layer=mi,n.LayerGroup=ks,n.LineUtil=RP,n.Map=Xe,n.Marker=lc,n.Mixin=OP,n.Path=$r,n.Point=A,n.PolyUtil=TP,n.Polygon=As,n.Polyline=ur,n.Popup=gc,n.PosAnimation=M_,n.Projection=LP,n.Rectangle=q_,n.Renderer=fr,n.SVG=$a,n.SVGOverlay=$_,n.TileLayer=Rs,n.Tooltip=mc,n.Transformation=It,n.Util=ae,n.VideoOverlay=j_,n.bind=r,n.bounds=H,n.canvas=Y_,n.circle=UP,n.circleMarker=$P,n.control=Na,n.divIcon=JP,n.extend=t,n.featureGroup=VP,n.geoJSON=z_,n.geoJson=GP,n.gridLayer=QP,n.icon=zP,n.imageOverlay=YP,n.latLng=fe,n.latLngBounds=pe,n.layerGroup=BP,n.map=xP,n.marker=jP,n.point=O,n.polygon=WP,n.polyline=HP,n.popup=ZP,n.rectangle=nw,n.setOptions=m,n.stamp=s,n.svg=X_,n.svgOverlay=qP,n.tileLayer=H_,n.tooltip=KP,n.transformation=We,n.version=e,n.videoOverlay=XP;var rw=window.L;n.noConflict=function(){return window.L=rw,this;},window.L=n;});});var Ie=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;var Ne=globalThis;var Wi="9.47.1";function ko(){return Io(Ne),Ne;}function Io(n){let e=n.__SENTRY__=n.__SENTRY__||{};return e.version=e.version||Wi,e[Wi]=e[Wi]||{};}function _r(n,e,t=Ne){let i=t.__SENTRY__=t.__SENTRY__||{},r=i[Wi]=i[Wi]||{};return r[n]||(r[n]=e());}var ap=["debug","info","warn","error","log","assert","trace"],fw="Sentry Logger ",Vs={};function Un(n){if(!("console"in Ne))return n();let e=Ne.console,t={},i=Object.keys(Vs);i.forEach(r=>{let o=Vs[r];t[r]=e[r],e[r]=o;});try{return n();}finally{i.forEach(r=>{e[r]=t[r];});}}function gw(){cp().enabled=!0;}function mw(){cp().enabled=!1;}function Y0(){return cp().enabled;}function _w(...n){lp("log",...n);}function vw(...n){lp("warn",...n);}function yw(...n){lp("error",...n);}function lp(n,...e){Ie&&Y0()&&Un(()=>{Ne.console[n](`${fw}[${n}]:`,...e);});}function cp(){return Ie?_r("loggerSettings",()=>({enabled:!1})):{enabled:!1};}var Pe={enable:gw,disable:mw,isEnabled:Y0,log:_w,warn:vw,error:yw};var Gi="?",X0=/\(error: (.*)\)/,q0=/captureMessage|captureException/;function Ac(...n){let e=n.sort((t,i)=>t[0]-i[0]).map(t=>t[1]);return(t,i=0,r=0)=>{let o=[],s=t.split(`
`);for(let l=i;l<s.length;l++){let c=s[l];if(c.length>1024)continue;let d=X0.test(c)?c.replace(X0,"$1"):c;if(!d.match(/\S*Error: /)){for(let u of e){let g=u(d);if(g){o.push(g);break;}}if(o.length>=50+r)break;}}return Z0(o.slice(r));};}function dp(n){return Array.isArray(n)?Ac(...n):n;}function Z0(n){if(!n.length)return[];let e=Array.from(n);return /sentryWrapped/.test(Ic(e).function||"")&&e.pop(),e.reverse(),q0.test(Ic(e).function||"")&&(e.pop(),q0.test(Ic(e).function||"")&&e.pop()),e.slice(0,50).map(t=>se(D({},t),{filename:t.filename||Ic(e).filename,function:t.function||Gi}));}function Ic(n){return n[n.length-1]||{};}var hp="<anonymous>";function oi(n){try{return!n||typeof n!="function"?hp:n.name||hp;}catch{return hp;}}function Fc(n){let e=n.exception;if(e){let t=[];try{return e.values.forEach(i=>{i.stacktrace.frames&&t.push(...i.stacktrace.frames);}),t;}catch{return;}}}var Rc={},K0={};function un(n,e){Rc[n]=Rc[n]||[],Rc[n].push(e);}function pn(n,e){if(!K0[n]){K0[n]=!0;try{e();}catch(t){Ie&&Pe.error(`Error while instrumenting ${n}`,t);}}}function $t(n,e){let t=n&&Rc[n];if(t)for(let i of t)try{i(e);}catch(r){Ie&&Pe.error(`Error while triggering instrumentation handler.
Type: ${n}
Name: ${oi(i)}
Error:`,r);}}var up=null;function pp(n){let e="error";un(e,n),pn(e,Cw);}function Cw(){up=Ne.onerror,Ne.onerror=function(n,e,t,i,r){return $t("error",{column:i,error:r,line:t,msg:n,url:e}),up?up.apply(this,arguments):!1;},Ne.onerror.__SENTRY_INSTRUMENTED__=!0;}var fp=null;function gp(n){let e="unhandledrejection";un(e,n),pn(e,bw);}function bw(){fp=Ne.onunhandledrejection,Ne.onunhandledrejection=function(n){return $t("unhandledrejection",n),fp?fp.apply(this,arguments):!0;},Ne.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0;}var J0=Object.prototype.toString;function Ao(n){switch(J0.call(n)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return _i(n,Error);}}function zs(n,e){return J0.call(n)===`[object ${e}]`;}function Lc(n){return zs(n,"ErrorEvent");}function Dc(n){return zs(n,"DOMError");}function mp(n){return zs(n,"DOMException");}function sn(n){return zs(n,"String");}function js(n){return typeof n=="object"&&n!==null&&"__sentry_template_string__"in n&&"__sentry_template_values__"in n;}function Fo(n){return n===null||js(n)||typeof n!="object"&&typeof n!="function";}function vr(n){return zs(n,"Object");}function Ro(n){return typeof Event<"u"&&_i(n,Event);}function _p(n){return typeof Element<"u"&&_i(n,Element);}function vp(n){return zs(n,"RegExp");}function yr(n){return!!(n?.then&&typeof n.then=="function");}function yp(n){return vr(n)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n;}function _i(n,e){try{return n instanceof e;}catch{return!1;}}function Ga(n){return!!(typeof n=="object"&&n!==null&&(n.__isVue||n._isVue));}function Q0(n){return typeof Request<"u"&&_i(n,Request);}var Cp=Ne,xw=80;function Ya(n,e={}){if(!n)return"<unknown>";try{let t=n,i=5,r=[],o=0,s=0,l=" > ",c=l.length,d,u=Array.isArray(e)?e:e.keyAttrs,g=!Array.isArray(e)&&e.maxStringLength||xw;for(;t&&o++<i&&(d=Pw(t,u),!(d==="html"||o>1&&s+r.length*c+d.length>=g));)r.push(d),s+=d.length,t=t.parentNode;return r.reverse().join(l);}catch{return"<unknown>";}}function Pw(n,e){let t=n,i=[];if(!t?.tagName)return"";if(Cp.HTMLElement&&t instanceof HTMLElement&&t.dataset){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement;}i.push(t.tagName.toLowerCase());let r=e?.length?e.filter(s=>t.getAttribute(s)).map(s=>[s,t.getAttribute(s)]):null;if(r?.length)r.forEach(s=>{i.push(`[${s[0]}="${s[1]}"]`);});else{t.id&&i.push(`#${t.id}`);let s=t.className;if(s&&sn(s)){let l=s.split(/\s+/);for(let c of l)i.push(`.${c}`);}}let o=["aria-label","type","name","title","alt"];for(let s of o){let l=t.getAttribute(s);l&&i.push(`[${s}="${l}"]`);}return i.join("");}function Lo(){try{return Cp.document.location.href;}catch{return"";}}function bp(n){if(!Cp.HTMLElement)return null;let e=n,t=5;for(let i=0;i<t;i++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement;}e=e.parentNode;}return null;}function qr(n,e=0){return typeof n!="string"||e===0||n.length<=e?n:`${n.slice(0,e)}...`;}function Nc(n,e){if(!Array.isArray(n))return"";let t=[];for(let i=0;i<n.length;i++){let r=n[i];try{Ga(r)?t.push("[VueViewModel]"):t.push(String(r));}catch{t.push("[value cannot be serialized]");}}return t.join(e);}function ev(n,e,t=!1){return sn(n)?vp(e)?e.test(n):sn(e)?t?n===e:n.includes(e):!1:!1;}function $s(n,e=[],t=!1){return e.some(i=>ev(n,i,t));}function Ut(n,e,t){if(!(e in n))return;let i=n[e];if(typeof i!="function")return;let r=t(i);typeof r=="function"&&Bc(r,i);try{n[e]=r;}catch{Ie&&Pe.log(`Failed to replace method "${e}" in object`,n);}}function Hn(n,e,t){try{Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0});}catch{Ie&&Pe.log(`Failed to add non-enumerable property "${e}" to object`,n);}}function Bc(n,e){try{let t=e.prototype||{};n.prototype=e.prototype=t,Hn(n,"__sentry_original__",e);}catch{}}function Do(n){return n.__sentry_original__;}function Vc(n){if(Ao(n))return D({message:n.message,name:n.name,stack:n.stack},nv(n));if(Ro(n)){let e=D({type:n.type,target:tv(n.target),currentTarget:tv(n.currentTarget)},nv(n));return typeof CustomEvent<"u"&&_i(n,CustomEvent)&&(e.detail=n.detail),e;}else return n;}function tv(n){try{return _p(n)?Ya(n):Object.prototype.toString.call(n);}catch{return"<unknown>";}}function nv(n){if(typeof n=="object"&&n!==null){let e={};for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e;}else return{};}function xp(n,e=40){let t=Object.keys(Vc(n));t.sort();let i=t[0];if(!i)return"[object has no keys]";if(i.length>=e)return qr(i,e);for(let r=t.length;r>0;r--){let o=t.slice(0,r).join(", ");if(!(o.length>e))return r===t.length?o:qr(o,e);}return"";}function ww(){let n=Ne;return n.crypto||n.msCrypto;}function Ht(n=ww()){let e=()=>Math.random()*16;try{if(n?.randomUUID)return n.randomUUID().replace(/-/g,"");n?.getRandomValues&&(e=()=>{let t=new Uint8Array(1);return n.getRandomValues(t),t[0];});}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,t=>(t^(e()&15)>>t/4).toString(16));}function iv(n){return n.exception?.values?.[0];}function Yi(n){let{message:e,event_id:t}=n;if(e)return e;let i=iv(n);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||t||"<unknown>":t||"<unknown>";}function Us(n,e,t){let i=n.exception=n.exception||{},r=i.values=i.values||[],o=r[0]=r[0]||{};o.value||(o.value=e||""),o.type||(o.type=t||"Error");}function Xi(n,e){let t=iv(n);if(!t)return;let i={type:"generic",handled:!0},r=t.mechanism;if(t.mechanism=D(D(D({},i),r),e),e&&"data"in e){let o=D(D({},r?.data),e.data);t.mechanism.data=o;}}function zc(n){if(Mw(n))return!0;try{Hn(n,"__sentry_captured__",!0);}catch{}return!1;}function Mw(n){try{return n.__sentry_captured__;}catch{}}var ov=1e3;function qi(){return Date.now()/ov;}function Sw(){let{performance:n}=Ne;if(!n?.now||!n.timeOrigin)return qi;let e=n.timeOrigin;return()=>(e+n.now())/ov;}var rv;function fn(){return(rv??(rv=Sw()))();}function sv(n){let e=fn(),t={sid:Ht(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Ew(t)};return n&&Cr(t,n),t;}function Cr(n,e={}){if(e.user&&(!n.ipAddress&&e.user.ip_address&&(n.ipAddress=e.user.ip_address),!n.did&&!e.did&&(n.did=e.user.id||e.user.email||e.user.username)),n.timestamp=e.timestamp||fn(),e.abnormal_mechanism&&(n.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(n.ignoreDuration=e.ignoreDuration),e.sid&&(n.sid=e.sid.length===32?e.sid:Ht()),e.init!==void 0&&(n.init=e.init),!n.did&&e.did&&(n.did=`${e.did}`),typeof e.started=="number"&&(n.started=e.started),n.ignoreDuration)n.duration=void 0;else if(typeof e.duration=="number")n.duration=e.duration;else{let t=n.timestamp-n.started;n.duration=t>=0?t:0;}e.release&&(n.release=e.release),e.environment&&(n.environment=e.environment),!n.ipAddress&&e.ipAddress&&(n.ipAddress=e.ipAddress),!n.userAgent&&e.userAgent&&(n.userAgent=e.userAgent),typeof e.errors=="number"&&(n.errors=e.errors),e.status&&(n.status=e.status);}function av(n,e){let t={};e?t={status:e}:n.status==="ok"&&(t={status:"exited"}),Cr(n,t);}function Ew(n){return{sid:`${n.sid}`,init:n.init,started:new Date(n.started*1e3).toISOString(),timestamp:new Date(n.timestamp*1e3).toISOString(),status:n.status,errors:n.errors,did:typeof n.did=="number"||typeof n.did=="string"?`${n.did}`:void 0,duration:n.duration,abnormal_mechanism:n.abnormal_mechanism,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}};}function Zr(n,e,t=2){if(!e||typeof e!="object"||t<=0)return e;if(n&&Object.keys(e).length===0)return n;let i=D({},n);for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=Zr(i[r],e[r],t-1));return i;}function Pp(){return Ht();}function jc(){return Ht().substring(16);}var wp="_sentrySpan";function Mp(n,e){e?Hn(n,wp,e):delete n[wp];}function Sp(n){return n[wp];}var Ow=100,In=class n{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Pp(),sampleRand:Math.random()};}clone(){let e=new n();return e._breadcrumbs=[...this._breadcrumbs],e._tags=D({},this._tags),e._extra=D({},this._extra),e._contexts=D({},this._contexts),this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata=D({},this._sdkProcessingMetadata),e._propagationContext=D({},this._propagationContext),e._client=this._client,e._lastEventId=this._lastEventId,Mp(e,Sp(this)),e;}setClient(e){this._client=e;}setLastEventId(e){this._lastEventId=e;}getClient(){return this._client;}lastEventId(){return this._lastEventId;}addScopeListener(e){this._scopeListeners.push(e);}addEventProcessor(e){return this._eventProcessors.push(e),this;}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Cr(this._session,{user:e}),this._notifyScopeListeners(),this;}getUser(){return this._user;}setTags(e){return this._tags=D(D({},this._tags),e),this._notifyScopeListeners(),this;}setTag(e,t){return this._tags=se(D({},this._tags),{[e]:t}),this._notifyScopeListeners(),this;}setExtras(e){return this._extra=D(D({},this._extra),e),this._notifyScopeListeners(),this;}setExtra(e,t){return this._extra=se(D({},this._extra),{[e]:t}),this._notifyScopeListeners(),this;}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this;}setLevel(e){return this._level=e,this._notifyScopeListeners(),this;}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this;}setContext(e,t){return t===null?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this;}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this;}getSession(){return this._session;}update(e){if(!e)return this;let t=typeof e=="function"?e(this):e,i=t instanceof n?t.getScopeData():vr(t)?e:void 0,{tags:r,extra:o,user:s,contexts:l,level:c,fingerprint:d=[],propagationContext:u}=i||{};return this._tags=D(D({},this._tags),r),this._extra=D(D({},this._extra),o),this._contexts=D(D({},this._contexts),l),s&&Object.keys(s).length&&(this._user=s),c&&(this._level=c),d.length&&(this._fingerprint=d),u&&(this._propagationContext=u),this;}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Mp(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Pp(),sampleRand:Math.random()}),this._notifyScopeListeners(),this;}addBreadcrumb(e,t){let i=typeof t=="number"?t:Ow;if(i<=0)return this;let r=se(D({timestamp:qi()},e),{message:e.message?qr(e.message,2048):e.message});return this._breadcrumbs.push(r),this._breadcrumbs.length>i&&(this._breadcrumbs=this._breadcrumbs.slice(-i),this._client?.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this;}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1];}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this;}addAttachment(e){return this._attachments.push(e),this;}clearAttachments(){return this._attachments=[],this;}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Sp(this)};}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Zr(this._sdkProcessingMetadata,e,2),this;}setPropagationContext(e){return this._propagationContext=e,this;}getPropagationContext(){return this._propagationContext;}captureException(e,t){let i=t?.event_id||Ht();if(!this._client)return Ie&&Pe.warn("No client configured on scope - will not capture exception!"),i;let r=new Error("Sentry syntheticException");return this._client.captureException(e,se(D({originalException:e,syntheticException:r},t),{event_id:i}),this),i;}captureMessage(e,t,i){let r=i?.event_id||Ht();if(!this._client)return Ie&&Pe.warn("No client configured on scope - will not capture message!"),r;let o=new Error(e);return this._client.captureMessage(e,t,se(D({originalException:e,syntheticException:o},i),{event_id:r}),this),r;}captureEvent(e,t){let i=t?.event_id||Ht();return this._client?(this._client.captureEvent(e,se(D({},t),{event_id:i}),this),i):(Ie&&Pe.warn("No client configured on scope - will not capture event!"),i);}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this);}),this._notifyingListeners=!1);}};function lv(){return _r("defaultCurrentScope",()=>new In());}function hv(){return _r("defaultIsolationScope",()=>new In());}var Ep=class{constructor(e,t){let i;e?i=e:i=new In();let r;t?r=t:r=new In(),this._stack=[{scope:i}],this._isolationScope=r;}withScope(e){let t=this._pushScope(),i;try{i=e(t);}catch(r){throw this._popScope(),r;}return yr(i)?i.then(r=>(this._popScope(),r),r=>{throw this._popScope(),r;}):(this._popScope(),i);}getClient(){return this.getStackTop().client;}getScope(){return this.getStackTop().scope;}getIsolationScope(){return this._isolationScope;}getStackTop(){return this._stack[this._stack.length-1];}_pushScope(){let e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e;}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop();}};function Hs(){let n=ko(),e=Io(n);return e.stack=e.stack||new Ep(lv(),hv());}function Tw(n){return Hs().withScope(n);}function kw(n,e){let t=Hs();return t.withScope(()=>(t.getStackTop().scope=n,e(n)));}function dv(n){return Hs().withScope(()=>n(Hs().getIsolationScope()));}function uv(){return{withIsolationScope:dv,withScope:Tw,withSetScope:kw,withSetIsolationScope:(n,e)=>dv(e),getCurrentScope:()=>Hs().getScope(),getIsolationScope:()=>Hs().getIsolationScope()};}function $c(n){let e=Io(n);return e.acs?e.acs:uv();}function gn(){let n=ko();return $c(n).getCurrentScope();}function vi(){let n=ko();return $c(n).getIsolationScope();}function Uc(){return _r("globalScope",()=>new In());}function Xa(...n){let e=ko(),t=$c(e);if(n.length===2){let[i,r]=n;return i?t.withSetScope(i,r):t.withScope(r);}return t.withScope(n[0]);}function mt(){return gn().getClient();}function Op(n){let e=n.getPropagationContext(),{traceId:t,parentSpanId:i,propagationSpanId:r}=e,o={trace_id:t,span_id:r||jc()};return i&&(o.parent_span_id=i),o;}var qa="sentry.source",Tp="sentry.sample_rate",pv="sentry.previous_trace_sample_rate",kp="sentry.op",Hc="sentry.origin";var Ip="sentry.profile_id",Ap="sentry.exclusive_time";var Iw="_sentryScope",Aw="_sentryIsolationScope";function Wc(n){return{scope:n[Iw],isolationScope:n[Aw]};}var Fw="sentry-",Rw=/^sentry-/;function gv(n){let e=Lw(n);if(!e)return;let t=Object.entries(e).reduce((i,[r,o])=>{if(r.match(Rw)){let s=r.slice(Fw.length);i[s]=o;}return i;},{});if(Object.keys(t).length>0)return t;}function Lw(n){if(!(!n||!sn(n)&&!Array.isArray(n)))return Array.isArray(n)?n.reduce((e,t)=>{let i=fv(t);return Object.entries(i).forEach(([r,o])=>{e[r]=o;}),e;},{}):fv(n);}function fv(n){return n.split(",").map(e=>e.split("=").map(t=>{try{return decodeURIComponent(t.trim());}catch{return;}})).reduce((e,[t,i])=>(t&&i&&(e[t]=i),e),{});}function mv(n){if(typeof n=="boolean")return Number(n);let e=typeof n=="string"?parseFloat(n):n;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e;}var Cv=1,_v=!1;function Fp(n){let{spanId:e,traceId:t,isRemote:i}=n.spanContext(),r=i?e:No(n).parent_span_id,o=Wc(n).scope,s=i?o?.getPropagationContext().propagationSpanId||jc():e;return{parent_span_id:r,span_id:s,trace_id:t};}function Dw(n){if(n&&n.length>0)return n.map(s=>{var l=s,{context:c}=l,d=c,{spanId:e,traceId:t,traceFlags:i}=d,r=lt(d,["spanId","traceId","traceFlags"]),{attributes:o}=l;return D({span_id:e,trace_id:t,sampled:i===Cv,attributes:o},r);});}function vv(n){return typeof n=="number"?yv(n):Array.isArray(n)?n[0]+n[1]/1e9:n instanceof Date?yv(n.getTime()):fn();}function yv(n){return n>9999999999?n/1e3:n;}function No(n){if(Bw(n))return n.getSpanJSON();let{spanId:e,traceId:t}=n.spanContext();if(Nw(n)){let{attributes:i,startTime:r,name:o,endTime:s,status:l,links:c}=n,d="parentSpanId"in n?n.parentSpanId:"parentSpanContext"in n?n.parentSpanContext?.spanId:void 0;return{span_id:e,trace_id:t,data:i,description:o,parent_span_id:d,start_timestamp:vv(r),timestamp:vv(s)||void 0,status:Vw(l),op:i[kp],origin:i[Hc],links:Dw(c)};}return{span_id:e,trace_id:t,start_timestamp:0,data:{}};}function Nw(n){let e=n;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status;}function Bw(n){return typeof n.getSpanJSON=="function";}function bv(n){let{traceFlags:e}=n.spanContext();return e===Cv;}function Vw(n){if(!(!n||n.code===0))return n.code===1?"ok":n.message||"unknown_error";}var zw="_sentryRootSpan";function Ws(n){return n[zw]||n;}function Rp(){_v||(Un(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.");}),_v=!0);}function xv(n){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;let e=n||mt()?.getOptions();return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler);}var Gs="production";var jw=/^o(\d+)\./,$w=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Uw(n){return n==="http"||n==="https";}function Kr(n,e=!1){let{host:t,path:i,pass:r,port:o,projectId:s,protocol:l,publicKey:c}=n;return`${l}://${c}${e&&r?`:${r}`:""}@${t}${o?`:${o}`:""}/${i&&`${i}/`}${s}`;}function Hw(n){let e=$w.exec(n);if(!e){Un(()=>{console.error(`Invalid Sentry Dsn: ${n}`);});return;}let[t,i,r="",o="",s="",l=""]=e.slice(1),c="",d=l,u=d.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),d=u.pop()),d){let g=d.match(/^\d+/);g&&(d=g[0]);}return Pv({host:o,pass:r,path:c,projectId:d,port:s,protocol:t,publicKey:i});}function Pv(n){return{protocol:n.protocol,publicKey:n.publicKey||"",pass:n.pass||"",host:n.host,port:n.port||"",path:n.path||"",projectId:n.projectId};}function Ww(n){if(!Ie)return!0;let{port:e,projectId:t,protocol:i}=n;return["protocol","publicKey","host","projectId"].find(s=>n[s]?!1:(Pe.error(`Invalid Sentry Dsn: ${s} missing`),!0))?!1:t.match(/^\d+$/)?Uw(i)?e&&isNaN(parseInt(e,10))?(Pe.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(Pe.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),!1):(Pe.error(`Invalid Sentry Dsn: Invalid projectId ${t}`),!1);}function wv(n){return n.match(jw)?.[1];}function Mv(n){let e=typeof n=="string"?Hw(n):Pv(n);if(!(!e||!Ww(e)))return e;}var Gw="_frozenDsc";function Sv(n,e){let t=e.getOptions(),{publicKey:i,host:r}=e.getDsn()||{},o;t.orgId?o=String(t.orgId):r&&(o=wv(r));let s={environment:t.environment||Gs,release:t.release,public_key:i,trace_id:n,org_id:o};return e.emit("createDsc",s),s;}function Ev(n,e){let t=e.getPropagationContext();return t.dsc||Sv(t.traceId,n);}function Lp(n){let e=mt();if(!e)return{};let t=Ws(n),i=No(t),r=i.data,o=t.spanContext().traceState,s=o?.get("sentry.sample_rate")??r[Tp]??r[pv];function l(_){return(typeof s=="number"||typeof s=="string")&&(_.sample_rate=`${s}`),_;}let c=t[Gw];if(c)return l(c);let d=o?.get("sentry.dsc"),u=d&&gv(d);if(u)return l(u);let g=Sv(n.spanContext().traceId,e),f=r[qa],m=i.description;return f!=="url"&&m&&(g.transaction=m),xv()&&(g.sampled=String(bv(t)),g.sample_rand=o?.get("sentry.sample_rand")??Wc(t).scope?.getPropagationContext().sampleRand.toString()),l(g),e.emit("createDsc",g,t),g;}function si(n,e=100,t=1/0){try{return Dp("",n,e,t);}catch(i){return{ERROR:`**non-serializable** (${i})`};}}function Gc(n,e=3,t=100*1024){let i=si(n,e);return Zw(i)>t?Gc(n,e-1,t):i;}function Dp(n,e,t=1/0,i=1/0,r=Kw()){let[o,s]=r;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;let l=Yw(n,e);if(!l.startsWith("[object "))return l;if(e.__sentry_skip_normalization__)return e;let c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:t;if(c===0)return l.replace("object ","");if(o(e))return"[Circular ~]";let d=e;if(d&&typeof d.toJSON=="function")try{let m=d.toJSON();return Dp("",m,c-1,i,r);}catch{}let u=Array.isArray(e)?[]:{},g=0,f=Vc(e);for(let m in f){if(!Object.prototype.hasOwnProperty.call(f,m))continue;if(g>=i){u[m]="[MaxProperties ~]";break;}let _=f[m];u[m]=Dp(m,_,c-1,i,r),g++;}return s(e),u;}function Yw(n,e){try{if(n==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(n==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(Ga(e))return"[VueViewModel]";if(yp(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${oi(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;let t=Xw(e);return /^HTML(\w*)Element$/.test(t)?`[HTMLElement: ${t}]`:`[object ${t}]`;}catch(t){return`**non-serializable** (${t})`;}}function Xw(n){let e=Object.getPrototypeOf(n);return e?.constructor?e.constructor.name:"null prototype";}function qw(n){return~-encodeURI(n).split(/%..|./).length;}function Zw(n){return qw(JSON.stringify(n));}function Kw(){let n=new WeakSet();function e(i){return n.has(i)?!0:(n.add(i),!1);}function t(i){n.delete(i);}return[e,t];}function br(n,e=[]){return[n,e];}function Ov(n,e){let[t,i]=n;return[t,[...i,e]];}function Bp(n,e){let t=n[1];for(let i of t){let r=i[0].type;if(e(i,r))return!0;}return!1;}function Np(n){let e=Io(Ne);return e.encodePolyfill?e.encodePolyfill(n):new TextEncoder().encode(n);}function Tv(n){let[e,t]=n,i=JSON.stringify(e);function r(o){typeof i=="string"?i=typeof o=="string"?i+o:[Np(i),o]:i.push(typeof o=="string"?Np(o):o);}for(let o of t){let[s,l]=o;if(r(`
${JSON.stringify(s)}
`),typeof l=="string"||l instanceof Uint8Array)r(l);else{let c;try{c=JSON.stringify(l);}catch{c=JSON.stringify(si(l));}r(c);}}return typeof i=="string"?i:Jw(i);}function Jw(n){let e=n.reduce((r,o)=>r+o.length,0),t=new Uint8Array(e),i=0;for(let r of n)t.set(r,i),i+=r.length;return t;}function kv(n){let e=typeof n.data=="string"?Np(n.data):n.data;return[{type:"attachment",length:e.length,filename:n.filename,content_type:n.contentType,attachment_type:n.attachmentType},e];}var Qw={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function Vp(n){return Qw[n];}function zp(n){if(!n?.sdk)return;let{name:e,version:t}=n.sdk;return{name:e,version:t};}function Iv(n,e,t,i){let r=n.sdkProcessingMetadata?.dynamicSamplingContext;return D(D(D({event_id:n.event_id,sent_at:new Date().toISOString()},e&&{sdk:e}),!!t&&i&&{dsn:Kr(i)}),r&&{trace:r});}function eM(n,e){return e&&(n.sdk=n.sdk||{},n.sdk.name=n.sdk.name||e.name,n.sdk.version=n.sdk.version||e.version,n.sdk.integrations=[...(n.sdk.integrations||[]),...(e.integrations||[])],n.sdk.packages=[...(n.sdk.packages||[]),...(e.packages||[])]),n;}function Av(n,e,t,i){let r=zp(t),o=D(D({sent_at:new Date().toISOString()},r&&{sdk:r}),!!i&&e&&{dsn:Kr(e)}),s="aggregates"in n?[{type:"sessions"},n]:[{type:"session"},n.toJSON()];return br(o,[s]);}function Fv(n,e,t,i){let r=zp(t),o=n.type&&n.type!=="replay_event"?n.type:"event";eM(n,t?.sdk);let s=Iv(n,r,i,e);return delete n.sdkProcessingMetadata,br(s,[[{type:o},n]]);}var jp=0,Rv=1,Lv=2;function ai(n){return new yi(e=>{e(n);});}function Jr(n){return new yi((e,t)=>{t(n);});}var yi=class n{constructor(e){this._state=jp,this._handlers=[],this._runExecutor(e);}then(e,t){return new n((i,r)=>{this._handlers.push([!1,o=>{if(!e)i(o);else try{i(e(o));}catch(s){r(s);}},o=>{if(!t)r(o);else try{i(t(o));}catch(s){r(s);}}]),this._executeHandlers();});}catch(e){return this.then(t=>t,e);}finally(e){return new n((t,i)=>{let r,o;return this.then(s=>{o=!1,r=s,e&&e();},s=>{o=!0,r=s,e&&e();}).then(()=>{if(o){i(r);return;}t(r);});});}_executeHandlers(){if(this._state===jp)return;let e=this._handlers.slice();this._handlers=[],e.forEach(t=>{t[0]||(this._state===Rv&&t[1](this._value),this._state===Lv&&t[2](this._value),t[0]=!0);});}_runExecutor(e){let t=(o,s)=>{if(this._state===jp){if(yr(s)){s.then(i,r);return;}this._state=o,this._value=s,this._executeHandlers();}},i=o=>{t(Rv,o);},r=o=>{t(Lv,o);};try{e(i,r);}catch(o){r(o);}}};function Yc(n,e,t,i=0){return new yi((r,o)=>{let s=n[i];if(e===null||typeof s!="function")r(e);else{let l=s(D({},e),t);Ie&&s.id&&l===null&&Pe.log(`Event processor "${s.id}" dropped event`),yr(l)?l.then(c=>Yc(n,c,t,i+1).then(r)).then(null,o):Yc(n,l,t,i+1).then(r).then(null,o);}});}function Dv(n,e){let{fingerprint:t,span:i,breadcrumbs:r,sdkProcessingMetadata:o}=e;tM(n,e),i&&rM(n,i),oM(n,t),nM(n,r),iM(n,o);}function $p(n,e){let{extra:t,tags:i,user:r,contexts:o,level:s,sdkProcessingMetadata:l,breadcrumbs:c,fingerprint:d,eventProcessors:u,attachments:g,propagationContext:f,transactionName:m,span:_}=e;Xc(n,"extra",t),Xc(n,"tags",i),Xc(n,"user",r),Xc(n,"contexts",o),n.sdkProcessingMetadata=Zr(n.sdkProcessingMetadata,l,2),s&&(n.level=s),m&&(n.transactionName=m),_&&(n.span=_),c.length&&(n.breadcrumbs=[...n.breadcrumbs,...c]),d.length&&(n.fingerprint=[...n.fingerprint,...d]),u.length&&(n.eventProcessors=[...n.eventProcessors,...u]),g.length&&(n.attachments=[...n.attachments,...g]),n.propagationContext=D(D({},n.propagationContext),f);}function Xc(n,e,t){n[e]=Zr(n[e],t,1);}function tM(n,e){let{extra:t,tags:i,user:r,contexts:o,level:s,transactionName:l}=e;Object.keys(t).length&&(n.extra=D(D({},t),n.extra)),Object.keys(i).length&&(n.tags=D(D({},i),n.tags)),Object.keys(r).length&&(n.user=D(D({},r),n.user)),Object.keys(o).length&&(n.contexts=D(D({},o),n.contexts)),s&&(n.level=s),l&&n.type!=="transaction"&&(n.transaction=l);}function nM(n,e){let t=[...(n.breadcrumbs||[]),...e];n.breadcrumbs=t.length?t:void 0;}function iM(n,e){n.sdkProcessingMetadata=D(D({},n.sdkProcessingMetadata),e);}function rM(n,e){n.contexts=D({trace:Fp(e)},n.contexts),n.sdkProcessingMetadata=D({dynamicSamplingContext:Lp(e)},n.sdkProcessingMetadata);let t=Ws(e),i=No(t).description;i&&!n.transaction&&n.type==="transaction"&&(n.transaction=i);}function oM(n,e){n.fingerprint=n.fingerprint?Array.isArray(n.fingerprint)?n.fingerprint:[n.fingerprint]:[],e&&(n.fingerprint=n.fingerprint.concat(e)),n.fingerprint.length||delete n.fingerprint;}var qc,Nv,Zc;function Bv(n){let e=Ne._sentryDebugIds;if(!e)return{};let t=Object.keys(e);return Zc&&t.length===Nv||(Nv=t.length,Zc=t.reduce((i,r)=>{qc||(qc={});let o=qc[r];if(o)i[o[0]]=o[1];else{let s=n(r);for(let l=s.length-1;l>=0;l--){let d=s[l]?.filename,u=e[r];if(d&&u){i[d]=u,qc[r]=[d,u];break;}}}return i;},{})),Zc;}function Vv(n,e,t,i,r,o){let{normalizeDepth:s=3,normalizeMaxBreadth:l=1e3}=n,c=se(D({},e),{event_id:e.event_id||t.event_id||Ht(),timestamp:e.timestamp||qi()}),d=t.integrations||n.integrations.map(E=>E.name);sM(c,n),cM(c,d),r&&r.emit("applyFrameMetadata",e),e.type===void 0&&aM(c,n.stackParser);let u=dM(i,t.captureContext);t.mechanism&&Xi(c,t.mechanism);let g=r?r.getEventProcessors():[],f=Uc().getScopeData();if(o){let E=o.getScopeData();$p(f,E);}if(u){let E=u.getScopeData();$p(f,E);}let m=[...(t.attachments||[]),...f.attachments];m.length&&(t.attachments=m),Dv(c,f);let _=[...g,...f.eventProcessors];return Yc(_,c,t).then(E=>(E&&lM(E),typeof s=="number"&&s>0?hM(E,s,l):E));}function sM(n,e){let{environment:t,release:i,dist:r,maxValueLength:o=250}=e;n.environment=n.environment||t||Gs,!n.release&&i&&(n.release=i),!n.dist&&r&&(n.dist=r);let s=n.request;s?.url&&(s.url=qr(s.url,o));}function aM(n,e){let t=Bv(e);n.exception?.values?.forEach(i=>{i.stacktrace?.frames?.forEach(r=>{r.filename&&(r.debug_id=t[r.filename]);});});}function lM(n){let e={};if(n.exception?.values?.forEach(i=>{i.stacktrace?.frames?.forEach(r=>{r.debug_id&&(r.abs_path?e[r.abs_path]=r.debug_id:r.filename&&(e[r.filename]=r.debug_id),delete r.debug_id);});}),Object.keys(e).length===0)return;n.debug_meta=n.debug_meta||{},n.debug_meta.images=n.debug_meta.images||[];let t=n.debug_meta.images;Object.entries(e).forEach(([i,r])=>{t.push({type:"sourcemap",code_file:i,debug_id:r});});}function cM(n,e){e.length>0&&(n.sdk=n.sdk||{},n.sdk.integrations=[...(n.sdk.integrations||[]),...e]);}function hM(n,e,t){if(!n)return null;let i=D(D(D(D(D({},n),n.breadcrumbs&&{breadcrumbs:n.breadcrumbs.map(r=>D(D({},r),r.data&&{data:si(r.data,e,t)}))}),n.user&&{user:si(n.user,e,t)}),n.contexts&&{contexts:si(n.contexts,e,t)}),n.extra&&{extra:si(n.extra,e,t)});return n.contexts?.trace&&i.contexts&&(i.contexts.trace=n.contexts.trace,n.contexts.trace.data&&(i.contexts.trace.data=si(n.contexts.trace.data,e,t))),n.spans&&(i.spans=n.spans.map(r=>D(D({},r),r.data&&{data:si(r.data,e,t)}))),n.contexts?.flags&&i.contexts&&(i.contexts.flags=si(n.contexts.flags,3,t)),i;}function dM(n,e){if(!e)return n;let t=n?n.clone():new In();return t.update(e),t;}function zv(n){if(n)return uM(n)?{captureContext:n}:fM(n)?{captureContext:n}:n;}function uM(n){return n instanceof In||typeof n=="function";}var pM=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function fM(n){return Object.keys(n).some(e=>pM.includes(e));}function Kc(n,e){return gn().captureException(n,zv(e));}function Jc(n,e){let t=typeof e=="string"?e:void 0,i=typeof e!="string"?{captureContext:e}:void 0;return gn().captureMessage(n,t,i);}function Za(n,e){return gn().captureEvent(n,e);}function Qc(n,e){vi().setContext(n,e);}function Ka(n){let e=vi(),t=gn(),{userAgent:i}=Ne.navigator||{},r=sv(D(D({user:t.getUser()||e.getUser()},i&&{userAgent:i}),n)),o=e.getSession();return o?.status==="ok"&&Cr(o,{status:"exited"}),eh(),e.setSession(r),r;}function eh(){let n=vi(),t=gn().getSession()||n.getSession();t&&av(t),$v(),n.setSession();}function $v(){let n=vi(),e=mt(),t=n.getSession();t&&e&&e.captureSession(t);}function Ja(n=!1){if(n){eh();return;}$v();}var gM="7";function mM(n){let e=n.protocol?`${n.protocol}:`:"",t=n.port?`:${n.port}`:"";return`${e}//${n.host}${t}${n.path?`/${n.path}`:""}/api/`;}function _M(n){return`${mM(n)}${n.projectId}/envelope/`;}function vM(n,e){let t={sentry_version:gM};return n.publicKey&&(t.sentry_key=n.publicKey),e&&(t.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(t).toString();}function Uv(n,e,t){return e||`${_M(n)}?${vM(n,t)}`;}var Hv=[];function yM(n){let e={};return n.forEach(t=>{let{name:i}=t,r=e[i];r&&!r.isDefaultInstance&&t.isDefaultInstance||(e[i]=t);}),Object.values(e);}function Up(n){let e=n.defaultIntegrations||[],t=n.integrations;e.forEach(r=>{r.isDefaultInstance=!0;});let i;if(Array.isArray(t))i=[...e,...t];else if(typeof t=="function"){let r=t(e);i=Array.isArray(r)?r:[r];}else i=e;return yM(i);}function Wv(n,e){let t={};return e.forEach(i=>{i&&Wp(n,i,t);}),t;}function Hp(n,e){for(let t of e)t?.afterAllSetup&&t.afterAllSetup(n);}function Wp(n,e,t){if(t[e.name]){Ie&&Pe.log(`Integration skipped because it was already installed: ${e.name}`);return;}if(t[e.name]=e,Hv.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),Hv.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(n),typeof e.preprocessEvent=="function"){let i=e.preprocessEvent.bind(e);n.on("preprocessEvent",(r,o)=>i(r,o,n));}if(typeof e.processEvent=="function"){let i=e.processEvent.bind(e),r=Object.assign((o,s)=>i(o,s,n),{id:e.name});n.addEventProcessor(r);}Ie&&Pe.log(`Integration installed: ${e.name}`);}function Gv(n,e,t){let i=[{type:"client_report"},{timestamp:t||qi(),discarded_events:n}];return br(e?{dsn:e}:{},[i]);}function th(n){let e=[];n.message&&e.push(n.message);try{let t=n.exception.values[n.exception.values.length-1];t?.value&&(e.push(t.value),t.type&&e.push(`${t.type}: ${t.value}`));}catch{}return e;}function Yv(n){let{trace_id:e,parent_span_id:t,span_id:i,status:r,origin:o,data:s,op:l}=n.contexts?.trace??{};return{data:s??{},description:n.transaction,op:l,parent_span_id:t,span_id:i??"",start_timestamp:n.start_timestamp??0,status:r,timestamp:n.timestamp,trace_id:e??"",origin:o,profile_id:s?.[Ip],exclusive_time:s?.[Ap],measurements:n.measurements,is_segment:!0};}function Xv(n){return{type:"transaction",timestamp:n.timestamp,start_timestamp:n.start_timestamp,transaction:n.description,contexts:{trace:{trace_id:n.trace_id,span_id:n.span_id,parent_span_id:n.parent_span_id,op:n.op,status:n.status,origin:n.origin,data:D(D(D({},n.data),n.profile_id&&{[Ip]:n.profile_id}),n.exclusive_time&&{[Ap]:n.exclusive_time})}},measurements:n.measurements};}var qv="Not capturing exception because it's already been captured.",Zv="Discarded session because of missing or non-string release",ey=Symbol.for("SentryInternalError"),ty=Symbol.for("SentryDoNotSendEventError");function nh(n){return{message:n,[ey]:!0};}function Gp(n){return{message:n,[ty]:!0};}function Kv(n){return!!n&&typeof n=="object"&&ey in n;}function Jv(n){return!!n&&typeof n=="object"&&ty in n;}var Qa=class{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Mv(e.dsn):Ie&&Pe.warn("No DSN provided, client will not send events."),this._dsn){let t=Uv(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport(se(D({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this)},e.transportOptions),{url:t}));}}captureException(e,t,i){let r=Ht();if(zc(e))return Ie&&Pe.log(qv),r;let o=D({event_id:r},t);return this._process(this.eventFromException(e,o).then(s=>this._captureEvent(s,o,i))),o.event_id;}captureMessage(e,t,i,r){let o=D({event_id:Ht()},i),s=js(e)?e:String(e),l=Fo(e)?this.eventFromMessage(s,t,o):this.eventFromException(e,o);return this._process(l.then(c=>this._captureEvent(c,o,r))),o.event_id;}captureEvent(e,t,i){let r=Ht();if(t?.originalException&&zc(t.originalException))return Ie&&Pe.log(qv),r;let o=D({event_id:r},t),s=e.sdkProcessingMetadata||{},l=s.capturedSpanScope,c=s.capturedSpanIsolationScope;return this._process(this._captureEvent(e,o,l||i,c)),o.event_id;}captureSession(e){this.sendSession(e),Cr(e,{init:!1});}getDsn(){return this._dsn;}getOptions(){return this._options;}getSdkMetadata(){return this._options._metadata;}getTransport(){return this._transport;}flush(e){let t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then(i=>t.flush(e).then(r=>i&&r))):ai(!0);}close(e){return this.flush(e).then(t=>(this.getOptions().enabled=!1,this.emit("close"),t));}getEventProcessors(){return this._eventProcessors;}addEventProcessor(e){this._eventProcessors.push(e);}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations();}getIntegrationByName(e){return this._integrations[e];}addIntegration(e){let t=this._integrations[e.name];Wp(this,e,this._integrations),t||Hp(this,[e]);}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let i=Fv(e,this._dsn,this._options._metadata,this._options.tunnel);for(let o of t.attachments||[])i=Ov(i,kv(o));let r=this.sendEnvelope(i);r&&r.then(o=>this.emit("afterSendEvent",e,o),null);}sendSession(e){let{release:t,environment:i=Gs}=this._options;if("aggregates"in e){let o=e.attrs||{};if(!o.release&&!t){Ie&&Pe.warn(Zv);return;}o.release=o.release||t,o.environment=o.environment||i,e.attrs=o;}else{if(!e.release&&!t){Ie&&Pe.warn(Zv);return;}e.release=e.release||t,e.environment=e.environment||i;}this.emit("beforeSendSession",e);let r=Av(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r);}recordDroppedEvent(e,t,i=1){if(this._options.sendClientReports){let r=`${e}:${t}`;Ie&&Pe.log(`Recording outcome: "${r}"${i>1?` (${i} times)`:""}`),this._outcomes[r]=(this._outcomes[r]||0)+i;}}on(e,t){let i=this._hooks[e]=this._hooks[e]||[];return i.push(t),()=>{let r=i.indexOf(t);r>-1&&i.splice(r,1);};}emit(e,...t){let i=this._hooks[e];i&&i.forEach(r=>r(...t));}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,t=>(Ie&&Pe.error("Error while sending envelope:",t),t)):(Ie&&Pe.error("Transport disabled"),ai({}));}_setupIntegrations(){let{integrations:e}=this._options;this._integrations=Wv(this,e),Hp(this,e);}_updateSessionFromEvent(e,t){let i=t.level==="fatal",r=!1,o=t.exception?.values;if(o){r=!0;for(let c of o)if(c.mechanism?.handled===!1){i=!0;break;}}let s=e.status==="ok";(s&&e.errors===0||s&&i)&&(Cr(e,se(D({},i&&{status:"crashed"}),{errors:e.errors||Number(r||i)})),this.captureSession(e));}_isClientDoneProcessing(e){return new yi(t=>{let i=0,r=1,o=setInterval(()=>{this._numProcessing==0?(clearInterval(o),t(!0)):(i+=r,e&&i>=e&&(clearInterval(o),t(!1)));},r);});}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0;}_prepareEvent(e,t,i,r){let o=this.getOptions(),s=Object.keys(this._integrations);return!t.integrations&&s?.length&&(t.integrations=s),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),Vv(o,e,t,i,this,r).then(l=>{if(l===null)return l;this.emit("postprocessEvent",l,t),l.contexts=D({trace:Op(i)},l.contexts);let c=Ev(this,i);return l.sdkProcessingMetadata=D({dynamicSamplingContext:c},l.sdkProcessingMetadata),l;});}_captureEvent(e,t={},i=gn(),r=vi()){return Ie&&Yp(e)&&Pe.log(`Captured error event \`${th(e)[0]||"<unknown>"}\``),this._processEvent(e,t,i,r).then(o=>o.event_id,o=>{Ie&&(Jv(o)?Pe.log(o.message):Kv(o)?Pe.warn(o.message):Pe.warn(o));});}_processEvent(e,t,i,r){let o=this.getOptions(),{sampleRate:s}=o,l=ny(e),c=Yp(e),d=e.type||"error",u=`before send for type \`${d}\``,g=typeof s>"u"?void 0:mv(s);if(c&&typeof g=="number"&&Math.random()>g)return this.recordDroppedEvent("sample_rate","error"),Jr(Gp(`Discarding event because it's not included in the random sample (sampling rate = ${s})`));let f=d==="replay_event"?"replay":d;return this._prepareEvent(e,t,i,r).then(m=>{if(m===null)throw this.recordDroppedEvent("event_processor",f),Gp("An event processor returned `null`, will not send event.");if(t.data&&t.data.__sentry__===!0)return m;let y=bM(this,o,m,t);return CM(y,u);}).then(m=>{if(m===null){if(this.recordDroppedEvent("before_send",f),l){let C=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",C);}throw Gp(`${u} returned \`null\`, will not send event.`);}let _=i.getSession()||r.getSession();if(c&&_&&this._updateSessionFromEvent(_,m),l){let E=m.sdkProcessingMetadata?.spanCountBeforeProcessing||0,C=m.spans?m.spans.length:0,b=E-C;b>0&&this.recordDroppedEvent("before_send","span",b);}let y=m.transaction_info;if(l&&y&&m.transaction!==e.transaction){let E="custom";m.transaction_info=se(D({},y),{source:E});}return this.sendEvent(m,t),m;}).then(null,m=>{throw Jv(m)||Kv(m)?m:(this.captureException(m,{data:{__sentry__:!0},originalException:m}),nh(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${m}`));});}_process(e){this._numProcessing++,e.then(t=>(this._numProcessing--,t),t=>(this._numProcessing--,t));}_clearOutcomes(){let e=this._outcomes;return this._outcomes={},Object.entries(e).map(([t,i])=>{let[r,o]=t.split(":");return{reason:r,category:o,quantity:i};});}_flushOutcomes(){Ie&&Pe.log("Flushing outcomes...");let e=this._clearOutcomes();if(e.length===0){Ie&&Pe.log("No outcomes to send");return;}if(!this._dsn){Ie&&Pe.log("No dsn provided, will not send outcomes");return;}Ie&&Pe.log("Sending outcomes:",e);let t=Gv(e,this._options.tunnel&&Kr(this._dsn));this.sendEnvelope(t);}};function CM(n,e){let t=`${e} must return \`null\` or a valid event.`;if(yr(n))return n.then(i=>{if(!vr(i)&&i!==null)throw nh(t);return i;},i=>{throw nh(`${e} rejected with ${i}`);});if(!vr(n)&&n!==null)throw nh(t);return n;}function bM(n,e,t,i){let{beforeSend:r,beforeSendTransaction:o,beforeSendSpan:s}=e,l=t;if(Yp(l)&&r)return r(l,i);if(ny(l)){if(s){let c=s(Yv(l));if(c?l=Zr(t,Xv(c)):Rp(),l.spans){let d=[];for(let u of l.spans){let g=s(u);g?d.push(g):(Rp(),d.push(u));}l.spans=d;}}if(o){if(l.spans){let c=l.spans.length;l.sdkProcessingMetadata=se(D({},t.sdkProcessingMetadata),{spanCountBeforeProcessing:c});}return o(l,i);}}return l;}function Yp(n){return n.type===void 0;}function ny(n){return n.type==="transaction";}function xM(n){return[{type:"log",item_count:n.length,content_type:"application/vnd.sentry.items.log+json"},{items:n}];}function iy(n,e,t,i){let r={};return e?.sdk&&(r.sdk={name:e.sdk.name,version:e.sdk.version}),t&&i&&(r.dsn=Kr(i)),br(r,[xM(n)]);}function el(n,e){let t=e??PM(n)??[];if(t.length===0)return;let i=n.getOptions(),r=iy(t,i._metadata,i.tunnel,n.getDsn());ry().set(n,[]),n.emit("flushLogs"),n.sendEnvelope(r);}function PM(n){return ry().get(n);}function ry(){return _r("clientToLogBufferMap",()=>new WeakMap());}function Xp(n,e){e.debug===!0&&(Ie?Pe.enable():Un(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.");})),gn().update(e.initialScope);let i=new n(e);return qp(i),i.init(),i;}function qp(n){gn().setClient(n);}var Zp=Symbol.for("SentryBufferFullError");function oy(n){let e=[];function t(){return n===void 0||e.length<n;}function i(s){return e.splice(e.indexOf(s),1)[0]||Promise.resolve(void 0);}function r(s){if(!t())return Jr(Zp);let l=s();return e.indexOf(l)===-1&&e.push(l),l.then(()=>i(l)).then(null,()=>i(l).then(null,()=>{})),l;}function o(s){return new yi((l,c)=>{let d=e.length;if(!d)return l(!0);let u=setTimeout(()=>{s&&s>0&&l(!1);},s);e.forEach(g=>{ai(g).then(()=>{--d||(clearTimeout(u),l(!0));},c);});});}return{$:e,add:r,drain:o};}function wM(n,e=Date.now()){let t=parseInt(`${n}`,10);if(!isNaN(t))return t*1e3;let i=Date.parse(`${n}`);return isNaN(i)?6e4:i-e;}function MM(n,e){return n[e]||n.all||0;}function sy(n,e,t=Date.now()){return MM(n,e)>t;}function ay(n,{statusCode:e,headers:t},i=Date.now()){let r=D({},n),o=t?.["x-sentry-rate-limits"],s=t?.["retry-after"];if(o)for(let l of o.trim().split(",")){let[c,d,,,u]=l.split(":",5),g=parseInt(c,10),f=(isNaN(g)?60:g)*1e3;if(!d)r.all=i+f;else for(let m of d.split(";"))m==="metric_bucket"?(!u||u.split(";").includes("custom"))&&(r[m]=i+f):r[m]=i+f;}else s?r.all=i+wM(s,i):e===429&&(r.all=i+60*1e3);return r;}var SM=64;function ih(n,e,t=oy(n.bufferSize||SM)){let i={},r=s=>t.drain(s);function o(s){let l=[];if(Bp(s,(g,f)=>{let m=Vp(f);sy(i,m)?n.recordDroppedEvent("ratelimit_backoff",m):l.push(g);}),l.length===0)return ai({});let c=br(s[0],l),d=g=>{Bp(c,(f,m)=>{n.recordDroppedEvent(g,Vp(m));});},u=()=>e({body:Tv(c)}).then(g=>(g.statusCode!==void 0&&(g.statusCode<200||g.statusCode>=300)&&Ie&&Pe.warn(`Sentry responded with status code ${g.statusCode} to sent event.`),i=ay(i,g),g),g=>{throw d("network_error"),Ie&&Pe.error("Encountered error running transport request:",g),g;});return t.add(u).then(g=>g,g=>{if(g===Zp)return Ie&&Pe.error("Skipped sending event because buffer is full."),d("queue_overflow"),ai({});throw g;});}return{send:o,flush:r};}function Kp(n){n.user?.ip_address===void 0&&(n.user=se(D({},n.user),{ip_address:"{{auto}}"}));}function Jp(n){"aggregates"in n?n.attrs?.ip_address===void 0&&(n.attrs=se(D({},n.attrs),{ip_address:"{{auto}}"})):n.ipAddress===void 0&&(n.ipAddress="{{auto}}");}function tl(n,e,t=[e],i="npm"){let r=n._metadata||{};r.sdk||(r.sdk={name:`sentry.javascript.${e}`,packages:t.map(o=>({name:`${i}:@sentry/${o}`,version:Wi})),version:Wi}),n._metadata=r;}var EM=100;function Zi(n,e){let t=mt(),i=vi();if(!t)return;let{beforeBreadcrumb:r=null,maxBreadcrumbs:o=EM}=t.getOptions();if(o<=0)return;let s=qi(),l=D({timestamp:s},n),c=r?Un(()=>r(l,e)):l;c!==null&&(t.emit&&t.emit("beforeAddBreadcrumb",c,e),i.addBreadcrumb(c,o));}var ly,OM="FunctionToString",cy=new WeakMap(),TM=()=>({name:OM,setupOnce(){ly=Function.prototype.toString;try{Function.prototype.toString=function(...n){let e=Do(this),t=cy.has(mt())&&e!==void 0?e:this;return ly.apply(t,n);};}catch{}},setup(n){cy.set(n,!0);}}),Ys=TM;var kM=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],IM="EventFilters",Qp=(n={})=>{let e;return{name:IM,setup(t){let i=t.getOptions();e=hy(n,i);},processEvent(t,i,r){if(!e){let o=r.getOptions();e=hy(n,o);}return AM(t,e)?null:t;}};},Xs=(n={})=>se(D({},Qp(n)),{name:"InboundFilters"});function hy(n={},e={}){return{allowUrls:[...(n.allowUrls||[]),...(e.allowUrls||[])],denyUrls:[...(n.denyUrls||[]),...(e.denyUrls||[])],ignoreErrors:[...(n.ignoreErrors||[]),...(e.ignoreErrors||[]),...(n.disableErrorDefaults?[]:kM)],ignoreTransactions:[...(n.ignoreTransactions||[]),...(e.ignoreTransactions||[])]};}function AM(n,e){if(n.type){if(n.type==="transaction"&&RM(n,e.ignoreTransactions))return Ie&&Pe.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Yi(n)}`),!0;}else{if(FM(n,e.ignoreErrors))return Ie&&Pe.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Yi(n)}`),!0;if(BM(n))return Ie&&Pe.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Yi(n)}`),!0;if(LM(n,e.denyUrls))return Ie&&Pe.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Yi(n)}.
Url: ${rh(n)}`),!0;if(!DM(n,e.allowUrls))return Ie&&Pe.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Yi(n)}.
Url: ${rh(n)}`),!0;}return!1;}function FM(n,e){return e?.length?th(n).some(t=>$s(t,e)):!1;}function RM(n,e){if(!e?.length)return!1;let t=n.transaction;return t?$s(t,e):!1;}function LM(n,e){if(!e?.length)return!1;let t=rh(n);return t?$s(t,e):!1;}function DM(n,e){if(!e?.length)return!0;let t=rh(n);return t?$s(t,e):!0;}function NM(n=[]){for(let e=n.length-1;e>=0;e--){let t=n[e];if(t&&t.filename!=="<anonymous>"&&t.filename!=="[native code]")return t.filename||null;}return null;}function rh(n){try{let t=[...(n.exception?.values??[])].reverse().find(i=>i.mechanism?.parent_id===void 0&&i.stacktrace?.frames?.length)?.stacktrace?.frames;return t?NM(t):null;}catch{return Ie&&Pe.error(`Cannot extract url for event ${Yi(n)}`),null;}}function BM(n){return n.exception?.values?.length?!n.message&&!n.exception.values.some(e=>e.stacktrace||e.type&&e.type!=="Error"||e.value):!1;}function tf(n,e,t,i,r,o){if(!r.exception?.values||!o||!_i(o.originalException,Error))return;let s=r.exception.values.length>0?r.exception.values[r.exception.values.length-1]:void 0;s&&(r.exception.values=ef(n,e,i,o.originalException,t,r.exception.values,s,0));}function ef(n,e,t,i,r,o,s,l){if(o.length>=t+1)return o;let c=[...o];if(_i(i[r],Error)){dy(s,l);let d=n(e,i[r]),u=c.length;uy(d,r,u,l),c=ef(n,e,t,i[r],r,[d,...c],d,u);}return Array.isArray(i.errors)&&i.errors.forEach((d,u)=>{if(_i(d,Error)){dy(s,l);let g=n(e,d),f=c.length;uy(g,`errors[${u}]`,f,l),c=ef(n,e,t,d,r,[g,...c],g,f);}}),c;}function dy(n,e){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism=se(D(D({},n.mechanism),n.type==="AggregateError"&&{is_exception_group:!0}),{exception_id:e});}function uy(n,e,t,i){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism=se(D({},n.mechanism),{type:"chained",source:e,exception_id:t,parent_id:i});}function nf(n){let e="console";un(e,n),pn(e,VM);}function VM(){"console"in Ne&&ap.forEach(function(n){n in Ne.console&&Ut(Ne.console,n,function(e){return Vs[n]=e,function(...t){$t("console",{args:t,level:n}),Vs[n]?.apply(Ne.console,t);};});});}function rf(n){return n==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(n)?n:"log";}var zM="Dedupe",jM=()=>{let n;return{name:zM,processEvent(e){if(e.type)return e;try{if($M(e,n))return Ie&&Pe.warn("Event dropped due to being a duplicate of previously captured event."),null;}catch{}return n=e;}};},qs=jM;function $M(n,e){return e?!!(UM(n,e)||HM(n,e)):!1;}function UM(n,e){let t=n.message,i=e.message;return!(!t&&!i||t&&!i||!t&&i||t!==i||!gy(n,e)||!fy(n,e));}function HM(n,e){let t=py(e),i=py(n);return!(!t||!i||t.type!==i.type||t.value!==i.value||!gy(n,e)||!fy(n,e));}function fy(n,e){let t=Fc(n),i=Fc(e);if(!t&&!i)return!0;if(t&&!i||!t&&i||(t=t,i=i,i.length!==t.length))return!1;for(let r=0;r<i.length;r++){let o=i[r],s=t[r];if(o.filename!==s.filename||o.lineno!==s.lineno||o.colno!==s.colno||o.function!==s.function)return!1;}return!0;}function gy(n,e){let t=n.fingerprint,i=e.fingerprint;if(!t&&!i)return!0;if(t&&!i||!t&&i)return!1;t=t,i=i;try{return t.join("")===i.join("");}catch{return!1;}}function py(n){return n.exception?.values?.[0];}function nl(n){if(!n)return{};let e=n.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};let t=e[6]||"",i=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:t,hash:i,relative:e[5]+t+i};}function oh(n){if(n!==void 0)return n>=400&&n<500?"warning":n>=500?"error":void 0;}var il=Ne;function of(){return"history"in il&&!!il.history;}function WM(){if(!("fetch"in il))return!1;try{return new Headers(),new Request("http://www.example.com"),new Response(),!0;}catch{return!1;}}function rl(n){return n&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(n.toString());}function sf(){if(typeof EdgeRuntime=="string")return!0;if(!WM())return!1;if(rl(il.fetch))return!0;let n=!1,e=il.document;if(e&&typeof e.createElement=="function")try{let t=e.createElement("iframe");t.hidden=!0,e.head.appendChild(t),t.contentWindow?.fetch&&(n=rl(t.contentWindow.fetch)),e.head.removeChild(t);}catch(t){Ie&&Pe.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t);}return n;}function lf(n,e){let t="fetch";un(t,n),pn(t,()=>GM(void 0,e));}function GM(n,e=!1){e&&!sf()||Ut(Ne,"fetch",function(t){return function(...i){let r=new Error(),{method:o,url:s}=YM(i),l={args:i,fetchData:{method:o,url:s},startTimestamp:fn()*1e3,virtualError:r,headers:XM(i)};return n||$t("fetch",D({},l)),t.apply(Ne,i).then(c=>J(null,null,function*(){return n?n(c):$t("fetch",se(D({},l),{endTimestamp:fn()*1e3,response:c})),c;}),c=>{if($t("fetch",se(D({},l),{endTimestamp:fn()*1e3,error:c})),Ao(c)&&c.stack===void 0&&(c.stack=r.stack,Hn(c,"framesToPop",1)),c instanceof TypeError&&(c.message==="Failed to fetch"||c.message==="Load failed"||c.message==="NetworkError when attempting to fetch resource."))try{let d=new URL(l.fetchData.url);c.message=`${c.message} (${d.host})`;}catch{}throw c;});};});}function af(n,e){return!!n&&typeof n=="object"&&!!n[e];}function my(n){return typeof n=="string"?n:n?af(n,"url")?n.url:n.toString?n.toString():"":"";}function YM(n){if(n.length===0)return{method:"GET",url:""};if(n.length===2){let[t,i]=n;return{url:my(t),method:af(i,"method")?String(i.method).toUpperCase():"GET"};}let e=n[0];return{url:my(e),method:af(e,"method")?String(e.method).toUpperCase():"GET"};}function XM(n){let[e,t]=n;try{if(typeof t=="object"&&t!==null&&"headers"in t&&t.headers)return new Headers(t.headers);if(Q0(e))return new Headers(e.headers);}catch{}}function cf(){return"npm";}var ht=Ne,hf=0;function df(){return hf>0;}function lS(){hf++,setTimeout(()=>{hf--;});}function Bo(n,e={}){function t(r){return typeof r=="function";}if(!t(n))return n;try{let r=n.__sentry_wrapped__;if(r)return typeof r=="function"?r:n;if(Do(n))return n;}catch{return n;}let i=function(...r){try{let o=r.map(s=>Bo(s,e));return n.apply(this,o);}catch(o){throw lS(),Xa(s=>{s.addEventProcessor(l=>(e.mechanism&&(Us(l,void 0,void 0),Xi(l,e.mechanism)),l.extra=se(D({},l.extra),{arguments:r}),l)),Kc(o);}),o;}};try{for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r]);}catch{}Bc(i,n),Hn(n,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get(){return n.name;}});}catch{}return i;}function _y(){let n=Lo(),{referrer:e}=ht.document||{},{userAgent:t}=ht.navigator||{},i=D(D({},e&&{Referer:e}),t&&{"User-Agent":t});return{url:n,headers:i};}function sh(n,e){let t=ff(n,e),i={type:pS(e),value:fS(e)};return t.length&&(i.stacktrace={frames:t}),i.type===void 0&&i.value===""&&(i.value="Unrecoverable error caught"),i;}function cS(n,e,t,i){let o=mt()?.getOptions().normalizeDepth,s=_S(e),l={__serialized__:Gc(e,o)};if(s)return{exception:{values:[sh(n,s)]},extra:l};let c={exception:{values:[{type:Ro(e)?e.constructor.name:i?"UnhandledRejection":"Error",value:gS(e,{isUnhandledRejection:i})}]},extra:l};if(t){let d=ff(n,t);d.length&&(c.exception.values[0].stacktrace={frames:d});}return c;}function uf(n,e){return{exception:{values:[sh(n,e)]}};}function ff(n,e){let t=e.stacktrace||e.stack||"",i=dS(e),r=uS(e);try{return n(t,i,r);}catch{}return[];}var hS=/Minified React error #\d+;/i;function dS(n){return n&&hS.test(n.message)?1:0;}function uS(n){return typeof n.framesToPop=="number"?n.framesToPop:0;}function vy(n){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?n instanceof WebAssembly.Exception:!1;}function pS(n){let e=n?.name;return!e&&vy(n)?n.message&&Array.isArray(n.message)&&n.message.length==2?n.message[0]:"WebAssembly.Exception":e;}function fS(n){let e=n?.message;return vy(n)?Array.isArray(n.message)&&n.message.length==2?n.message[1]:"wasm exception":e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message";}function yy(n,e,t,i){let r=t?.syntheticException||void 0,o=ah(n,e,r,i);return Xi(o),o.level="error",t?.event_id&&(o.event_id=t.event_id),ai(o);}function Cy(n,e,t="info",i,r){let o=i?.syntheticException||void 0,s=pf(n,e,o,r);return s.level=t,i?.event_id&&(s.event_id=i.event_id),ai(s);}function ah(n,e,t,i,r){let o;if(Lc(e)&&e.error)return uf(n,e.error);if(Dc(e)||mp(e)){let s=e;if("stack"in e)o=uf(n,e);else{let l=s.name||(Dc(s)?"DOMError":"DOMException"),c=s.message?`${l}: ${s.message}`:l;o=pf(n,c,t,i),Us(o,c);}return"code"in s&&(o.tags=se(D({},o.tags),{"DOMException.code":`${s.code}`})),o;}return Ao(e)?uf(n,e):vr(e)||Ro(e)?(o=cS(n,e,t,r),Xi(o,{synthetic:!0}),o):(o=pf(n,e,t,i),Us(o,`${e}`,void 0),Xi(o,{synthetic:!0}),o);}function pf(n,e,t,i){let r={};if(i&&t){let o=ff(n,t);o.length&&(r.exception={values:[{value:e,stacktrace:{frames:o}}]}),Xi(r,{synthetic:!0});}if(js(e)){let{__sentry_template_string__:o,__sentry_template_values__:s}=e;return r.logentry={message:o,params:s},r;}return r.message=e,r;}function gS(n,{isUnhandledRejection:e}){let t=xp(n),i=e?"promise rejection":"exception";return Lc(n)?`Event \`ErrorEvent\` captured as ${i} with message \`${n.message}\``:Ro(n)?`Event \`${mS(n)}\` (type=${n.type}) captured as ${i}`:`Object captured as ${i} with keys: ${t}`;}function mS(n){try{let e=Object.getPrototypeOf(n);return e?e.constructor.name:void 0;}catch{}}function _S(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e)){let t=n[e];if(t instanceof Error)return t;}}var vS=5e3,lh=class extends Qa{constructor(e){let t=yS(e),i=ht.SENTRY_SDK_SOURCE||cf();tl(t,"browser",["browser"],i),super(t);let{sendDefaultPii:r,sendClientReports:o,enableLogs:s,_experiments:l}=this._options,c=s??l?.enableLogs;ht.document&&(o||c)&&ht.document.addEventListener("visibilitychange",()=>{ht.document.visibilityState==="hidden"&&(o&&this._flushOutcomes(),c&&el(this));}),c&&(this.on("flush",()=>{el(this);}),this.on("afterCaptureLog",()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout(()=>{el(this);},vS);})),r&&(this.on("postprocessEvent",Kp),this.on("beforeSendSession",Jp));}eventFromException(e,t){return yy(this._options.stackParser,e,t,this._options.attachStacktrace);}eventFromMessage(e,t="info",i){return Cy(this._options.stackParser,e,t,i,this._options.attachStacktrace);}_prepareEvent(e,t,i,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,i,r);}};function yS(n){return D({release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:ht.SENTRY_RELEASE?.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0},n);}var by=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;var Wt=Ne;var CS=1e3,xy,gf,mf;function _f(n){let e="dom";un(e,n),pn(e,bS);}function bS(){if(!Wt.document)return;let n=$t.bind(null,"dom"),e=Py(n,!0);Wt.document.addEventListener("click",e,!1),Wt.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(t=>{let r=Wt[t]?.prototype;r?.hasOwnProperty?.("addEventListener")&&(Ut(r,"addEventListener",function(o){return function(s,l,c){if(s==="click"||s=="keypress")try{let d=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},u=d[s]=d[s]||{refCount:0};if(!u.handler){let g=Py(n);u.handler=g,o.call(this,s,g,c);}u.refCount++;}catch{}return o.call(this,s,l,c);};}),Ut(r,"removeEventListener",function(o){return function(s,l,c){if(s==="click"||s=="keypress")try{let d=this.__sentry_instrumentation_handlers__||{},u=d[s];u&&(u.refCount--,u.refCount<=0&&(o.call(this,s,u.handler,c),u.handler=void 0,delete d[s]),Object.keys(d).length===0&&delete this.__sentry_instrumentation_handlers__);}catch{}return o.call(this,s,l,c);};}));});}function xS(n){if(n.type!==gf)return!1;try{if(!n.target||n.target._sentryId!==mf)return!1;}catch{}return!0;}function PS(n,e){return n!=="keypress"?!1:e?.tagName?!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable):!0;}function Py(n,e=!1){return t=>{if(!t||t._sentryCaptured)return;let i=wS(t);if(PS(t.type,i))return;Hn(t,"_sentryCaptured",!0),i&&!i._sentryId&&Hn(i,"_sentryId",Ht());let r=t.type==="keypress"?"input":t.type;xS(t)||(n({event:t,name:r,global:e}),gf=t.type,mf=i?i._sentryId:void 0),clearTimeout(xy),xy=Wt.setTimeout(()=>{mf=void 0,gf=void 0;},CS);};}function wS(n){try{return n.target;}catch{return null;}}var ch;function sl(n){let e="history";un(e,n),pn(e,MS);}function MS(){if(Wt.addEventListener("popstate",()=>{let e=Wt.location.href,t=ch;if(ch=e,t===e)return;$t("history",{from:t,to:e});}),!of())return;function n(e){return function(...t){let i=t.length>2?t[2]:void 0;if(i){let r=ch,o=SS(String(i));if(ch=o,r===o)return e.apply(this,t);$t("history",{from:r,to:o});}return e.apply(this,t);};}Ut(Wt.history,"pushState",n),Ut(Wt.history,"replaceState",n);}function SS(n){try{return new URL(n,Wt.location.origin).toString();}catch{return n;}}var hh={};function vf(n){let e=hh[n];if(e)return e;let t=Wt[n];if(rl(t))return hh[n]=t.bind(Wt);let i=Wt.document;if(i&&typeof i.createElement=="function")try{let r=i.createElement("iframe");r.hidden=!0,i.head.appendChild(r);let o=r.contentWindow;o?.[n]&&(t=o[n]),i.head.removeChild(r);}catch(r){by&&Pe.warn(`Could not create sandbox iframe for ${n} check, bailing to window.${n}: `,r);}return t&&(hh[n]=t.bind(Wt));}function dh(n){hh[n]=void 0;}var Vo="__sentry_xhr_v3__";function yf(n){let e="xhr";un(e,n),pn(e,ES);}function ES(){if(!Wt.XMLHttpRequest)return;let n=XMLHttpRequest.prototype;n.open=new Proxy(n.open,{apply(e,t,i){let r=new Error(),o=fn()*1e3,s=sn(i[0])?i[0].toUpperCase():void 0,l=OS(i[1]);if(!s||!l)return e.apply(t,i);t[Vo]={method:s,url:l,request_headers:{}},s==="POST"&&l.match(/sentry_key/)&&(t.__sentry_own_request__=!0);let c=()=>{let d=t[Vo];if(d&&t.readyState===4){try{d.status_code=t.status;}catch{}let u={endTimestamp:fn()*1e3,startTimestamp:o,xhr:t,virtualError:r};$t("xhr",u);}};return"onreadystatechange"in t&&typeof t.onreadystatechange=="function"?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply(d,u,g){return c(),d.apply(u,g);}}):t.addEventListener("readystatechange",c),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(d,u,g){let[f,m]=g,_=u[Vo];return _&&sn(f)&&sn(m)&&(_.request_headers[f.toLowerCase()]=m),d.apply(u,g);}}),e.apply(t,i);}}),n.send=new Proxy(n.send,{apply(e,t,i){let r=t[Vo];if(!r)return e.apply(t,i);i[0]!==void 0&&(r.body=i[0]);let o={startTimestamp:fn()*1e3,xhr:t};return $t("xhr",o),e.apply(t,i);}});}function OS(n){if(sn(n))return n;try{return n.toString();}catch{}}function wy(n,e=vf("fetch")){let t=0,i=0;function r(o){let s=o.body.length;t+=s,i++;let l=D({body:o.body,method:"POST",referrerPolicy:"strict-origin",headers:n.headers,keepalive:t<=6e4&&i<15},n.fetchOptions);if(!e)return dh("fetch"),Jr("No fetch implementation available");try{return e(n.url,l).then(c=>(t-=s,i--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}));}catch(c){return dh("fetch"),t-=s,i--,Jr(c);}}return ih(n,r);}var TS=30;var kS=50;function Cf(n,e,t,i){let r={filename:n,function:e==="<anonymous>"?Gi:e,in_app:!0};return t!==void 0&&(r.lineno=t),i!==void 0&&(r.colno=i),r;}var IS=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,AS=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,FS=/\((\S*)(?::(\d+))(?::(\d+))\)/,RS=n=>{let e=IS.exec(n);if(e){let[,i,r,o]=e;return Cf(i,Gi,+r,+o);}let t=AS.exec(n);if(t){if(t[2]&&t[2].indexOf("eval")===0){let s=FS.exec(t[2]);s&&(t[2]=s[1],t[3]=s[2],t[4]=s[3]);}let[r,o]=Sy(t[1]||Gi,t[2]);return Cf(o,r,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0);}},LS=[TS,RS],DS=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,NS=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,BS=n=>{let e=DS.exec(n);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){let o=NS.exec(e[3]);o&&(e[1]=e[1]||"eval",e[3]=o[1],e[4]=o[2],e[5]="");}let i=e[3],r=e[1]||Gi;return[r,i]=Sy(r,i),Cf(i,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0);}},VS=[kS,BS];var zS=[LS,VS],My=Ac(...zS),Sy=(n,e)=>{let t=n.indexOf("safari-extension")!==-1,i=n.indexOf("safari-web-extension")!==-1;return t||i?[n.indexOf("@")!==-1?n.split("@")[0]:Gi,t?`safari-extension:${e}`:`safari-web-extension:${e}`]:[n,e];};var Qr=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;var uh=1024,jS="Breadcrumbs",$S=(n={})=>{let e=D({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},n);return{name:jS,setup(t){e.console&&nf(WS(t)),e.dom&&_f(HS(t,e.dom)),e.xhr&&yf(GS(t)),e.fetch&&lf(YS(t)),e.history&&sl(XS(t)),e.sentry&&t.on("beforeSendEvent",US(t));}};},al=$S;function US(n){return function(t){mt()===n&&Zi({category:`sentry.${t.type==="transaction"?"transaction":"event"}`,event_id:t.event_id,level:t.level,message:Yi(t)},{event:t});};}function HS(n,e){return function(i){if(mt()!==n)return;let r,o,s=typeof e=="object"?e.serializeAttribute:void 0,l=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;l&&l>uh&&(Qr&&Pe.warn(`\`dom.maxStringLength\` cannot exceed ${uh}, but a value of ${l} was configured. Sentry will use ${uh} instead.`),l=uh),typeof s=="string"&&(s=[s]);try{let d=i.event,u=qS(d)?d.target:d;r=Ya(u,{keyAttrs:s,maxStringLength:l}),o=bp(u);}catch{r="<unknown>";}if(r.length===0)return;let c={category:`ui.${i.name}`,message:r};o&&(c.data={"ui.component_name":o}),Zi(c,{event:i.event,name:i.name,global:i.global});};}function WS(n){return function(t){if(mt()!==n)return;let i={category:"console",data:{arguments:t.args,logger:"console"},level:rf(t.level),message:Nc(t.args," ")};if(t.level==="assert")if(t.args[0]===!1)i.message=`Assertion failed: ${Nc(t.args.slice(1)," ")||"console.assert"}`,i.data.arguments=t.args.slice(1);else return;Zi(i,{input:t.args,level:t.level});};}function GS(n){return function(t){if(mt()!==n)return;let{startTimestamp:i,endTimestamp:r}=t,o=t.xhr[Vo];if(!i||!r||!o)return;let{method:s,url:l,status_code:c,body:d}=o,u={method:s,url:l,status_code:c},g={xhr:t.xhr,input:d,startTimestamp:i,endTimestamp:r},f={category:"xhr",data:u,type:"http",level:oh(c)};n.emit("beforeOutgoingRequestBreadcrumb",f,g),Zi(f,g);};}function YS(n){return function(t){if(mt()!==n)return;let{startTimestamp:i,endTimestamp:r}=t;if(r&&!(t.fetchData.url.match(/sentry_key/)&&t.fetchData.method==="POST"))if(t.fetchData.method,t.fetchData.url,t.error){let o=t.fetchData,s={data:t.error,input:t.args,startTimestamp:i,endTimestamp:r},l={category:"fetch",data:o,level:"error",type:"http"};n.emit("beforeOutgoingRequestBreadcrumb",l,s),Zi(l,s);}else{let o=t.response,s=se(D({},t.fetchData),{status_code:o?.status});t.fetchData.request_body_size,t.fetchData.response_body_size,o?.status;let l={input:t.args,response:o,startTimestamp:i,endTimestamp:r},c={category:"fetch",data:s,type:"http",level:oh(s.status_code)};n.emit("beforeOutgoingRequestBreadcrumb",c,l),Zi(c,l);}};}function XS(n){return function(t){if(mt()!==n)return;let i=t.from,r=t.to,o=nl(ht.location.href),s=i?nl(i):void 0,l=nl(r);s?.path||(s=o),o.protocol===l.protocol&&o.host===l.host&&(r=l.relative),o.protocol===s.protocol&&o.host===s.host&&(i=s.relative),Zi({category:"navigation",data:{from:i,to:r}});};}function qS(n){return!!n&&!!n.target;}var ZS=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],KS="BrowserApiErrors",JS=(n={})=>{let e=D({XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1},n);return{name:KS,setupOnce(){e.setTimeout&&Ut(ht,"setTimeout",Ey),e.setInterval&&Ut(ht,"setInterval",Ey),e.requestAnimationFrame&&Ut(ht,"requestAnimationFrame",QS),e.XMLHttpRequest&&"XMLHttpRequest"in ht&&Ut(XMLHttpRequest.prototype,"send",eE);let t=e.eventTarget;t&&(Array.isArray(t)?t:ZS).forEach(r=>tE(r,e));}};},Oy=JS;function Ey(n){return function(...e){let t=e[0];return e[0]=Bo(t,{mechanism:{data:{function:oi(n)},handled:!1,type:"instrument"}}),n.apply(this,e);};}function QS(n){return function(e){return n.apply(this,[Bo(e,{mechanism:{data:{function:"requestAnimationFrame",handler:oi(n)},handled:!1,type:"instrument"}})]);};}function eE(n){return function(...e){let t=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(r=>{r in t&&typeof t[r]=="function"&&Ut(t,r,function(o){let s={mechanism:{data:{function:r,handler:oi(o)},handled:!1,type:"instrument"}},l=Do(o);return l&&(s.mechanism.data.handler=oi(l)),Bo(o,s);});}),n.apply(this,e);};}function tE(n,e){let i=ht[n]?.prototype;i?.hasOwnProperty?.("addEventListener")&&(Ut(i,"addEventListener",function(r){return function(o,s,l){try{nE(s)&&(s.handleEvent=Bo(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:oi(s),target:n},handled:!1,type:"instrument"}}));}catch{}return e.unregisterOriginalCallbacks&&iE(this,o,s),r.apply(this,[o,Bo(s,{mechanism:{data:{function:"addEventListener",handler:oi(s),target:n},handled:!1,type:"instrument"}}),l]);};}),Ut(i,"removeEventListener",function(r){return function(o,s,l){try{let c=s.__sentry_wrapped__;c&&r.call(this,o,c,l);}catch{}return r.call(this,o,s,l);};}));}function nE(n){return typeof n.handleEvent=="function";}function iE(n,e,t){n&&typeof n=="object"&&"removeEventListener"in n&&typeof n.removeEventListener=="function"&&n.removeEventListener(e,t);}var ll=()=>({name:"BrowserSession",setupOnce(){if(typeof ht.document>"u"){Qr&&Pe.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return;}Ka({ignoreDuration:!0}),Ja(),sl(({from:n,to:e})=>{n!==void 0&&n!==e&&(Ka({ignoreDuration:!0}),Ja());});}});var rE="GlobalHandlers",oE=(n={})=>{let e=D({onerror:!0,onunhandledrejection:!0},n);return{name:rE,setupOnce(){Error.stackTraceLimit=50;},setup(t){e.onerror&&(sE(t),Ty("onerror")),e.onunhandledrejection&&(aE(t),Ty("onunhandledrejection"));}};},cl=oE;function sE(n){pp(e=>{let{stackParser:t,attachStacktrace:i}=ky();if(mt()!==n||df())return;let{msg:r,url:o,line:s,column:l,error:c}=e,d=hE(ah(t,c||r,void 0,i,!1),o,s,l);d.level="error",Za(d,{originalException:c,mechanism:{handled:!1,type:"onerror"}});});}function aE(n){gp(e=>{let{stackParser:t,attachStacktrace:i}=ky();if(mt()!==n||df())return;let r=lE(e),o=Fo(r)?cE(r):ah(t,r,void 0,i,!0);o.level="error",Za(o,{originalException:r,mechanism:{handled:!1,type:"onunhandledrejection"}});});}function lE(n){if(Fo(n))return n;try{if("reason"in n)return n.reason;if("detail"in n&&"reason"in n.detail)return n.detail.reason;}catch{}return n;}function cE(n){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(n)}`}]}};}function hE(n,e,t,i){let r=n.exception=n.exception||{},o=r.values=r.values||[],s=o[0]=o[0]||{},l=s.stacktrace=s.stacktrace||{},c=l.frames=l.frames||[],d=i,u=t,g=sn(e)&&e.length>0?e:Lo();return c.length===0&&c.push({colno:d,filename:g,function:Gi,in_app:!0,lineno:u}),n;}function Ty(n){Qr&&Pe.log(`Global Handler attached: ${n}`);}function ky(){return mt()?.getOptions()||{stackParser:()=>[],attachStacktrace:!1};}var hl=()=>({name:"HttpContext",preprocessEvent(n){if(!ht.navigator&&!ht.location&&!ht.document)return;let e=_y(),t=D(D({},e.headers),n.request?.headers);n.request=se(D(D({},e),n.request),{headers:t});}});var dE="cause",uE=5,pE="LinkedErrors",fE=(n={})=>{let e=n.limit||uE,t=n.key||dE;return{name:pE,preprocessEvent(i,r,o){let s=o.getOptions();tf(sh,s.stackParser,t,e,i,r);}};},dl=fE;function Iy(){return gE()?(Qr&&Un(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/");}),!0):!1;}function gE(){if(typeof ht.window>"u")return!1;let n=ht;if(n.nw||!(n.chrome||n.browser)?.runtime?.id)return!1;let t=Lo(),i=["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"];return!(ht===ht.top&&i.some(o=>t.startsWith(`${o}://`)));}function Ay(n){return[Xs(),Ys(),Oy(),al(),cl(),dl(),qs(),hl(),ll()];}function bf(n={}){let e=!n.skipBrowserExtensionCheck&&Iy(),t=se(D({},n),{enabled:e?!1:n.enabled,stackParser:dp(n.stackParser||My),integrations:Up({integrations:n.integrations,defaultIntegrations:n.defaultIntegrations==null?Ay():n.defaultIntegrations}),transport:n.transport||wy});return Xp(lh,t);}var _E=typeof __SENTRY_DEBUG__>"u"?!0:__SENTRY_DEBUG__;function vE(n={}){return[Xs(),Ys(),al(),cl(),dl(),qs(),hl(),ll()];}function Fy(n){let e=D({defaultIntegrations:vE()},n);return tl(e,"angular"),yE(),bf(e);}function yE(){let e=Wa?.major&&parseInt(Wa.major,10);e&&(e<14&&_E&&Pe.warn(`This Sentry SDK does not officially support Angular ${e}.`,"This SDK only supports Angular 14 and above.","If you're using lower Angular versions, check the Angular Version Compatibility table in our docs: https://docs.sentry.io/platforms/javascript/guides/angular/#angular-version-compatibility.","Otherwise, please consider upgrading your Angular version."),Qc("angular",{version:e}));}var X7=typeof Zone<"u"&&Zone.root?.run;function Bt(n){n||(ip(Bt),n=zt(ii));let e=new Ur(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(Cc(e));}function xf(n){n===void 0&&(ip(xf),n=zt(Wr));let e=n.get(wc);return t=>new Ur(i=>{let r=e.add(),o=!1;function s(){o||(r(),o=!0);}let l=t.subscribe({next:c=>{i.next(c),s();},complete:()=>{i.complete(),s();},error:c=>{i.error(c),s();}});return l.add(()=>{i.unsubscribe(),s();}),l;});}var li=class n{constructor(e){this.el=e;let t=$localize.locale||"en";E0(t)==="rtl"&&(this.el.nativeElement.style.direction="rtl");}static fac=function(t){return new(t||n)(ue(Ns));};static dir=y0({type:n,selectors:[["","ltr",""]]});};var Ot=class n{constructor(e){this.platform=e;e.browser(()=>{let t=localStorage.getItem("batchTags");if(t)try{this.batchTags.set(JSON.parse(t));}catch{}}),at(()=>{let t=this.batchTags();e.browser(()=>{localStorage.setItem("batchTags",JSON.stringify(t));});});}currentImage=G(null);currentImageUrl=G(null);currentTextboxData=G(null);currentCanvasState=G(null);mainMenuHeight=G(348);aboutVisible=G(!1);authenticated=G(!1);batchPreference=G("");batchPotential=G(null);batchTags=G([]);batchTagsInput=G("");setImage(e){this.currentImage.set(e);let t=this.currentImageUrl();t&&URL.revokeObjectURL(t),this.currentImageUrl.set(URL.createObjectURL(e));}static fac=function(t){return new(t||n)(Qt(it));};static prov=tn({token:n,factory:n.fac,providedIn:"root"});};var CE=["video"],bE=["canvas"],xE=()=>["/"];function PE(n,e){if(n&1&&(P(0,"div",2),N(1),S()),n&2){let t=j();I(),vt(" ",t.displayMsg()," ");}}function wE(n,e){if(n&1){let t=ve();P(0,"div",18),Z("click",function(){X(t);let r=j();return q(r.cameraClicked.set(!0));}),S();}}function ME(n,e){if(n&1&&(ke(),te(0,"circle",13)),n&2){let t=e.$implicit;ct("cx",t.x)("cy",t.y);}}function SE(n,e){if(n&1&&(ke(),te(0,"circle",17)),n&2){let t=e.$implicit;ct("cx",t.x)("cy",t.y);}}var ph=class n{constructor(e,t,i,r,o,s,l){this.el=e;this.platform=t;this.destroyRef=i;this.state=r;this.router=o;this.route=s;this.api=l;this.api.updateFromRoute(this.route.snapshot),this.displayMsgSubject.pipe(Bt(),Oo(),gr(150),Oo(),st(()=>{this.displayMsg.set("");}),Nt(1)).subscribe(c=>{this.displayMsg.set(c);});}videoEl;canvasEl;canvasCtx;COUNTDOWN_INITIAL=30;FRAME_COUNT_DARKER=100;TIMEOUT_DURATION=5e3;DEFAULT_CORNER_MARGIN=.15;countDown=this.COUNTDOWN_INITIAL;scanState=null;stream=null;stopScannerSubject=new En();displayMsgSubject=new En();msg=G("");displayMsg=G("");videoHeightM=G(0);videoWidthM=G(0);displayWidth=G(0);displayHeight=G(0);viewBox=_e(()=>this.displayWidth()===0||this.displayHeight()===0?"0 0 480 640":`0 0 ${this.displayWidth()} ${this.displayHeight()}`);maskPath=_e(()=>{let e=this.points();return e.length<4?"":`M${e[0].x} ${e[0].y} L ${e[1].x} ${e[1].y} L ${e[2].x} ${e[2].y} L ${e[3].x} ${e[3].y} Z`;});points=G([]);cameraClicked=G(!1);displayCameraButton=G(!1);scanStartTime=0;timeoutReached=G(!1);ngAfterViewInit(){if(!this.platform.browser()){console.log("Not in browser, skipping scanner initialization");return;}Ds(100).pipe(Bt(this.destroyRef),Vt(()=>!!window.jscanify!==void 0),Vt(()=>!!window.cv!==void 0),Vt(()=>!!this.canvasEl?.nativeElement),Xt(1)).subscribe(()=>{console.log("Starting scanner...",jscanify),this.canvasCtx=this.canvasEl.nativeElement.getContext("2d"),this.startScanner();});}getVideoConstraints(){return this.platform.ios?{facingMode:"environment",width:{min:640,ideal:1920},height:{min:480,ideal:1080}}:{facingMode:{ideal:"environment"},width:{ideal:1920},height:{ideal:1080}};}startScanner(){let e={audio:!1,video:!0};e.video=this.getVideoConstraints(),this.platform.browser()&&navigator.mediaDevices.getUserMedia(e).then(t=>{this.stream=t,this.videoEl.nativeElement.srcObject=t;let i=t.getVideoTracks()[0];i.getCapabilities().torch&&i.applyConstraints({advanced:[{torch:!0}]}).catch(o=>console.error("Torch ON failed:",o));});}checkCornerPoints(e){if(!e||!e.topLeftCorner||!e.topRightCorner||!e.bottomLeftCorner||!e.bottomRightCorner)return null;let t=["topLeftCorner","topRightCorner","bottomLeftCorner","bottomRightCorner"];for(let i of t){let r=e[i];if(typeof r.x!="number"||typeof r.y!="number"||r.x<0||r.y<0)return null;}return e;}checkDimensions(e,t,i,r){if(!e)return r<this.FRAME_COUNT_DARKER?this.displayMsgSubject.next("Pas de pagina aan het frame aan"):this.displayMsgSubject.next("Probeer op een donkerder achtergrond"),{valid:!1,snap:!1};let o=Math.sqrt(Math.pow(e.topLeftCorner.x-e.topRightCorner.x,2)+Math.pow(e.topLeftCorner.y-e.topRightCorner.y,2)),s=Math.sqrt(Math.pow(e.bottomLeftCorner.x-e.bottomRightCorner.x,2)+Math.pow(e.bottomLeftCorner.y-e.bottomRightCorner.y,2)),l=Math.sqrt(Math.pow(e.topLeftCorner.x-e.bottomLeftCorner.x,2)+Math.pow(e.topLeftCorner.y-e.bottomLeftCorner.y,2)),c=Math.sqrt(Math.pow(e.topRightCorner.x-e.bottomRightCorner.x,2)+Math.pow(e.topRightCorner.y-e.bottomRightCorner.y,2)),d=(o+s)/2,u=(l+c)/2,g=d/u/.53,f=r<this.FRAME_COUNT_DARKER?.05:.1;if(g<1-f||g>1+f)return this.msg.set("averageRatio is not in range: "+g),r<this.FRAME_COUNT_DARKER?this.displayMsgSubject.next("Pas de pagina aan het frame aan"):this.displayMsgSubject.next("Probeer op een donkerder achtergrond"),{valid:!1,snap:!1};let m=Math.max(o,s)/Math.min(o,s),_=Math.max(l,c)/Math.min(l,c);if(m>1.2||m<.8)return this.msg.set("topBottomRatio is not in range: "+m),this.displayMsgSubject.next("Verander je hoek"),{valid:!1,snap:!0};if(_>1.1||_<.9)return this.msg.set("leftRightRatio is not in range: "+_),this.displayMsgSubject.next("Verander je hoek"),{valid:!1,snap:!0};let y=d>.5*t,E=u>.5*i;return!y&&!E?(this.msg.set("Neither averageWidth nor averageHeight is above 66% of video dimensions: "+d+"<0.66*"+t+" "+u+"<0.66*"+i),this.displayMsgSubject.next("Kom dichterbij met je camera"),{valid:!1,snap:!0}):(this.msg.set("Dimensions are valid: "+y+" "+E),{valid:!0,snap:!0});}checkBlurry(e){let t=new cv.Mat(),i=new cv.Mat(),r=new cv.Mat();cv.cvtColor(e,e,cv.COLOR_RGB2GRAY,0),cv.Laplacian(e,t,cv.CV_64F,1,1,0,cv.BORDER_DEFAULT),cv.meanStdDev(t,r,i);let o=i.data64F[0]<10;return this.msg.set("Blurriness is "+o+" "+i.data64F[0]),t.delete(),i.delete(),r.delete(),o;}playing(){console.log("PLAYING"),this.videoEl.nativeElement.play();let e=new jscanify(),t=this.videoEl.nativeElement.videoWidth,i=this.videoEl.nativeElement.videoHeight;this.videoHeightM.set(i),this.videoWidthM.set(t),this.canvasEl.nativeElement.width=t,this.canvasEl.nativeElement.height=i;let r=Math.min(this.el.nativeElement.clientWidth/t,this.el.nativeElement.clientHeight/i),o=Math.floor(Math.min(i/640,t/480));console.log("SAMPLE RATIO",o);let s=0;this.scanStartTime=Date.now(),Ds(33).pipe(Bt(this.destroyRef),Cc(this.stopScannerSubject),Vt(()=>this.countDown>=0),Jt(()=>{let l=null,c=null,d={valid:!1,snap:!1},u=null;s+=1,s%100===0&&console.log("Scanning...",s);try{this.canvasCtx?.drawImage(this.videoEl.nativeElement,0,0),l=cv.imread(this.canvasEl.nativeElement),c=new cv.Mat();let g=Math.floor(l.cols/o),f=Math.floor(l.rows/o);this.displayWidth.set(g),this.displayHeight.set(f);let m=new cv.Size(g,f);cv.resize(l,c,m,0,0,cv.INTER_NEAREST);let _=e.findPaperContour(c);if(_){let y=this.checkCornerPoints(e.getCornerPoints(_,c)),{valid:E,snap:C}=this.checkDimensions(y,g,f,s);E&&(u=this.checkBlurry(c)),d={valid:E,snap:C,blurry:u,cornerPoints:y};}this.api.demo()&&(d={valid:!0,snap:!0,blurry:!1,cornerPoints:{topLeftCorner:{x:50,y:50},topRightCorner:{x:g-50,y:50},bottomLeftCorner:{x:50,y:f-50},bottomRightCorner:{x:g-50,y:f-50}}});}catch(g){console.error("Error processing video frame",s,g),this.restartScanner();}finally{l?.delete(),c?.delete();}return d;})).subscribe(l=>{if(this.setPoints(l?.snap&&l?.cornerPoints||null),this.shouldShowTimeoutButton(l)&&(this.timeoutReached.set(!0),this.displayCameraButton.set(!0),this.displayMsgSubject.next("Edges not detected. You can submit anyway.")),l?.valid&&this.timeoutReached()&&(this.timeoutReached.set(!1),this.displayCameraButton.set(!1)),l?.cornerPoints&&(l.cornerPoints.topLeftCorner.x*=o,l.cornerPoints.topLeftCorner.y*=o,l.cornerPoints.topRightCorner.x*=o,l.cornerPoints.topRightCorner.y*=o,l.cornerPoints.bottomLeftCorner.x*=o,l.cornerPoints.bottomLeftCorner.y*=o,l.cornerPoints.bottomRightCorner.x*=o,l.cornerPoints.bottomRightCorner.y*=o),l?.valid?(this.displayMsgSubject.next("Houd je camera stil..."),this.countDown>0&&(this.countDown-=1),!l.blurry&&this.countDown>5&&(this.countDown=0),this.countDown===0&&this.displayCameraButton.set(!0),this.cameraClicked()&&this.extractAndNavigate(e,l.cornerPoints)):this.countDown=this.COUNTDOWN_INITIAL,this.cameraClicked()&&this.timeoutReached()){let c={topLeftCorner:{x:t*this.DEFAULT_CORNER_MARGIN,y:i*this.DEFAULT_CORNER_MARGIN},topRightCorner:{x:t*(1-this.DEFAULT_CORNER_MARGIN),y:i*this.DEFAULT_CORNER_MARGIN},bottomLeftCorner:{x:t*this.DEFAULT_CORNER_MARGIN,y:i*(1-this.DEFAULT_CORNER_MARGIN)},bottomRightCorner:{x:t*(1-this.DEFAULT_CORNER_MARGIN),y:i*(1-this.DEFAULT_CORNER_MARGIN)}};this.extractAndNavigate(e,c);}});}setPoints(e){let t;e?t=e:t={topLeftCorner:{x:this.displayWidth()*this.DEFAULT_CORNER_MARGIN,y:this.displayHeight()*this.DEFAULT_CORNER_MARGIN},topRightCorner:{x:this.displayWidth()*(1-this.DEFAULT_CORNER_MARGIN),y:this.displayHeight()*this.DEFAULT_CORNER_MARGIN},bottomLeftCorner:{x:this.displayWidth()*this.DEFAULT_CORNER_MARGIN,y:this.displayHeight()*(1-this.DEFAULT_CORNER_MARGIN)},bottomRightCorner:{x:this.displayWidth()*(1-this.DEFAULT_CORNER_MARGIN),y:this.displayHeight()*(1-this.DEFAULT_CORNER_MARGIN)}},this.points.set([{x:t.topLeftCorner.x,y:t.topLeftCorner.y},{x:t.topRightCorner.x,y:t.topRightCorner.y},{x:t.bottomRightCorner.x,y:t.bottomRightCorner.y},{x:t.bottomLeftCorner.x,y:t.bottomLeftCorner.y}]);}extractAndNavigate(e,t){this.countDown=-1;let i=e.extractPaper(this.canvasEl.nativeElement,1060,2e3,t);console.log("Extraction result:",i),this.stream?.getTracks().forEach(r=>{r.readyState=="live"&&r.stop();}),this.videoEl.nativeElement.pause(),this.stream=null,i.toBlob(r=>{r&&(this.state.setImage(r),this.router.navigate(["/confirm"],{queryParamsHandling:"merge"}));},"image/jpeg",.95);}shouldShowTimeoutButton(e){return Date.now()-this.scanStartTime>=this.TIMEOUT_DURATION&&!e?.valid&&!this.timeoutReached();}ngOnDestroy(){this.stopScanner();}stopScanner(){this.stopScannerSubject.next(),this.stream&&(this.stream.getTracks().forEach(e=>{e.stop();}),this.stream=null),this.platform.browser()&&this.videoEl?.nativeElement?.pause();}restartScanner(){this.stopScanner(),this.countDown=this.COUNTDOWN_INITIAL,this.timeoutReached.set(!1),this.scanStartTime=0,console.log("RESTARTING SCANNER"),jn(500).subscribe(()=>{this.startScanner();});}static fac=function(t){return new(t||n)(ue(Ns),ue(it),ue(ii),ue(Ot),ue(gt),ue(Ct),ue(rt));};static cmp=Me({type:n,selectors:[["app-scanner"]],viewQuery:function(t,i){if(t&1&&(Pt(CE,7),Pt(bE,7)),t&2){let r;wt(r=Mt())&&(i.videoEl=r.first),wt(r=Mt())&&(i.canvasEl=r.first);}},decls:22,vars:7,consts:[["canvas",""],["video",""],["ltr","",1,"message","ai"],[1,"camera-button"],["queryParamsHandling","preserve",1,"close",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","33","height","32","viewBox","0 0 33 32","fill","none"],["d","M9.4086 8.00799C10.1897 7.22694 11.456 7.22694 12.237 8.00799L17.4167 13.1877L22.5957 8.00868L22.7483 7.87127C23.5339 7.23087 24.692 7.27656 25.4242 8.00868C26.1561 8.74081 26.2019 9.89903 25.5616 10.6845L25.4242 10.8371L20.2452 16.0161L25.4242 21.1951L25.5616 21.3477C26.2019 22.1333 26.1563 23.2914 25.4242 24.0235C24.692 24.7555 23.5338 24.8013 22.7483 24.161L22.5957 24.0235L17.4167 18.8445L12.237 24.0242C11.456 24.8049 10.1896 24.805 9.4086 24.0242C8.62767 23.2433 8.62789 21.9769 9.4086 21.1958L14.5883 16.0161L9.4086 10.8364C8.62761 10.0554 8.62773 8.78905 9.4086 8.00799Z","fill","white"],[1,"action"],["autoplay","","playsinline","","muted","","volume","0",3,"loadeddata"],["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","false",1,"overlay-svg"],["id","mask"],["x","0","y","0","width","100%","height","100%","fill","white"],["fill","#000","stroke","white","stroke-width","4"],["stroke-width","4","r","12","fill","white","stroke","white"],["mask","url(#mask)",1,"overlay"],["x","0","y","0","width","100%","height","100%"],["stroke-width","4"],["stroke-width","4","r","12"],[1,"camera-button",3,"click"]],template:function(t,i){if(t&1){let r=ve();ge(0,PE,2,1,"div",2)(1,wE,1,0,"div",3),P(2,"a",4),ke(),P(3,"svg",5),te(4,"path",6),S()(),Ye(),P(5,"div",7),te(6,"canvas",null,0),P(8,"video",8,1),Z("loadeddata",function(){return X(r),q(i.playing());}),S(),ke(),P(10,"svg",9)(11,"defs")(12,"mask",10),te(13,"rect",11)(14,"path",12),ze(15,ME,1,2,":svg:circle",13,jt),S()(),P(17,"g",14),te(18,"rect",15)(19,"path",16),ze(20,SE,1,2,":svg:circle",17,jt),S()()();}t&2&&(he(i.displayMsg()?0:-1),I(),he(i.displayCameraButton()?1:-1),I(),K("routerLink",yt(6,xE)),I(8),ct("viewBox",i.viewBox()),I(4),ct("d",i.maskPath()),I(),je(i.points()),I(4),ct("d",i.maskPath()),I(),je(i.points()));},dependencies:[li,rn],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
[_nghost-%COMP%] {
  display: flex;
  flex-flow: column;
  width: 100%;
  height: 100%;
  position: relative;
  background-color: rgba(59, 0, 137, 0.5);
}
[_nghost-%COMP%]   .message[_ngcontent-%COMP%] {
  position: absolute;
  top: 4px;
  left: 24px;
  transform: translateY(-300%);
  z-index: 1;
  animation: _ngcontent-%COMP%_showElastic 0.8s linear forwards;
  width: max-content;
  max-width: none;
}
[_nghost-%COMP%]   .message[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%] {
  width: max-content;
  white-space: nowrap;
}
[_nghost-%COMP%]   .camera-button[_ngcontent-%COMP%] {
  position: absolute;
  bottom: 32px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1;
  width: 66px;
  height: 66px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  background-image: url("./media/button-camera-XMAZB2RA.svg");
  background-size: 66px;
  transform-origin: center;
  will-change: transform, opacity;
  animation: _ngcontent-%COMP%_popIn 420ms cubic-bezier(0.22, 1, 0.36, 1) both;
  filter: drop-shadow(0 8px 24px rgba(59, 0, 137, 0.3));
}
[_nghost-%COMP%]   .close[_ngcontent-%COMP%] {
  position: absolute;
  top: 12px;
  right: 24px;
  z-index: 1;
}
[_nghost-%COMP%]   .action[_ngcontent-%COMP%] {
  position: relative;
  flex: 1 1 auto;
}
[_nghost-%COMP%]   .action[_ngcontent-%COMP%]   video[_ngcontent-%COMP%], 
[_nghost-%COMP%]   .action[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%], 
[_nghost-%COMP%]   .action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  object-fit: contain;
  position: absolute;
  top: 0;
  left: 0;
}
[_nghost-%COMP%]   .action[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%] {
  fill: rgba(59, 0, 137, 0.5);
}
[_nghost-%COMP%]   .action[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {
  stroke: #B969FF;
  fill: white;
}
[_nghost-%COMP%]   .action[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%] {
  fill: #000;
  stroke: #B969FF;
}
@keyframes _ngcontent-%COMP%_showElastic {
  0% {
    transform: translateY(-300%);
  }
  16% {
    transform: translateY(96.81%);
  }
  28% {
    transform: translateY(-39.36%);
  }
  44% {
    transform: translateY(13.89%);
  }
  59% {
    transform: translateY(-4.92%);
  }
  73% {
    transform: translateY(1.73%);
  }
  88% {
    transform: translateY(-0.6%);
  }
  100% {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_popIn {
  0% {
    transform: translateX(-50%) scale(0.92);
    opacity: 0;
  }
  60% {
    transform: translateX(-50%) scale(1.06);
    opacity: 1;
  }
  100% {
    transform: translateX(-50%) scale(1);
    opacity: 1;
  }
}
@media (prefers-reduced-motion: reduce) {
  [_nghost-%COMP%]   .camera-button[_ngcontent-%COMP%] {
    animation: _ngcontent-%COMP%_popFade 160ms ease-out both;
  }
}
@keyframes _ngcontent-%COMP%_popFade {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}`]});};var EE=()=>["/canvas-creator"],OE=()=>["/scan"],Ly=(n,e)=>e.value;function TE(n,e){if(n&1&&(P(0,"option",22),N(1),S()),n&2){let t=e.$implicit;K("value",t.value),I(),Ve(t.label);}}function kE(n,e){if(n&1&&(P(0,"option",25),N(1),S()),n&2){let t=e.$implicit;K("ngValue",t.value),I(),Ve(t.label);}}function IE(n,e){if(n&1){let t=ve();P(0,"span",31),N(1),P(2,"button",34),Z("click",function(){let r=X(t).$implicit,o=j(2);return q(o.removeTag(r));}),N(3," \u2715 "),S()();}if(n&2){let t=e.$implicit;I(),vt(" ",t," ");}}function AE(n,e){if(n&1){let t=ve();P(0,"button",36),Z("click",function(){let r=X(t).$implicit,o=j(3);return q(o.onSuggestionSelect(r));})("mousedown",function(r){return X(t),q(r.preventDefault());}),N(1),S();}if(n&2){let t=e.$implicit;I(),vt(" ",t," ");}}function FE(n,e){if(n&1&&(P(0,"div",33),ze(1,AE,2,1,"button",35,ji),S()),n&2){let t=j(2);I(),je(t.filteredTags());}}function RE(n,e){if(n&1){let t=ve();P(0,"div",10)(1,"div",17)(2,"label",18),be(3,1),S(),P(4,"div",19)(5,"select",20),Z("ngModelChange",function(r){X(t);let o=j();return q(o.state.batchPreference.set(r));}),P(6,"option",21),be(7,2),S(),ze(8,TE,2,2,"option",22,Ly),S(),ke(),P(10,"svg",23),te(11,"path",24),S()()(),Ye(),P(12,"div",17)(13,"label",18),be(14,3),S(),P(15,"div",19)(16,"select",20),Z("ngModelChange",function(r){X(t);let o=j();return q(o.state.batchPotential.set(r));}),P(17,"option",25),be(18,4),S(),ze(19,kE,2,2,"option",25,Ly),S(),ke(),P(21,"svg",23),te(22,"path",24),S()()(),Ye(),P(23,"div",26)(24,"label",27),be(25,5),S(),P(26,"div",28)(27,"div",29)(28,"div",30),ze(29,IE,4,1,"span",31,ji),P(31,"input",32,0),Z("input",function(){X(t);let r=$i(32),o=j();return q(o.onTagInputChange(r.value));})("keydown",function(r){X(t);let o=j();return q(o.onKeyDown(r));})("blur",function(){X(t);let r=j();return q(r.hideSuggestions());}),S()(),ge(33,FE,3,0,"div",33),S()()()();}if(n&2){let t=j();I(5),K("ngModel",t.state.batchPreference()),I(3),je(t.preferenceOptions),I(8),K("ngModel",t.state.batchPotential()),I(),K("ngValue",null),I(2),je(t.potentialOptions),I(10),je(t.state.batchTags()),I(2),K("value",t.state.batchTagsInput()),I(2),he(t.showSuggestions()&&t.filteredTags().length>0?33:-1);}}function LE(n,e){n&1&&(P(0,"a",15),ke(),P(1,"svg",37),te(2,"path",38),S(),Ye(),P(3,"span"),be(4,6),S()()),n&2&&K("routerLink",yt(1,EE));}function DE(n,e){n&1&&(P(0,"a",15),ke(),P(1,"svg",37),te(2,"path",38),S(),Ye(),P(3,"span"),be(4,7),S()()),n&2&&K("routerLink",yt(1,OE));}function NE(n,e){if(n&1){let t=ve();P(0,"a",39),Z("click",function(){X(t);let r=j();return q(r.upload());}),ke(),P(1,"svg",40),te(2,"path",41)(3,"path",42),S(),Ye(),P(4,"span"),be(5,8),S()();}}function BE(n,e){n&1&&(P(0,"span",16),ke(),P(1,"svg",40),te(2,"path",41)(3,"path",42),S(),Ye(),P(4,"span"),be(5,9),S()());}var fh=class n{constructor(e,t,i,r){this.state=e;this.router=t;this.api=i;this.route=r;this.api.updateFromRoute(this.route.snapshot),this.isTemplateFlow=this.route.snapshot.queryParamMap.get("template")==="true",this.state.currentImageUrl()||this.router.navigate(["/scan"],{queryParamsHandling:"preserve"});}isTemplateFlow=!1;preferenceOptions=[{label:"Preferred",value:"prefer"},{label:"Mostly Preferred",value:"mostly prefer"},{label:"Mostly Prevented",value:"mostly prevent"},{label:"Prevented",value:"prevent"}];potentialOptions=[{label:"Verwacht",value:100},{label:"Waarschijnlijk",value:75},{label:"Geloofwaardig",value:50},{label:"Voorstelbaar",value:25},{label:"Absurd",value:0}];availableTags=_e(()=>this.api.getAvailableTags());showSuggestions=G(!1);filteredTags=_e(()=>{let e=this.state.batchTagsInput().toLowerCase().trim();if(!e)return this.availableTags();let t=this.state.batchTags();return this.availableTags().filter(i=>i.toLowerCase().includes(e)&&!t.includes(i));});onTagInputChange(e){this.state.batchTagsInput.set(e),this.showSuggestions.set(e.trim().length>0);}onKeyDown(e){let t=this.state.batchTagsInput();if(e.key==="Enter"||e.key===","){e.preventDefault();let i=t.trim().replace(/,$/g,"");i&&this.addTag(i);}else if(e.key==="Backspace"&&!t&&this.state.batchTags().length>0){e.preventDefault();let i=this.state.batchTags();this.removeTag(i[i.length-1]);}}handleSuggestionClick(e,t){t.preventDefault(),this.onSuggestionSelect(e);}addTag(e){let t=e.trim();if(t&&!this.state.batchTags().includes(t)){let i=[...this.state.batchTags(),t];this.state.batchTags.set(i),this.state.batchTagsInput.set(""),this.showSuggestions.set(!1);}}removeTag(e){let t=this.state.batchTags().filter(i=>i!==e);this.state.batchTags.set(t);}onSuggestionSelect(e){this.addTag(e);}hideSuggestions(){setTimeout(()=>{this.showSuggestions.set(!1);},200);}upload(){let e=this.state.currentImage();if(e){let t={},i=this.state.batchPreference();i&&(t.favorable_future=i);let r=this.state.batchPotential();r!==null&&(t.plausibility=r);let o=this.state.currentTextboxData();o&&(t.textbox_content=o);let s=this.state.batchTags();console.log("[CONFIRM] Current batch tags:",s),this.isTemplateFlow?t.tags=["no-paper",...s]:s.length>0&&(t.tags=s),console.log("[CONFIRM] Metadata.tags being sent:",t.tags),console.log("[CONFIRM] Full metadata:",t),this.api.createItem(t).subscribe({next:l=>{console.log("[CONFIRM] Item created successfully:",l);let c={"item-id":l.item_id,key:l.item_key};this.isTemplateFlow&&(c.template="true"),this.api.automatic()?this.api.uploadImageAuto(e,l.item_id,l.item_key).subscribe(()=>{console.log("[CONFIRM] Upload complete"),this.router.navigate(["/scan"],{queryParamsHandling:"preserve"});}):(this.api.uploadImage(e,l.item_id,l.item_key),this.router.navigate(["/props"],{queryParams:c,queryParamsHandling:"merge"}));},error:l=>{console.error("[CONFIRM] Failed to create item:",l),console.error("[CONFIRM] Error status:",l.status),console.error("[CONFIRM] Error details:",l.error),l.status===403?alert("Access denied. Please check that you have the correct API key with write permissions for this workspace."):alert("Failed to create item. Please try again or contact support.");}});}else this.router.navigate(["/scan"],{queryParamsHandling:"preserve"});}static fac=function(t){return new(t||n)(ue(Ot),ue(gt),ue(rt),ue(Ct));};static cmp=Me({type:n,selectors:[["app-confirm"]],decls:9,vars:4,consts:()=>{let e;e="PREFERENCE:";let t;t="none";let i;i="POTENTIAL:";let r;r="none";let o;o="TAGS:";let s;s="re-edit";let l;l="Opnieuw scannen";let c;c="Ziet er goed uit";let d;return d="Afbeelding uploaden...",[["tagInput",""],e,t,i,r,o,s,l,c,d,[1,"dropdowns-container"],[1,"img"],[1,"inner"],["alt","Confirmation Image",3,"src"],["ltr","",1,"confirm-buttons"],["queryParamsHandling","merge",1,"again",3,"routerLink"],[1,"confirm"],[1,"dropdown-wrapper"],[1,"dropdown-label"],[1,"dropdown-select"],[1,"dropdown",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["width","12","height","12","viewBox","0 0 12 12","fill","none","xmlns","http://www.w3.org/2000/svg",1,"dropdown-icon"],["d","M2 4L6 8L10 4","stroke","#B969FF","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[3,"ngValue"],[1,"tags-wrapper"],[1,"tags-label"],[1,"tags-input-container"],[1,"tags-input-wrapper"],[1,"tags-input-with-chips"],[1,"tag-chip"],["type","text","placeholder","Type to add tags...","aria-label","Tags input field",1,"tags-input",3,"input","keydown","blur","value"],[1,"tags-suggestions"],["type","button","aria-label","Remove tag",1,"tag-remove",3,"click"],["type","button",1,"tag-suggestion"],["type","button",1,"tag-suggestion",3,"click","mousedown"],["xmlns","http://www.w3.org/2000/svg","width","24","height","25","viewBox","0 0 24 25","fill","none"],["d","M11 18.5H14.75C16.1424 18.5 17.4777 17.9469 18.4623 16.9623C19.4469 15.9777 20 14.6424 20 13.25C20 11.8576 19.4469 10.5223 18.4623 9.53769C17.4777 8.55312 16.1424 8 14.75 8H5M7.5 4.5L4 8L7.5 11.5","stroke","#EDECEC","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"confirm",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","25","height","25","viewBox","0 0 25 25","fill","none"],["d","M5.5 15.5V17.5C5.5 18.0304 5.71071 18.5391 6.08579 18.9142C6.46086 19.2893 6.96957 19.5 7.5 19.5H17.5C18.0304 19.5 18.5391 19.2893 18.9142 18.9142C19.2893 18.5391 19.5 18.0304 19.5 17.5V15.5","stroke","#4E02B2","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12.5 14.4844L12.5 5.98437M12.5 5.98437L9.5 8.98437M12.5 5.98437L15.5 8.98438","stroke","#4E02B2","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"]];},template:function(t,i){t&1&&(ge(0,RE,34,5,"div",10),P(1,"div",11)(2,"div",12),te(3,"img",13),S()(),P(4,"div",14),ge(5,LE,5,2,"a",15)(6,DE,5,2,"a",15)(7,NE,6,0,"a",16)(8,BE,6,0,"span",16),S()),t&2&&(he(i.api.automatic()?0:-1),I(3),K("src",i.state.currentImageUrl(),Ue),I(2),he(i.isTemplateFlow?5:6),I(2),he(i.api.currentlyUploadingImage()?8:7));},dependencies:[rn,li,on,Tc,kc,Oc,On,Tn],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
[_nghost-%COMP%] {
  display: flex;
  flex-flow: column;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background-color: #301A4E;
}
[_nghost-%COMP%]   .dropdowns-container[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  padding: 8px 16px;
  gap: 12px;
  min-height: 65px;
  border-bottom: 1px solid #B969FF;
  overflow-x: scroll;
}
[_nghost-%COMP%]   .dropdown-wrapper[_ngcontent-%COMP%] {
  flex: 1 1 auto;
  display: flex;
  flex-flow: column;
  align-items: flex-start;
  gap: 4px;
}
[_nghost-%COMP%]   .dropdown-label[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  leading-trim: both;
  text-edge: cap;
  font-style: normal;
  font-weight: 900;
  font-size: 10px;
  line-height: 13px;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: #B969FF;
  margin: 0;
}
[_nghost-%COMP%]   .dropdown-select[_ngcontent-%COMP%] {
  position: relative;
  width: 100%;
}
[_nghost-%COMP%]   .dropdown[_ngcontent-%COMP%] {
  box-sizing: border-box;
  width: 100%;
  min-width: 100px;
  padding: 8px 30px 8px 10px;
  border: 1px solid #B969FF;
  border-radius: 8px;
  background-color: #301A4E;
  color: #E7CBFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  leading-trim: both;
  text-edge: cap;
  font-style: normal;
  font-weight: 500;
  font-size: 13px;
  line-height: 16px;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  cursor: pointer;
  transition: all 0.2s;
}
[_nghost-%COMP%]   .dropdown[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #B969FF;
}
[_nghost-%COMP%]   .dropdown[_ngcontent-%COMP%]:hover {
  border-color: #B969FF;
}
[_nghost-%COMP%]   .dropdown[_ngcontent-%COMP%]   option[_ngcontent-%COMP%] {
  background-color: #301A4E;
  color: #E7CBFF;
}
[_nghost-%COMP%]   .dropdown-icon[_ngcontent-%COMP%] {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}
[_nghost-%COMP%]   .tags-wrapper[_ngcontent-%COMP%] {
  flex: 1 1 auto;
  display: flex;
  flex-flow: column;
  align-items: flex-start;
  gap: 4px;
  min-width: 200px;
}
[_nghost-%COMP%]   .tags-label[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  leading-trim: both;
  text-edge: cap;
  font-style: normal;
  font-weight: 900;
  font-size: 10px;
  line-height: 13px;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: #B969FF;
  margin: 0;
}
[_nghost-%COMP%]   .tags-input-container[_ngcontent-%COMP%] {
  position: relative;
}
[_nghost-%COMP%]   .tags-input-wrapper[_ngcontent-%COMP%] {
  position: relative;
  width: 100%;
}
[_nghost-%COMP%]   .tags-input-with-chips[_ngcontent-%COMP%] {
  box-sizing: border-box;
  width: 100%;
  min-height: 34px;
  padding: 4px;
  border: 1px solid #B969FF;
  border-radius: 8px;
  background-color: #301A4E;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: all 0.2s;
}
[_nghost-%COMP%]   .tags-input-with-chips[_ngcontent-%COMP%]:focus-within {
  border-color: #B969FF;
}
[_nghost-%COMP%]   .tags-input-with-chips[_ngcontent-%COMP%]:hover {
  border-color: #B969FF;
}
[_nghost-%COMP%]   .tag-chip[_ngcontent-%COMP%] {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  border-radius: 4px;
  background-color: #B969FF;
  color: #301A4E;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 12px;
  font-weight: 600;
  white-space: nowrap;
  flex-shrink: 0;
}
[_nghost-%COMP%]   .tag-chip[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%] {
  background: none;
  border: none;
  color: #301A4E;
  cursor: pointer;
  padding: 0;
  font-size: 12px;
  line-height: 1;
  margin-left: 2px;
  transition: opacity 0.2s;
}
[_nghost-%COMP%]   .tag-chip[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%]:hover {
  opacity: 0.7;
}
[_nghost-%COMP%]   .tag-chip[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%]:focus {
  outline: none;
}
[_nghost-%COMP%]   .tags-input[_ngcontent-%COMP%] {
  flex: 1 1 auto;
  min-width: 120px;
  border: none;
  background: transparent;
  color: #E7CBFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  leading-trim: both;
  text-edge: cap;
  font-style: normal;
  font-weight: 500;
  font-size: 13px;
  line-height: 16px;
  padding: 4px;
  outline: none;
}
[_nghost-%COMP%]   .tags-input[_ngcontent-%COMP%]::placeholder {
  color: rgba(217, 177, 255, 0.5);
}
[_nghost-%COMP%]   .tags-suggestions[_ngcontent-%COMP%] {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: 4px;
  background-color: #301A4E;
  border: 1px solid #B969FF;
  border-radius: 8px;
  max-height: 200px;
  overflow-y: auto;
  z-index: 10;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
}
[_nghost-%COMP%]   .tag-suggestion[_ngcontent-%COMP%] {
  display: block;
  width: 100%;
  padding: 8px 12px;
  border: none;
  background: none;
  color: #E7CBFF;
  text-align: left;
  cursor: pointer;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 13px;
  font-weight: 500;
  transition: background-color 0.2s;
}
[_nghost-%COMP%]   .tag-suggestion[_ngcontent-%COMP%]:hover {
  background-color: rgba(217, 177, 255, 0.1);
}
[_nghost-%COMP%]   .tag-suggestion[_ngcontent-%COMP%]:focus {
  outline: none;
  background-color: rgba(217, 177, 255, 0.15);
}
[_nghost-%COMP%]   .tag-suggestion[_ngcontent-%COMP%]:not(:last-child) {
  border-bottom: 1px solid rgba(217, 177, 255, 0.1);
}
[_nghost-%COMP%]   .img[_ngcontent-%COMP%] {
  flex: 1 1 auto;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 16px;
  overflow: hidden;
}
[_nghost-%COMP%]   .img[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}
[_nghost-%COMP%]   .img[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  object-fit: contain;
  object-position: center;
  max-width: 100%;
  max-height: 100%;
}
[_nghost-%COMP%]   .confirm-buttons[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  padding: 12px 16px;
  display: flex;
  flex-flow: row nowrap;
  gap: 8px;
  justify-content: center;
  border-top: 1px solid #B969FF;
}
[_nghost-%COMP%]   .confirm-buttons[_ngcontent-%COMP%]   .again[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  gap: 4px;
  padding: 0 8px;
  color: #EDECEC;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
  text-decoration: none;
}
[_nghost-%COMP%]   .confirm-buttons[_ngcontent-%COMP%]   .again[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
  width: 24px;
  height: 24px;
}
[_nghost-%COMP%]   .confirm-buttons[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%] {
  height: 52px;
  width: 100%;
  flex: 1 1 auto;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: center;
  gap: 4px;
  padding: 0 16px;
  border-radius: 16px;
  background: #FFFDF6;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 700;
  text-decoration: none;
}
[_nghost-%COMP%]   .confirm-buttons[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
  width: 24px;
  height: 24px;
}`]});};function $y(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};}var $o=$y();function VE(n){$o=n;}var Uy=/[&<>"']/,zE=new RegExp(Uy.source,"g"),Hy=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,jE=new RegExp(Hy.source,"g"),$E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Dy=n=>$E[n];function an(n,e){if(e){if(Uy.test(n))return n.replace(zE,Dy);}else if(Hy.test(n))return n.replace(jE,Dy);return n;}var UE=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Wy(n){return n.replace(UE,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""));}var HE=/(^|[^\[])\^/g;function dt(n,e){n=typeof n=="string"?n:n.source,e=e||"";let t={replace:(i,r)=>(r=r.source||r,r=r.replace(HE,"$1"),n=n.replace(i,r),t),getRegex:()=>new RegExp(n,e)};return t;}var WE=/[^\w:]/g,GE=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Ny(n,e,t){if(n){let i;try{i=decodeURIComponent(Wy(t)).replace(WE,"").toLowerCase();}catch{return null;}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null;}e&&!GE.test(t)&&(t=ZE(e,t));try{t=encodeURI(t).replace(/%25/g,"%");}catch{return null;}return t;}var gh={},YE=/^[^:]+:\/*[^/]*$/,XE=/^([^:]+:)[\s\S]*$/,qE=/^([^:]+:\/*[^/]*)[\s\S]*$/;function ZE(n,e){gh[" "+n]||(YE.test(n)?gh[" "+n]=n+"/":gh[" "+n]=mh(n,"/",!0)),n=gh[" "+n];let t=n.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:n.replace(XE,"$1")+e:e.charAt(0)==="/"?t?e:n.replace(qE,"$1")+e:n+e;}var _h={exec:function(){}};function By(n,e){let t=n.replace(/\|/g,(o,s,l)=>{let c=!1,d=s;for(;--d>=0&&l[d]==="\\";)c=!c;return c?"|":" |";}),i=t.split(/ \|/),r=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i;}function mh(n,e,t){let i=n.length;if(i===0)return"";let r=0;for(;r<i;){let o=n.charAt(i-r-1);if(o===e&&!t)r++;else if(o!==e&&t)r++;else break;}return n.slice(0,i-r);}function KE(n,e){if(n.indexOf(e[1])===-1)return-1;let t=n.length,i=0,r=0;for(;r<t;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])i++;else if(n[r]===e[1]&&(i--,i<0))return r;return-1;}function JE(n){n&&n.sanitize&&!n.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options");}function Vy(n,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=n),e>>=1,n+=n;return t+n;}function zy(n,e,t,i){let r=e.href,o=e.title?an(e.title):null,s=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){i.state.inLink=!0;let l={type:"link",raw:t,href:r,title:o,text:s,tokens:i.inlineTokens(s)};return i.state.inLink=!1,l;}return{type:"image",raw:t,href:r,title:o,text:an(s)};}function QE(n,e){let t=n.match(/^(\s+)(?:```)/);if(t===null)return e;let i=t[1];return e.split(`
`).map(r=>{let o=r.match(/^\s+/);if(o===null)return r;let[s]=o;return s.length>=i.length?r.slice(i.length):r;}).join(`
`);}var ul=class{constructor(e){this.options=e||$o;}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]};}code(e){let t=this.rules.block.code.exec(e);if(t){let i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:mh(i,`
`)};}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let i=t[0],r=QE(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:r};}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){let r=mh(i,"#");(this.options.pedantic||!r||/ $/.test(r))&&(i=r.trim());}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)};}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]};}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let i=t[0].replace(/^ *>[ \t]?/gm,""),r=this.lexer.state.top;this.lexer.state.top=!0;let o=this.lexer.blockTokens(i);return this.lexer.state.top=r,{type:"blockquote",raw:t[0],tokens:o,text:i};}}list(e){let t=this.rules.block.list.exec(e);if(t){let i,r,o,s,l,c,d,u,g,f,m,_,y=t[1].trim(),E=y.length>1,C={type:"list",raw:"",ordered:E,start:E?+y.slice(0,-1):"",loose:!1,items:[]};y=E?`\\d{1,9}\\${y.slice(-1)}`:`\\${y}`,this.options.pedantic&&(y=E?y:"[*+-]");let b=new RegExp(`^( {0,3}${y})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;e&&(_=!1,!(!(t=b.exec(e))||this.rules.block.hr.test(e)));){if(i=t[0],e=e.substring(i.length),u=t[2].split(`
`,1)[0].replace(/^\t+/,w=>" ".repeat(3*w.length)),g=e.split(`
`,1)[0],this.options.pedantic?(s=2,m=u.trimLeft()):(s=t[2].search(/[^ ]/),s=s>4?1:s,m=u.slice(s),s+=t[1].length),c=!1,!u&&/^ *$/.test(g)&&(i+=g+`
`,e=e.substring(g.length+1),_=!0),!_){let w=new RegExp(`^ {0,${Math.min(3,s-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),T=new RegExp(`^ {0,${Math.min(3,s-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),R=new RegExp(`^ {0,${Math.min(3,s-1)}}(?:\`\`\`|~~~)`),V=new RegExp(`^ {0,${Math.min(3,s-1)}}#`);for(;e&&(f=e.split(`
`,1)[0],g=f,this.options.pedantic&&(g=g.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(R.test(g)||V.test(g)||w.test(g)||T.test(e)));){if(g.search(/[^ ]/)>=s||!g.trim())m+=`
`+g.slice(s);else{if(c||u.search(/[^ ]/)>=4||R.test(u)||V.test(u)||T.test(u))break;m+=`
`+g;}!c&&!g.trim()&&(c=!0),i+=f+`
`,e=e.substring(f.length+1),u=g.slice(s);}}C.loose||(d?C.loose=!0:/\n *\n *$/.test(i)&&(d=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(m),r&&(o=r[0]!=="[ ] ",m=m.replace(/^\[[ xX]\] +/,""))),C.items.push({type:"list_item",raw:i,task:!!r,checked:o,loose:!1,text:m}),C.raw+=i;}C.items[C.items.length-1].raw=i.trimRight(),C.items[C.items.length-1].text=m.trimRight(),C.raw=C.raw.trimRight();let x=C.items.length;for(l=0;l<x;l++)if(this.lexer.state.top=!1,C.items[l].tokens=this.lexer.blockTokens(C.items[l].text,[]),!C.loose){let w=C.items[l].tokens.filter(R=>R.type==="space"),T=w.length>0&&w.some(R=>/\n.*\n/.test(R.raw));C.loose=T;}if(C.loose)for(l=0;l<x;l++)C.items[l].loose=!0;return C;}}html(e){let t=this.rules.block.html.exec(e);if(t){let i={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};if(this.options.sanitize){let r=this.options.sanitizer?this.options.sanitizer(t[0]):an(t[0]);i.type="paragraph",i.text=r,i.tokens=this.lexer.inline(r);}return i;}}def(e){let t=this.rules.block.def.exec(e);if(t){let i=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:r,title:o};}}table(e){let t=this.rules.block.table.exec(e);if(t){let i={type:"table",header:By(t[1]).map(r=>({text:r})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=t[0];let r=i.align.length,o,s,l,c;for(o=0;o<r;o++)/^ *-+: *$/.test(i.align[o])?i.align[o]="right":/^ *:-+: *$/.test(i.align[o])?i.align[o]="center":/^ *:-+ *$/.test(i.align[o])?i.align[o]="left":i.align[o]=null;for(r=i.rows.length,o=0;o<r;o++)i.rows[o]=By(i.rows[o],i.header.length).map(d=>({text:d}));for(r=i.header.length,s=0;s<r;s++)i.header[s].tokens=this.lexer.inline(i.header[s].text);for(r=i.rows.length,s=0;s<r;s++)for(c=i.rows[s],l=0;l<c.length;l++)c[l].tokens=this.lexer.inline(c[l].text);return i;}}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])};}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)};}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])};}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:an(t[1])};}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):an(t[0]):t[0]};}link(e){let t=this.rules.inline.link.exec(e);if(t){let i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;let s=mh(i.slice(0,-1),"\\");if((i.length-s.length)%2===0)return;}else{let s=KE(t[2],"()");if(s>-1){let c=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,c).trim(),t[3]="";}}let r=t[2],o="";if(this.options.pedantic){let s=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);s&&(r=s[1],o=s[3]);}else o=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(i)?r=r.slice(1):r=r.slice(1,-1)),zy(t,{href:r&&r.replace(this.rules.inline._escapes,"$1"),title:o&&o.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer);}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let r=(i[2]||i[1]).replace(/\s+/g," ");if(r=t[r.toLowerCase()],!r){let o=i[0].charAt(0);return{type:"text",raw:o,text:o};}return zy(i,r,i[0],this.lexer);}}emStrong(e,t,i=""){let r=this.rules.inline.emStrong.lDelim.exec(e);if(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))return;let o=r[1]||r[2]||"";if(!o||o&&(i===""||this.rules.inline.punctuation.exec(i))){let s=r[0].length-1,l,c,d=s,u=0,g=r[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(g.lastIndex=0,t=t.slice(-1*e.length+s);(r=g.exec(t))!=null;){if(l=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!l)continue;if(c=l.length,r[3]||r[4]){d+=c;continue;}else if((r[5]||r[6])&&s%3&&!((s+c)%3)){u+=c;continue;}if(d-=c,d>0)continue;c=Math.min(c,c+d+u);let f=e.slice(0,s+r.index+(r[0].length-l.length)+c);if(Math.min(s,c)%2){let _=f.slice(1,-1);return{type:"em",raw:f,text:_,tokens:this.lexer.inlineTokens(_)};}let m=f.slice(2,-2);return{type:"strong",raw:f,text:m,tokens:this.lexer.inlineTokens(m)};}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," "),r=/[^ ]/.test(i),o=/^ /.test(i)&&/ $/.test(i);return r&&o&&(i=i.substring(1,i.length-1)),i=an(i,!0),{type:"codespan",raw:t[0],text:i};}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]};}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])};}autolink(e,t){let i=this.rules.inline.autolink.exec(e);if(i){let r,o;return i[2]==="@"?(r=an(this.options.mangle?t(i[1]):i[1]),o="mailto:"+r):(r=an(i[1]),o=r),{type:"link",raw:i[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]};}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let r,o;if(i[2]==="@")r=an(this.options.mangle?t(i[0]):i[0]),o="mailto:"+r;else{let s;do s=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(s!==i[0]);r=an(i[0]),i[1]==="www."?o="http://"+i[0]:o=i[0];}return{type:"link",raw:i[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]};}}inlineText(e,t){let i=this.rules.inline.text.exec(e);if(i){let r;return this.lexer.state.inRawBlock?r=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):an(i[0]):i[0]:r=an(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:r};}}},Ae={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:_h,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};Ae._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;Ae._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Ae.def=dt(Ae.def).replace("label",Ae._label).replace("title",Ae._title).getRegex();Ae.bullet=/(?:[*+-]|\d{1,9}[.)])/;Ae.listItemStart=dt(/^( *)(bull) */).replace("bull",Ae.bullet).getRegex();Ae.list=dt(Ae.list).replace(/bull/g,Ae.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ae.def.source+")").getRegex();Ae._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Ae._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Ae.html=dt(Ae.html,"i").replace("comment",Ae._comment).replace("tag",Ae._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Ae.paragraph=dt(Ae._paragraph).replace("hr",Ae.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ae._tag).getRegex();Ae.blockquote=dt(Ae.blockquote).replace("paragraph",Ae.paragraph).getRegex();Ae.normal=D({},Ae);Ae.gfm=se(D({},Ae.normal),{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});Ae.gfm.table=dt(Ae.gfm.table).replace("hr",Ae.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ae._tag).getRegex();Ae.gfm.paragraph=dt(Ae._paragraph).replace("hr",Ae.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Ae.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ae._tag).getRegex();Ae.pedantic=se(D({},Ae.normal),{html:dt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ae._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:_h,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:dt(Ae.normal._paragraph).replace("hr",Ae.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ae.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var xe={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:_h,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:_h,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};xe._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";xe.punctuation=dt(xe.punctuation).replace(/punctuation/g,xe._punctuation).getRegex();xe.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;xe.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;xe._comment=dt(Ae._comment).replace("(?:-->|$)","-->").getRegex();xe.emStrong.lDelim=dt(xe.emStrong.lDelim).replace(/punct/g,xe._punctuation).getRegex();xe.emStrong.rDelimAst=dt(xe.emStrong.rDelimAst,"g").replace(/punct/g,xe._punctuation).getRegex();xe.emStrong.rDelimUnd=dt(xe.emStrong.rDelimUnd,"g").replace(/punct/g,xe._punctuation).getRegex();xe._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;xe._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;xe._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;xe.autolink=dt(xe.autolink).replace("scheme",xe._scheme).replace("email",xe._email).getRegex();xe._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;xe.tag=dt(xe.tag).replace("comment",xe._comment).replace("attribute",xe._attribute).getRegex();xe._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;xe._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;xe._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;xe.link=dt(xe.link).replace("label",xe._label).replace("href",xe._href).replace("title",xe._title).getRegex();xe.reflink=dt(xe.reflink).replace("label",xe._label).replace("ref",Ae._label).getRegex();xe.nolink=dt(xe.nolink).replace("ref",Ae._label).getRegex();xe.reflinkSearch=dt(xe.reflinkSearch,"g").replace("reflink",xe.reflink).replace("nolink",xe.nolink).getRegex();xe.normal=D({},xe);xe.pedantic=se(D({},xe.normal),{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:dt(/^!?\[(label)\]\((.*?)\)/).replace("label",xe._label).getRegex(),reflink:dt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",xe._label).getRegex()});xe.gfm=se(D({},xe.normal),{escape:dt(xe.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});xe.gfm.url=dt(xe.gfm.url,"i").replace("email",xe.gfm._extended_email).getRegex();xe.breaks=se(D({},xe.gfm),{br:dt(xe.br).replace("{2,}","*").getRegex(),text:dt(xe.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function eO(n){return n.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026");}function jy(n){let e="",t,i,r=n.length;for(t=0;t<r;t++)i=n.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),e+="&#"+i+";";return e;}var zo=class n{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||$o,this.options.tokenizer=this.options.tokenizer||new ul(),this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={block:Ae.normal,inline:xe.normal};this.options.pedantic?(t.block=Ae.pedantic,t.inline=xe.pedantic):this.options.gfm&&(t.block=Ae.gfm,this.options.breaks?t.inline=xe.breaks:t.inline=xe.gfm),this.tokenizer.rules=t;}static get rules(){return{block:Ae,inline:xe};}static lex(e,t){return new n(t).lex(e);}static lexInline(e,t){return new n(t).inlineTokens(e);}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens;}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(l,c,d)=>c+"    ".repeat(d.length));let i,r,o,s;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(l=>(i=l.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(i);continue;}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+i.raw,r.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i);continue;}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+i.raw,r.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue;}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let l=1/0,c=e.slice(1),d;this.options.extensions.startBlock.forEach(function(u){d=u.call({lexer:this},c),typeof d=="number"&&d>=0&&(l=Math.min(l,d));}),l<1/0&&l>=0&&(o=e.substring(0,l+1));}if(this.state.top&&(i=this.tokenizer.paragraph(o))){r=t[t.length-1],s&&r.type==="paragraph"?(r.raw+=`
`+i.raw,r.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i),s=o.length!==e.length,e=e.substring(i.raw.length);continue;}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&r.type==="text"?(r.raw+=`
`+i.raw,r.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(i);continue;}if(e){let l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break;}else throw new Error(l);}}return this.state.top=!0,t;}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t;}inlineTokens(e,t=[]){let i,r,o,s=e,l,c,d;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)u.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,l.index)+"["+Vy("a",l[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex));}for(;(l=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,l.index)+"["+Vy("a",l[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(l=this.tokenizer.rules.inline.escapedEmSt.exec(s))!=null;)s=s.slice(0,l.index+l[0].length-2)+"++"+s.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(c||(d=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue;}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue;}if(i=this.tokenizer.emStrong(e,s,d)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue;}if(i=this.tokenizer.autolink(e,jy)){e=e.substring(i.raw.length),t.push(i);continue;}if(!this.state.inLink&&(i=this.tokenizer.url(e,jy))){e=e.substring(i.raw.length),t.push(i);continue;}if(o=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0,g=e.slice(1),f;this.options.extensions.startInline.forEach(function(m){f=m.call({lexer:this},g),typeof f=="number"&&f>=0&&(u=Math.min(u,f));}),u<1/0&&u>=0&&(o=e.substring(0,u+1));}if(i=this.tokenizer.inlineText(o,eO)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(d=i.raw.slice(-1)),c=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue;}if(e){let u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break;}else throw new Error(u);}}return t;}},pl=class{constructor(e){this.options=e||$o;}code(e,t,i){let r=(t||"").match(/\S*/)[0];if(this.options.highlight){let o=this.options.highlight(e,r);o!=null&&o!==e&&(i=!0,e=o);}return e=e.replace(/\n$/,"")+`
`,r?'<pre><code class="'+this.options.langPrefix+an(r)+'">'+(i?e:an(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:an(e,!0))+`</code></pre>
`;}blockquote(e){return`<blockquote>
${e}</blockquote>
`;}html(e){return e;}heading(e,t,i,r){if(this.options.headerIds){let o=this.options.headerPrefix+r.slug(i);return`<h${t} id="${o}">${e}</h${t}>
`;}return`<h${t}>${e}</h${t}>
`;}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`;}list(e,t,i){let r=t?"ol":"ul",o=t&&i!==1?' start="'+i+'"':"";return"<"+r+o+`>
`+e+"</"+r+`>
`;}listitem(e){return`<li>${e}</li>
`;}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> ";}paragraph(e){return`<p>${e}</p>
`;}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`;}tablerow(e){return`<tr>
${e}</tr>
`;}tablecell(e,t){let i=t.header?"th":"td";return(t.align?`<${i} align="${t.align}">`:`<${i}>`)+e+`</${i}>
`;}strong(e){return`<strong>${e}</strong>`;}em(e){return`<em>${e}</em>`;}codespan(e){return`<code>${e}</code>`;}br(){return this.options.xhtml?"<br/>":"<br>";}del(e){return`<del>${e}</del>`;}link(e,t,i){if(e=Ny(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let r='<a href="'+e+'"';return t&&(r+=' title="'+t+'"'),r+=">"+i+"</a>",r;}image(e,t,i){if(e=Ny(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let r=`<img src="${e}" alt="${i}"`;return t&&(r+=` title="${t}"`),r+=this.options.xhtml?"/>":">",r;}text(e){return e;}},vh=class{strong(e){return e;}em(e){return e;}codespan(e){return e;}del(e){return e;}html(e){return e;}text(e){return e;}link(e,t,i){return""+i;}image(e,t,i){return""+i;}br(){return"";}},yh=class{constructor(){this.seen={};}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");}getNextSafeSlug(e,t){let i=e,r=0;if(this.seen.hasOwnProperty(i)){r=this.seen[e];do r++,i=e+"-"+r;while(this.seen.hasOwnProperty(i));}return t||(this.seen[e]=r,this.seen[i]=0),i;}slug(e,t={}){let i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun);}},jo=class n{constructor(e){this.options=e||$o,this.options.renderer=this.options.renderer||new pl(),this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new vh(),this.slugger=new yh();}static parse(e,t){return new n(t).parse(e);}static parseInline(e,t){return new n(t).parseInline(e);}parse(e,t=!0){let i="",r,o,s,l,c,d,u,g,f,m,_,y,E,C,b,x,w,T,R,V=e.length;for(r=0;r<V;r++){if(m=e[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[m.type]&&(R=this.options.extensions.renderers[m.type].call({parser:this},m),R!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(m.type))){i+=R||"";continue;}switch(m.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue;}case"heading":{i+=this.renderer.heading(this.parseInline(m.tokens),m.depth,Wy(this.parseInline(m.tokens,this.textRenderer)),this.slugger);continue;}case"code":{i+=this.renderer.code(m.text,m.lang,m.escaped);continue;}case"table":{for(g="",u="",l=m.header.length,o=0;o<l;o++)u+=this.renderer.tablecell(this.parseInline(m.header[o].tokens),{header:!0,align:m.align[o]});for(g+=this.renderer.tablerow(u),f="",l=m.rows.length,o=0;o<l;o++){for(d=m.rows[o],u="",c=d.length,s=0;s<c;s++)u+=this.renderer.tablecell(this.parseInline(d[s].tokens),{header:!1,align:m.align[s]});f+=this.renderer.tablerow(u);}i+=this.renderer.table(g,f);continue;}case"blockquote":{f=this.parse(m.tokens),i+=this.renderer.blockquote(f);continue;}case"list":{for(_=m.ordered,y=m.start,E=m.loose,l=m.items.length,f="",o=0;o<l;o++)b=m.items[o],x=b.checked,w=b.task,C="",b.task&&(T=this.renderer.checkbox(x),E?b.tokens.length>0&&b.tokens[0].type==="paragraph"?(b.tokens[0].text=T+" "+b.tokens[0].text,b.tokens[0].tokens&&b.tokens[0].tokens.length>0&&b.tokens[0].tokens[0].type==="text"&&(b.tokens[0].tokens[0].text=T+" "+b.tokens[0].tokens[0].text)):b.tokens.unshift({type:"text",text:T}):C+=T),C+=this.parse(b.tokens,E),f+=this.renderer.listitem(C,w,x);i+=this.renderer.list(f,_,y);continue;}case"html":{i+=this.renderer.html(m.text);continue;}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(m.tokens));continue;}case"text":{for(f=m.tokens?this.parseInline(m.tokens):m.text;r+1<V&&e[r+1].type==="text";)m=e[++r],f+=`
`+(m.tokens?this.parseInline(m.tokens):m.text);i+=t?this.renderer.paragraph(f):f;continue;}default:{let B='Token with "'+m.type+'" type was not found.';if(this.options.silent){console.error(B);return;}else throw new Error(B);}}}return i;}parseInline(e,t){t=t||this.renderer;let i="",r,o,s,l=e.length;for(r=0;r<l;r++){if(o=e[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]&&(s=this.options.extensions.renderers[o.type].call({parser:this},o),s!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type))){i+=s||"";continue;}switch(o.type){case"escape":{i+=t.text(o.text);break;}case"html":{i+=t.html(o.text);break;}case"link":{i+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break;}case"image":{i+=t.image(o.href,o.title,o.text);break;}case"strong":{i+=t.strong(this.parseInline(o.tokens,t));break;}case"em":{i+=t.em(this.parseInline(o.tokens,t));break;}case"codespan":{i+=t.codespan(o.text);break;}case"br":{i+=t.br();break;}case"del":{i+=t.del(this.parseInline(o.tokens,t));break;}case"text":{i+=t.text(o.text);break;}default:{let c='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(c);return;}else throw new Error(c);}}}return i;}},fl=class{constructor(e){this.options=e||$o;}static passThroughHooks=new Set(["preprocess","postprocess"]);preprocess(e){return e;}postprocess(e){return e;}};function tO(n,e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let r="<p>An error occurred:</p><pre>"+an(i.message+"",!0)+"</pre>";if(e)return Promise.resolve(r);if(t){t(null,r);return;}return r;}if(e)return Promise.reject(i);if(t){t(i);return;}throw i;};}function Gy(n,e){return(t,i,r)=>{typeof i=="function"&&(r=i,i=null);let o=D({},i);i=D(D({},Ee.defaults),o);let s=tO(i.silent,i.async,r);if(typeof t>"u"||t===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(JE(i),i.hooks&&(i.hooks.options=i),r){let l=i.highlight,c;try{i.hooks&&(t=i.hooks.preprocess(t)),c=n(t,i);}catch(g){return s(g);}let d=function(g){let f;if(!g)try{i.walkTokens&&Ee.walkTokens(c,i.walkTokens),f=e(c,i),i.hooks&&(f=i.hooks.postprocess(f));}catch(m){g=m;}return i.highlight=l,g?s(g):r(null,f);};if(!l||l.length<3||(delete i.highlight,!c.length))return d();let u=0;Ee.walkTokens(c,function(g){g.type==="code"&&(u++,setTimeout(()=>{l(g.text,g.lang,function(f,m){if(f)return d(f);m!=null&&m!==g.text&&(g.text=m,g.escaped=!0),u--,u===0&&d();});},0));}),u===0&&d();return;}if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then(l=>n(l,i)).then(l=>i.walkTokens?Promise.all(Ee.walkTokens(l,i.walkTokens)).then(()=>l):l).then(l=>e(l,i)).then(l=>i.hooks?i.hooks.postprocess(l):l).catch(s);try{i.hooks&&(t=i.hooks.preprocess(t));let l=n(t,i);i.walkTokens&&Ee.walkTokens(l,i.walkTokens);let c=e(l,i);return i.hooks&&(c=i.hooks.postprocess(c)),c;}catch(l){return s(l);}};}function Ee(n,e,t){return Gy(zo.lex,jo.parse)(n,e,t);}Ee.options=Ee.setOptions=function(n){return Ee.defaults=D(D({},Ee.defaults),n),VE(Ee.defaults),Ee;};Ee.getDefaults=$y;Ee.defaults=$o;Ee.use=function(...n){let e=Ee.defaults.extensions||{renderers:{},childTokens:{}};n.forEach(t=>{let i=D({},t);if(i.async=Ee.defaults.async||i.async||!1,t.extensions&&(t.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if(r.renderer){let o=e.renderers[r.name];o?e.renderers[r.name]=function(...s){let l=r.renderer.apply(this,s);return l===!1&&(l=o.apply(this,s)),l;}:e.renderers[r.name]=r.renderer;}if(r.tokenizer){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");e[r.level]?e[r.level].unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]));}r.childTokens&&(e.childTokens[r.name]=r.childTokens);}),i.extensions=e),t.renderer){let r=Ee.defaults.renderer||new pl();for(let o in t.renderer){let s=r[o];r[o]=(...l)=>{let c=t.renderer[o].apply(r,l);return c===!1&&(c=s.apply(r,l)),c;};}i.renderer=r;}if(t.tokenizer){let r=Ee.defaults.tokenizer||new ul();for(let o in t.tokenizer){let s=r[o];r[o]=(...l)=>{let c=t.tokenizer[o].apply(r,l);return c===!1&&(c=s.apply(r,l)),c;};}i.tokenizer=r;}if(t.hooks){let r=Ee.defaults.hooks||new fl();for(let o in t.hooks){let s=r[o];fl.passThroughHooks.has(o)?r[o]=l=>{if(Ee.defaults.async)return Promise.resolve(t.hooks[o].call(r,l)).then(d=>s.call(r,d));let c=t.hooks[o].call(r,l);return s.call(r,c);}:r[o]=(...l)=>{let c=t.hooks[o].apply(r,l);return c===!1&&(c=s.apply(r,l)),c;};}i.hooks=r;}if(t.walkTokens){let r=Ee.defaults.walkTokens;i.walkTokens=function(o){let s=[];return s.push(t.walkTokens.call(this,o)),r&&(s=s.concat(r.call(this,o))),s;};}Ee.setOptions(i);});};Ee.walkTokens=function(n,e){let t=[];for(let i of n)switch(t=t.concat(e.call(Ee,i)),i.type){case"table":{for(let r of i.header)t=t.concat(Ee.walkTokens(r.tokens,e));for(let r of i.rows)for(let o of r)t=t.concat(Ee.walkTokens(o.tokens,e));break;}case"list":{t=t.concat(Ee.walkTokens(i.items,e));break;}default:Ee.defaults.extensions&&Ee.defaults.extensions.childTokens&&Ee.defaults.extensions.childTokens[i.type]?Ee.defaults.extensions.childTokens[i.type].forEach(function(r){t=t.concat(Ee.walkTokens(i[r],e));}):i.tokens&&(t=t.concat(Ee.walkTokens(i.tokens,e)));}return t;};Ee.parseInline=Gy(zo.lexInline,jo.parseInline);Ee.Parser=jo;Ee.parser=jo.parse;Ee.Renderer=pl;Ee.TextRenderer=vh;Ee.Lexer=zo;Ee.lexer=zo.lex;Ee.Tokenizer=ul;Ee.Slugger=yh;Ee.Hooks=fl;Ee.parse=Ee;var DV=Ee.options,NV=Ee.setOptions,BV=Ee.use,VV=Ee.walkTokens,zV=Ee.parseInline;var jV=jo.parse,$V=zo.lex;var Xy=a0(Yy());var nO=["messagesEl"],iO=["spacer"],rO=["thinkingEl"],oO=[[["",8,"message"]],[["",8,"spacer"]]],sO=[".message",".spacer"];function aO(n,e){if(n&1&&(P(0,"div",8),te(1,"span",9),S()),n&2){let t=e.$implicit;Se("human",t.kind==="human")("ai",t.kind==="ai")("part",t.part),I(),K("innerHTML",t._(),Mc);}}var _n=class{constructor(e,t,i){this.kind=e;this.text=t;this.part=i;this.fullText=t,this._text.set(t);}fullText;_text=G("");_=_e(()=>{let e=this._text();return Ee(e);});setText(e){this.fullText=e,this._text.set(e);}resetDisplayed(){this._text.set("");}},Ci=class n{constructor(e,t){this.platform=e;this.ref=t;this.platform.browser(()=>{at(()=>{let i=this.messages();jn(1).subscribe(()=>{this.setScrollParams(i);});}),Hr(window,"resize").pipe(Bt(),gr(100)).subscribe(()=>{let i=this.messages();this.setScrollParams(i);});}),this.scroller.pipe(gr(30)).subscribe(i=>{i();});}bg=!1;scrollOnAI=!0;paddingTop=16;messages=G([]);thinking=G(!1);allTypingComplete=G(!1);messagesEl;spacerEl;scroller=new En();spacerHeight=G(0);scrollPosition=new En();loadingAnim;thinkingEl;_=Ee;typingIntervals=new Set();messageQueue=[];isProcessingQueue=!1;scrollIfOutOfView(){let e=this.messagesEl?.nativeElement;if(!e)return;let t=e.querySelector(".message:last-of-type");if(!t)return;let i=e.getBoundingClientRect(),r=t.getBoundingClientRect();(r.bottom>i.bottom||r.top<i.top)&&this.scroller.next(()=>{t.scrollIntoView({behavior:"smooth",block:"nearest"});});}ngAfterViewInit(){this.platform.browser(()=>{this.loadingAnim=Xy.default.loadAnimation({container:this.thinkingEl.nativeElement,renderer:"svg",loop:!0,autoplay:!0,path:"/thinking.json"}),Hr(this.messagesEl.nativeElement,"scroll").pipe(Bt(this.ref),p0(100,void 0,{leading:!0,trailing:!0})).subscribe(()=>{let e=this.messagesEl.nativeElement;this.scrollPosition.next(e.scrollTop);});});}ngOnDestroy(){this.loadingAnim?.destroy(),this.typingIntervals.forEach(e=>clearInterval(e)),this.typingIntervals.clear();}clear(){this.messages.update(()=>[]),this.messagesEl.nativeElement.scrollTop=0;}addMessage(e){console.log("[Messages] addMessage called - queuing:",e.kind,e.fullText.substring(0,30)),this.messageQueue.push(e),this.isProcessingQueue||(this.allTypingComplete.set(!1),this.processQueue());}processQueue(){return J(this,null,function*(){if(this.messageQueue.length===0){this.isProcessingQueue=!1,console.log("[Messages] Queue empty, stopping processor"),setTimeout(()=>{console.log("[Messages] Setting allTypingComplete to true"),this.allTypingComplete.set(!0);},0);return;}this.isProcessingQueue=!0;let e=this.messageQueue.shift();if(console.log("[Messages] Processing message:",e.kind,"at",Date.now()),this.messages.update(t=>[...t,e]),!this.platform.browser()){e.setText(e.fullText),this.processQueue();return;}yield this.startTypewriter(e),console.log("[Messages] Finished typing, processing next message"),this.processQueue();});}startTypewriter(e){let t=e.fullText||"";return e.setText(t),this.scrollIfOutOfView(),Promise.resolve();}setScrollParams(e){let t=this.messagesEl.nativeElement;if(t){let i=t.querySelectorAll(".message");if(i.length>0){let r=i[e.length-1];if(!r)return;let o=r.getBoundingClientRect(),s=t.offsetHeight-o.height-8;if(s<1&&(s=1),this.spacerHeight.set(s),r.classList.contains("human")){let c=r.getBoundingClientRect().top;this.scroller.next(()=>{console.log("scrolling last message",r,r.classList),this.messagesEl.nativeElement.scrollBy({top:c-4,behavior:"smooth"});});}else this.scrollOnAI&&this.scroller.next(()=>{console.log("scrolling spacer",r,r.classList),this.spacerEl.nativeElement.scrollIntoView({behavior:"smooth",block:"end"});});}}}static fac=function(t){return new(t||n)(ue(it),ue(ii));};static cmp=Me({type:n,selectors:[["app-messages"]],viewQuery:function(t,i){if(t&1&&(Pt(nO,5),Pt(iO,5),Pt(rO,5)),t&2){let r;wt(r=Mt())&&(i.messagesEl=r.first),wt(r=Mt())&&(i.spacerEl=r.first),wt(r=Mt())&&(i.thinkingEl=r.first);}},inputs:{bg:"bg",scrollOnAI:"scrollOnAI",paddingTop:"paddingTop"},ngContentSelectors:sO,decls:11,vars:10,consts:[["messagesEl",""],["thinkingEl",""],["spacer",""],[1,"messages"],["ltr","",1,"message",3,"human","ai","part"],[1,"spacer"],[1,"thinking-animation"],[1,"under-spacer"],["ltr","",1,"message"],[1,"message-text",3,"innerHTML"]],template:function(t,i){t&1&&(C0(oO),P(0,"div",3,0),ze(2,aO,2,7,"div",4,jt),rp(4),P(5,"div",5),te(6,"div",6,1)(8,"div",7,2),rp(10,1),S()()),t&2&&(Et("padding-top",i.paddingTop,"px"),Se("bg",i.bg),I(2),je(i.messages()),I(3),Et("min-height",i.spacerHeight(),"px"),I(),Se("visible",i.thinking()),I(2),Et("height",i.spacerHeight(),"px"));},dependencies:[li],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
[_nghost-%COMP%] {
  display: flex;
  width: 100%;
  height: 100%;
}
[_nghost-%COMP%]   .messages[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  gap: 4px;
  width: 100%;
  height: 100%;
  overflow-x: hidden;
  overflow-y: auto;
  padding: 16px 32px;
  padding-bottom: 0px;
}
[_nghost-%COMP%]   .messages.bg[_ngcontent-%COMP%] {
  background-color: #F5F0E7;
}
[_nghost-%COMP%]   .messages[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%] {
  height: 0%;
  flex: 0 0 auto;
  position: relative;
  width: calc(100% + 64px);
  left: -32px;
}
[_nghost-%COMP%]   .messages[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .thinking-animation[_ngcontent-%COMP%] {
  opacity: 0;
  transition: opacity 0.5s ease-in-out;
  display: inline-block;
  width: 80px;
  height: 45px;
  position: absolute;
  top: 4px;
  left: 32px;
}
[_nghost-%COMP%]   .messages[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .thinking-animation.visible[_ngcontent-%COMP%] {
  opacity: 1;
}
[_nghost-%COMP%]   .messages[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]   .under-spacer[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  z-index: -1;
  pointer-events: none;
}`]});};function lO(n,e){n&1&&(ke(),P(0,"svg",5),te(1,"path",6),S());}function cO(n,e){if(n&1&&(P(0,"a",4),ge(1,lO,2,0,":svg:svg",5),P(2,"span"),N(3),S()()),n&2){let t=e.$implicit;Se("primary",t.primary),K("href",t.url||null,Ue),I(),he(t.primary?1:-1),I(2),Ve(t.name);}}var Ks=class n{constructor(e,t,i){this.locale=e;this.platform=t;this.api=i;console.log("Current locale:",e),this.currentLanguageCode.set(e),this.platform.browser(()=>{this.host=location.host;});}LANGUAGES=_e(()=>{let e=this.api.workspace(),t=e?.metadata?.languages?.length?e.metadata.languages:["en","nl","he","ar"],i=Array.from(new Set(t)),r={en:"English",nl:"Nederlands",he:"\u05E2\u05D1\u05E8\u05D9\u05EA",ar:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"},o=i.map(l=>({code:l,name:r[l]||l,baseHref:l==="en"?"/":`/${l}/`})),s=o.find(l=>l.code===this.currentLanguageCode());return s&&o.forEach(l=>{l.primary=l.code===s.code,l.url=this.urlForLanguage(s,l);}),o;});currentLanguageCode=G("");host="mapfuture.es";urlForLanguage(e,t){if(t.code!==e.code){if(this.platform.browser())try{let i=new URL(location.href),r=["en","nl","he","ar"],o=i.pathname.split("/").filter(Boolean),s=o[0];r.includes(s)&&o.shift();let l=o.length>0?o.join("/"):"",c=t.code==="en"?`/${l}`:`/${t.code}/${l}`;return i.pathname=c,i.toString();}catch{return t.baseHref;}return t.baseHref;}}static fac=function(t){return new(t||n)(ue(Ec),ue(it),ue(rt));};static cmp=Me({type:n,selectors:[["app-language-selector"]],decls:5,vars:0,consts:[[1,"container"],[1,"buttons"],[1,"button-row"],[1,"language","button",3,"primary","href"],[1,"language","button",3,"href"],["xmlns","http://www.w3.org/2000/svg","width","25","height","25","viewBox","0 0 25 25","fill","none"],["d","M18.1176 8.70358L10.7537 16.0675L6.51104 11.8249","stroke","#4E02B2","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"]],template:function(t,i){t&1&&(P(0,"div",0)(1,"div",1)(2,"div",2),ze(3,cO,4,5,"a",3,ji),S()()()),t&2&&(I(3),je(i.LANGUAGES()));},styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  height: 52px;
  gap: 8px;
  padding: none;
}
.container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] {
  padding: 16px 8px;
}
.container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  gap: 8px;
}
.container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 40px;
  gap: 8px;
  border-radius: 8px;
  border: 1px solid #E7CBFF;
  background: #FFFDF6;
  color: #6C707B;
  font-size: 16px;
  font-weight: 400;
}
.container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  color: #4E02B2;
  font-weight: 700;
  background: #E7CBFF;
  pointer-events: none;
}`]});};var qy=()=>["/"],hO=()=>["/prescan"];function dO(n,e){n&1&&(P(0,"a",6),ke(),P(1,"svg",7),te(2,"path",8),S(),Ye(),P(3,"span"),be(4,2),S()()),n&2&&K("routerLink",yt(1,hO));}var Zy=348-2*56,Js=class n{constructor(e,t){this.api=e;this.state=t;at(()=>{this.api.workspaceId()&&this.api.api_key()&&this.api.workspace()?.source?this.state.mainMenuHeight.set(Zy):this.state.mainMenuHeight.set(Zy-56);});}explore=new Gr();static fac=function(t){return new(t||n)(ue(rt),ue(Ot));};static cmp=Me({type:n,selectors:[["app-main-menu"]],outputs:{explore:"explore"},decls:8,vars:7,consts:()=>{let e;e="Bekijk de Futures Map";let t;t="Over + Contact";let i;return i="Toevoegen aan Futures Map",[e,t,i,[1,"menu"],[1,"links"],["queryParamsHandling","preserve",1,"simple",3,"click","routerLink"],["queryParamsHandling","preserve",1,"primary",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M12 4.01562C12.5523 4.01563 13 4.46334 13 5.01562V11.0078H18.9951L19.0977 11.0127C19.6017 11.0641 19.9951 11.4902 19.9951 12.0078C19.9951 12.5254 19.6017 12.9515 19.0977 13.0029L18.9951 13.0078H13V19.0029L12.9951 19.1055C12.9437 19.6095 12.5176 20.0029 12 20.0029C11.4824 20.0029 11.0563 19.6095 11.0049 19.1055L11 19.0029V13.0078H5.00781C4.45553 13.0078 4.00781 12.5601 4.00781 12.0078C4.00781 11.4555 4.45553 11.0078 5.00781 11.0078H11V5.01562C11 4.46334 11.4477 4.01562 12 4.01562Z","fill","#FFFDF6"]];},template:function(t,i){t&1&&(P(0,"div",3),te(1,"app-language-selector"),P(2,"div",4)(3,"a",5),Z("click",function(){return i.explore.next();}),be(4,0),S(),P(5,"a",5),Z("click",function(){return i.state.aboutVisible.set(!0);}),be(6,1),S(),ge(7,dO,5,2,"a",6),S()()),t&2&&(Et("height",i.state.mainMenuHeight(),"px"),I(3),K("routerLink",yt(5,qy)),I(2),K("routerLink",yt(6,qy)),I(2),he(i.api.workspaceId()&&i.api.api_key()&&i.api.workspace().source?7:-1));},dependencies:[Ks,rn],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.menu[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  background-color: #FBF5F6;
  align-items: stretch;
  padding: none;
  padding-bottom: 8px;
}
.menu[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  gap: 4px;
  padding: 0 24px;
  position: relative;
  top: -8px;
}
.menu[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  display: flex;
  width: 100%;
  height: 52px;
  padding: 0px 8px;
  justify-content: center;
  align-items: center;
  gap: 4px;
  border-radius: 16px;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  text-decoration: none;
}
.menu[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   a.primary[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}`]});};var uO=()=>["/"],pO=()=>["/canvas-creator"],fO=()=>["/scan"],gO=()=>({"item-id":null,key:null});function mO(n,e){if(n&1&&(P(0,"a",16),ke(),P(1,"svg",19),te(2,"path",20)(3,"path",21),S(),Ye(),P(4,"span"),be(5,1),S()()),n&2){let t=j(2);K("href",t.api.workspace().whatsapp_group,Ue);}}function _O(n,e){n&1&&(P(0,"div",23),be(1,3),S()),n&2&&K("routerLink",yt(1,pO));}function vO(n,e){if(n&1){let t=ve();P(0,"div",22),Z("click",function(){X(t);let r=j(2);return q(r.inputAnswer.next("yes"));}),be(1,2),S(),ge(2,_O,2,2,"div",23);}if(n&2){let t=j(2);I(2),he(t.api.showNoPaperOption()?2:-1);}}function yO(n,e){if(n&1){let t=ve();P(0,"div",24),Z("click",function(){X(t);let r=j(2);return q(r.inputAnswer.next("more"));}),be(1,4),S();}}function CO(n,e){n&1&&(P(0,"div",18),be(1,5),S()),n&2&&K("routerLink",yt(2,fO))("queryParams",yt(3,gO));}function bO(n,e){if(n&1&&(P(0,"div",13),ge(1,mO,6,1,"a",16)(2,vO,3,1)(3,yO,2,0,"div",17)(4,CO,2,4,"div",18),S()),n&2){let t=j();I(),he(t.showWhatsappButton()?1:-1),I(),he(t.showScanButton()?2:-1),I(),he(t.showMoreButton()?3:-1),I(),he(t.showAgreeButton()?4:-1);}}function xO(n,e){if(n&1){let t=ve();P(0,"div",25),Z("click",function(){X(t);let r=j();return q(r.mainMenuOpen.set(!1));}),S();}}var Ch=class n{constructor(e,t,i,r,o){this.route=e;this.api=t;this.platform=i;this.router=r;this.ref=o;this.api.updateFromRoute(this.route.snapshot),at(()=>{let s=this.api.workspace();s&&s.source&&this.initialInteraction.length===0&&this.uiInitialized()&&(this.initialInteraction=[new _n("ai","Hi"),this.api.workspace().whatsapp_group?new _n("ai","**Eerst, sluit je aan bij de chatgroep** die we hebben opgezet voor :EVENT_NAME:."):new _n("ai","Fijn dat je **:EVENT_NAME:** bezoekt!"),new _n("ai","Ik ga je helpen je schermafbeelding te **scannen** en toe te voegen aan de Futures Map.")],this.interact());});}messagesComponent;initialInteraction=[];answer=new _n("human","Ja, ik wil scannen!");tellMore=new _n("ai","Vind onze stand in de lobby tegenover de ingang. Daar vind je sjablonen en begeleiding.");secondInteraction=new _n("ai","Mooi!\n\nMaar eerst vraag ik je om akkoord te gaan met de gebruiksvoorwaarden zoals beschreven in het [Privacybeleid](/nl/privacy-policy).\n\nEn ik ga je ook vragen om **toegang tot je camera**. Dan kunnen we beginnen.");inputAnswer=new En();showMoreButton=G(!1);showScanButton=G(!1);showAgreeButton=G(!1);showWhatsappButton=G(!1);topMenuOpen=G(!0);mainMenuOpen=G(!1);uiInitialized=G(!1);addMessage(e){e.setText(e.text.replace(/:EVENT_NAME:/g,this.api.workspace()?.event_name||"De workshop")),this.messagesComponent.addMessage(e);}ngOnInit(){this.messagesComponent?.clear(),this.showMoreButton.set(!1),this.showScanButton.set(!1),this.showAgreeButton.set(!1);}ngAfterViewInit(){this.platform.browser(()=>{this.uiInitialized.set(!0),this.messagesComponent.scrollPosition.pipe(Bt(this.ref),Jt(e=>e<10)).subscribe(e=>{this.topMenuOpen.set(e);});});}interact(){console.log("[Prescan] interact() called, adding messages to queue...");for(let e=0;e<this.initialInteraction.length;e++){for(let t=0;t<this.initialInteraction.length;t++)this.initialInteraction[t].part=t!==e;this.addMessage(this.initialInteraction[e]);}jn(3e3).subscribe(()=>{this.showWhatsappButton.set(this.api.isWorkshop()&&this.api.workspace()?.whatsapp_group),this.showScanButton.set(!0);}),this.inputAnswer.pipe(st(e=>{e==="more"&&(this.addMessage(this.tellMore),this.showMoreButton.set(!1));}),Vt(e=>e==="yes"),st(()=>{this.addMessage(this.answer),this.showScanButton.set(!1),this.showMoreButton.set(!1);}),Nt(300),st(()=>{this.addMessage(this.secondInteraction),this.showAgreeButton.set(!0);})).subscribe(()=>{this.showAgreeButton.set(!1),this.router.navigate(["scan"],{queryParamsHandling:"preserve"}),console.log("DONE");});}static fac=function(t){return new(t||n)(ue(Ct),ue(rt),ue(it),ue(gt),ue(ii));};static cmp=Me({type:n,selectors:[["app-home"]],viewQuery:function(t,i){if(t&1&&Pt(Ci,5),t&2){let r;wt(r=Mt())&&(i.messagesComponent=r.first);}},decls:13,vars:10,consts:()=>{let e;e="Word lid van de WhatsApp-groep";let t;t="Ja, ik wil scannen!";let i;i="I have no paper";let r;r="Hoe maak ik er een?";let o;return o="Ja, ik ga akkoord",[["messages",""],e,t,i,r,o,[1,"sticky-menu"],[1,"header"],["queryParamsHandling","preserve",3,"routerLink"],[1,"back"],[1,"logo"],[1,"open-menu",3,"click"],[3,"scrollOnAI","paddingTop"],["ltr","",1,"buttons"],[1,"menu-overlay"],[1,"menu"],["target","_blank",1,"button",3,"href"],[1,"button"],["queryParamsHandling","merge",1,"button","primary",3,"routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M22.375 12.0195C22.375 17.5425 17.898 22.0195 12.375 22.0195C10.6195 22.022 8.89463 21.5604 7.375 20.6815L2.375 21.5195L3.207 16.0195C2.65735 14.7577 2.3741 13.3959 2.375 12.0195C2.375 6.49653 6.852 2.01953 12.375 2.01953C17.898 2.01953 22.375 6.49653 22.375 12.0195Z","stroke","#4E02B2","stroke-width","1.5","stroke-linecap","round"],["d","M13.335 13.8875L15.415 13.4815L17.375 14.2345V16.0575C17.375 16.6645 16.853 17.1275 16.265 16.9975C14.742 16.6635 11.975 15.8235 10.053 13.8875C8.223 12.0445 7.598 9.47753 7.385 8.06053C7.3 7.49353 7.749 7.01953 8.318 7.01953H10.212L10.947 8.98853L10.558 11.0895","stroke","#4E02B2","stroke-width","1.5","stroke-linecap","round"],[1,"button","primary",3,"click"],["queryParamsHandling","merge",1,"button",3,"routerLink"],[1,"button",3,"click"],[1,"menu-overlay",3,"click"]];},template:function(t,i){if(t&1){let r=ve();P(0,"div",6)(1,"div",7)(2,"a",8),te(3,"div",9)(4,"div",10),S(),P(5,"div",11),Z("click",function(){return X(r),q(i.mainMenuOpen.set(!0));}),S()(),te(6,"app-language-selector"),S(),te(7,"app-messages",12,0),ge(9,bO,5,4,"div",13)(10,xO,1,0,"div",14),P(11,"div",15),te(12,"app-main-menu"),S();}t&2&&(Se("visible",i.topMenuOpen()),I(2),K("routerLink",yt(9,uO)),I(5),K("scrollOnAI",!1)("paddingTop",124),I(2),he(i.showScanButton()||i.showMoreButton()||i.showAgreeButton()?9:-1),I(),he(i.mainMenuOpen()?10:-1),I(),Se("open",i.mainMenuOpen()));},dependencies:[rn,Ci,li,Js,Ks],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
[_nghost-%COMP%] {
  display: flex;
  width: 100%;
  height: 100%;
  position: relative;
  flex-flow: column;
}
[_nghost-%COMP%]   .sticky-menu[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  z-index: 1000;
  width: 100%;
  height: 124px;
  display: flex;
  flex-flow: column;
  align-items: stretch;
  gap: 8px;
  padding: 0 16px;
  transition: transform 0.3s ease-in-out;
  transform: translateY(-100%);
  background-color: #FFFDF6;
}
[_nghost-%COMP%]   .sticky-menu.visible[_ngcontent-%COMP%] {
  transform: translateY(0);
}
[_nghost-%COMP%]   .sticky-menu[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  height: 52px;
  gap: 8px;
}
[_nghost-%COMP%]   .sticky-menu[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  gap: 8px;
}
[_nghost-%COMP%]   .sticky-menu[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%] {
  width: 24px;
  height: 24px;
  background-image: url("./media/icon-back-FAO6AZBV.svg");
}
[_nghost-%COMP%]   .sticky-menu[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%] {
  width: 132px;
  height: 10px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  background-image: url("./media/logo-futures-VIS6UZMX.svg");
}
[_nghost-%COMP%]   .sticky-menu[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .open-menu[_ngcontent-%COMP%] {
  margin-inline-start: auto;
  width: 36px;
  height: 36px;
  background-image: url("./media/icon-caret-down-2AWNRY6E.svg");
}
[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%] {
  position: absolute;
  bottom: 0;
  padding: 8px 24px;
  animation: _ngcontent-%COMP%_slideInUp 0.3s ease-in-out;
}
[_nghost-%COMP%]   .menu-overlay[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0);
  z-index: 1000;
  -webkit-backdrop-filter: blur(4px);
  backdrop-filter: blur(4px);
}
[_nghost-%COMP%]   .menu[_ngcontent-%COMP%] {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: fit-content;
  transition: transform 0.3s ease-in-out;
  transform: translateY(105%);
  z-index: 1001;
}
[_nghost-%COMP%]   .menu.open[_ngcontent-%COMP%] {
  transform: translateY(0);
}`]});};function PO(n,e){n&1&&te(0,"div",1);}function wO(n,e){n&1&&te(0,"div",3);}function MO(n,e){n&1&&te(0,"div",4);}var Qs=class n{constructor(e,t){this.api=e;this.state=t;}hasEvaluation=_e(()=>{let e=this.api.item(),t=e?.plausibility,i=e?.favorable_future;return typeof t=="number"&&i!==void 0&&i!==null&&i!=="";});prefer=_e(()=>{let e=this.api.item()?.favorable_future||"";return e.indexOf("prefer")>=0||e.indexOf("prevent")>=0&&e.indexOf("mostly")>=0;});prevent=_e(()=>{let e=this.api.item()?.favorable_future||"";return e.indexOf("prevent")>=0||e.indexOf("prefer")>=0&&e.indexOf("mostly")>=0;});preferred=_e(()=>(this.api.item()?.favorable_future||"").indexOf("prefer")>=0);rotate=_e(()=>{if(!this.hasEvaluation())return 0;let e=this.preferred()?-1:1;return(100-(this.api.item()?.plausibility||0))/100*32*e;});imageUrl=_e(()=>{let e=this.api.item();return this.state.currentImageUrl()||e?.screenshot_url||null;});static fac=function(t){return new(t||n)(ue(rt),ue(Ot));};static cmp=Me({type:n,selectors:[["app-completion-image"]],decls:5,vars:12,consts:[[1,"container"],[1,"line"],["alt","Confirmation Image",3,"src"],[1,"prefer"],[1,"prevent"]],template:function(t,i){t&1&&(P(0,"div",0),ge(1,PO,1,0,"div",1),te(2,"img",2),ge(3,wO,1,0,"div",3)(4,MO,1,0,"div",4),S()),t&2&&(Et("transform","rotate("+i.rotate()+"deg)"),Se("prefer",!!i.prefer())("prevent",!!i.prevent())("preferred",i.preferred()),I(),he(i.hasEvaluation()?1:-1),I(),K("src",i.imageUrl(),Ue),I(),he(i.prefer()?3:-1),I(),he(i.prevent()?4:-1));},styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  align-items: center;
  position: relative;
  padding-top: 0;
  padding-left: 32px;
  padding-right: 32px;
  padding-bottom: 80px;
  transform-origin: center;
}
.container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 50%;
  max-width: 520px;
  position: relative;
  z-index: 1;
}
.container[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: -100%;
  width: 400%;
  height: 2px;
  border-top: 4px solid;
  border-top-color: #F73C3C;
}
.container.preferred[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] {
  border-top-color: #698CFF;
}
.container[_ngcontent-%COMP%]   .prefer[_ngcontent-%COMP%], 
.container[_ngcontent-%COMP%]   .prevent[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  width: 40px;
  height: 106px;
  position: absolute;
  z-index: 2;
}
.container[_ngcontent-%COMP%]   .prefer[_ngcontent-%COMP%] {
  background-image: url("./media/img-pin-prefer-v-6BJXLG6S.svg");
  top: -40px;
  left: 26%;
  transform: rotate(-13deg) scale(1);
}
.container[_ngcontent-%COMP%]   .prevent[_ngcontent-%COMP%] {
  background-image: url("./media/img-pin-prevent-v-A4RVBFLH.svg");
  top: -40px;
  left: 59%;
  transform: rotate(16deg) scale(1);
}`]});};var Ky=()=>({"item-id":null,key:null,template_id:null});function SO(n,e){if(n&1){let t=ve();P(0,"div",8)(1,"a",9),ke(),P(2,"svg",10),te(3,"path",11),S(),Ye(),P(4,"span"),be(5,0),S()(),P(6,"a",12),Z("click",function(r){X(t);let o=j();return q(o.onShowOnMap(r));}),ke(),P(7,"svg",13),te(8,"path",14),S(),Ye(),P(9,"span"),be(10,1),S()()(),P(11,"a",15),Z("click",function(){X(t);let r=j();return q(r.downloadImage());}),ke(),P(12,"svg",13),te(13,"path",16),S(),Ye(),P(14,"span"),be(15,2),S()(),P(16,"a",15),Z("click",function(){X(t);let r=j();return q(r.shareImage());}),ke(),P(17,"svg",17),te(18,"path",18),S(),Ye(),P(19,"span"),be(20,3),S()();}if(n&2){let t=j();I(),K("routerLink",t.addAnotherRoute())("queryParams",yt(3,Ky)),I(5),K("href",t.showOnMapLink(),Ue);}}function EO(n,e){if(n&1){let t=ve();P(0,"div",8)(1,"a",9),ke(),P(2,"svg",10),te(3,"path",11),S(),Ye(),P(4,"span"),be(5,4),S()()(),P(6,"div",8)(7,"a",15),Z("click",function(){X(t);let r=j();return q(r.downloadImage());}),ke(),P(8,"svg",19)(9,"g",20),te(10,"path",21)(11,"path",22),S(),P(12,"defs")(13,"clipPath",23),te(14,"rect",24),S()()(),Ye(),P(15,"span"),be(16,5),S()()();}if(n&2){let t=j();I(),K("routerLink",t.addAnotherRoute())("queryParams",yt(2,Ky));}}var ea=class n{constructor(e,t,i){this.api=e;this.http=t;this.route=i;}thinking=nn(!1);addAnotherRoute=_e(()=>{let e=this.route.snapshot.queryParamMap.get("template")==="true",t=this.api.item()?.tags,i=Array.isArray(t)&&t.includes("no-paper");return e||i?["/canvas-creator"]:["/scan"];});showOnMapLink=_e(()=>{let e=this.api.workspaceId(),t=this.api.itemId(),i=this.api.api_key(),r=this.api.locale;return!e||!t||!i?"/":`${r==="en"?"":`/${r}`}/showcase-ws?workspace=${e}&api_key=${i}#${t}`;});onShowOnMap(e){console.log("[COMPLETE_EVAL] onShowOnMap called");let t=this.showOnMapLink(),i=typeof window<"u"&&window.self!==window.top;if(console.log("[COMPLETE_EVAL] isFramed:",i,"url:",t),i&&window.parent){console.log("[COMPLETE_EVAL] Posting show-on-map message to parent window"),e.preventDefault(),window.parent.postMessage({type:"show-on-map",itemId:this.api.itemId(),workspaceId:this.api.workspaceId(),apiKey:this.api.api_key(),source:"sidebar-iframe"},"*"),console.log("[COMPLETE_EVAL] Message posted");return;}console.log("[COMPLETE_EVAL] Not in frame, navigating to:",t),typeof window<"u"&&window.top?window.top.location.href=t:window.location.href=t;}downloadImage(){let e=this.api.item(),t=e.screenshot_url;if(!t){console.log("No screenshot URL available",e);return;}this.http.get(t,{responseType:"blob"}).pipe($n(i=>{let r=[new File([i],"my-screenshot.png",{type:i.type})];return navigator&&navigator.canShare&&navigator.canShare({files:r})?Ua(navigator.share({files:r})).pipe(Jt(()=>({native:!0,url:""}))):Ua(new Promise(o=>{let s=new FileReader();s.onload=()=>o(s.result),s.readAsDataURL(i);})).pipe(Jt(o=>({native:!1,url:o})));})).subscribe(({native:i,url:r})=>{if(!i){var o=document.createElement("a");o.download="my-screenshot.png",o.href=r,o.click();}});}shareImage(){let e=this.api.workspaceId(),t=this.api.itemId(),i=this.api.item();if(!e||!t){console.error("Workspace ID or Item ID is missing");return;}let r=`https://mapfutur.es/props?workspace=${e}&item-id=${t}`,o={title:"Onze toekomst?",text:i.future_scenario_tagline||"Bekijk deze afbeelding!",url:r};navigator.share(o);}static fac=function(t){return new(t||n)(ue(rt),ue(Ui),ue(Ct));};static cmp=Me({type:n,selectors:[["app-complete-evaluation"]],inputs:{thinking:[1,"thinking"]},decls:5,vars:3,consts:()=>{let e;e="Voeg er nog een toe";let t;t="Show on map";let i;i="Afbeelding downloaden";let r;r="Delen";let o;o="Voeg er nog een toe";let s;return s="Delen",[e,t,i,r,o,s,[1,"container"],["ltr","",1,"buttons"],[1,"button-row"],["queryParamsHandling","merge",1,"button","primary",3,"routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","width","24","height","25","viewBox","0 0 24 25","fill","none"],["fill-rule","evenodd","clip-rule","evenodd","d","M12.7461 19.58L12.75 19.5038V13.26H18.9932L19.0693 13.2561C19.4477 13.2179 19.7432 12.8985 19.7432 12.51C19.7432 12.1216 19.4477 11.8021 19.0693 11.7639L18.9932 11.76H12.75V5.51648C12.75 5.10227 12.4142 4.76648 12 4.76648C11.5858 4.76648 11.25 5.10227 11.25 5.51648V11.76H5.00586C4.59165 11.76 4.25586 12.0958 4.25586 12.51C4.25586 12.9242 4.59165 13.26 5.00586 13.26H11.25V19.5038L11.2539 19.58C11.2921 19.9583 11.6115 20.2538 12 20.2538C12.3885 20.2538 12.7079 19.9583 12.7461 19.58Z","fill","#ffffff"],[1,"button",3,"click","href"],["xmlns","http://www.w3.org/2000/svg","width","25","height","24","viewBox","0 0 25 24","fill","none"],["d","M16.25 6.99872V16.4987M9.25 16.9987V8.49872M4.271 6.71472L8.824 4.23171C8.95671 4.15924 9.10414 4.11781 9.25517 4.11053C9.40621 4.10326 9.55693 4.13033 9.696 4.18972L15.804 6.80772C15.9431 6.8671 16.0938 6.89417 16.2448 6.8869C16.3959 6.87962 16.5433 6.83819 16.676 6.76572L20.271 4.80572C20.4233 4.7226 20.5946 4.68055 20.7681 4.68369C20.9416 4.68684 21.1113 4.73506 21.2605 4.82364C21.4097 4.91221 21.5333 5.03808 21.6191 5.18887C21.7049 5.33967 21.75 5.5102 21.75 5.68372V16.4047C21.75 16.5844 21.7017 16.7607 21.61 16.9152C21.5183 17.0697 21.3867 17.1967 21.229 17.2827L16.676 19.7657C16.5433 19.8382 16.3959 19.8796 16.2448 19.8869C16.0938 19.8942 15.9431 19.8671 15.804 19.8077L9.696 17.1887C9.55693 17.1293 9.40621 17.1023 9.25517 17.1095C9.10414 17.1168 8.95671 17.1582 8.824 17.2307L5.229 19.1907C5.07676 19.2738 4.90554 19.3158 4.73214 19.3127C4.55874 19.3096 4.38913 19.2615 4.23996 19.1731C4.09079 19.0846 3.96718 18.9589 3.88128 18.8082C3.79538 18.6575 3.75014 18.4871 3.75 18.3137V7.59371C3.74997 7.41406 3.79833 7.23772 3.89001 7.08322C3.98169 6.92872 4.1133 6.80077 4.271 6.71472Z","stroke","#4E02B2","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"button",3,"click"],["d","M12.25 5V13.5M12.25 13.5L15.25 10.5M12.25 13.5L9.25 10.5M5.25 15V17C5.25 17.5304 5.46071 18.0391 5.83579 18.4142C6.21086 18.7893 6.71957 19 7.25 19H17.25C17.7804 19 18.2891 18.7893 18.6642 18.4142C19.0393 18.0391 19.25 17.5304 19.25 17V15","stroke","#4E02B2","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["xmlns","http://www.w3.org/2000/svg","width","25","height","25","viewBox","0 0 25 25","fill","none"],["d","M12.25 5.5V14M15.25 7.5L12.25 4.5L9.25 7.5M5.25 12.5V17.5C5.25 18.0304 5.46071 18.5391 5.83579 18.9142C6.21086 19.2893 6.71957 19.5 7.25 19.5H17.25C17.7804 19.5 18.2891 19.2893 18.6642 18.9142C19.0393 18.5391 19.25 18.0304 19.25 17.5V12.5","stroke","#4E02B2","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["width","25","height","24","viewBox","0 0 25 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0_1892_11452)"],["d","M12.25 11.8477V20.3477M15.25 13.8477L12.25 10.8477L9.25 13.8477","stroke","#4E02B2","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M8.63647 18.7721L4.9375 18.7188C4.38522 18.7188 3.9375 18.271 3.9375 17.7188V11.7187C3.9375 8.40504 6.62379 5.71875 9.9375 5.71875C9.9375 5.71875 11.8003 5.71875 13.9374 5.71875C17.2511 5.71875 19.9375 8.40504 19.9375 11.7188V12.7188C19.9375 15.4316 18.137 17.724 15.6659 18.4661","stroke","#4E02B2","stroke-width","2","stroke-linecap","round"],["id","clip0_1892_11452"],["width","24","height","24","fill","white","transform","translate(0.25)"]];},template:function(t,i){t&1&&(P(0,"div",6),te(1,"app-completion-image"),P(2,"div",7),ge(3,SO,21,4)(4,EO,17,3),S()()),t&2&&(I(2),Se("hide",i.thinking()),I(),he(i.api.isWorkshop()?4:3));},dependencies:[rn,Qs],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: flex-end;
  height: 100%;
  width: 100%;
  position: relative;
}
.container[_ngcontent-%COMP%]   app-completion-image[_ngcontent-%COMP%] {
  position: absolute;
  top: 32px;
  left: 0;
  width: 100%;
  height: 100%;
}
.container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] {
  padding: 12px 16px;
  width: 100%;
  max-width: 520px;
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1;
  background-color: #FFFDF6;
  border-top: 1px solid #EDECEC;
  display: flex;
  flex-flow: column;
  gap: 8px;
  transition: transform 0.3s ease-in-out;
}
.container[_ngcontent-%COMP%]   .buttons.hide[_ngcontent-%COMP%] {
  transform: translateX(-50%) translateY(100%);
}`]});};var OO=["image"];function TO(n,e){if(n&1){let t=ve();P(0,"button",23),Z("click",function(r){X(t);let o=j();return r.stopPropagation(),q(o.toggleImage());}),N(1," X "),S();}}function kO(n,e){n&1&&te(0,"div",7);}function IO(n,e){n&1&&te(0,"div",9);}function AO(n,e){n&1&&te(0,"div",10);}function FO(n,e){if(n&1&&(P(0,"div",13)(1,"div",24),N(2),S()()),n&2){let t=j();I(2),Ve(t.reply());}}function RO(n,e){n&1&&(P(0,"div",13)(1,"div",24),N(2,"Something went wrong... please refresh the page or try again in a few minutes."),S()());}function LO(n,e){if(n&1&&te(0,"app-complete-evaluation",14),n&2){let t=j();K("thinking",t.completionThinking());}}var xh=class n{constructor(e,t,i,r,o,s,l){this.state=e;this.router=t;this.api=i;this.route=r;this.platform=o;this.sanitizer=s;this.http=l;this.api.updateFromRoute(this.route.snapshot),this.item_id.set(this.route.snapshot.queryParams["item-id"]),at(()=>{this.completed()&&this.refreshItem();}),at(()=>{let c=this.receivedDone(),d=this.thinking(),u=this.messagesComponent?.thinking(),g=this.typingComplete();console.log("[COMPLETION CHECK]",{receivedDone:c,thinking:d,messagesThinking:u,typingComplete:g,completed:this.completed()}),c&&!d&&!u&&g&&!this.reply()&&!this.completed()&&(console.log("[COMPLETION] Setting completed to true"),this.completed.set(!0));}),at(()=>{let c=this.showCompletionButtons();console.log("[BUTTONS] showCompletionButtons:",c,{completed:this.completed(),completionThinking:this.completionThinking(),typingComplete:this.typingComplete()});});}messages;inputMessage=G("");reply=G("");item_id=G("");item_key=G("");item=G({});hasEvaluation=_e(()=>{let e=this.item(),t=e?.plausibility,i=e?.favorable_future;return typeof t=="number"&&i!==void 0&&i!==null&&i!=="";});needsEvaluation=_e(()=>!this.hasEvaluation());prefer=_e(()=>{let e=this.item()?.favorable_future||"";return e.indexOf("prefer")>=0||e.indexOf("prevent")>=0&&e.indexOf("mostly")>=0;});prevent=_e(()=>{let e=this.item()?.favorable_future||"";return e.indexOf("prevent")>=0||e.indexOf("prefer")>=0&&e.indexOf("mostly")>=0;});preferred=_e(()=>(this.item()?.favorable_future||"").indexOf("prefer")>=0);rotationClass=_e(()=>{if(!this.hasEvaluation())return"tilt-0";let t=(100-(this.item()?.plausibility??0))/100*32,i=Math.min(32,Math.max(0,Math.round(t/8)*8));return i===0?"tilt-0":`${this.preferred()?"tilt-neg":"tilt-pos"}-${i}`;});imageUrl=_e(()=>this.sanitizer.bypassSecurityTrustUrl(this.item().screenshot_url));thinking=G(!0);inputDisabled=_e(()=>this.thinking()||(this.messagesComponent?.thinking()??!1)||this.completed());imageLoaded=G(!1);hasText=G(!1);messagesComponentReady=G(!1);showChat=_e(()=>this.imageLoaded()||this.hasText()||this.thinking());imageExpanded=G(!1);imageCollapsed=_e(()=>(this.hasText()||this.completed())&&!this.imageExpanded());receivedDone=G(!1);completed=G(!1);completionThinking=_e(()=>(this.messagesComponent?this.messagesComponent.thinking():!1)||this.thinking());typingComplete=_e(()=>{if(!this.messagesComponentReady())return!1;let e=this.messagesComponent?this.messagesComponent.allTypingComplete():!1;return console.log("[TYPING-COMPUTED] typingComplete evaluated:",e),e;});inputVisible=_e(()=>this.showChat()&&!this.completed());showCompletionButtons=_e(()=>this.completed()&&!this.completionThinking()&&this.typingComplete());failed=G(!1);messagesComponent;imageEl;ngAfterViewInit(){this.messages=this.messagesComponent.messages,this.messagesComponentReady.set(!0);let e=this.item_id();if(e){this.item_key.set(this.route.snapshot.queryParams.key);let t=this.item_key();this.api.fetchItem(e,t).subscribe(i=>{i&&this.platform.browser()&&(this.submitMessage(),Hr(this.imageEl.nativeElement,"load").pipe(Xt(1)).subscribe(()=>{this.imageLoaded.set(!0);}),this.item.set(i));});}else this.router.navigate(["/"],{queryParamsHandling:"preserve"});}refreshItem(){this.api.fetchItem(this.item_id(),this.item_key()).subscribe(e=>{e&&this.item.set(e);});}toggleImage(){this.imageExpanded.update(e=>!e);}addMessage(e,t){let i=new _n(e,t);this.messagesComponent.addMessage(i);}submitMessage(){this.thinking.set(!0),this.messagesComponent.thinking.set(!0),console.log("thinking...");let e=this.inputMessage();e&&this.addMessage("human",e),this.inputMessage.set(""),this.api.sendMessage(e||"initial").subscribe(t=>{if(console.log("[SERVER RET] kind=",t?.kind,"payload=",t),console.log("[DISCUSS STATE]",{thinking:this.thinking(),messagesThinking:this.messagesComponent?.thinking()??!1,typingComplete:this.typingComplete(),reply:this.reply(),replyLength:(this.reply()||"").length,receivedDone:this.receivedDone(),completed:this.completed(),inputVisible:this.inputVisible(),inputDisabled:this.inputDisabled(),showCompletionButtons:this.showCompletionButtons()}),t.kind==="message"){this.hasText.set(!0);let i=t.idx,r=t.content,o=t.role==="assistant"?"ai":"human";this.messages().length>i?this.messages.update(l=>{let c=l.slice();return c[i].setText(r),c[i].kind=o,c;}):(this.reply.set(""),this.addMessage(o,r));}else t.kind==="status"&&t.status==="done"?this.receivedDone.set(!0):t.kind==="status"&&t.status==="stream-error"?(console.warn("[SERVER RET] Stream error received, treating as recoverable",t),this.thinking.set(!1),this.messagesComponent.thinking.set(!1)):t.kind==="status"&&t.status==="failed"?this.failed.set(!0):t.kind==="status"&&t.status==="failed"?this.failed.set(!0):t.kind==="text"?(this.hasText.set(!0),this.reply.update(i=>(i+=t.value,i.slice(0,10).indexOf("DONE")>=0?(this.completed.set(!0),""):(this.messages.update(r=>r.slice()),i))),console.log("thinking done..."),this.thinking.set(!1),this.messagesComponent.thinking.set(!1)):t.kind==="status"&&t.status&&t.status!=="done"&&t.status!=="failed"&&(this.thinking.set(!1),this.messagesComponent.thinking.set(!1),this.failed.set(!1),this.reply()&&(this.addMessage("ai",this.reply()),this.reply.set("")));});}static fac=function(t){return new(t||n)(ue(Ot),ue(gt),ue(rt),ue(Ct),ue(it),ue(F0),ue(Ui));};static cmp=Me({type:n,selectors:[["ng-component"]],viewQuery:function(t,i){if(t&1&&(Pt(Ci,5),Pt(OO,5)),t&2){let r;wt(r=Mt())&&(i.messagesComponent=r.first),wt(r=Mt())&&(i.imageEl=r.first);}},decls:25,vars:28,consts:()=>{let e;return e="In je eigen woorden...",[["image",""],["messagesComponent",""],[1,"flow-shell"],[1,"image-overlay"],[1,"backdrop",3,"click"],["type","button","aria-label","Close image view",1,"image-close"],[1,"image",3,"click","ngClass"],[1,"string"],[3,"src"],[1,"pin","prefer"],[1,"pin","prevent"],[1,"discuss"],[3,"bg"],["ltr","",1,"message","ai"],[1,"spacer",3,"thinking"],["ltr","",1,"input"],["rows","1","placeholder",e,1,"input-el",3,"ngModelChange","keyup.enter","ngModel","disabled"],["width","40","height","40","viewBox","0 0 41 41","fill","none","xmlns","http://www.w3.org/2000/svg",1,"submit",3,"click"],["x","0.75","y","0.5","width","40","height","40","rx","20"],["clip-path","url(#clip0_1016_4900)"],["d","M20.75 28.5V12.5M20.75 12.5L26.75 18.5M20.75 12.5L14.75 18.5","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["id","clip0_1016_4900"],["width","24","height","24","fill","white","transform","translate(8.75 8.5)"],["type","button","aria-label","Close image view",1,"image-close",3,"click"],[1,"message-text"]];},template:function(t,i){if(t&1){let r=ve();P(0,"div",2)(1,"div",3)(2,"div",4),Z("click",function(){return X(r),q(i.toggleImage());}),S(),ge(3,TO,2,0,"button",5),P(4,"div",6),Z("click",function(){return X(r),q(i.toggleImage());}),ge(5,kO,1,0,"div",7),te(6,"img",8,0),ge(8,IO,1,0,"div",9)(9,AO,1,0,"div",10),S()(),P(10,"div",11)(11,"app-messages",12,1),ge(13,FO,3,1,"div",13)(14,RO,3,0,"div",13)(15,LO,1,1,"app-complete-evaluation",14),S(),P(16,"div",15)(17,"textarea",16),tt("ngModelChange",function(s){return X(r),et(i.inputMessage,s)||(i.inputMessage=s),q(s);}),Z("keyup.enter",function(){return X(r),q(i.submitMessage());}),S(),ke(),P(18,"svg",17),Z("click",function(){return X(r),q(i.submitMessage());}),te(19,"rect",18),P(20,"g",19),te(21,"path",20),S(),P(22,"defs")(23,"clipPath",21),te(24,"rect",22),S()()()()()();}t&2&&(I(),Se("collapsed",i.imageCollapsed())("expanded",i.imageExpanded()),I(2),he(i.imageExpanded()?3:-1),I(),Se("small",i.imageCollapsed())("completed",i.completed()),K("ngClass",i.rotationClass()),I(),he(i.needsEvaluation()?5:-1),I(),K("src",i.imageUrl(),Ue),I(2),he(!i.completed()&&i.prefer()?8:-1),I(),he(!i.completed()&&i.prevent()?9:-1),I(),Se("visible",i.showChat())("completed",i.completed()),I(),K("bg",!i.completed()),I(2),he(!i.thinking()&&i.reply()?13:-1),I(),he(i.failed()?14:-1),I(),he(i.showCompletionButtons()?15:-1),I(),Se("visible",i.inputVisible()),I(),Qe("ngModel",i.inputMessage),K("disabled",i.inputDisabled()),I(),Se("disabled",i.inputDisabled()));},dependencies:[O0,on,Hi,On,Tn,Ci,li,ea],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
[_nghost-%COMP%] {
  width: 100%;
  height: 100%;
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  position: relative;
}
.flow-shell[_ngcontent-%COMP%] {
  position: relative;
  width: 100%;
  max-width: 520px;
  height: 100%;
  max-height: 900px;
  display: flex;
  flex-direction: column;
  justify-content: stretch;
}
@media (min-width: 900px) {
  .flow-shell[_ngcontent-%COMP%] {
    height: 90vh;
  }
}
.image-overlay[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 2;
  pointer-events: none;
}
.image-overlay[_ngcontent-%COMP%]   .backdrop[_ngcontent-%COMP%] {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0);
  opacity: 0;
  transition: opacity 0.2s ease-in-out, background 0.2s ease-in-out;
  pointer-events: none;
}
.image-overlay[_ngcontent-%COMP%]   .image-close[_ngcontent-%COMP%] {
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 4;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.9);
  color: #4E02B2;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
}
.image-overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%] {
  position: absolute;
  bottom: 50%;
  left: 50%;
  width: 60%;
  aspect-ratio: 53 / 100;
  transition: all 0.35s ease-in-out;
  transition-property:
    transform,
    bottom,
    left,
    width,
    opacity,
    z-index;
  --tilt: 0deg;
  transform: translate(-50%, 50%) rotate(var(--tilt, 0deg));
  opacity: 1;
  cursor: pointer;
  z-index: 3;
  pointer-events: all;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-0[_ngcontent-%COMP%] {
  --tilt: 0deg;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-pos-8[_ngcontent-%COMP%] {
  --tilt: 8deg;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-pos-16[_ngcontent-%COMP%] {
  --tilt: 16deg;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-pos-24[_ngcontent-%COMP%] {
  --tilt: 24deg;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-pos-32[_ngcontent-%COMP%] {
  --tilt: 32deg;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-neg-8[_ngcontent-%COMP%] {
  --tilt: -8deg;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-neg-16[_ngcontent-%COMP%] {
  --tilt: -16deg;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-neg-24[_ngcontent-%COMP%] {
  --tilt: -24deg;
}
.image-overlay[_ngcontent-%COMP%]   .image.tilt-neg-32[_ngcontent-%COMP%] {
  --tilt: -32deg;
}
.image-overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .string[_ngcontent-%COMP%] {
  position: absolute;
  top: -14px;
  left: -12%;
  width: 124%;
  height: 3px;
  background:
    linear-gradient(
      90deg,
      rgba(0, 0, 0, 0.05) 0%,
      rgba(0, 0, 0, 0.2) 50%,
      rgba(0, 0, 0, 0.05) 100%);
  border-radius: 4px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
  z-index: 0;
}
.image-overlay[_ngcontent-%COMP%]   .image.small[_ngcontent-%COMP%] {
  transform: translate(0, 0) scale(0.55) rotate(var(--tilt, 0deg));
  width: 26%;
  bottom: 12px;
  left: 0;
  pointer-events: all;
  z-index: 0;
}
.image-overlay[_ngcontent-%COMP%]   .image.small[_ngcontent-%COMP%]   .string[_ngcontent-%COMP%] {
  top: -8px;
  left: -20%;
  width: 140%;
}
.image-overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  object-fit: contain;
  position: relative;
  z-index: 1;
  border-radius: 12px;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.18);
}
.image-overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .pin[_ngcontent-%COMP%] {
  position: absolute;
  z-index: 2;
  background-size: cover;
  background-repeat: no-repeat;
  transform-origin: center;
}
.image-overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .pin.prefer[_ngcontent-%COMP%] {
  background-image: url("./media/img-pin-prefer-v-6BJXLG6S.svg");
  width: 40px;
  height: 106px;
  top: -40px;
  left: 26%;
  transform: rotate(-13deg) scale(1.5);
}
.image-overlay[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .pin.prevent[_ngcontent-%COMP%] {
  background-image: url("./media/img-pin-prevent-v-A4RVBFLH.svg");
  width: 30px;
  height: 106px;
  top: -56px;
  left: 80%;
  transform: rotate(16deg) scale(1.5);
}
.image-overlay[_ngcontent-%COMP%]   .image.small[_ngcontent-%COMP%]   .pin.prefer[_ngcontent-%COMP%] {
  width: 22px;
  height: 58px;
  top: -24px;
  left: 22%;
  transform: rotate(-13deg) scale(1.5);
}
.image-overlay[_ngcontent-%COMP%]   .image.small[_ngcontent-%COMP%]   .pin.prevent[_ngcontent-%COMP%] {
  width: 16px;
  height: 58px;
  top: -24px;
  left: 72%;
  transform: rotate(16deg) scale(1.5);
}
.image-overlay[_ngcontent-%COMP%]   .image.completed[_ngcontent-%COMP%] {
  opacity: 0;
}
.image-overlay.expanded[_ngcontent-%COMP%] {
  z-index: 4;
}
.image-overlay.expanded[_ngcontent-%COMP%]   .backdrop[_ngcontent-%COMP%] {
  opacity: 1;
  background: rgba(0, 0, 0, 0.3);
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  pointer-events: all;
}
.image-overlay.expanded[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%] {
  transform: translate(-50%, -50%) scale(1);
  width: 60%;
  top: 50%;
  left: 50%;
  bottom: auto;
}
.discuss[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  display: flex;
  flex-flow: column;
  align-items: stretch;
  overflow: hidden;
  transition: opacity 0.2s ease-in-out;
  opacity: 0;
  position: relative;
  z-index: 1;
  max-width: 520px;
  margin: 0 auto;
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.1);
}
.discuss.visible[_ngcontent-%COMP%] {
  opacity: 1;
}
.discuss[_ngcontent-%COMP%]   app-messages[_ngcontent-%COMP%] {
  flex: 1 1 auto;
  overflow: hidden;
  display: flex;
  background: #F5F0E7;
}
.discuss[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  border-radius: 16px 16px 0px 0px;
  background: #FFF;
  box-shadow: 0px 0px 16px 0px rgba(78, 2, 178, 0.2);
  height: 64px;
  padding: 8px;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  gap: 4px;
  transition: transform 0.35s ease-out;
  transform: translateY(100%);
}
.discuss[_ngcontent-%COMP%]   .input.visible[_ngcontent-%COMP%] {
  transition-delay: 0s;
  transform: translateY(0);
}
.discuss[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .input-el[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  resize: none;
  border-radius: 4px;
  padding: 8px;
  outline: none;
  appearance: none;
  border: none;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
}
.discuss[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .input-el[_ngcontent-%COMP%]:placeholder-shown {
  color: #9B90AA;
  font-weight: 400;
}
.discuss[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%] {
  fill: #EDECEC;
  pointer-events: none;
}
.discuss[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .submit.disabled[_ngcontent-%COMP%] {
  pointer-events: none;
}
.discuss[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .submit.disabled[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%] {
  fill: #EDECEC;
}
.discuss[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .input-el[_ngcontent-%COMP%]:not(:placeholder-shown)    + .submit[_ngcontent-%COMP%]:not(.disabled)   rect[_ngcontent-%COMP%] {
  fill: #4E02B2;
}
.discuss.completed[_ngcontent-%COMP%] {
  z-index: 1;
}
.buttons[_ngcontent-%COMP%] {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  pointer-events: all;
  z-index: 1;
}
app-complete-evaluation[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
}`]});};var Ji=class n{constructor(e,t,i){this.route=e;this.router=t;this.platform=i;this.platform.browser(()=>{console.log("Redirecting to:",this.route.snapshot.data);let r=this.route.snapshot.data.redirectTo;console.log("Redirecting to:",r),r?window.location.href=r:this.router.navigate(["/"]);});}static fac=function(t){return new(t||n)(ue(Ct),ue(gt),ue(it));};static cmp=Me({type:n,selectors:[["app-redirector"]],decls:0,vars:0,template:function(t,i){},encapsulation:2});};var Ph=class n{constructor(e){this.http=e;this._configs.pipe(Oo((t,i)=>t?.tag===i?.tag&&t?.set_id===i?.set_id)).subscribe(t=>{this.config.next(t);});}_configs=new En();config=new So(1);loadConfig(e){let t=`https://storage.googleapis.com/chronomaps3-eu/tiles/${e}/config.json`;this.http.get(t).pipe($n(i=>{let r=i.set_id||0,o=`https://storage.googleapis.com/chronomaps3-eu/tiles/${e}/${r}/config.json`;return this.http.get(o).pipe(Jt(s=>D(D({},i),s)));}),Eo(i=>(console.error("Error loading config:",i),[]))).subscribe(i=>{this._configs.next(i);});}static fac=function(t){return new(t||n)(Qt(Ui));};static prov=tn({token:n,factory:n.fac,providedIn:"root"});};var Mh=class n{constructor(e){this.platform=e;this.platform.browser()&&(this.L=Qy());}L=null;static fac=function(t){return new(t||n)(Qt(it));};static prov=tn({token:n,factory:n.fac,providedIn:"root"});};var BO=["mapEl"],VO=["clusterLabelsEl"],zO=["maskEl"];function jO(n,e){if(n&1&&(ke(),P(0,"g")(1,"g")(2,"text",38),N(3),S()()()),n&2){let t=e.$implicit,i=j(2);Se("positive",t.average_rotation<=0)("negative",t.average_rotation>0),ct("transform","translate("+t.x+","+t.y+")"),I(),Et("transform","rotate("+-t.average_rotation*2+"deg)"),I(),ct("font-size",t.fontSize[i.lang()]),I(),vt(" ",t.title[i.lang()]," ");}}function $O(n,e){if(n&1&&(ke(),P(0,"svg",35)(1,"g",22),te(2,"rect",36),ze(3,jO,4,9,":svg:g",37,jt),S()()),n&2){let t=j();Se("visible",t.clusterLabelsVisible()),ct("width",t.w())("height",t.h())("viewBox","0 0 "+t.w()+" "+t.h()),I(2),ct("x",0)("y",0)("width",t.w())("height",t.h()),I(),je(t.config().clusters);}}function UO(n,e){if(n&1&&(ke(),te(0,"rect",23)),n&2){let t=e.$implicit;ct("x",t.x)("y",t.y)("width",1)("height",1);}}function HO(n,e){if(n&1&&(P(0,"div",26),ke(),P(1,"svg",39)(2,"g")(3,"g",40)(4,"g",41),te(5,"path",42),P(6,"text",43),be(7,5),S()(),P(8,"g",44),te(9,"path",42),P(10,"text",43),be(11,6),S()(),P(12,"g",45),te(13,"path",42),P(14,"text",43),be(15,7),S()(),P(16,"g",46),te(17,"path",42),P(18,"text",43),be(19,8),S()(),P(20,"g",47),te(21,"path",48),P(22,"text",49),be(23,9),S()(),P(24,"g",50),te(25,"path",48),P(26,"text",49),be(27,10),S()(),P(28,"g",51),te(29,"path",48),P(30,"text",49),be(31,11),S()(),P(32,"g",52),te(33,"path",48),P(34,"text",49),be(35,12),S()(),P(36,"g",53),te(37,"path",54),P(38,"text",55),be(39,13),S(),P(40,"text",56),be(41,14),S(),te(42,"circle",57),S()()()()()),n&2){let t=j();I(2),mr("expander "+t.coneExpand());}}var Gn=class n{constructor(e,t,i,r){this.api=e;this.platform=t;this.activatedRoute=i;this.leafletService=r;this.L=this.leafletService.L,i.queryParams.subscribe(o=>{this.setLanguage(),this.tag=o.tag||this.tag;}),this.api.config.pipe(Bt(),Vt(o=>!!o)).subscribe(o=>{o.clusters.forEach(s=>{s.x=(s.bounds[0][0]+s.bounds[1][0])/2*o.conversion_ratio[0],s.y=(s.bounds[0][1]+s.bounds[1][1])/2*o.conversion_ratio[1],s.w=(s.bounds[1][0]-s.bounds[0][0])*o.conversion_ratio[0],s.h=(s.bounds[1][1]-s.bounds[0][1])*o.conversion_ratio[1],s.fontSize={},Object.keys(s.title).forEach(l=>{let c=s.title[l];s.fontSize[l]=s.w/(c.length*.75);});}),o.grid=o.grid.sort((s,l)=>-(s.metadata.timestamp?.localeCompare(l.metadata.timestamp)||0)),this.sortCorrectly=!0,this.currentIndex=0,this.config.set(o);}),this.platform.browser(()=>{this.looped.pipe(Bt(),st(()=>{console.log("WATCHDOG RESETTING");}),gr(18e4),st(()=>{Jc("WATCHDOG RELOADING",{extra:{tag:this.tag,config:this.config(),sortCorrectly:this.sortCorrectly,currentIndex:this.currentIndex,loopStep:this.loopStep},level:"warning"});}),Nt(1e3)).subscribe(()=>{console.log("WATCHDOG RELOADING - ",this.loopStep),window.location.reload();}),this.api.config.pipe(Vt(o=>!!o),Xt(1),Nt(2e3),st(()=>{this.mapChangingOpportunity.next(),this.addToQueue();}),Nt(2e3)).subscribe(()=>{this.doLoop&&this.loop();}),at(()=>{this.viewInit()&&this.config()&&this.L&&(console.log("LANG GETTING MAP?"),this.mapChangingOpportunity.pipe(Xt(1)).subscribe(()=>{console.log("LANG GETTING MAP!"),this.map.update(o=>o?(this.tileLayer.remove(),this.addTileLayer(o),o):this.getMap(this.config()));}));}),at(()=>{let o=this.currentZoom();!this.doLoop&&this.clusterLabelsLayer&&(o<4?(this.clusterLabelsLayer.setOpacity(1),this.clusterLabelsVisible.set(!0)):o>4.5?(this.clusterLabelsLayer.setOpacity(0),this.clusterLabelsVisible.set(!1)):(this.clusterLabelsLayer.setOpacity(1-(o-4)/.5),this.clusterLabelsVisible.set(!0)));}),Ds(6e4).pipe(Bt()).subscribe(()=>{this.api.loadConfig(this.tag);});});}tag="main";language="";doLoop=!1;mapElement;clusterLabelsElement;maskElement;L;map=G(null);tileLayer=null;clusterLabelsLayer=null;maskLayer=null;config=G(null);viewInit=G(!1);currentZoom=G(0);lang=G("dutch");sortCorrectly=!0;currentIndex=0;clusterLabelsVisible=G(!1);showClusters=!0;itemImg=G("");itemImgVisible=G(!1);mapTransform=G("rotate(0deg)");overlayTransform=G("rotate(0deg)");clothespinTextVisible=G("none");clothespinVisible=G("none");clothespinSelected=G(!1);coneVisible=G(!1);coneExpand=G("");selectedLabel=G(-1);maskAmount=G(20);maskBase=G({x:10,y:10});maskLayerVisible=G(!1);maskItems=_e(()=>{let e=this.maskAmount(),t=this.maskBase();return this.calculateMask(e,t);});queue=new So(1);moveEnded=new En();mapChangingOpportunity=new En();looped=new En();wdim=_e(()=>this.config()?this.config().dim[0]+this.config().padding_ratio:0);hdim=_e(()=>this.config()?this.config().dim[1]:0);w=_e(()=>this.config()?this.wdim()*this.config().conversion_ratio[0]:0);h=_e(()=>this.config()?this.hdim()*this.config().conversion_ratio[1]:0);bounds=_e(()=>[[-this.h(),0],[0,this.w()]]);loopStep=0;ngOnInit(){this.tag=this.tag||this.activatedRoute.snapshot.queryParams.tag,this.api.loadConfig(this.tag);}setLanguage(e){let t=[this.activatedRoute.snapshot.queryParams.lang,e,this.language,"english"],i=this.config()?.clusters?.[0]?.title;if(console.log("LANG OPTIONS",t),console.log("LANG CLUSTER",i),i){for(let r of t)if(r&&(r=r.toLowerCase(),i[r])){this.lang.set(r);return;}}this.lang.set(t[t.length-1]);}ngAfterViewInit(){this.viewInit.set(!0),this.setLanguage();}loop(){this.looped.next(),this.queue.pipe(st(e=>{this.loopStep=0,this.looped.next(),console.log("LANG QUEUE",e?.id);}),Vt(e=>!!e),Oo(),st(e=>{this.loopStep=10;let t=e.metadata.url;t=t.replace("https://storage.googleapis.com/chronomaps3.firebasestorage.app/","https://storage.googleapis.com/chronomaps3-eu/"),this.itemImg.set(t);}),st(e=>{this.loopStep=20,this.maskBase.set({x:e.pos[0],y:e.pos[1]}),this.maskAmount.set(1);}),Nt(1e3),st(e=>{this.loopStep=30,this.maskLayerVisible.set(!0);}),Nt(3e3),$n(e=>{this.loopStep=40,console.log("New item in queue:",e);let t=e.geo_bounds,i=this.config().conversion_ratio,r=this.config().cell_ratios||[1,1],o=[1,0].map(s=>i[s]*(1.5/r[s]-1));return t[0][0]-=o[0],t[0][1]-=o[1],t[1][0]+=o[0],t[1][1]+=o[1],this.map().flyToBounds(t,{animate:!0,duration:5}),this.clusterLabelsVisible.set(!1),this.overlayTransform.set(`rotate(${-e.metadata.rotate}deg)`),np(this.moveEnded,jn(5e3)).pipe(Xt(1),Jt(()=>e));}),st(e=>{this.loopStep=50,this.clusterLabelsVisible.set(!1),this.mapTransform.set(`rotate(${e.metadata.rotate}deg)`),this.overlayTransform.set("rotate(0deg)"),this.itemImgVisible.set(!0);}),Nt(1e3),st(e=>{this.loopStep=60,this.clothespinTextVisible.set("both"),this.clothespinVisible.set("both");}),Nt(1e3),st(e=>{this.loopStep=70,e.metadata.sign>0?(this.clothespinTextVisible.set("prefer"),this.clothespinVisible.set("prefer")):e.metadata.sign<0&&(this.clothespinTextVisible.set("prevent"),this.clothespinVisible.set("prevent"));}),Nt(500),st(e=>{this.loopStep=80,this.clothespinSelected.set(!0);}),Nt(500),st(e=>{this.loopStep=90,this.clothespinTextVisible.set("none"),this.coneVisible.set(!0);}),Nt(4e3),st(e=>{this.loopStep=100,this.selectedLabel.set(Math.round(e.metadata.rotate/8));let t="-"+Math.abs(this.selectedLabel());e.metadata.rotate>0?t="expand-p"+t:e.metadata.rotate<0?t="expand-n"+t:t="expand-"+t,this.mapElement.nativeElement.offsetWidth>this.mapElement.nativeElement.offsetHeight?t=t+"  h":t=t+"  v",this.coneExpand.set(t),this.overlayTransform.set(`rotate(${-e.metadata.rotate}deg)`),this.mapTransform.set("rotate(0deg)"),this.mapChangingOpportunity.next();}),Nt(5e3),st(e=>{this.loopStep=110,this.itemImgVisible.set(!1);}),Nt(1e3),$n(e=>{this.loopStep=120,this.clothespinSelected.set(!1),this.coneVisible.set(!1),this.coneExpand.set(""),this.clusterLabelsVisible.set(!0),console.log("LANGUAGE ITEM",e.metadata),this.setLanguage(e.metadata.lang);let t=5,i=33;this.map().flyToBounds(this.bounds(),{animate:!0,duration:t,easeLinearity:1});let r=Math.ceil(t*1e3/i);return np(jn(6e3),u0([Ds(33,h0).pipe(Xt(r),st(o=>{let s=this.wdim()**2*3,l=((o+1)/r)**5;this.maskAmount.set(Math.ceil(l*s));})),this.moveEnded])).pipe(Xt(1),Jt(()=>e));}),st(e=>{this.loopStep=130,this.clothespinVisible.set("none"),this.maskLayerVisible.set(!1);}),Nt(3e3),Eo(e=>Ua(["error: "+e+" "+this.loopStep]))).subscribe(e=>{this.loopStep=200,console.log("Finished with item",e),this.addToQueue();});}getMap(e){let t=this.w(),i=this.h(),r=this.bounds(),o=.333,s=[[-i*(1+o),-t*o],[i*o,t*(1+o)]];console.log("BOUNDS",e.dim,e.conversion_ratio,r,s);let l=this.L.map(this.mapElement.nativeElement,{crs:this.L.CRS.Simple,maxBounds:s,center:[r[0][0]/2,r[1][1]/2],zoom:2,maxZoom:8,minZoom:2,zoomSnap:0,zoomControl:this.platform.isDesktop,attributionControl:!1});return l.fitBounds(r),l.on("moveend",()=>{this.currentZoom.set(l.getZoom()),this.moveEnded.next();}),this.addTileLayer(l),jn(0).subscribe(()=>{if(this.doLoop&&this.maskElement?.nativeElement){let c=this.maskElement.nativeElement.querySelector("svg");c&&(this.maskLayer=this.L.svgOverlay(c,r),this.maskLayer?.addTo(l));}if(this.clusterLabelsElement?.nativeElement){let c=this.clusterLabelsElement.nativeElement.querySelector("svg");c&&(this.clusterLabelsLayer=this.L.svgOverlay(c,r),this.clusterLabelsLayer?.addTo(l));}}),l;}addTileLayer(e){let t=[[-this.h()*2,-this.w()],[this.h(),this.w()*2]],i=this.config();this.tileLayer=new this.L.TileLayer(`https://storage.googleapis.com/chronomaps3-eu/tiles/${this.tag}/${i.set_id}/{z}/{x}/{y}.png`,{maxZoom:8,minZoom:2,bounds:t,errorTileUrl:"empty.png"}),this.tileLayer.addTo(e);}addToQueue(){if(this.config()){let e=null,t=this.config().grid;if(t&&t.length>0){for(;!e;){let i=this.currentIndex;this.sortCorrectly||(i=Math.floor(Math.random()*t.length)),e=t[i],this.currentIndex++,this.currentIndex>=t.length&&(this.currentIndex=0,this.sortCorrectly=!1);}this.queue.next(e);}}}calculateMask(e,t){let i=[{x:1,y:-.5},{x:0,y:-1},{x:-1,y:-.5},{x:-1,y:.5},{x:0,y:1},{x:1,y:.5}],r=[t],o=1;for(;r.length<e;){let s={x:t.x+o,y:t.y};r.push(s);for(let l of i)for(let c=0;c<o;c++)s={x:s.x+l.y,y:s.y+l.x},r.push(s);o++;}return r.slice(0,e);}static fac=function(t){return new(t||n)(ue(Ph),ue(it),ue(Ct),ue(Mh));};static cmp=Me({type:n,selectors:[["app-output-map"]],viewQuery:function(t,i){if(t&1&&(Pt(BO,5),Pt(VO,5),Pt(zO,5)),t&2){let r;wt(r=Mt())&&(i.mapElement=r.first),wt(r=Mt())&&(i.clusterLabelsElement=r.first),wt(r=Mt())&&(i.maskElement=r.first);}},inputs:{tag:"tag",language:"language",doLoop:"doLoop"},decls:26,vars:34,consts:()=>{let e;e="Gewenst";let t;t="Gevreesd";let i;i="Waarschijnlijk";let r;r="Geloofwaardig";let o;o="Voorstelbaar";let s;s="Absurd";let l;l="Waarschijnlijk";let c;c="Geloofwaardig";let d;d="Voorstelbaar";let u;u="Absurd";let g;g="NU";let f;return f="VOORSPELBAAR",[["mapEl",""],["clusterLabelsEl",""],["maskEl",""],e,t,i,r,o,s,l,c,d,u,g,f,[1,"map"],[2,"display","none"],["xmlns","http://www.w3.org/2000/svg",1,"cluster-labels",3,"visible"],[1,"mask-overlay",2,"display","none"],["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","none",1,"mask"],["id","mask"],["fill","white"],["transform","translate(0,0)"],["fill","black"],["fill","#fffdf6","mask","url(#mask)",1,"blur"],[1,"image-overlay"],[1,"cone"],[1,"clothespin-text","prefer"],[1,"item-image"],[3,"src"],[1,"clothespin","prefer"],["src","/img-pin-prefer-v.svg"],[1,"clothespin","prevent"],["src","/img-pin-prevent-v.svg"],[1,"clothespin-text","prevent"],["xmlns","http://www.w3.org/2000/svg",1,"cluster-labels"],["fill","#fffdf6","opacity","0.5"],[3,"positive","negative"],["x","0","y","0","text-anchor","middle","alignment-baseline","middle"],["xmlns","http://www.w3.org/2000/svg","width","100","height","100","viewBox","0 0 1000 1000","fill","none"],["transform","translate(25,500)"],["transform-origin","125 0",1,"probable","preferred","cone-line"],["d","M125 0 L825 0","stroke","#698CFF","stroke-width","1",1,"line"],["x","825","y","0","dy","6","dx","16","fill","#698CFF","font-size","24",1,"label"],["transform-origin","125 0",1,"plausible","preferred","cone-line"],["transform-origin","125 0",1,"possible","preferred","cone-line"],["transform-origin","125 0",1,"preposterous","preferred","cone-line"],["transform-origin","125 0",1,"probable","prevent","cone-line"],["d","M125 0 L825 0","stroke","#F73C3C","stroke-width","1",1,"line"],["x","825","y","0","dy","6","dx","16","fill","#F73C3C","font-size","24",1,"label"],["transform-origin","125 0",1,"plausible","prevent","cone-line"],["transform-origin","125 0",1,"possible","prevent","cone-line"],["transform-origin","125 0",1,"preposterous","prevent","cone-line"],[1,"projected"],["d","M125 0 L825 0","stroke","#8F8F8F","stroke-width","1",1,"line"],["x","125","y","0","dy","6","dx","-16","fill","#8F8F8F","font-size","24","text-anchor","end",1,"now"],["x","825","y","0","dy","6","dx","16","fill","#8F8F8F","font-size","24","transform","translate(-450,0)",1,"label"],["cx","125","cy","0","r","5","fill","#8F8F8F",1,"circle"]];},template:function(t,i){t&1&&(te(0,"div",15,0),P(2,"div",16,1),ge(4,$O,5,9,":svg:svg",17),S(),P(5,"div",18,2),ke(),P(7,"svg",19)(8,"mask",20),te(9,"rect",21),P(10,"g",22),ze(11,UO,1,4,":svg:rect",23,jt),S()(),te(13,"rect",24),S()(),Ye(),P(14,"div",25),ge(15,HO,43,2,"div",26),P(16,"div",27),be(17,3),S(),P(18,"div",28),te(19,"img",29),P(20,"div",30),te(21,"img",31),S(),P(22,"div",32),te(23,"img",33),S()(),P(24,"div",34),be(25,4),S()()),t&2&&(Et("transform",i.mapTransform()),I(4),he(i.map()?4:-1),I(3),Se("visible",i.maskLayerVisible()),ct("width",i.wdim())("height",i.hdim())("viewBox","0 0 "+i.wdim()+" "+i.hdim()),I(2),ct("x",0)("y",0)("width",i.wdim())("height",i.hdim()),I(2),je(i.maskItems()),I(2),ct("x",0)("y",0)("width",i.wdim())("height",i.hdim()),I(),Se("visible",i.itemImgVisible()),I(),he(i.coneVisible()?15:-1),I(),Se("visible",i.clothespinTextVisible()==="prefer"||i.clothespinTextVisible()==="both"),I(2),Et("transform",i.overlayTransform()),I(),K("src",i.itemImg(),Ue),I(),Se("visible",i.clothespinVisible()==="prefer"||i.clothespinVisible()==="both")("selected",i.clothespinSelected()),I(2),Se("visible",i.clothespinVisible()==="prevent"||i.clothespinVisible()==="both")("selected",i.clothespinSelected()),I(2),Se("visible",i.clothespinTextVisible()==="prevent"||i.clothespinTextVisible()==="both"));},styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
[_nghost-%COMP%] {
  display: block;
  position: relative;
  width: 100%;
  height: 100%;
  z-index: 0;
  overflow: hidden;
  background: #fffdf6;
}
[_nghost-%COMP%]   .map[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1;
  transition: transform 1s ease-in-out;
}
[_nghost-%COMP%]   .cluster-labels[_ngcontent-%COMP%] {
  opacity: 0;
  transition: opacity 1s ease-in-out;
}
[_nghost-%COMP%]   .cluster-labels.visible[_ngcontent-%COMP%] {
  opacity: 1;
}
[_nghost-%COMP%]   .cluster-labels[_ngcontent-%COMP%]     text {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-weight: 400;
  font-style: italic;
  stroke: #FFFDF6;
  stroke-width: 0.5em;
  paint-order: stroke;
}
[_nghost-%COMP%]   .cluster-labels[_ngcontent-%COMP%]     .positive text {
  fill: #B50F0F;
}
[_nghost-%COMP%]   .cluster-labels[_ngcontent-%COMP%]     .negative text {
  fill: #0030CC;
}
[_nghost-%COMP%]   .mask[_ngcontent-%COMP%] {
  opacity: 0;
  transition: opacity 1s ease-in-out;
}
[_nghost-%COMP%]   .mask.visible[_ngcontent-%COMP%] {
  opacity: 1;
}
[_nghost-%COMP%]   .mask[_ngcontent-%COMP%]   rect.blur[_ngcontent-%COMP%] {
  opacity: 0.85;
  -webkit-backdrop-filter: grayscale(1);
  backdrop-filter: grayscale(1);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 20000;
  pointer-events: none;
  display: flex;
  flex-flow: row nowrap;
  justify-content: center;
  align-items: center;
  gap: 70px;
  opacity: 0;
  transition: opacity 1s ease-in-out;
  background-color: #FFFDF6;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%] {
  max-width: 100%;
  max-height: 100%;
  height: 100%;
  width: 100%;
  position: absolute;
  aspect-ratio: 1/1;
  display: flex;
  justify-content: center;
  align-items: center;
  animation: _ngcontent-%COMP%_fadeIn 1s ease-in-out;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%] {
  transition: transform 3s ease-in-out;
  transform-origin: center;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand-p-4[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(201vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand-p-3[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(137vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand-p-2[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(79vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand-p-1[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(26vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand--0[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-25vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand-n-1[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-75vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand-n-2[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-126vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand-n-3[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-183vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.h.expand-n-4[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-246vh) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand-p-4[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(160vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand-p-3[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(103vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand-p-2[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(53vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand-p-1[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(5vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand--0[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-41vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand-n-1[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-88vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand-n-2[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-138vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand-n-3[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-193vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .expander.v.expand-n-4[_ngcontent-%COMP%] {
  transform: translateX(-10%) translateY(-257vw) scale(10);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .projected[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] {
  stroke-dasharray: 700;
  stroke-dashoffset: 450;
  animation: _ngcontent-%COMP%_projected-intro 1s ease-in-out forwards 1s;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .projected[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_no-transform 1s ease-in-out forwards 1s;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line[_ngcontent-%COMP%] {
  opacity: 0;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.preferred[_ngcontent-%COMP%]   text[_ngcontent-%COMP%] {
  fill: #698CFF;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.preferred[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {
  stroke: #698CFF;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.preferred.probable[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_probable-preferred 1s ease-in-out 2s forwards;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.preferred.plausible[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_plausible-preferred 1s ease-in-out 2s forwards;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.preferred.possible[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_possible-preferred 1s ease-in-out 2s forwards;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.preferred.preposterous[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_preposterous-preferred 1s ease-in-out 2s forwards;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.prevent[_ngcontent-%COMP%]   text[_ngcontent-%COMP%] {
  fill: #F73C3C;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.prevent[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {
  stroke: #F73C3C;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.prevent.probable[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_probable-prevent 1s ease-in-out 2s forwards;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.prevent.plausible[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_plausible-prevent 1s ease-in-out 2s forwards;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.prevent.possible[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_possible-prevent 1s ease-in-out 2s forwards;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .cone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .cone-line.prevent.preposterous[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_preposterous-prevent 1s ease-in-out 2s forwards;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%] {
  aspect-ratio: 53/100;
  height: 48%;
  position: relative;
  display: flex;
  transition: transform 1s ease-in-out;
  transition-property: transform, height;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  position: absolute;
  top: 0;
  left: 0;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .clothespin[_ngcontent-%COMP%] {
  width: 3.87vh;
  height: 12.84vh;
  position: absolute;
  transition: opacity 0.5s ease-in-out;
  transition-property:
    opacity,
    transform,
    top,
    left,
    right;
  opacity: 0;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .clothespin[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], 
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .clothespin[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .clothespin.visible[_ngcontent-%COMP%] {
  opacity: 1;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .clothespin.prefer[_ngcontent-%COMP%] {
  top: 50%;
  left: 0;
  transform: translateY(-4vh) rotate(90deg) scale(0.8) translateY(2vh);
  transform-origin: top left;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .clothespin.prefer.selected[_ngcontent-%COMP%] {
  left: 2vh;
  top: -7vh;
  transform: translateY(0) rotate(-12deg) scale(1) translateY(0);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .clothespin.prevent[_ngcontent-%COMP%] {
  top: 50%;
  right: 0;
  transform-origin: top right;
  transform: translateY(-4vh) rotate(270deg) scale(0.8) translateY(2vh);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .clothespin.prevent.selected[_ngcontent-%COMP%] {
  right: 2vh;
  top: -4vh;
  transform: translateY(0) rotate(16deg) scale(1) translateY(0);
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .clothespin-text[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  leading-trim: both;
  text-edge: cap;
  font-size: 40px;
  font-style: normal;
  font-weight: 400;
  opacity: 0;
  transition: opacity 1s ease-in-out;
  width: 150px;
  text-align: center;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .clothespin-text.visible[_ngcontent-%COMP%] {
  opacity: 1;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .clothespin-text.prefer[_ngcontent-%COMP%] {
  color: #698CFF;
}
[_nghost-%COMP%]   .image-overlay[_ngcontent-%COMP%]   .clothespin-text.prevent[_ngcontent-%COMP%] {
  color: #F73C3C;
}
[_nghost-%COMP%]   .image-overlay.visible[_ngcontent-%COMP%] {
  opacity: 1;
}
@keyframes _ngcontent-%COMP%_fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@keyframes _ngcontent-%COMP%_projected-intro {
  to {
    stroke-dashoffset: 0;
  }
}
@keyframes _ngcontent-%COMP%_no-transform {
  to {
    transform: translate(0, 0);
  }
}
@keyframes _ngcontent-%COMP%_probable-preferred {
  from {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: rotate(-8deg);
  }
}
@keyframes _ngcontent-%COMP%_probable-prevent {
  from {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: rotate(8deg);
  }
}
@keyframes _ngcontent-%COMP%_plausible-preferred {
  from {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: rotate(-16deg);
  }
}
@keyframes _ngcontent-%COMP%_plausible-prevent {
  from {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: rotate(16deg);
  }
}
@keyframes _ngcontent-%COMP%_possible-preferred {
  from {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: rotate(-24deg);
  }
}
@keyframes _ngcontent-%COMP%_possible-prevent {
  from {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: rotate(24deg);
  }
}
@keyframes _ngcontent-%COMP%_preposterous-preferred {
  from {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: rotate(-32deg);
  }
}
@keyframes _ngcontent-%COMP%_preposterous-prevent {
  from {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: rotate(32deg);
  }
}`]});};var ta=class n{constructor(e,t){this.locale_=e;this.http=t;this.locale.set(e.split("-")[0]),at(()=>{let i=this.aboutUrl();console.log("About URL:",i),i&&this.http.get(i,{responseType:"text"}).subscribe(r=>{let o=Ee(r);this.content.set(o);});});}prefix="";locale=G(null);aboutUrl=_e(()=>{let e=this.prefix_(),t=this.locale();return!t||e===null?null:`/abouts/${e}${t}.md`;});_=Ee;content=G("");prefix_=G(null);ngOnInit(){this.ngOnChanges();}ngOnChanges(){console.log("Prefix changed:",this.prefix),this.prefix_.set(this.prefix);}static fac=function(t){return new(t||n)(ue(Ec),ue(Ui));};static cmp=Me({type:n,selectors:[["app-about"]],inputs:{prefix:"prefix"},features:[g0],decls:2,vars:1,consts:[[1,"container"],[1,"content",3,"innerHTML"]],template:function(t,i){t&1&&(P(0,"div",0),te(1,"div",1),S()),t&2&&(I(),K("innerHTML",i.content(),Mc));},styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: #FFFDF6;
  display: flex;
}
.container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%] {
  padding: 24px;
  height: fit-content;
}
.container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]  {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  color: #4E02B2;
  font-size: 18px;
  font-weight: 400;
}
.container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]  * {
  margin: 0;
  padding: 0;
}
.container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]  h1 {
  font-size: 36px;
  font-weight: 400;
  margin-bottom: 16px;
}
.container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]  h2 {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 8px;
}
.container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]  p {
  margin-bottom: 8px;
}`]});};var Sh=class n{constructor(e,t){this.state=e;this.api=t;at(()=>{let i=this.password(),r=this.api.workspaceId()?.split("-")||[];if(r.length>4){let o=r[1][0]+r[2][0]+r[3][0]+r[4][0];this.state.authenticated.set(i===o);}});}password=G("");static fac=function(t){return new(t||n)(ue(Ot),ue(rt));};static cmp=Me({type:n,selectors:[["app-password-prompt"]],decls:4,vars:1,consts:()=>{let e;return e="Enter Password",[e,[1,"prompt"],["type","password","id","chronomaps-password",3,"ngModelChange","ngModel"]];},template:function(t,i){t&1&&(P(0,"div",1)(1,"h2"),be(2,0),S(),P(3,"input",2),tt("ngModelChange",function(o){return et(i.password,o)||(i.password=o),o;}),S()()),t&2&&(I(3),Qe("ngModel",i.password));},dependencies:[on,Hi,On,Tn],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
[_nghost-%COMP%] {
  display: flex;
  width: 100%;
  height: 100%;
  flex-flow: column;
  align-items: center;
  justify-content: center;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
[_nghost-%COMP%]   input[_ngcontent-%COMP%] {
  padding: 0.75rem;
  border: 2px solid #E7CBFF;
  border-radius: 8px;
  font-size: 1rem;
  letter-spacing: 40%;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  background-color: white;
  transition: border-color 0.2s;
}
[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #B969FF;
}
[_nghost-%COMP%]   input[_ngcontent-%COMP%]:disabled, 
[_nghost-%COMP%]   input[readonly][_ngcontent-%COMP%] {
  background-color: #f5f5f5;
  color: #9B90AA;
  cursor: not-allowed;
}`]});};var WO=["mapContainer"];function GO(n,e){n&1&&te(0,"app-password-prompt");}function YO(n,e){if(n&1&&te(0,"app-output-map",15),n&2){let t=j(2);K("tag",t.tag());}}function XO(n,e){if(n&1&&ge(0,GO,1,0,"app-password-prompt")(1,YO,1,1,"app-output-map",15),n&2){let t=j();he(t.api.passwordProtected()&&!t.state.authenticated()?0:1);}}function qO(n,e){if(n&1){let t=ve();P(0,"div",14)(1,"div",16)(2,"a",17),Z("click",function(){X(t);let r=j();return q(r.state.aboutVisible.set(!1));}),te(3,"div",18)(4,"div",8),S()(),te(5,"app-about"),S();}}var Eh=class n{constructor(e,t,i,r,o){this.platform=e;this.destroyRef=t;this.route=i;this.api=r;this.state=o;this.api.updateFromRoute(i.snapshot),this.platform.browser(()=>{this.browser=!0;}),this.route.queryParams.subscribe(s=>{let l=s.tag||"main";this.tag.set(l);}),this.route.fragment.pipe(Bt(this.destroyRef),Xt(1)).subscribe(s=>{s==="about"&&(this.mainMenuOpen.set(!0),this.state.aboutVisible.set(!0));});}tag=G("main");mainMenuOpen=G(!1);browser=!1;mapContainer;outputMap;ngAfterViewInit(){this.platform.browser(()=>{new Ur(e=>{let t=new ResizeObserver(r=>{e.next(r);});return t.observe(this.mapContainer.nativeElement),()=>{t.disconnect();};}).pipe(Bt(this.destroyRef)).subscribe(e=>{if(e[0]){let i=this.outputMap.map();if(i){let r=i.getCenter();i.invalidateSize(),i.flyTo(r);}}});});}static fac=function(t){return new(t||n)(ue(it),ue(ii),ue(Ct),ue(rt),ue(Ot));};static cmp=Me({type:n,selectors:[["app-home"]],viewQuery:function(t,i){if(t&1&&(Pt(WO,5),Pt(Gn,5)),t&2){let r;wt(r=Mt())&&(i.mapContainer=r.first),wt(r=Mt())&&(i.outputMap=r.first);}},decls:17,vars:10,consts:()=>{let e;return e="MENU",[["mapContainer",""],e,[1,"container"],[1,"map"],[1,"borders",3,"click"],[1,"border","b1"],[1,"border","b2"],[1,"border","b3"],[1,"logo"],[1,"menu-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","25","viewBox","0 0 24 25","fill","none",1,"button"],["d","M7.375 9.51953L12.375 14.5195L17.375 9.51953","stroke","#6C707B","stroke-width","1.5","stroke-linecap","round"],[1,"menu-container"],[3,"explore"],[1,"about"],[3,"tag"],[1,"about-header"],[3,"click"],[1,"back"]];},template:function(t,i){if(t&1){let r=ve();P(0,"div",2)(1,"div",3,0),ge(3,XO,2,1),P(4,"div",4),Z("click",function(){return X(r),q(i.mainMenuOpen.set(!1));}),te(5,"div",5)(6,"div",6)(7,"div",7),S(),te(8,"div",8),P(9,"div",9),Z("click",function(){return X(r),q(i.mainMenuOpen.set(!i.mainMenuOpen()));}),ke(),P(10,"svg",10),te(11,"path",11),S(),Ye(),P(12,"span"),be(13,1),S()()(),P(14,"div",12)(15,"app-main-menu",13),Z("explore",function(){return X(r),q(i.mainMenuOpen.set(!1));}),S()(),ge(16,qO,6,0,"div",14),S();}t&2&&(I(3),he(i.browser?3:-1),I(),Se("fullscreen",!i.mainMenuOpen()),I(4),Se("fullscreen",!i.mainMenuOpen()),I(2),Se("open",i.mainMenuOpen()),I(4),Et("height",i.mainMenuOpen()?i.state.mainMenuHeight():0,"px"),I(2),he(i.state.aboutVisible()?16:-1));},dependencies:[Gn,Js,ta,Sh],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  align-items: stretch;
  height: 100%;
  overflow: hidden;
  position: relative;
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%] {
  flex: 1 1 100%;
  position: relative;
  display: flex;
  flex-flow: column;
  align-items: center;
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .borders[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  transition: background-color 0.3s ease-in-out;
  background-color: rgba(255, 253, 246, 0.75);
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .borders.fullscreen[_ngcontent-%COMP%] {
  background-color: rgba(255, 253, 246, 0);
  pointer-events: none;
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .borders[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%] {
  position: absolute;
  top: 2px;
  left: 2px;
  width: calc(100% - 4px);
  height: calc(100% - 4px);
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .borders[_ngcontent-%COMP%]   .border.b1[_ngcontent-%COMP%] {
  z-index: 900;
  border: 3px solid #4E02B2;
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .borders[_ngcontent-%COMP%]   .border.b2[_ngcontent-%COMP%] {
  z-index: 901;
  border: 2px dashed #FFFDF6;
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .borders[_ngcontent-%COMP%]   .border.b3[_ngcontent-%COMP%] {
  z-index: 902;
  border: 1px solid #4E02B2;
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   app-output-map[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  position: relative;
  flex: 1 1 100%;
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%] {
  position: absolute;
  z-index: 1000;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  height: 52px;
  display: flex;
  flex-flow: row nowrap;
  gap: 4px;
  align-items: center;
  color: #6C707B;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  transition: transform 0.3s ease-in-out;
  transform: rotate(180deg);
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]   .button.open[_ngcontent-%COMP%] {
  transform: rotate(0deg);
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%] {
  position: absolute;
  z-index: 1000;
  pointer-events: none;
  left: 50%;
  top: 50%;
  transform: translateX(-50%) translateY(-50%);
  transition: all 0.3s ease-in-out;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  width: 165px;
  height: 138px;
  background-image: url("./media/futures-map-logo-UYVZA7QU.svg");
}
.container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]   .logo.fullscreen[_ngcontent-%COMP%] {
  top: 16px;
  transform: translateX(-50%) translateY(0);
}
.container[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  transition: height 0.3s ease-in-out;
}
.container[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-flow: column nowrap;
  align-items: stretch;
  z-index: 2000;
}
.container[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]   .about-header[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  height: 52px;
  gap: 8px;
  animation: _ngcontent-%COMP%_slideInDown 0.3s ease-in-out;
  background-color: #FFFDF6;
  padding: 0 16px;
  border-bottom: 1px solid #F1E5F3;
}
.container[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]   .about-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  gap: 8px;
}
.container[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]   .about-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .back[_ngcontent-%COMP%] {
  width: 24px;
  height: 24px;
  background-image: url("./media/icon-back-FAO6AZBV.svg");
}
.container[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]   .about-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%] {
  width: 132px;
  height: 10px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  background-image: url("./media/logo-futures-VIS6UZMX.svg");
  pointer-events: none;
}
.container[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]   app-about[_ngcontent-%COMP%] {
  flex: 1 1 auto;
  animation: _ngcontent-%COMP%_slideInUp 0.3s ease-in-out;
  overflow: hidden;
}`]});};var Oh=class n{static fac=function(t){return new(t||n)();};static cmp=Me({type:n,selectors:[["app-pps25"]],decls:4,vars:2,consts:[[1,"container"],[1,"map-container"],["language","hebrew",3,"tag","doLoop"],[1,"frame"]],template:function(t,i){t&1&&(P(0,"div",0)(1,"div",1),te(2,"app-output-map",2),S(),te(3,"div",3),S()),t&2&&(I(2),K("tag","its_time")("doLoop",!0));},dependencies:[Gn],styles:[`

[_nghost-%COMP%] {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  padding: 24px;
  background: #FFFDF6;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%] {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 20px;
  padding-right: 252px;
  overflow: hidden;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .frame[_ngcontent-%COMP%] {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1000;
  top: 0;
  left: 0;
  background-image: url("./media/pps25-screen-frame-w-YZA6GP5U.svg");
  background-size: 100% 100%;
  background-repeat: no-repeat;
  background-position: center;
}`]});};var Th=class n{static fac=function(t){return new(t||n)();};static cmp=Me({type:n,selectors:[["app-pps25v"]],decls:4,vars:2,consts:[[1,"container"],[1,"map-container"],["language","hebrew",3,"tag","doLoop"],[1,"frame"]],template:function(t,i){t&1&&(P(0,"div",0)(1,"div",1),te(2,"app-output-map",2),S(),te(3,"div",3),S()),t&2&&(I(2),K("tag","its_time")("doLoop",!0));},dependencies:[Gn],styles:[`

[_nghost-%COMP%] {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  padding: 24px;
  background: #FFFDF6;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%] {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  padding-top: 20px;
  padding-left: 20px;
  padding-right: 20px;
  padding-bottom: 252px;
  overflow: hidden;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .frame[_ngcontent-%COMP%] {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1000;
  top: 0;
  left: 0;
  background-image: url("./media/pps25-screen-frame-LFMNTZKR.svg");
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
}`]});};var kh=class n{static fac=function(t){return new(t||n)();};static cmp=Me({type:n,selectors:[["app-jma25"]],decls:4,vars:2,consts:[[1,"container"],[1,"map-container"],["language","dutch",3,"tag","doLoop"],[1,"frame"]],template:function(t,i){t&1&&(P(0,"div",0)(1,"div",1),te(2,"app-output-map",2),S(),te(3,"div",3),S()),t&2&&(I(2),K("tag","jma25")("doLoop",!0));},dependencies:[Gn],styles:[`

[_nghost-%COMP%] {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  padding: 24px;
  background: #FFFDF6;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%] {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  padding-top: 20px;
  padding-left: 20px;
  padding-right: 20px;
  padding-bottom: 20px;
  overflow: hidden;
}
[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .frame[_ngcontent-%COMP%] {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1000;
  top: 0;
  left: 0;
  background-image: url("./media/screen-frame-jma-5QASPRSV.svg");
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
}`]});};function ZO(n,e){n&1&&(P(0,"span",18),be(1,1),S());}function KO(n,e){if(n&1&&(P(0,"span",16),be(1,0),S(),ge(2,ZO,2,0,"span",18)),n&2){let t=j();I(2),he(t.secondary()?2:-1);}}function JO(n,e){n&1&&(P(0,"span",16),be(1,3),S());}function QO(n,e){if(n&1&&(P(0,"span",18),be(1,2),S(),ge(2,JO,2,0,"span",16)),n&2){let t=j();I(2),he(t.secondary()?2:-1);}}function eT(n,e){if(n&1){let t=ve();P(0,"div",21)(1,"div",23),Z("click",function(){X(t);let r=j();return q(r.primary.set("prefer"));}),te(2,"img",24),P(3,"span"),be(4,4),S()(),P(5,"div",25),Z("click",function(){X(t);let r=j();return q(r.primary.set("prevent"));}),te(6,"img",26),P(7,"span"),be(8,5),S()()();}}function tT(n,e){n&1&&(P(0,"span"),be(1,8),S(),N(2,"\xA0"),P(3,"strong"),be(4,9),S(),N(5,"\xA0"),P(6,"span"),be(7,10),S());}function nT(n,e){n&1&&(P(0,"span"),be(1,11),S(),N(2,"\xA0"),P(3,"strong"),be(4,12),S(),N(5,"\xA0"),P(6,"span"),be(7,13),S());}function iT(n,e){if(n&1){let t=ve();P(0,"div",22)(1,"div"),te(2,"div",27),P(3,"div",28)(4,"input",29),tt("ngModelChange",function(r){X(t);let o=j();return et(o.secondary,r)||(o.secondary=r),q(r);}),S(),P(5,"span"),ge(6,tT,8,0)(7,nT,8,0),S()()(),P(8,"div",30)(9,"div",31),Z("click",function(){X(t);let r=j();return q(r.clear());}),ke(),P(10,"svg",32),te(11,"path",33)(12,"path",34),S(),Ye(),P(13,"span"),be(14,6),S()(),P(15,"div",35),Z("click",function(){X(t);let r=j();return q(r.submit());}),P(16,"span"),be(17,7),S()()()();}if(n&2){let t=j();I(),mr("ish "+t.primary()),I(),Se("visible",!t.secondary()),I(2),Qe("ngModel",t.secondary),I(2),he(t.primary()==="prefer"?6:t.primary()==="prevent"?7:-1);}}var Ih=class n{constructor(e,t){this.state=e;this.api=t;}done=new Gr();primary=G(null);secondary=G(!1);primarySelected=_e(()=>this.primary()!==null);imageUrl=_e(()=>this.state.currentImageUrl()||this.api.item()?.screenshot_url||null);message=_e(()=>{let e="",t=this.primary(),i=this.secondary();return t==="prefer"?e+="Gewenst":t==="prevent"&&(e+="Gevreesd"),i&&(e+="(deels)"),e;});clear(){this.primary.set(null),this.secondary.set(!1);}submit(){let e=this.primary();if(!e)return;let t={favorable_future:e};this.secondary()&&(t.favorable_future="mostly "+t.favorable_future);let i=this.message();this.done.emit({message:i,props:t});}static fac=function(t){return new(t||n)(ue(Ot),ue(rt));};static cmp=Me({type:n,selectors:[["app-collect-properties-favorable"]],outputs:{done:"done"},decls:11,vars:9,consts:()=>{let e;e="Gewenst";let t;t="(deels)";let i;i="Gevreesd";let r;r="(deels)";let o;o="Gewenst";let s;s="Gevreesd";let l;l="Ongedaan maken";let c;c="Doorgaan";let d;d="Maar een deel hiervan zou ik willen";let u;u="Voorkomen";let g;g="\xA0";let f;f="Maar een deel hiervan zou ik nog steeds";let m;m="Wensen";let _;return _="\xA0",[e,t,i,r,o,s,l,c,d,u,g,f,m,_,[1,"container"],[1,"pins"],[1,"prefer"],[1,"label"],[1,"prevent"],[1,"img"],["alt","Confirmation Image",3,"src"],[1,"initial"],[1,"selected"],[1,"prefer",3,"click"],["ngSrc","/img-pin-prefer-h.svg","priority","","width","105px","height","28px",1,"img"],[1,"prevent",3,"click"],["ngSrc","/img-pin-prevent-h.svg","priority","","width","105px","height","28px",1,"img"],[1,"pin"],[1,"ish-select"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"controls"],[1,"undo",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","25","height","25","viewBox","0 0 25 25","fill","none"],["d","M7.14716 12.0595C7.14714 13.5462 7.71432 15.033 8.84869 16.1673C11.1174 18.436 14.7957 18.436 17.0644 16.1673C19.3331 13.8986 19.3331 10.2203 17.0644 7.95161C15.93 6.81725 14.4433 6.25007 12.9565 6.25009C12.1998 6.25008 10.4462 6.35411 10.4462 6.35411","stroke","#6C707B","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M12.1597 4.20703L10.0422 6.32452L12.1597 8.44201","stroke","#6C707B","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"submit",3,"click"]];},template:function(t,i){t&1&&(P(0,"div",14)(1,"div",15),te(2,"div",16),P(3,"div",17),ge(4,KO,3,1)(5,QO,3,1),S(),te(6,"div",18),S(),P(7,"div",19),te(8,"img",20),S(),ge(9,eT,9,0,"div",21)(10,iT,18,6,"div",22),S()),t&2&&(I(2),Se("visible",i.primary()==="prefer"||i.primary()==="prevent"&&i.secondary()),I(),Se("visible",i.primarySelected()),I(),he(i.primary()==="prefer"?4:i.primary()==="prevent"?5:-1),I(2),Se("visible",i.primary()==="prevent"||i.primary()==="prefer"&&i.secondary()),I(2),K("src",i.imageUrl(),Ue),I(),he(i.primarySelected()?10:9));},dependencies:[on,Bs,On,Tn,T0],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  align-items: center;
  width: 100%;
  gap: 15px;
  padding: 16px 0;
  padding-bottom: 0;
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  height: 50px;
  display: flex;
  width: 100%;
  position: relative;
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]    > *[_ngcontent-%COMP%] {
  transition: opacity 1s ease-in-out;
  opacity: 0;
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]   .visible[_ngcontent-%COMP%] {
  opacity: 1;
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%] {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 18px;
  font-weight: 700;
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .prefer[_ngcontent-%COMP%] {
  color: #0030CC;
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   .prevent[_ngcontent-%COMP%] {
  color: #B50F0F;
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]    > .prefer[_ngcontent-%COMP%], 
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]    > .prevent[_ngcontent-%COMP%] {
  position: absolute;
  top: 0px;
  left: 50%;
  width: 28px;
  height: 105px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]    > .prefer[_ngcontent-%COMP%] {
  transform: translateX(-108px) rotate(-13deg);
  background-image: url("./media/img-pin-prefer-v-6BJXLG6S.svg");
}
.container[_ngcontent-%COMP%]   .pins[_ngcontent-%COMP%]    > .prevent[_ngcontent-%COMP%] {
  transform: translateX(70px) translateY(10px) rotate(15deg);
  background-image: url("./media/img-pin-prevent-v-A4RVBFLH.svg");
}
.container[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%] {
  flex: 1 1 auto;
  overflow: auto;
  display: flex;
  flex-flow: column;
  align-items: center;
  width: 100%;
}
.container[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  object-fit: contain;
  object-position: center;
  width: 50%;
}
.container[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%], 
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%] {
  width: 100%;
  position: sticky;
  bottom: 0;
  padding: 16px;
}
.container[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  display: flex;
  flex-flow: row nowrap;
  gap: 20px;
  height: fit-content;
  justify-content: center;
}
.container[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%]   .prefer[_ngcontent-%COMP%], 
.container[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%]   .prevent[_ngcontent-%COMP%] {
  display: flex;
  width: 145px;
  height: 145px;
  border-radius: 80px;
  flex-flow: column nowrap;
  align-items: center;
  justify-content: flex-end;
  padding-bottom: 25px;
  gap: 8px;
  animation: _ngcontent-%COMP%_slideInUp2 0.5s ease-out forwards;
  transform: translateY(200%);
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 18px;
  font-weight: 700;
  position: relative;
  background-color: rgba(255, 253, 246, 0.75);
  border: 2px solid black;
  -webkit-backdrop-filter: blur(5px);
  backdrop-filter: blur(5px);
}
.container[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%]   .prefer[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%], 
.container[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%]   .prevent[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%] {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translateX(-50%) translateY(-50%);
  width: 105px;
  height: 28px;
}
.container[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%]   .prefer[_ngcontent-%COMP%] {
  border-color: rgba(105, 140, 255, 0.15);
  color: #0030CC;
}
.container[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%]   .prevent[_ngcontent-%COMP%] {
  border-color: rgba(247, 60, 60, 0.15);
  color: #B50F0F;
  animation-delay: 1s;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  display: flex;
  flex-flow: column nowrap;
  height: fit-content;
  width: 100%;
  padding: 0;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column nowrap;
  align-items: center;
  width: 100%;
  padding: 16px;
  padding-top: 24px;
  background: rgba(255, 253, 246, 0.75);
  -webkit-backdrop-filter: blur(10px);
  backdrop-filter: blur(10px);
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish[_ngcontent-%COMP%]   .pin[_ngcontent-%COMP%] {
  height: 14px;
  width: 52px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  transition: opacity 1s ease-in-out;
  opacity: 0;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish[_ngcontent-%COMP%]   .pin.visible[_ngcontent-%COMP%] {
  opacity: 1;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish[_ngcontent-%COMP%]   .ish-select[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  gap: 8px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish[_ngcontent-%COMP%]   .ish-select[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%] {
  font-weight: 700;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish.prefer[_ngcontent-%COMP%]   .pin[_ngcontent-%COMP%] {
  background-image: url("./media/img-pin-prevent-h-WLA2BAFB.svg");
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish.prefer[_ngcontent-%COMP%]   .ish-select[_ngcontent-%COMP%] {
  color: #B50F0F;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish.prefer[_ngcontent-%COMP%]   .ish-select[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
  font: inherit;
  color: #B50F0F;
  background-color: rgba(247, 60, 60, 0.15);
  width: 24px;
  height: 24px;
  border: 2px solid #B50F0F;
  border-radius: 4px;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish.prefer[_ngcontent-%COMP%]   .ish-select[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked {
  background-color: #B50F0F;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  background-image: url("./media/icon-check-white-FZEHZEKN.svg");
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish.prevent[_ngcontent-%COMP%]   .pin[_ngcontent-%COMP%] {
  background-image: url("./media/img-pin-prefer-h-5YUBVJU6.svg");
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish.prevent[_ngcontent-%COMP%]   .ish-select[_ngcontent-%COMP%] {
  color: #0030CC;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish.prevent[_ngcontent-%COMP%]   .ish-select[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
  font: inherit;
  color: #0030CC;
  background-color: rgba(105, 140, 255, 0.15);
  width: 24px;
  height: 24px;
  border: 2px solid #0030CC;
  border-radius: 4px;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .ish.prevent[_ngcontent-%COMP%]   .ish-select[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked {
  background-color: #0030CC;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  background-image: url("./media/icon-check-white-FZEHZEKN.svg");
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%] {
  padding: 12px 16px;
  display: flex;
  flex-flow: row nowrap;
  gap: 8px;
  align-items: center;
  background-color: #FFFDF6;
  border-top: 1px solid #EDECEC;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .undo[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  gap: 4px;
  padding: 0 8px;
  color: #6C707B;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
}
.container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%] {
  display: flex;
  height: 52px;
  padding: 0px 16px;
  justify-content: center;
  align-items: center;
  gap: 4px;
  flex: 1 0 0;
  border-radius: 16px;
  background: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 700;
}`]});};function rT(n,e){if(n&1){let t=ve();P(0,"div",2),te(1,"div",3),P(2,"div",4),Z("click",function(){let r=X(t).$implicit,o=j();return q(o.submit(r));}),P(3,"span"),N(4),S(),P(5,"span"),N(6),S()()();}if(n&2){let t=e.$implicit,i=j();Et("transform","rotate("+(i.prefer?-1:1)*(100-t.value)*.32+"deg)"),Se("prefer",!!i.prefer)("prevent",!i.prefer),I(),Et("animation-delay",500-t.value*5+1e3,"ms"),Se("dashed",t.dashed),I(3),Ve(t.label),I(2),Ve(t.description);}}var Ah=class n{constructor(e,t){this.state=e;this.api=t;}prefer=!0;done=new Gr();LABELS=[{label:"Verwacht",description:"Zal wel gebeuren",value:100},{label:"Waarschijnlijk",description:"Zou best kunnen",value:75},{label:"Geloofwaardig",description:"Kan ook nog",value:50},{label:"Voorstelbaar",description:"Niet onmogelijk",value:25},{label:"Absurd",description:"Hoogs onwaarschijnlijk",value:0,dashed:!0}];imageUrl=_e(()=>this.state.currentImageUrl()||this.api.item()?.screenshot_url||null);submit(e){let t=e.label,i={plausibility:e.value};this.done.emit({message:t,props:i});}static fac=function(t){return new(t||n)(ue(Ot),ue(rt));};static cmp=Me({type:n,selectors:[["app-collect-properties-potential"]],inputs:{prefer:"prefer"},outputs:{done:"done"},decls:3,vars:0,consts:[[1,"container"],[1,"cone-line",3,"prefer","prevent","transform"],[1,"cone-line"],[1,"string"],[1,"label",3,"click"]],template:function(t,i){t&1&&(P(0,"div",0),ze(1,rT,7,12,"div",1,jt),S()),t&2&&(I(),je(i.LABELS));},styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  align-items: center;
  height: 100%;
  width: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  gap: 15px;
  position: relative;
  padding: 16px 0;
}
.container[_ngcontent-%COMP%]   .cone-line[_ngcontent-%COMP%] {
  position: absolute;
  left: calc(108px - 496px);
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  transform-origin: left center;
}
.container[_ngcontent-%COMP%]   .cone-line.prefer[_ngcontent-%COMP%] {
  bottom: 20px;
}
.container[_ngcontent-%COMP%]   .cone-line.prevent[_ngcontent-%COMP%] {
  top: 20px;
}
.container[_ngcontent-%COMP%]   .cone-line[_ngcontent-%COMP%]   .string[_ngcontent-%COMP%] {
  width: 0px;
  height: 0px;
  border-top: 2px solid currentColor;
  animation: _ngcontent-%COMP%_elongate 0.3s ease-out forwards;
}
.container[_ngcontent-%COMP%]   .cone-line[_ngcontent-%COMP%]   .string.dashed[_ngcontent-%COMP%] {
  border-top-style: dashed;
}
.container[_ngcontent-%COMP%]   .cone-line[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%] {
  padding: 0px 16px;
  height: 62px;
  display: flex;
  flex-flow: column;
  align-items: flex-start;
  justify-content: center;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 18px;
  border-radius: 0px 8px 8px 0px;
  white-space: nowrap;
  border-left: 1px solid currentColor;
}
.container[_ngcontent-%COMP%]   .cone-line[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child {
  font-weight: 700;
}
.container[_ngcontent-%COMP%]   .cone-line[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child {
  font-weight: 400;
}
.container[_ngcontent-%COMP%]   .cone-line.prefer[_ngcontent-%COMP%] {
  color: #698CFF;
}
.container[_ngcontent-%COMP%]   .cone-line.prefer[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%] {
  color: #0030CC;
  background-color: rgba(105, 140, 255, 0.15);
}
.container[_ngcontent-%COMP%]   .cone-line.prevent[_ngcontent-%COMP%] {
  color: #F73C3C;
}
.container[_ngcontent-%COMP%]   .cone-line.prevent[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%] {
  color: #B50F0F;
  background-color: rgba(247, 60, 60, 0.15);
}
@keyframes _ngcontent-%COMP%_elongate {
  from {
    width: 0px;
  }
  to {
    width: 496px;
  }
}`]});};var Fh=class n{done=new Gr();email=G(null);emailSubscribe=G(!0);localStorage=typeof localStorage<"u"?localStorage:null;submit(){let e=this.email();e&&(this.localStorage?.setItem("mapfutures-email",e),this.localStorage?.setItem("mapfutures-email-subscribe",this.emailSubscribe()?"true":"false"),this.done.emit({message:e,props:{_private_email:e,_private_email_subscribe:this.emailSubscribe()}}));}noThanks(){this.done.emit({message:"Nee bedankt",props:{_private_refused_email:!0}});}static fac=function(t){return new(t||n)();};static cmp=Me({type:n,selectors:[["app-collect-email"]],outputs:{done:"done"},decls:16,vars:4,consts:()=>{let e;e="Je e-mail";let t;t="Ik ontvang graag inspiratie voor hoopvol activisme en politieke verbeelding in mijn inbox.";let i;i="Nee bedankt";let r;return r="Stuur link",[["emailEl",""],t,i,r,[1,"container"],[1,"form"],["type","email","placeholder",e,3,"ngModelChange","ngModel"],[1,"opt-in"],["type","checkbox",3,"ngModelChange","ngModel"],["for","emailSubscribe"],[1,"submit-buttons"],[1,"no-thanks",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","25","height","25","viewBox","0 0 25 25","fill","none"],["d","M13.9546 2.06738C14.5011 2.11022 15.027 2.30271 15.4741 2.625C15.985 2.99323 16.3668 3.51288 16.5659 4.11035L16.8823 5.05859H20.6616C21.2139 5.05859 21.6616 5.50631 21.6616 6.05859C21.6616 6.61088 21.2139 7.05859 20.6616 7.05859H19.5923L18.7241 19.2012C18.6881 19.7054 18.4621 20.1769 18.0923 20.5215C17.7685 20.8232 17.3555 21.0083 16.9185 21.0498L16.73 21.0586H8.59033C8.08508 21.0578 7.59852 20.866 7.229 20.5215C6.8596 20.1769 6.63415 19.705 6.59814 19.2012L5.73096 7.05859H4.66162C4.10934 7.05859 3.66162 6.61088 3.66162 6.05859C3.66162 5.50631 4.10934 5.05859 4.66162 5.05859H8.44092L8.75732 4.11035L8.84033 3.89062C9.05369 3.38591 9.40127 2.94726 9.84814 2.625C10.3588 2.25678 10.9725 2.05882 11.6021 2.05859H13.7192L13.9546 2.06738ZM8.59326 19.0586H16.729L17.5874 7.05859H7.73486L8.59326 19.0586ZM9.95459 10.3516C10.3207 9.98545 10.8997 9.96285 11.2925 10.2832L11.3687 10.3516L12.6616 11.6445L13.9546 10.3516L14.0308 10.2832C14.4235 9.96285 15.0025 9.98545 15.3687 10.3516C15.7348 10.7177 15.7574 11.2967 15.437 11.6895L15.3687 11.7656L14.0757 13.0586L15.3687 14.3516L15.437 14.4277C15.7574 14.8205 15.7348 15.3995 15.3687 15.7656C15.0025 16.1317 14.4235 16.1543 14.0308 15.834L13.9546 15.7656L12.6616 14.4727L11.3687 15.7656L11.2925 15.834C10.8997 16.1543 10.3207 16.1317 9.95459 15.7656C9.58847 15.3995 9.56588 14.8205 9.88623 14.4277L9.95459 14.3516L11.2476 13.0586L9.95459 11.7656L9.88623 11.6895C9.56588 11.2967 9.58847 10.7177 9.95459 10.3516ZM11.4468 4.07129C11.2928 4.09567 11.1457 4.15508 11.0181 4.24707C10.848 4.36973 10.7212 4.54327 10.6548 4.74219V4.74316L10.5493 5.05859H14.7739L14.6685 4.74316V4.74219C14.6021 4.54323 14.4753 4.36973 14.3052 4.24707C14.1773 4.15493 14.0297 4.09556 13.8755 4.07129L13.7202 4.05859H11.603L11.4468 4.07129Z","fill","#6C707B"],[1,"submit",3,"click"]];},template:function(t,i){if(t&1){let r=ve();P(0,"div",4)(1,"div",5)(2,"input",6,0),tt("ngModelChange",function(s){return X(r),et(i.email,s)||(i.email=s),q(s);}),S(),P(4,"div",7)(5,"input",8),tt("ngModelChange",function(s){return X(r),et(i.emailSubscribe,s)||(i.emailSubscribe=s),q(s);}),S(),P(6,"label",9),be(7,1),S()()(),P(8,"div",10)(9,"div",11),Z("click",function(){return X(r),q(i.noThanks());}),ke(),P(10,"svg",12),te(11,"path",13),S(),Ye(),P(12,"span"),be(13,2),S()(),P(14,"div",14),Z("click",function(){X(r);let s=$i(3);return q(i.email()&&s.validity.valid?i.submit():null);}),be(15,3),S()()();}if(t&2){let r=$i(3);I(2),Qe("ngModel",i.email),I(3),Qe("ngModel",i.emailSubscribe),I(9),Se("enabled",i.email()&&r.validity.valid);}},dependencies:[on,Hi,Bs,On,Tn],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: flex-end;
  height: 100%;
  width: 100%;
  gap: 14px;
}
.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%] {
  padding: 0 32px;
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: flex-end;
  gap: 14px;
}
.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%] {
  height: 56px;
  width: 100%;
  padding: 8px 24px;
  border-radius: 16px;
  border: 2px solid #B969FF;
  background: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
  color: #4E02B2;
}
.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]:placeholder-shown {
  color: #6C707B;
}
.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .opt-in[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: row nowrap;
  align-items: flex-start;
  gap: 8px;
  padding: 0 8px;
}
.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .opt-in[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] {
  flex: 0 0 auto;
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
  font: inherit;
  color: #6C707B;
  background-color: rgba(108, 112, 123, 0.15);
  width: 24px;
  height: 24px;
  border: 2px solid #6C707B;
  border-radius: 4px;
}
.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .opt-in[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked {
  background-color: #6C707B;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  background-image: url("./media/icon-check-white-FZEHZEKN.svg");
}
.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .opt-in[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  color: #6C707B;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
}
.container[_ngcontent-%COMP%]   .submit-buttons[_ngcontent-%COMP%] {
  padding: 12px 16px;
  display: flex;
  flex-flow: row nowrap;
  gap: 8px;
  justify-content: center;
  border-top: 1px solid #EDECEC;
  width: 100%;
}
.container[_ngcontent-%COMP%]   .submit-buttons[_ngcontent-%COMP%]   .no-thanks[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: row nowrap;
  white-space: nowrap;
  padding: 0px 8px;
  align-items: center;
  gap: 4px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
  color: #6C707B;
}
.container[_ngcontent-%COMP%]   .submit-buttons[_ngcontent-%COMP%]   .no-thanks[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  width: 24px;
  height: 24px;
}
.container[_ngcontent-%COMP%]   .submit-buttons[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%] {
  display: flex;
  height: 52px;
  padding: 0px 16px;
  justify-content: center;
  align-items: center;
  flex: 1 1 auto;
  width: 100%;
  border-radius: 16px;
  background: #EDECEC;
  color: #6C707B;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  font-weight: 400;
}
.container[_ngcontent-%COMP%]   .submit-buttons[_ngcontent-%COMP%]   .submit.enabled[_ngcontent-%COMP%] {
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}`]});};var Rh=class n{constructor(e){this.api=e;}showOnMapLink=_e(()=>{let e=this.api.workspaceId(),t=this.api.itemId(),i=this.api.api_key(),r=this.api.locale;return!e||!t||!i?"/":`${r==="en"?"":`/${r}`}/showcase-ws?workspace=${e}&api_key=${i}#${t}`;});onShowOnMap(e){let t=this.showOnMapLink();if(typeof window<"u"&&window.self!==window.top&&window.parent){e.preventDefault(),window.parent.postMessage({type:"show-on-map",itemId:this.api.itemId(),workspaceId:this.api.workspaceId(),apiKey:this.api.api_key(),source:"sidebar-iframe"},"*");return;}typeof window<"u"&&window.top?window.top.location.href=t:window.location.href=t;}static fac=function(t){return new(t||n)(ue(rt));};static cmp=Me({type:n,selectors:[["app-direct-to-map"]],decls:8,vars:1,consts:()=>{let e;return e="Show on map",[e,[1,"container"],["ltr","",1,"buttons"],[1,"button","primary",3,"click","href"],["xmlns","http://www.w3.org/2000/svg","width","25","height","24","viewBox","0 0 25 24","fill","none"],["d","M16.25 6.99872V16.4987M9.25 16.9987V8.49872M4.271 6.71472L8.824 4.23171C8.95671 4.15924 9.10414 4.11781 9.25517 4.11053C9.40621 4.10326 9.55693 4.13033 9.696 4.18972L15.804 6.80772C15.9431 6.8671 16.0938 6.89417 16.2448 6.8869C16.3959 6.87962 16.5433 6.83819 16.676 6.76572L20.271 4.80572C20.4233 4.7226 20.5946 4.68055 20.7681 4.68369C20.9416 4.68684 21.1113 4.73506 21.2605 4.82364C21.4097 4.91221 21.5333 5.03808 21.6191 5.18887C21.7049 5.33967 21.75 5.5102 21.75 5.68372V16.4047C21.75 16.5844 21.7017 16.7607 21.61 16.9152C21.5183 17.0697 21.3867 17.1967 21.229 17.2827L16.676 19.7657C16.5433 19.8382 16.3959 19.8796 16.2448 19.8869C16.0938 19.8942 15.9431 19.8671 15.804 19.8077L9.696 17.1887C9.55693 17.1293 9.40621 17.1023 9.25517 17.1095C9.10414 17.1168 8.95671 17.1582 8.824 17.2307L5.229 19.1907C5.07676 19.2738 4.90554 19.3158 4.73214 19.3127C4.55874 19.3096 4.38913 19.2615 4.23996 19.1731C4.09079 19.0846 3.96718 18.9589 3.88128 18.8082C3.79538 18.6575 3.75014 18.4871 3.75 18.3137V7.59371C3.74997 7.41406 3.79833 7.23772 3.89001 7.08322C3.98169 6.92872 4.1133 6.80077 4.271 6.71472Z","stroke","#ffffff","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"]];},template:function(t,i){t&1&&(P(0,"div",1),te(1,"app-completion-image"),P(2,"div",2)(3,"a",3),Z("click",function(o){return i.onShowOnMap(o);}),ke(),P(4,"svg",4),te(5,"path",5),S(),Ye(),P(6,"span"),be(7,0),S()()()()),t&2&&(I(3),K("href",i.showOnMapLink(),Ue));},dependencies:[Qs],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.container[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: flex-end;
  height: 100%;
  width: 100%;
  position: relative;
}
.container[_ngcontent-%COMP%]   app-completion-image[_ngcontent-%COMP%] {
  position: absolute;
  top: 32px;
  left: 0;
  width: 100%;
  height: 100%;
}
.container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] {
  padding: 12px 16px;
  width: 100%;
  position: fixed;
  bottom: 0;
  z-index: 1;
  background-color: #FFFDF6;
  border-top: 1px solid #EDECEC;
}`]});};function oT(n,e){if(n&1){let t=ve();P(0,"app-collect-properties-favorable",6),Z("done",function(r){X(t);let o=j();return q(o.completeStep(r));}),S();}}function sT(n,e){if(n&1){let t=ve();P(0,"app-collect-properties-potential",7),Z("done",function(r){X(t);let o=j();return q(o.completeStep(r));}),S();}if(n&2){let t=j();K("prefer",!!t.prefer());}}function aT(n,e){if(n&1){let t=ve();P(0,"app-collect-email",6),Z("done",function(r){X(t);let o=j();return q(o.completeStep(r));}),S();}}function lT(n,e){if(n&1&&te(0,"app-complete-evaluation",5),n&2){j();let t=$i(2);K("thinking",t.thinking());}}function cT(n,e){n&1&&te(0,"app-direct-to-map");}var Lh=class n{constructor(e,t,i){this.api=e;this.route=t;this.router=i;this.api.updateFromRoute(this.route.snapshot),this.fragment.set(this.route.snapshot.fragment||null),console.log("FRAGMENT",this.fragment()),at(()=>{let r=this.messages?.messages()||[],o=this.actualSteps(),s=o.length*2-1;if(r.length===s-1){let l=o[o.length-1],c=new _n("ai",l.instructions.replace(":TAGLINE:",this.api.item()?.future_scenario_tagline||"").replace(":EMAIL:",this.api.item()?._private_email||""));this.messages.addMessage(c);}}),at(()=>{let r=this.step(),o=this.api.item();!this.stepInitialized()&&this.viewInit()&&r===-1&&o&&(this.stepInitialized.set(!0),console.log("Step is -1, adding first step"),jn(0).subscribe(()=>J(this,null,function*(){yield this.addStep();})));});}messages;step=G(-1);actualSteps=G([]);steps=[{id:0,instructions:"Is dit een toekomst die je **wenst**, of **vreest**?",skip:()=>this.api.item()?.favorable_future?{}:this.api.isWorkshop()?(console.log("Skipping favorable future step, workshop mode"),{}):null},{id:1,instructions:"En kun je beoordelen hoe waarschijnlijk deze toekomst is?",skip:()=>{let e=this.api.item()?.plausibility;return e!=null&&e>=0?(console.log("Skipping potential step, already set",e),{}):this.api.isWorkshop()?(console.log("Skipping potential step, workshop mode"),{}):(console.log("Potential step not skipped, not set",e),null);}},{id:2,instructions:"Begrepen. Bedankt!\n\nWe analyseren momenteel je screenshot en voegen deze toe aan de Futures Map. Als het klaar is, sturen we je een **link** per **e-mail** zodat je je screenshot altijd kunt vinden, bewerken of verwijderen van de Futures Map.",skip:()=>{let e=this.api.item()?._private_email,t=this.api.item()?._private_refused_email;if(e||t)return{};e=this.localStorage?.getItem("mapfutures-email");let i=this.localStorage?.getItem("mapfutures-email-subscribe")==="true";return e?(this.emailFromStorage=!0,{_private_email:e,_private_email_subscribe:i}):(this.emailRequested=!0,null);}},{id:10,instructions:"",skip:()=>{let e=this.api.itemId(),t=this.api.itemKey(),i=this.api.item();if(i&&!i.author_id){let o=this.getOrGenerateAuthorId();this.propsUpdate.update(s=>Object.assign({},s,{author_id:o}));}let r=this.propsUpdate();if(console.log("CONSIDERING IF UPDATE IS NEEDED",r),e&&t)for(let o in r){this.api.item.update(s=>Object.assign({},s,r)),console.log("Updating item with props:",r),this.messages.thinking.set(!0),this.api.uploadImageInProgress.pipe(Vt(s=>s===!1),$n(()=>this.api.updateItem(r,e,t)),st(()=>{this.messages.thinking.set(!1);})).subscribe();break;}return this.propsUpdate.set({}),{};}},{id:11,instructions:"Perfect! Helemaal klaar.\n\nVerwacht binnenkort een e-mail van **MapFutur.es!**",skip:()=>{let e=this.api.item();return this.emailRequested&&e&&e._private_email?null:{};}},{id:12,instructions:"Begrepen. Bedankt!\n\nWe sturen een andere **link** naar :EMAIL: zodra deze screenshot aan de Futures Map is toegevoegd.",skip:()=>this.emailFromStorage?null:{}},{id:13,instructions:"Je verliest de mogelijkheid om je screenshot te bewerken, te volgen of te verwijderen, maar we zullen er zorgvuldig mee omgaan. **Bedankt**!",skip:()=>{let e=this.api.item();return this.emailRequested&&e&&e._private_refused_email?null:{};}},{id:20,instructions:"",skip:()=>!this.api.isWorkshopFollowup()&&!this.api.isWorkshop()?(console.log("Skipping potential step, not in workshop mode"),{}):(this.router.navigate(["/discuss"],{queryParamsHandling:"preserve"}),null)},{id:21,instructions:"Mooi!\n\nWe hebben \u201C:TAGLINE:\u201D aan de Futures Map toegevoegd!\n\n**Wil je het zien?**",skip:()=>this.api.itemKey()&&this.fragment()==="publish"?null:{}},{id:22,instructions:"We hebben \u201C:TAGLINE:\u201D aan de Futures Map toegevoegd!\n\n**Wil je het zien?**",skip:()=>this.api.itemKey()&&this.fragment()==="publish"?{}:null}];propsUpdate=G({});prefer=_e(()=>this.propsUpdate()?.favorable_future.indexOf("prefer")>=0);viewInit=G(!1);stepInitialized=G(!1);fragment=G(null);emailRequested=!1;emailFromStorage=!1;localStorage=typeof localStorage<"u"?localStorage:null;ngAfterViewInit(){this.viewInit.set(!0);}getOrGenerateAuthorId(){let e=this.localStorage?.getItem("future_screenshots_author_id");return e||(e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),this.localStorage?.setItem("future_screenshots_author_id",e)),e;}addStep(){return J(this,null,function*(){let e=this.actualSteps(),t=e.length>0?e[e.length-1].id:-1;for(let i=0;i<this.steps.length;i++){let r=this.steps[i];if(r.id>t){if(r.skip){let o=yield r.skip();if(console.log("Step ID",r.id,"skipped with props?",o),o!==null){this.propsUpdate.update(s=>Object.assign({},s,o));continue;}}console.log("Adding step",r.id,"with instructions",r.instructions),this.actualSteps.update(o=>[...o,r]),this.step.set(r.id);return;}}console.log("No more steps to add, setting step to 99"),this.step.set(99);});}completeStep(e){this.messages.addMessage(new _n("human",e.message)),this.propsUpdate.update(t=>Object.assign({},t,e.props)),this.step.set(99),jn(2e3).subscribe(()=>J(this,null,function*(){yield this.addStep();}));}static fac=function(t){return new(t||n)(ue(rt),ue(Ct),ue(gt));};static cmp=Me({type:n,selectors:[["app-collect-properties"]],viewQuery:function(t,i){if(t&1&&Pt(Ci,5),t&2){let r;wt(r=Mt())&&(i.messages=r.first);}},decls:9,vars:1,consts:[["messages",""],[1,"flow-shell"],["ngSkipHydration",""],[1,"spacer"],[3,"prefer"],[3,"thinking"],[3,"done"],[3,"done","prefer"]],template:function(t,i){t&1&&(P(0,"div",1)(1,"app-messages",2,0)(3,"div",3),ge(4,oT,1,0,"app-collect-properties-favorable")(5,sT,1,1,"app-collect-properties-potential",4)(6,aT,1,0,"app-collect-email")(7,lT,1,1,"app-complete-evaluation",5)(8,cT,1,0,"app-direct-to-map"),S()()()),t&2&&(I(4),he(i.step()===0?4:i.step()===1?5:i.step()===2?6:i.step()>10&&i.step()<20?7:i.step()>=20&&i.step()<30?8:-1));},dependencies:[Ci,Ih,Ah,Fh,ea,Rh],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
.spacer[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  overflow: visible;
}
.spacer[_ngcontent-%COMP%]    > *[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  overflow: visible;
}
.flow-shell[_ngcontent-%COMP%] {
  position: relative;
  width: 100%;
  max-width: 520px;
  height: 100%;
  max-height: 900px;
  display: flex;
  flex-direction: column;
  justify-content: stretch;
  margin: 0 auto;
}
@media (min-width: 900px) {
  .flow-shell[_ngcontent-%COMP%] {
    height: 90vh;
  }
}`]});};var e1=()=>{};var i1=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128);}return e;},hT=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63);}else if(r>239&&r<365){let o=n[t++],s=n[t++],l=n[t++],c=((r&7)<<18|(o&63)<<12|(s&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023));}else{let o=n[t++],s=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|s&63);}}return e.join("");},Dh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/=";},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_.";},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let o=n[r],s=r+1<n.length,l=s?n[r+1]:0,c=r+2<n.length,d=c?n[r+2]:0,u=o>>2,g=(o&3)<<4|l>>4,f=(l&15)<<2|d>>6,m=d&63;c||(m=64,s||(f=64)),i.push(t[u],t[g],t[f],t[m]);}return i.join("");},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(i1(n),e);},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):hT(this.decodeStringToByteArray(n,e));},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let o=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;let d=r<n.length?t[n.charAt(r)]:64;++r;let g=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||l==null||d==null||g==null)throw new wf();let f=o<<2|l>>4;if(i.push(f),d!==64){let m=l<<4&240|d>>2;if(i.push(m),g!==64){let _=d<<6&192|g;i.push(_);}}}return i;},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n);}}},wf=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError";}},dT=function(n){let e=i1(n);return Dh.encodeByteArray(e,!0);},Sf=function(n){return dT(n).replace(/\./g,"");},Nh=function(n){try{return Dh.decodeString(n,!0);}catch(e){console.error("base64Decode failed: ",e);}return null;};function r1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.");}var uT=()=>r1().__FIREBASE_DEFAULTS__,pT=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n);},fT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/);}catch{return;}let e=n&&Nh(n[1]);return e&&JSON.parse(e);},Ef=()=>{try{return e1()||uT()||pT()||fT();}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return;}},o1=n=>{var e,t;return(t=(e=Ef())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n];};var Of=()=>{var n;return(n=Ef())===null||n===void 0?void 0:n.config;},Tf=n=>{var e;return(e=Ef())===null||e===void 0?void 0:e[`_${n}`];};var Uo=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t;});}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i));};}};function ml(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev");}catch{return!1;}}function s1(n){return J(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok;});}var gl={};function gT(){let n={prod:[],emulator:[]};for(let e of Object.keys(gl))gl[e]?n.emulator.push(e):n.prod.push(e);return n;}function mT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e};}var t1=!1;function a1(n,e){if(typeof window>"u"||typeof document>"u"||!ml(window.location.host)||gl[n]===e||gl[n]||t1)return;gl[n]=e;function t(f){return`__firebase__banner__${f}`;}let i="__firebase__banner",o=gT().prod.length>0;function s(){let f=document.getElementById(i);f&&f.remove();}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center";}function c(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px";}function d(){let f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{t1=!0,s();},f;}function u(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline";}function g(){let f=mT(i),m=t("text"),_=document.getElementById(m)||document.createElement("span"),y=t("learnmore"),E=document.getElementById(y)||document.createElement("a"),C=t("preprendIcon"),b=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){let x=f.element;l(x),u(E,y);let w=d();c(b,C),x.append(b,_,E,w),document.body.appendChild(x);}o?(_.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",m);}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g();}function ln(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:"";}function l1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ln());}function c1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers";}function h1(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0;}function d1(){return typeof navigator=="object"&&navigator.product==="ReactNative";}function u1(){let n=ln();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0;}function Bh(){try{return typeof indexedDB=="object";}catch{return!1;}}function p1(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0);},r.onupgradeneeded=()=>{t=!1;},r.onerror=()=>{var o;e(((o=r.error)===null||o===void 0?void 0:o.message)||"");};}catch(t){e(t);}});}var _T="FirebaseError",bi=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=_T,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xi.prototype.create);}},xi=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i;}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],s=o?vT(o,i):"Error",l=`${this.serviceName}: ${s} (${r}).`;return new bi(r,l,i);}};function vT(n,e){return n.replace(yT,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`;});}var yT=/\{\$([^}]+)}/g;function f1(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0;}function eo(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let o=n[r],s=e[r];if(n1(o)&&n1(s)){if(!eo(o,s))return!1;}else if(o!==s)return!1;}for(let r of i)if(!t.includes(r))return!1;return!0;}function n1(n){return n!==null&&typeof n=="object";}function na(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):"";}function g1(n,e){let t=new Mf(n,e);return t.subscribe.bind(t);}var Mf=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this);}).catch(i=>{this.error(i);});}next(e){this.forEachObserver(t=>{t.next(e);});}error(e){this.forEachObserver(t=>{t.error(e);}),this.close(e);}complete(){this.forEachObserver(e=>{e.complete();}),this.close();}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");CT(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Pf),r.error===void 0&&(r.error=Pf),r.complete===void 0&&(r.complete=Pf);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete();}catch{}}),this.observers.push(r),o;}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this));}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e);}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e]);}catch(i){typeof console<"u"&&console.error&&console.error(i);}});}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0;}));}};function CT(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1;}function Pf(){}var zj=4*60*60*1e3;function to(n){return n&&n._delegate?n._delegate:n;}var Yn=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null;}setInstantiationMode(e){return this.instantiationMode=e,this;}setMultipleInstances(e){return this.multipleInstances=e,this;}setServiceProps(e){return this.serviceProps=e,this;}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this;}};var Ho="[DEFAULT]";var kf=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map(),this.instancesDeferred=new Map(),this.instancesOptions=new Map(),this.onInitCallbacks=new Map();}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Uo();if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r);}catch{}}return this.instancesDeferred.get(t).promise;}getImmediate(e){var t;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i});}catch(o){if(r)return null;throw o;}else{if(r)return null;throw Error(`Service ${this.name} is not available`);}}getComponent(){return this.component;}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xT(e))try{this.getOrInitializeService({instanceIdentifier:Ho});}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o);}catch{}}}}clearInstance(e=Ho){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e);}delete(){return J(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())]);});}isComponentSet(){return this.component!=null;}isInitialized(e=Ho){return this.instances.has(e);}getOptions(e=Ho){return this.instancesOptions.get(e)||{};}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[o,s]of this.instancesDeferred.entries()){let l=this.normalizeInstanceIdentifier(o);i===l&&s.resolve(r);}return r;}onInit(e,t){var i;let r=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set();o.add(e),this.onInitCallbacks.set(r,o);let s=this.instances.get(r);return s&&e(s,r),()=>{o.delete(e);};}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t);}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:bT(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i);}catch{}return i||null;}normalizeInstanceIdentifier(e=Ho){return this.component?this.component.multipleInstances?e:Ho:e;}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT";}};function bT(n){return n===Ho?void 0:n;}function xT(n){return n.instantiationMode==="EAGER";}var Vh=class{constructor(e){this.name=e,this.providers=new Map();}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e);}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e);}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new kf(e,this);return this.providers.set(e,t),t;}getProviders(){return Array.from(this.providers.values());}};var PT=[],ut=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n;}(ut||{}),wT={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},MT=ut.INFO,ST={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},ET=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=ST[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);},no=class{constructor(e){this.name=e,this._logLevel=MT,this._logHandler=ET,this._userLogHandler=null,PT.push(this);}get logLevel(){return this._logLevel;}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e;}setLogLevel(e){this._logLevel=typeof e=="string"?wT[e]:e;}get logHandler(){return this._logHandler;}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e;}get userLogHandler(){return this._userLogHandler;}set userLogHandler(e){this._userLogHandler=e;}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e);}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e);}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e);}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e);}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e);}};var OT=(n,e)=>e.some(t=>n instanceof t),m1,_1;function TT(){return m1||(m1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]);}function kT(){return _1||(_1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]);}var v1=new WeakMap(),Af=new WeakMap(),y1=new WeakMap(),If=new WeakMap(),Rf=new WeakMap();function IT(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s);},o=()=>{t(Qi(n.result)),r();},s=()=>{i(n.error),r();};n.addEventListener("success",o),n.addEventListener("error",s);});return e.then(t=>{t instanceof IDBCursor&&v1.set(t,n);}).catch(()=>{}),Rf.set(e,n),e;}function AT(n){if(Af.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s);},o=()=>{t(),r();},s=()=>{i(n.error||new DOMException("AbortError","AbortError")),r();};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s);});Af.set(n,e);}var Ff={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Af.get(n);if(e==="objectStoreNames")return n.objectStoreNames||y1.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0]);}return Qi(n[e]);},set(n,e,t){return n[e]=t,!0;},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n;}};function C1(n){Ff=n(Ff);}function FT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(zh(this),e,...t);return y1.set(i,e.sort?e.sort():[e]),Qi(i);}:kT().includes(n)?function(...e){return n.apply(zh(this),e),Qi(v1.get(this));}:function(...e){return Qi(n.apply(zh(this),e));};}function RT(n){return typeof n=="function"?FT(n):(n instanceof IDBTransaction&&AT(n),OT(n,TT())?new Proxy(n,Ff):n);}function Qi(n){if(n instanceof IDBRequest)return IT(n);if(If.has(n))return If.get(n);let e=RT(n);return e!==n&&(If.set(n,e),Rf.set(e,n)),e;}var zh=n=>Rf.get(n);function x1(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){let s=indexedDB.open(n,e),l=Qi(s);return i&&s.addEventListener("upgradeneeded",c=>{i(Qi(s.result),c.oldVersion,c.newVersion,Qi(s.transaction),c);}),t&&s.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),r&&c.addEventListener("versionchange",d=>r(d.oldVersion,d.newVersion,d));}).catch(()=>{}),l;}var LT=["get","getKey","getAll","getAllKeys","count"],DT=["put","add","delete","clear"],Lf=new Map();function b1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Lf.get(e))return Lf.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=DT.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||LT.includes(t)))return;let o=function(s,...l){return J(this,null,function*(){let c=this.transaction(s,r?"readwrite":"readonly"),d=c.store;return i&&(d=d.index(l.shift())),(yield Promise.all([d[t](...l),r&&c.done]))[0];});};return Lf.set(e,o),o;}C1(n=>se(D({},n),{get:(e,t,i)=>b1(e,t)||n.get(e,t,i),has:(e,t)=>!!b1(e,t)||n.has(e,t)}));var Nf=class{constructor(e){this.container=e;}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(NT(t)){let i=t.getImmediate();return`${i.library}/${i.version}`;}else return null;}).filter(t=>t).join(" ");}};function NT(n){let e=n.getComponent();return e?.type==="VERSION";}var Bf="@firebase/app",P1="0.13.2";var xr=new no("@firebase/app"),BT="@firebase/app-compat",VT="@firebase/analytics-compat",zT="@firebase/analytics",jT="@firebase/app-check-compat",$T="@firebase/app-check",UT="@firebase/auth",HT="@firebase/auth-compat",WT="@firebase/database",GT="@firebase/data-connect",YT="@firebase/database-compat",XT="@firebase/functions",qT="@firebase/functions-compat",ZT="@firebase/installations",KT="@firebase/installations-compat",JT="@firebase/messaging",QT="@firebase/messaging-compat",e2="@firebase/performance",t2="@firebase/performance-compat",n2="@firebase/remote-config",i2="@firebase/remote-config-compat",r2="@firebase/storage",o2="@firebase/storage-compat",s2="@firebase/firestore",a2="@firebase/ai",l2="@firebase/firestore-compat",c2="firebase",h2="11.10.0";var Vf="[DEFAULT]",d2={[Bf]:"fire-core",[BT]:"fire-core-compat",[zT]:"fire-analytics",[VT]:"fire-analytics-compat",[$T]:"fire-app-check",[jT]:"fire-app-check-compat",[UT]:"fire-auth",[HT]:"fire-auth-compat",[WT]:"fire-rtdb",[GT]:"fire-data-connect",[YT]:"fire-rtdb-compat",[XT]:"fire-fn",[qT]:"fire-fn-compat",[ZT]:"fire-iid",[KT]:"fire-iid-compat",[JT]:"fire-fcm",[QT]:"fire-fcm-compat",[e2]:"fire-perf",[t2]:"fire-perf-compat",[n2]:"fire-rc",[i2]:"fire-rc-compat",[r2]:"fire-gcs",[o2]:"fire-gcs-compat",[s2]:"fire-fst",[l2]:"fire-fst-compat",[a2]:"fire-vertex","fire-js":"fire-js",[c2]:"fire-js-all"};var _l=new Map(),u2=new Map(),zf=new Map();function w1(n,e){try{n.container.addComponent(e);}catch(t){xr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t);}}function Pr(n){let e=n.name;if(zf.has(e))return xr.debug(`There were multiple attempts to register component ${e}.`),!1;zf.set(e,n);for(let t of _l.values())w1(t,n);for(let t of u2.values())w1(t,n);return!0;}function jh(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e);}function Pi(n){return n==null?!1:n.settings!==void 0;}var p2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},io=new xi("app","Firebase",p2);var jf=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Yn("app",()=>this,"PUBLIC"));}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled;}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e;}get name(){return this.checkDestroyed(),this._name;}get options(){return this.checkDestroyed(),this._options;}get config(){return this.checkDestroyed(),this._config;}get container(){return this._container;}get isDeleted(){return this._isDeleted;}set isDeleted(e){this._isDeleted=e;}checkDestroyed(){if(this.isDeleted)throw io.create("app-deleted",{appName:this._name});}};var ia=h2;function Hf(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=Object.assign({name:Vf,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw io.create("bad-app-name",{appName:String(r)});if(t||(t=Of()),!t)throw io.create("no-options");let o=_l.get(r);if(o){if(eo(t,o.options)&&eo(i,o.config))return o;throw io.create("duplicate-app",{appName:r});}let s=new Vh(r);for(let c of zf.values())s.addComponent(c);let l=new jf(t,i,s);return _l.set(r,l),l;}function yl(n=Vf){let e=_l.get(n);if(!e&&n===Vf&&Of())return Hf();if(!e)throw io.create("no-app",{appName:n});return e;}function $h(){return Array.from(_l.values());}function en(n,e,t){var i;let r=(i=d2[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);let o=r.match(/\s|\//),s=e.match(/\s|\//);if(o||s){let l=[`Unable to register library "${r}" with version "${e}":`];o&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&s&&l.push("and"),s&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xr.warn(l.join(" "));return;}Pr(new Yn(`${r}-version`,()=>({library:r,version:e}),"VERSION"));}var f2="firebase-heartbeat-database",g2=1,vl="firebase-heartbeat-store",Df=null;function O1(){return Df||(Df=x1(f2,g2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(vl);}catch(t){console.warn(t);}}}}).catch(n=>{throw io.create("idb-open",{originalErrorMessage:n.message});})),Df;}function m2(n){return J(this,null,function*(){try{let t=(yield O1()).transaction(vl),i=yield t.objectStore(vl).get(T1(n));return yield t.done,i;}catch(e){if(e instanceof bi)xr.warn(e.message);else{let t=io.create("idb-get",{originalErrorMessage:e?.message});xr.warn(t.message);}}});}function M1(n,e){return J(this,null,function*(){try{let i=(yield O1()).transaction(vl,"readwrite");yield i.objectStore(vl).put(e,T1(n)),yield i.done;}catch(t){if(t instanceof bi)xr.warn(t.message);else{let i=io.create("idb-set",{originalErrorMessage:t?.message});xr.warn(i.message);}}});}function T1(n){return`${n.name}!${n.options.appId}`;}var _2=1024,v2=30,$f=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Uf(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i));}triggerHeartbeat(){return J(this,null,function*(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=S1();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:r}),this._heartbeatsCache.heartbeats.length>v2){let s=C2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1);}return this._storage.overwrite(this._heartbeatsCache);}catch(i){xr.warn(i);}});}getHeartbeatsHeader(){return J(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=S1(),{heartbeatsToSend:i,unsentEntries:r}=y2(this._heartbeatsCache.heartbeats),o=Sf(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o;}catch(t){return xr.warn(t),"";}});}};function S1(){return new Date().toISOString().substring(0,10);}function y2(n,e=_2){let t=[],i=n.slice();for(let r of n){let o=t.find(s=>s.agent===r.agent);if(o){if(o.dates.push(r.date),E1(t)>e){o.dates.pop();break;}}else if(t.push({agent:r.agent,dates:[r.date]}),E1(t)>e){t.pop();break;}i=i.slice(1);}return{heartbeatsToSend:t,unsentEntries:i};}var Uf=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck();}runIndexedDBEnvironmentCheck(){return J(this,null,function*(){return Bh()?p1().then(()=>!0).catch(()=>!1):!1;});}read(){return J(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield m2(this.app);return t?.heartbeats?t:{heartbeats:[]};}else return{heartbeats:[]};});}overwrite(e){return J(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return M1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats});}else return;});}add(e){return J(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return M1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]});}else return;});}};function E1(n){return Sf(JSON.stringify({version:2,heartbeats:n})).length;}function C2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e;}function b2(n){Pr(new Yn("platform-logger",e=>new Nf(e),"PRIVATE")),Pr(new Yn("heartbeat",e=>new $f(e),"PRIVATE")),en(Bf,P1,n),en(Bf,P1,"esm2017"),en("fire-js","");}b2("");var x2="firebase",P2="11.10.0";en(x2,P2,"app");var oa=new M0("ANGULARFIRE2_VERSION");function Wf(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(s=>s.app===t);if(o.length===1)return o[0];}return t.container.getProvider(n).getImmediate({optional:!0});}var Hh=(n,e)=>{let t=e?[e]:$h(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(s=>{i.includes(s)||i.push(s);});}),i;},ra=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n;}(ra||{}),k1=sp()&&typeof Zone<"u"?ra.WARN:ra.SILENT;var Uh=class{zone;delegate;constructor(e,t=c0){this.zone=e,this.delegate=t;}now(){return this.delegate.now();}schedule(e,t,i){let r=this.zone,o=function(s){r?r.runGuarded(()=>{e.apply(this,[s]);}):e.apply(this,[s]);};return this.delegate.schedule(o,t,i);}},sa=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=zt(Yr);this.outsideAngular=t.runOutsideAngular(()=>new Uh(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Uh(typeof Zone>"u"?void 0:Zone.current,l0));}static fac=function(i){return new(i||n)();};static prov=tn({token:n,factory:n.fac,providedIn:"root"});}return n;})(),I1=!1;function w2(n,e){!I1&&(k1>ra.SILENT||sp())&&(I1=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),k1>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`);}function M2(n){let e=zt(Yr,{optional:!0});return e?e.runOutsideAngular(()=>n()):n();}function Wo(n){let e=zt(Yr,{optional:!0});return e?e.run(()=>n()):n();}var S2=(n,e,t)=>(...i)=>(e&&setTimeout(e,0),Pc(t,()=>Wo(()=>n.apply(void 0,i)))),aa=(n,e,t)=>(t||=e?ra.WARN:ra.VERBOSE,function(){let i,r=arguments,o,s,l;try{o=zt(sa),s=zt(wc),l=zt(f0);}catch{return w2(n,t),n.apply(this,r);}for(let d=0;d<arguments.length;d++)typeof r[d]=="function"&&(e&&(i||=Wo(()=>s.add())),r[d]=S2(r[d],i,l));let c=M2(()=>n.apply(this,r));return e?c instanceof Ur?c.pipe(ep(o.outsideAngular),Qu(o.insideAngular),xf(l)):c instanceof Promise?Wo(()=>new Promise((d,u)=>{s.run(()=>c).then(g=>Pc(l,()=>Wo(()=>d(g))),g=>Pc(l,()=>Wo(()=>u(g))));})):typeof c=="function"&&i?function(){return setTimeout(i,0),c.apply(this,arguments);}:Wo(()=>c):c instanceof Ur?c.pipe(ep(o.outsideAngular),Qu(o.insideAngular)):Wo(()=>c);});var Go=class{constructor(e){return e;}},Cl=class{constructor(){return $h();}};function E2(n){return n&&n.length===1?n[0]:new Go(yl());}var Gf=new bc("angularfire2._apps"),O2={provide:Go,useFactory:E2,deps:[[new To(),Gf]]},T2={provide:Cl,deps:[[new To(),Gf]]};function k2(n){return(e,t)=>{let i=t.get(m0);en("angularfire",oa.full,"core"),en("angularfire",oa.full,"app"),en("angular",Wa.full,i.toString());let r=e.runOutsideAngular(()=>n(t));return new Go(r);};}function A1(n,...e){return xc([O2,T2,{provide:Gf,useFactory:k2(n),multi:!0,deps:[Yr,Wr,sa,...e]}]);}var F1=aa(Hf,!0);var I2=new Map(),A2={activated:!1,tokenObservers:[]},F2={initialized:!1,enabled:!1};function wi(n){return I2.get(n)||Object.assign({},A2);}function N1(){return F2;}var R2="https://content-firebaseappcheck.googleapis.com/v1";var L2="exchangeDebugToken",R1={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},D$=24*60*60*1e3;var qf=class{constructor(e,t,i,r,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=r,r>o)throw new Error("Proactive refresh lower bound greater than upper bound!");}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{});}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null);}isRunning(){return!!this.pending;}process(e){return J(this,null,function*(){this.stop();try{this.pending=new Uo(),this.pending.promise.catch(t=>{}),yield D2(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Uo(),this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{});}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop();}});}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t;}}};function D2(n){return new Promise(e=>{setTimeout(e,n);});}var N2={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},ro=new xi("appCheck","AppCheck",N2);function B1(n){if(!wi(n).activated)throw ro.create("use-before-activation",{appName:n.name});}function V1(i,r){return J(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let m=yield s.getHeartbeatsHeader();m&&(o["X-Firebase-Client"]=m);}let l={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,l);}catch(m){throw ro.create("fetch-network-error",{originalErrorMessage:m?.message});}if(c.status!==200)throw ro.create("fetch-status-error",{httpStatus:c.status});let d;try{d=yield c.json();}catch(m){throw ro.create("fetch-parse-error",{originalErrorMessage:m?.message});}let u=d.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw ro.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let g=Number(u[1])*1e3,f=Date.now();return{token:d.token,expireTimeMillis:f+g,issuedAtTimeMillis:f};});}function z1(n,e){let{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${R2}/projects/${t}/apps/${i}:${L2}?key=${r}`,body:{debug_token:e}};}var B2="firebase-app-check-database",V2=1,Zf="firebase-app-check-store";var Wh=null;function z2(){return Wh||(Wh=new Promise((n,e)=>{try{let t=indexedDB.open(B2,V2);t.onsuccess=i=>{n(i.target.result);},t.onerror=i=>{var r;e(ro.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}));},t.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(Zf,{keyPath:"compositeKey"});}};}catch(t){e(ro.create("storage-open",{originalErrorMessage:t?.message}));}}),Wh);}function j2(n,e){return $2(U2(n),e);}function $2(n,e){return J(this,null,function*(){let i=(yield z2()).transaction(Zf,"readwrite"),o=i.objectStore(Zf).put({compositeKey:n,value:e});return new Promise((s,l)=>{o.onsuccess=c=>{s();},i.onerror=c=>{var d;l(ro.create("storage-set",{originalErrorMessage:(d=c.target.error)===null||d===void 0?void 0:d.message}));};});});}function U2(n){return`${n.options.appId}-${n.name}`;}var bl=new no("@firebase/app-check");function Yf(n,e){return Bh()?j2(n,e).catch(t=>{bl.warn(`Failed to write token to IndexedDB. Error: ${t}`);}):Promise.resolve();}function j1(){return N1().enabled;}function $1(){return J(this,null,function*(){let n=N1();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `);});}var H2={error:"UNKNOWN_ERROR"};function W2(n){return Dh.encodeString(JSON.stringify(n),!1);}function Kf(n,e=!1,t=!1){return J(this,null,function*(){let i=n.app;B1(i);let r=wi(i),o=r.token,s;if(o&&!xl(o)&&(r.token=void 0,o=void 0),!o){let d=yield r.cachedTokenPromise;d&&(xl(d)?o=d:yield Yf(i,void 0));}if(!e&&o&&xl(o))return{token:o.token};let l=!1;if(j1())try{r.exchangeTokenPromise||(r.exchangeTokenPromise=V1(z1(i,yield $1()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0;}),l=!0);let d=yield r.exchangeTokenPromise;return yield Yf(i,d),r.token=d,{token:d.token};}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?bl.warn(d.message):t&&bl.error(d),Xf(d);}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0;}),l=!0),o=yield wi(i).exchangeTokenPromise;}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?bl.warn(d.message):t&&bl.error(d),s=d;}let c;return o?s?xl(o)?c={token:o.token,internalError:s}:c=Xf(s):(c={token:o.token},r.token=o,yield Yf(i,o)):c=Xf(s),l&&q2(i,c),c;});}function G2(n){return J(this,null,function*(){let e=n.app;B1(e);let{provider:t}=wi(e);if(j1()){let i=yield $1(),{token:r}=yield V1(z1(e,i),n.heartbeatServiceProvider);return{token:r};}else{let{token:i}=yield t.getToken();return{token:i};}});}function Y2(n,e,t,i){let{app:r}=n,o=wi(r),s={next:t,error:i,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&xl(o.token)){let l=o.token;Promise.resolve().then(()=>{t({token:l.token}),L1(n);}).catch(()=>{});}o.cachedTokenPromise.then(()=>L1(n));}function U1(n,e){let t=wi(n),i=t.tokenObservers.filter(r=>r.next!==e);i.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i;}function L1(n){let{app:e}=n,t=wi(e),i=t.tokenRefresher;i||(i=X2(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start();}function X2(n){let{app:e}=n;return new qf(()=>J(null,null,function*(){let t=wi(e),i;if(t.token?i=yield Kf(n,!0):i=yield Kf(n),i.error)throw i.error;if(i.internalError)throw i.internalError;}),()=>!0,()=>{let t=wi(e);if(t.token){let i=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now());}else return 0;},R1.RETRIAL_MIN_WAIT,R1.RETRIAL_MAX_WAIT);}function q2(n,e){let t=wi(n).tokenObservers;for(let i of t)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e);}catch{}}function xl(n){return n.expireTimeMillis-Date.now()>0;}function Xf(n){return{token:W2(H2),error:n};}var Jf=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t;}_delete(){let{tokenObservers:e}=wi(this.app);for(let t of e)U1(this.app,t.next);return Promise.resolve();}};function Z2(n,e){return new Jf(n,e);}function K2(n){return{getToken:e=>Kf(n,e),getLimitedUseToken:()=>G2(n),addTokenListener:e=>Y2(n,"INTERNAL",e),removeTokenListener:e=>U1(n.app,e)};}var J2="@firebase/app-check",Q2="0.10.1";var ek="app-check",D1="app-check-internal";function tk(){Pr(new Yn(ek,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Z2(e,t);},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(D1).initialize();})),Pr(new Yn(D1,n=>{let e=n.getProvider("app-check").getImmediate();return K2(e);},"PUBLIC").setInstantiationMode("EXPLICIT")),en(J2,Q2);}tk();var nk="app-check";var Gh=class{constructor(){return Hh(nk);}};var ik=["localhost","0.0.0.0","127.0.0.1"],q$=typeof window<"u"&&ik.includes(window.location.hostname);function rC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."};}var oC=rC,sC=new xi("auth","Firebase",rC());var Jh=new no("@firebase/auth");function rk(n,...e){Jh.logLevel<=ut.WARN&&Jh.warn(`Auth (${ia}): ${n}`,...e);}function Xh(n,...e){Jh.logLevel<=ut.ERROR&&Jh.error(`Auth (${ia}): ${n}`,...e);}function tr(n,...e){throw mg(n,...e);}function Mi(n,...e){return mg(n,...e);}function gg(n,e,t){let i=Object.assign(Object.assign({},oC()),{[e]:t});return new xi("auth","Firebase",i).create(e,{appName:n.name});}function Yo(n){return gg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp");}function ok(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&tr(n,"argument-error"),gg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`);}function mg(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i);}return sC.create(n,...e);}function Le(n,e,...t){if(!n)throw mg(e,...t);}function wr(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Xh(e),new Error(e);}function Sr(n,e){n||wr(e);}function tg(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||"";}function sk(){return H1()==="http:"||H1()==="https:";}function H1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null;}function ak(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sk()||h1()||"connection"in navigator)?navigator.onLine:!0;}function lk(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null;}var Xo=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Sr(t>e,"Short delay should be less than long delay!"),this.isMobile=l1()||d1();}get(){return ak()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay);}};function _g(n,e){Sr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t;}var Qh=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i);}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill");}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill");}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill");}};var ck={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var hk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],dk=new Xo(3e4,6e4);function vg(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e;}function ca(o,s,l,c){return J(this,arguments,function*(n,e,t,i,r={}){return aC(n,r,()=>J(null,null,function*(){let d={},u={};i&&(e==="GET"?u=i:d={body:JSON.stringify(i)});let g=na(Object.assign({key:n.config.apiKey},u)).slice(1),f=yield n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);let m=Object.assign({method:e,headers:f},d);return c1()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&ml(n.emulatorConfig.host)&&(m.credentials="include"),Qh.fetch()(yield lC(n,n.config.apiHost,t,g),m);}));});}function aC(n,e,t){return J(this,null,function*(){n._canInitEmulator=!1;let i=Object.assign(Object.assign({},ck),e);try{let r=new ng(n),o=yield Promise.race([t(),r.promise]);r.clearNetworkTimeout();let s=yield o.json();if("needConfirmation"in s)throw Yh(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let l=o.ok?s.errorMessage:s.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yh(n,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Yh(n,"email-already-in-use",s);if(c==="USER_DISABLED")throw Yh(n,"user-disabled",s);let u=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw gg(n,u,d);tr(n,u);}}catch(r){if(r instanceof bi)throw r;tr(n,"network-request-failed",{message:String(r)});}});}function uk(o,s,l,c){return J(this,arguments,function*(n,e,t,i,r={}){let d=yield ca(n,e,t,i,r);return"mfaPendingCredential"in d&&tr(n,"multi-factor-auth-required",{_serverResponse:d}),d;});}function lC(n,e,t,i){return J(this,null,function*(){let r=`${e}${t}?${i}`,o=n,s=o.config.emulator?_g(n.config,r):`${n.config.apiScheme}://${r}`;return hk.includes(t)&&(yield o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s;});}var ng=class{clearNetworkTimeout(){clearTimeout(this.timer);}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Mi(this.auth,"network-request-failed")),dk.get());});}};function Yh(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=Mi(n,e,i);return r.customData._tokenResponse=t,r;}function pk(n,e){return J(this,null,function*(){return ca(n,"POST","/v1/accounts:delete",e);});}function ed(n,e){return J(this,null,function*(){return ca(n,"POST","/v1/accounts:lookup",e);});}function Pl(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString();}catch{}}function yg(n,e=!1){return J(this,null,function*(){let t=to(n),i=yield t.getIdToken(e),r=Cg(i);Le(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let o=typeof r.firebase=="object"?r.firebase:void 0,s=o?.sign_in_provider;return{claims:r,token:i,authTime:Pl(Qf(r.auth_time)),issuedAtTime:Pl(Qf(r.iat)),expirationTime:Pl(Qf(r.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null};});}function Qf(n){return Number(n)*1e3;}function Cg(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Xh("JWT malformed, contained fewer than 3 sections"),null;try{let r=Nh(t);return r?JSON.parse(r):(Xh("Failed to decode base64 JWT payload"),null);}catch(r){return Xh("Caught error parsing JWT payload as JSON",r?.toString()),null;}}function W1(n){let e=Cg(n);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat);}function Ml(n,e,t=!1){return J(this,null,function*(){if(t)return e;try{return yield e;}catch(i){throw i instanceof bi&&fk(i)&&n.auth.currentUser===n&&(yield n.auth.signOut()),i;}});}function fk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired";}var ig=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4;}_start(){this.isRunning||(this.isRunning=!0,this.schedule());}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId));}getInterval(e){var t;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i;}else{this.errorBackoff=3e4;let r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r);}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>J(this,null,function*(){yield this.iteration();}),t);}iteration(){return J(this,null,function*(){try{yield this.user.getIdToken(!0);}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return;}this.schedule();});}};var Sl=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime();}_initializeTime(){this.lastSignInTime=Pl(this.lastLoginAt),this.creationTime=Pl(this.createdAt);}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime();}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt};}};function td(n){return J(this,null,function*(){var e;let t=n.auth,i=yield n.getIdToken(),r=yield Ml(n,ed(t,{idToken:i}));Le(r?.users.length,t,"internal-error");let o=r.users[0];n._notifyReloadListener(o);let s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?cC(o.providerUserInfo):[],l=gk(n.providerData,s),c=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!l?.length,u=c?d:!1,g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Sl(o.createdAt,o.lastLoginAt),isAnonymous:u};Object.assign(n,g);});}function bg(n){return J(this,null,function*(){let e=to(n);yield td(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e);});}function gk(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e];}function cC(n){return n.map(e=>{var{providerId:t}=e,i=yc(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null};});}function mk(n,e){return J(this,null,function*(){let t=yield aC(n,{},()=>J(null,null,function*(){let i=na({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,s=yield lC(n,r,"/v1/token",`key=${o}`),l=yield n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:l,body:i};return n.emulatorConfig&&ml(n.emulatorConfig.host)&&(c.credentials="include"),Qh.fetch()(s,c);}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token};});}function _k(n,e){return J(this,null,function*(){return ca(n,"POST","/v2/accounts:revokeToken",vg(n,e));});}var wl=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null;}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4;}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):W1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t);}updateFromIdToken(e){Le(e.length!==0,"internal-error");let t=W1(e);this.updateTokensAndExpiration(e,null,t);}getToken(e,t=!1){return J(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null);});}clearRefreshToken(){this.refreshToken=null;}refresh(e,t){return J(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:o}=yield mk(e,t);this.updateTokensAndExpiration(i,r,Number(o));});}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3;}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:o}=t,s=new n();return i&&(Le(typeof i=="string","internal-error",{appName:e}),s.refreshToken=i),r&&(Le(typeof r=="string","internal-error",{appName:e}),s.accessToken=r),o&&(Le(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s;}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime};}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime;}_clone(){return Object.assign(new n(),this.toJSON());}_performRefresh(){return wr("not implemented");}};function oo(n,e){Le(typeof n=="string"||typeof n>"u","internal-error",{appName:e});}var so=class n{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,o=yc(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ig(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Sl(o.createdAt||void 0,o.lastLoginAt||void 0);}getIdToken(e){return J(this,null,function*(){let t=yield Ml(this,this.stsTokenManager.getToken(this.auth,e));return Le(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t;});}getIdTokenResult(e){return yg(this,e);}reload(){return bg(this);}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager));}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t;}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null);}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e;}_startProactiveRefresh(){this.proactiveRefresh._start();}_stopProactiveRefresh(){this.proactiveRefresh._stop();}_updateTokensIfNecessary(e,t=!1){return J(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield td(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this);});}delete(){return J(this,null,function*(){if(Pi(this.auth.app))return Promise.reject(Yo(this.auth));let e=yield this.getIdToken();return yield Ml(this,pk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut();});}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name});}get refreshToken(){return this.stsTokenManager.refreshToken||"";}static _fromJSON(e,t){var i,r,o,s,l,c,d,u;let g=(i=t.displayName)!==null&&i!==void 0?i:void 0,f=(r=t.email)!==null&&r!==void 0?r:void 0,m=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,_=(s=t.photoURL)!==null&&s!==void 0?s:void 0,y=(l=t.tenantId)!==null&&l!==void 0?l:void 0,E=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,C=(d=t.createdAt)!==null&&d!==void 0?d:void 0,b=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:x,emailVerified:w,isAnonymous:T,providerData:R,stsTokenManager:V}=t;Le(x&&V,e,"internal-error");let B=wl.fromJSON(this.name,V);Le(typeof x=="string",e,"internal-error"),oo(g,e.name),oo(f,e.name),Le(typeof w=="boolean",e,"internal-error"),Le(typeof T=="boolean",e,"internal-error"),oo(m,e.name),oo(_,e.name),oo(y,e.name),oo(E,e.name),oo(C,e.name),oo(b,e.name);let Y=new n({uid:x,auth:e,email:f,emailVerified:w,displayName:g,isAnonymous:T,photoURL:_,phoneNumber:m,tenantId:y,stsTokenManager:B,createdAt:C,lastLoginAt:b});return R&&Array.isArray(R)&&(Y.providerData=R.map(le=>Object.assign({},le))),E&&(Y._redirectEventId=E),Y;}static _fromIdTokenResponse(e,t,i=!1){return J(this,null,function*(){let r=new wl();r.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield td(o),o;});}static _fromGetAccountInfoResponse(e,t,i){return J(this,null,function*(){let r=t.users[0];Le(r.localId!==void 0,"internal-error");let o=r.providerUserInfo!==void 0?cC(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!o?.length,l=new wl();l.updateFromIdToken(i);let c=new n({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:s}),d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Sl(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!o?.length};return Object.assign(c,d),c;});}};var G1=new Map();function Mr(n){Sr(n instanceof Function,"Expected a class definition");let e=G1.get(n);return e?(Sr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n(),G1.set(n,e),e);}var vk=(()=>{class n{constructor(){this.type="NONE",this.storage={};}_isAvailable(){return J(this,null,function*(){return!0;});}_set(t,i){return J(this,null,function*(){this.storage[t]=i;});}_get(t){return J(this,null,function*(){let i=this.storage[t];return i===void 0?null:i;});}_remove(t){return J(this,null,function*(){delete this.storage[t];});}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n;})(),rg=vk;function qh(n,e,t){return`firebase:${n}:${e}:${t}`;}var nd=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:o}=this.auth;this.fullUserKey=qh(this.userKey,r.apiKey,o),this.fullPersistenceKey=qh("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler);}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON());}getCurrentUser(){return J(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield ed(this.auth,{idToken:e}).catch(()=>{});return t?so._fromGetAccountInfoResponse(this.auth,t,e):null;}return so._fromJSON(this.auth,e);});}removeCurrentUser(){return this.persistence._remove(this.fullUserKey);}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type);}setPersistence(e){return J(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t);});}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler);}static create(e,t,i="authUser"){return J(this,null,function*(){if(!t.length)return new n(Mr(rg),e,i);let r=(yield Promise.all(t.map(d=>J(null,null,function*(){if(yield d._isAvailable())return d;})))).filter(d=>d),o=r[0]||Mr(rg),s=qh(i,e.config.apiKey,e.name),l=null;for(let d of t)try{let u=yield d._get(s);if(u){let g;if(typeof u=="string"){let f=yield ed(e,{idToken:u}).catch(()=>{});if(!f)break;g=yield so._fromGetAccountInfoResponse(e,f,u);}else g=so._fromJSON(e,u);d!==o&&(l=g),o=d;break;}}catch{}let c=r.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new n(o,e,i):(o=c[0],l&&(yield o._set(s,l.toJSON())),yield Promise.all(t.map(d=>J(null,null,function*(){if(d!==o)try{yield d._remove(s);}catch{}}))),new n(o,e,i));});}};function Y1(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gC(e))return"Blackberry";if(mC(e))return"Webos";if(dC(e))return"Safari";if((e.includes("chrome/")||uC(e))&&!e.includes("edge/"))return"Chrome";if(fC(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1];}return"Other";}function hC(n=ln()){return /firefox\//i.test(n);}function dC(n=ln()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android");}function uC(n=ln()){return /crios\//i.test(n);}function pC(n=ln()){return /iemobile/i.test(n);}function fC(n=ln()){return /android/i.test(n);}function gC(n=ln()){return /blackberry/i.test(n);}function mC(n=ln()){return /webos/i.test(n);}function xg(n=ln()){return /iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n);}function yk(n=ln()){var e;return xg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone);}function Ck(){return u1()&&document.documentMode===10;}function _C(n=ln()){return xg(n)||fC(n)||mC(n)||gC(n)||/windows phone/i.test(n)||pC(n);}function vC(n,e=[]){let t;switch(n){case"Browser":t=Y1(ln());break;case"Worker":t=`${Y1(ln())}-${n}`;break;default:t=n;}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ia}/${i}`;}var og=class{constructor(e){this.auth=e,this.queue=[];}pushCallback(e,t){let i=o=>new Promise((s,l)=>{try{let c=e(o);s(c);}catch(c){l(c);}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve();};}runMiddleware(e){return J(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)yield i(e),i.onAbort&&t.push(i.onAbort);}catch(i){t.reverse();for(let r of t)try{r();}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message});}});}};function bk(t){return J(this,arguments,function*(n,e={}){return ca(n,"GET","/v2/passwordPolicy",vg(n,e));});}var xk=6,sg=class{constructor(e){var t,i,r,o;let s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=s.minPasswordLength)!==null&&t!==void 0?t:xk,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion;}validatePassword(e){var t,i,r,o,s,l;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(i=c.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsLowercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(o=c.containsUppercaseLetter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(s=c.containsNumericCharacter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c;}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r);}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i));}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o));}};var ag=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new id(this),this.idTokenSubscription=new id(this),this.beforeStateQueue=new og(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o);}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mr(t)),this._initializationPromise=this.queue(()=>J(this,null,function*(){var i,r,o;if(!this._deleted&&(this.persistenceManager=yield nd.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this);}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0);}})),this._initializationPromise;}_onStorageEvent(){return J(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return;}yield this._updateCurrentUser(e,!0);}});}initializeCurrentUserFromIdToken(e){return J(this,null,function*(){try{let t=yield ed(this,{idToken:e}),i=yield so._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(i);}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null);}});}initializeCurrentUser(e){return J(this,null,function*(){var t;if(Pi(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(l,l));}):this.directlySetCurrentUser(null);}let i=yield this.assertedPersistence.getCurrentUser(),r=i,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let s=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=r?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!s||s===l)&&c?.user&&(r=c.user,o=!0);}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(r);}catch(s){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s));}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null);}return Le(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r);});}tryRedirectSignIn(e){return J(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0);}catch{yield this._setRedirectUser(null);}return t;});}reloadAndSetCurrentUserOrClear(e){return J(this,null,function*(){try{yield td(e);}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null);}return this.directlySetCurrentUser(e);});}useDeviceLanguage(){this.languageCode=lk();}_delete(){return J(this,null,function*(){this._deleted=!0;});}updateCurrentUser(e){return J(this,null,function*(){if(Pi(this.app))return Promise.reject(Yo(this));let t=e?to(e):null;return t&&Le(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this));});}_updateCurrentUser(e,t=!1){return J(this,null,function*(){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>J(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners();}));});}signOut(){return J(this,null,function*(){return Pi(this.app)?Promise.reject(Yo(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0));});}setPersistence(e){return Pi(this.app)?Promise.reject(Yo(this)):this.queue(()=>J(this,null,function*(){yield this.assertedPersistence.setPersistence(Mr(e));}));}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId];}validatePassword(e){return J(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e);});}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId];}_updatePasswordPolicy(){return J(this,null,function*(){let e=yield bk(this),t=new sg(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t;});}_getPersistenceType(){return this.assertedPersistence.persistence.type;}_getPersistence(){return this.assertedPersistence.persistence;}_updateErrorMap(e){this._errorFactory=new xi("auth","Firebase",e());}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i);}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t);}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i);}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e();},t);}});}revokeAccessToken(e){return J(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),yield _k(this,i);}});}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()};}_setRedirectUser(e,t){return J(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e);});}getOrInitRedirectPersistenceManager(e){return J(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Mr(e)||this._popupRedirectResolver;Le(t,this,"argument-error"),this.redirectPersistenceManager=yield nd.create(this,[Mr(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser();}return this.redirectPersistenceManager;});}_redirectUserForId(e){return J(this,null,function*(){var t,i;return this._isInitialized&&(yield this.queue(()=>J(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null;});}_persistUserIfCurrent(e){return J(this,null,function*(){if(e===this.currentUser)return this.queue(()=>J(this,null,function*(){return this.directlySetCurrentUser(e);}));});}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners();}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`;}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh();}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh();}get _currentUser(){return this.currentUser;}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser));}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(l,this,"internal-error"),l.then(()=>{s||o(this.currentUser);}),typeof t=="function"){let c=e.addObserver(t,i,r);return()=>{s=!0,c();};}else{let c=e.addObserver(t);return()=>{s=!0,c();};}}directlySetCurrentUser(e){return J(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser();});}queue(e){return this.operations=this.operations.then(e,e),this.operations;}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager;}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vC(this.config.clientPlatform,this._getFrameworks()));}_getFrameworks(){return this.frameworks;}_getAdditionalHeaders(){return J(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(t["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t;});}_getAppCheckToken(){return J(this,null,function*(){var e;if(Pi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&rk(`Error while retrieving App Check token: ${t.error}`),t?.token;});}};function dd(n){return to(n);}var id=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=g1(t=>this.observer=t);}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer);}};var Pg={loadJS(){return J(this,null,function*(){throw new Error("Unable to load external scripts");});},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Pk(n){Pg=n;}function wk(n){return Pg.loadJS(n);}function Mk(){return Pg.gapiScript;}function yC(n){return`__${n}${Math.floor(Math.random()*1e6)}`;}function wg(n,e){let t=jh(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),o=t.getOptions();if(eo(o,e??{}))return r;tr(r,"already-initialized");}return t.initialize({options:e});}function Sk(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Mr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver);}function Mg(n,e,t){let i=dd(n);Le(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,o=CC(e),{host:s,port:l}=Ek(e),c=l===null?"":`:${l}`,d={url:`${o}//${s}${c}/`},u=Object.freeze({host:s,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Le(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Le(eo(d,i.config.emulator)&&eo(u,i.emulatorConfig),i,"emulator-config-failed");return;}i.config.emulator=d,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,ml(s)?(s1(`${o}//${s}${c}`),a1("Auth",!0)):r||Ok();}function CC(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1);}function Ek(n){let e=CC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let o=r[1];return{host:o,port:X1(i.substr(o.length+1))};}else{let[o,s]=i.split(":");return{host:o,port:X1(s)};}}function X1(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e;}function Ok(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e);}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n());}var El=class{constructor(e,t){this.providerId=e,this.signInMethod=t;}toJSON(){return wr("not implemented");}_getIdTokenResponse(e){return wr("not implemented");}_linkToIdToken(e,t){return wr("not implemented");}_getReauthenticationResolver(e){return wr("not implemented");}};function la(n,e){return J(this,null,function*(){return uk(n,"POST","/v1/accounts:signInWithIdp",vg(n,e));});}var Tk="http://localhost",rd=class n extends El{constructor(){super(...arguments),this.pendingToken=null;}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):tr("argument-error"),t;}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod};}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,o=yc(t,["providerId","signInMethod"]);if(!i||!r)return null;let s=new n(i,r);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s;}_getIdTokenResponse(e){let t=this.buildRequest();return la(e,t);}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,la(e,i);}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,la(e,t);}buildRequest(){let e={requestUri:Tk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=na(t);}return e;}};var Ol=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={};}setDefaultLanguage(e){this.defaultLanguageCode=e;}setCustomParameters(e){return this.customParameters=e,this;}getCustomParameters(){return this.customParameters;}};var od=class extends Ol{constructor(){super(...arguments),this.scopes=[];}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this;}getScopes(){return[...this.scopes];}};var Sg=(()=>{class n extends od{constructor(){super("google.com"),this.addScope("profile");}static credential(t,i){return rd._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i});}static credentialFromResult(t){return n.credentialFromTaggedObject(t);}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{});}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r);}catch{return null;}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n;})();var Tl=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType;}static _fromIdTokenResponse(e,t,i,r=!1){return J(this,null,function*(){let o=yield so._fromIdTokenResponse(e,i,r),s=q1(i);return new n({user:o,providerId:s,_tokenResponse:i,operationType:t});});}static _forOperation(e,t,i){return J(this,null,function*(){yield e._updateTokensIfNecessary(i,!0);let r=q1(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t});});}};function q1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null;}var lg=class n extends bi{constructor(e,t,i,r){var o;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:i};}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r);}};function bC(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?lg._fromErrorAndOperation(n,o,e,i):o;});}function kk(n,e,t=!1){return J(this,null,function*(){let i=yield Ml(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Tl._forOperation(n,"link",i);});}function Ik(n,e,t=!1){return J(this,null,function*(){let{auth:i}=n;if(Pi(i.app))return Promise.reject(Yo(i));let r="reauthenticate";try{let o=yield Ml(n,bC(i,r,e,n),t);Le(o.idToken,i,"internal-error");let s=Cg(o.idToken);Le(s,i,"internal-error");let{sub:l}=s;return Le(n.uid===l,i,"user-mismatch"),Tl._forOperation(n,r,o);}catch(o){throw o?.code==="auth/user-not-found"&&tr(i,"user-mismatch"),o;}});}function Ak(n,e,t=!1){return J(this,null,function*(){if(Pi(n.app))return Promise.reject(Yo(n));let i="signIn",r=yield bC(n,i,e),o=yield Tl._fromIdTokenResponse(n,i,r);return t||(yield n._updateCurrentUser(o.user)),o;});}function Eg(n,e,t,i){return to(n).onIdTokenChanged(e,t,i);}function Og(n,e,t){return to(n).beforeAuthStateChanged(e,t);}var sd="__sak";var ad=class{constructor(e,t){this.storageRetriever=e,this.type=t;}_isAvailable(){try{return this.storage?(this.storage.setItem(sd,"1"),this.storage.removeItem(sd),Promise.resolve(!0)):Promise.resolve(!1);}catch{return Promise.resolve(!1);}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve();}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null);}_remove(e){return this.storage.removeItem(e),Promise.resolve();}get storage(){return this.storageRetriever();}};var Fk=1e3,Rk=10,Lk=(()=>{class n extends ad{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_C(),this._shouldAllowMigration=!0;}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),o=this.localCache[i];r!==o&&t(i,o,r);}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((l,c,d)=>{this.notifyListeners(l,d);});return;}let r=t.key;i?this.detachListener():this.stopPolling();let o=()=>{let l=this.storage.getItem(r);!i&&this.localCache[r]===l||this.notifyListeners(r,l);},s=this.storage.getItem(r);Ck()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,Rk):o();}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i&&JSON.parse(i));}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0);});},Fk);}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null);}attachListener(){window.addEventListener("storage",this.boundEventHandler);}detachListener(){window.removeEventListener("storage",this.boundEventHandler);}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set(),this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i);}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling());}_set(t,i){return J(this,null,function*(){yield Mo(n.prototype,this,"_set").call(this,t,i),this.localCache[t]=JSON.stringify(i);});}_get(t){return J(this,null,function*(){let i=yield Mo(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(i),i;});}_remove(t){return J(this,null,function*(){yield Mo(n.prototype,this,"_remove").call(this,t),delete this.localCache[t];});}}return n.type="LOCAL",n;})(),xC=Lk;var Dk=(()=>{class n extends ad{constructor(){super(()=>window.sessionStorage,"SESSION");}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n;})(),Tg=Dk;function Nk(n){return Promise.all(n.map(e=>J(null,null,function*(){try{return{fulfilled:!0,value:yield e};}catch(t){return{fulfilled:!1,reason:t};}})));}var Bk=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this);}static _getInstance(t){let i=this.receivers.find(o=>o.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r;}isListeningto(t){return this.eventTarget===t;}handleEvent(t){return J(this,null,function*(){let i=t,{eventId:r,eventType:o,data:s}=i.data,l=this.handlersMap[o];if(!l?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:o});let c=Array.from(l).map(u=>J(this,null,function*(){return u(i.origin,s);})),d=yield Nk(c);i.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:d});});}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set()),this.handlersMap[t].add(i);}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler);}}n.receivers=[];return n;})();function kg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t;}var cg=class{constructor(e){this.target=e,this.handlers=new Set();}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e);}_send(e,t,i=50){return J(this,null,function*(){let r=typeof MessageChannel<"u"?new MessageChannel():null;if(!r)throw new Error("connection_unavailable");let o,s;return new Promise((l,c)=>{let d=kg("",20);r.port1.start();let u=setTimeout(()=>{c(new Error("unsupported_event"));},i);s={messageChannel:r,onMessage(g){let f=g;if(f.data.eventId===d)switch(f.data.status){case"ack":clearTimeout(u),o=setTimeout(()=>{c(new Error("timeout"));},3e3);break;case"done":clearTimeout(o),l(f.data.response);break;default:clearTimeout(u),clearTimeout(o),c(new Error("invalid_response"));break;}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[r.port2]);}).finally(()=>{s&&this.removeMessageHandler(s);});});}};function er(){return window;}function Vk(n){er().location.href=n;}function PC(){return typeof er().WorkerGlobalScope<"u"&&typeof er().importScripts=="function";}function zk(){return J(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active;}catch{return null;}});}function jk(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null;}function $k(){return PC()?self:null;}var wC="firebaseLocalStorageDb",Uk=1,ld="firebaseLocalStorage",MC="fbase_key",qo=class{constructor(e){this.request=e;}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result);}),this.request.addEventListener("error",()=>{t(this.request.error);});});}};function ud(n,e){return n.transaction([ld],e?"readwrite":"readonly").objectStore(ld);}function Hk(){let n=indexedDB.deleteDatabase(wC);return new qo(n).toPromise();}function hg(){let n=indexedDB.open(wC,Uk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error);}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(ld,{keyPath:MC});}catch(r){t(r);}}),n.addEventListener("success",()=>J(null,null,function*(){let i=n.result;i.objectStoreNames.contains(ld)?e(i):(i.close(),yield Hk(),e(yield hg()));}));});}function Z1(n,e,t){return J(this,null,function*(){let i=ud(n,!0).put({[MC]:e,value:t});return new qo(i).toPromise();});}function Wk(n,e){return J(this,null,function*(){let t=ud(n,!1).get(e),i=yield new qo(t).toPromise();return i===void 0?null:i.value;});}function K1(n,e){let t=ud(n,!0).delete(e);return new qo(t).toPromise();}var Gk=800,Yk=3,Xk=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{});}_openDb(){return J(this,null,function*(){return this.db?this.db:(this.db=yield hg(),this.db);});}_withRetries(t){return J(this,null,function*(){let i=0;for(;;)try{let r=yield this._openDb();return yield t(r);}catch(r){if(i++>Yk)throw r;this.db&&(this.db.close(),this.db=void 0);}});}initializeServiceWorkerMessaging(){return J(this,null,function*(){return PC()?this.initializeReceiver():this.initializeSender();});}initializeReceiver(){return J(this,null,function*(){this.receiver=Bk._getInstance($k()),this.receiver._subscribe("keyChanged",(t,i)=>J(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(i.key)};})),this.receiver._subscribe("ping",(t,i)=>J(this,null,function*(){return["keyChanged"];}));});}initializeSender(){return J(this,null,function*(){var t,i;if(this.activeServiceWorker=yield zk(),!this.activeServiceWorker)return;this.sender=new cg(this.activeServiceWorker);let r=yield this.sender._send("ping",{},800);r&&!((t=r[0])===null||t===void 0)&&t.fulfilled&&!((i=r[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0);});}notifyServiceWorker(t){return J(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||jk()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);}catch{}});}_isAvailable(){return J(this,null,function*(){try{if(!indexedDB)return!1;let t=yield hg();return yield Z1(t,sd,"1"),yield K1(t,sd),!0;}catch{}return!1;});}_withPendingWrite(t){return J(this,null,function*(){this.pendingWrites++;try{yield t();}finally{this.pendingWrites--;}});}_set(t,i){return J(this,null,function*(){return this._withPendingWrite(()=>J(this,null,function*(){return yield this._withRetries(r=>Z1(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t);}));});}_get(t){return J(this,null,function*(){let i=yield this._withRetries(r=>Wk(r,t));return this.localCache[t]=i,i;});}_remove(t){return J(this,null,function*(){return this._withPendingWrite(()=>J(this,null,function*(){return yield this._withRetries(i=>K1(i,t)),delete this.localCache[t],this.notifyServiceWorker(t);}));});}_poll(){return J(this,null,function*(){let t=yield this._withRetries(o=>{let s=ud(o,!1).getAll();return new qo(s).toPromise();});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set();if(t.length!==0)for(let{fbase_key:o,value:s}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),i.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),i.push(o));return i;});}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let o of Array.from(r))o(i);}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>J(this,null,function*(){return this._poll();}),Gk);}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null);}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set(),this._get(t)),this.listeners[t].add(i);}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling();}}return n.type="LOCAL",n;})(),SC=Xk;var oU=yC("rcb"),sU=new Xo(3e4,6e4);function EC(n,e){return e?Mr(e):(Le(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver);}var kl=class extends El{constructor(e){super("custom","custom"),this.params=e;}_getIdTokenResponse(e){return la(e,this._buildIdpRequest());}_linkToIdToken(e,t){return la(e,this._buildIdpRequest(t));}_getReauthenticationResolver(e){return la(e,this._buildIdpRequest());}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t;}};function qk(n){return Ak(n.auth,new kl(n),n.bypassAuthState);}function Zk(n){let{auth:e,user:t}=n;return Le(t,e,"internal-error"),Ik(t,new kl(n),n.bypassAuthState);}function Kk(n){return J(this,null,function*(){let{auth:e,user:t}=n;return Le(t,e,"internal-error"),kk(t,new kl(n),n.bypassAuthState);});}var cd=class{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t];}execute(){return new Promise((e,t)=>J(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this);}catch(i){this.reject(i);}}));}onAuthEvent(e){return J(this,null,function*(){let{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:s,type:l}=e;if(s){this.reject(s);return;}let c={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(l)(c));}catch(d){this.reject(d);}});}onError(e){this.reject(e);}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return qk;case"linkViaPopup":case"linkViaRedirect":return Kk;case"reauthViaPopup":case"reauthViaRedirect":return Zk;default:tr(this.auth,"internal-error");}}resolve(e){Sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp();}reject(e){Sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp();}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp();}};var Jk=new Xo(2e3,1e4);function Ig(n,e,t){return J(this,null,function*(){if(Pi(n.app))return Promise.reject(Mi(n,"operation-not-supported-in-this-environment"));let i=dd(n);ok(n,e,Ol);let r=EC(i,t);return new Qk(i,"signInViaPopup",e,r).executeNotNull();});}var Qk=(()=>{class n extends cd{constructor(t,i,r,o,s){super(t,i,o,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this;}executeNotNull(){return J(this,null,function*(){let t=yield this.execute();return Le(t,this.auth,"internal-error"),t;});}onExecution(){return J(this,null,function*(){Sr(this.filter.length===1,"Popup operations only handle one event");let t=kg();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i);}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(Mi(this.auth,"web-storage-unsupported"));}),this.pollUserCancellation();});}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null;}cancel(){this.reject(Mi(this.auth,"cancelled-popup-request"));}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null;}pollUserCancellation(){let t=()=>{var i,r;if(!((r=(i=this.authWindow)===null||i===void 0?void 0:i.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mi(this.auth,"popup-closed-by-user"));},8e3);return;}this.pollId=window.setTimeout(t,Jk.get());};t();}}n.currentPopupAction=null;return n;})(),eI="pendingRedirect",Zh=new Map(),dg=class n extends cd{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null;}execute(){return J(this,null,function*(){let e=Zh.get(this.auth._key());if(!e){try{let i=(yield tI(this.resolver,this.auth))?yield Mo(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(i);}catch(t){e=()=>Promise.reject(t);}Zh.set(this.auth._key(),e);}return this.bypassAuthState||Zh.set(this.auth._key(),()=>Promise.resolve(null)),e();});}onAuthEvent(e){return J(this,null,function*(){if(e.type==="signInViaRedirect")return Mo(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return;}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Mo(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null);}});}onExecution(){return J(this,null,function*(){});}cleanUp(){}};function tI(n,e){return J(this,null,function*(){let t=rI(e),i=iI(n);if(!(yield i._isAvailable()))return!1;let r=(yield i._get(t))==="true";return yield i._remove(t),r;});}function nI(n,e){Zh.set(n._key(),e);}function iI(n){return Mr(n._redirectPersistence);}function rI(n){return qh(eI,n.config.apiKey,n.name);}function oI(n,e,t=!1){return J(this,null,function*(){if(Pi(n.app))return Promise.reject(Yo(n));let i=dd(n),r=EC(i,e),s=yield new dg(i,r,t).execute();return s&&!t&&(delete s.user._redirectEventId,yield i._persistUserIfCurrent(s.user),yield i._setRedirectUser(null,e)),s;});}var sI=10*60*1e3,ug=class{constructor(e){this.auth=e,this.cachedEventUids=new Set(),this.consumers=new Set(),this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now();}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null);}unregisterConsumer(e){this.consumers.delete(e);}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e));}),this.hasHandledPotentialRedirect||!aI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t;}sendToConsumer(e,t){var i;if(e.error&&!OC(e)){let r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Mi(this.auth,r));}else t.onAuthEvent(e);}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i;}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=sI&&this.cachedEventUids.clear(),this.cachedEventUids.has(J1(e));}saveEventToCache(e){this.cachedEventUids.add(J1(e)),this.lastProcessedEventTime=Date.now();}};function J1(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-");}function OC({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event";}function aI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return OC(n);default:return!1;}}function lI(t){return J(this,arguments,function*(n,e={}){return ca(n,"GET","/v1/projects",e);});}var cI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hI=/^https?/;function dI(n){return J(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield lI(n);for(let t of e)try{if(uI(t))return;}catch{}tr(n,"unauthorized-domain");});}function uI(n){let e=tg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===i;}if(!hI.test(t))return!1;if(cI.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i);}var pI=new Xo(3e4,6e4);function Q1(){let n=er().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null;}}function fI(n){return new Promise((e,t)=>{var i,r,o;function s(){Q1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext());},ontimeout:()=>{Q1(),t(Mi(n,"network-request-failed"));},timeout:pI.get()});}if(!((r=(i=er().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((o=er().gapi)===null||o===void 0)&&o.load)s();else{let l=yC("iframefcb");return er()[l]=()=>{gapi.load?s():t(Mi(n,"network-request-failed"));},wk(`${Mk()}?onload=${l}`).catch(c=>t(c));}}).catch(e=>{throw Kh=null,e;});}var Kh=null;function gI(n){return Kh=Kh||fI(n),Kh;}var mI=new Xo(5e3,15e3),_I="__/auth/iframe",vI="emulator/auth/iframe",yI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function bI(n){let e=n.config;Le(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?_g(e,vI):`https://${n.config.authDomain}/${_I}`,i={apiKey:e.apiKey,appName:n.name,v:ia},r=CI.get(n.config.apiHost);r&&(i.eid=r);let o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${na(i).slice(1)}`;}function xI(n){return J(this,null,function*(){let e=yield gI(n),t=er().gapi;return Le(t,n,"internal-error"),e.open({where:document.body,url:bI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yI,dontclear:!0},i=>new Promise((r,o)=>J(null,null,function*(){yield i.restyle({setHideOnLeave:!1});let s=Mi(n,"network-request-failed"),l=er().setTimeout(()=>{o(s);},mI.get());function c(){er().clearTimeout(l),r(i);}i.ping(c).then(c,()=>{o(s);});})));});}var PI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wI=500,MI=600,SI="_blank",EI="http://localhost",hd=class{constructor(e){this.window=e,this.associatedEvent=null;}close(){if(this.window)try{this.window.close();}catch{}}};function OI(n,e,t,i=wI,r=MI){let o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),l="",c=Object.assign(Object.assign({},PI),{width:i.toString(),height:r.toString(),top:o,left:s}),d=ln().toLowerCase();t&&(l=uC(d)?SI:t),hC(d)&&(e=e||EI,c.scrollbars="yes");let u=Object.entries(c).reduce((f,[m,_])=>`${f}${m}=${_},`,"");if(yk(d)&&l!=="_self")return TI(e||"",l),new hd(null);let g=window.open(e||"",l,u);Le(g,n,"popup-blocked");try{g.focus();}catch{}return new hd(g);}function TI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i);}var kI="__/auth/handler",II="emulator/auth/handler",AI=encodeURIComponent("fac");function eC(n,e,t,i,r,o){return J(this,null,function*(){Le(n.config.authDomain,n,"auth-domain-config-required"),Le(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ia,eventId:r};if(e instanceof Ol){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",f1(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[u,g]of Object.entries(o||{}))s[u]=g;}if(e instanceof od){let u=e.getScopes().filter(g=>g!=="");u.length>0&&(s.scopes=u.join(","));}n.tenantId&&(s.tid=n.tenantId);let l=s;for(let u of Object.keys(l))l[u]===void 0&&delete l[u];let c=yield n._getAppCheckToken(),d=c?`#${AI}=${encodeURIComponent(c)}`:"";return`${FI(n)}?${na(l).slice(1)}${d}`;});}function FI({config:n}){return n.emulator?_g(n,II):`https://${n.authDomain}/${kI}`;}var eg="webStorageSupport",pg=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tg,this._completeRedirectFn=oI,this._overrideRedirectResult=nI;}_openPopup(e,t,i,r){return J(this,null,function*(){var o;Sr((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let s=yield eC(e,t,i,tg(),r);return OI(e,s,kg());});}_openRedirect(e,t,i,r){return J(this,null,function*(){yield this._originValidation(e);let o=yield eC(e,t,i,tg(),r);return Vk(o),new Promise(()=>{});});}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Sr(o,"If manager is not set, promise should be"),o);}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t];}),i;}initAndGetManager(e){return J(this,null,function*(){let t=yield xI(e),i=new ug(e);return t.register("authEvent",r=>(Le(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i;});}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(eg,{type:eg},r=>{var o;let s=(o=r?.[0])===null||o===void 0?void 0:o[eg];s!==void 0&&t(!!s),tr(e,"internal-error");},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER);}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=dI(e)),this.originValidationPromises[t];}get _shouldInitProactively(){return _C()||dC()||xg();}},TC=pg;var tC="@firebase/auth",nC="1.10.8";var fg=class{constructor(e){this.auth=e,this.internalListeners=new Map();}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null;}getToken(e){return J(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null;});}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null);});this.internalListeners.set(e,t),this.updateProactiveRefresh();}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh());}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth");}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh();}};function RI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return;}}function LI(n){Pr(new Yn("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:l}=i.options;Le(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});let c={apiKey:s,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vC(n)},d=new ag(i,r,o,c);return Sk(d,t),d;},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize();})),Pr(new Yn("auth-internal",e=>{let t=dd(e.getProvider("auth").getImmediate());return(i=>new fg(i))(t);},"PRIVATE").setInstantiationMode("EXPLICIT")),en(tC,nC,RI(n)),en(tC,nC,"esm2017");}var DI=5*60,NI=Tf("authIdTokenMaxAge")||DI,iC=null,BI=n=>e=>J(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>NI)return;let r=t?.token;iC!==r&&(iC=r,yield fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}));});function Ag(n=yl()){let e=jh(n,"auth");if(e.isInitialized())return e.getImmediate();let t=wg(n,{popupRedirectResolver:TC,persistence:[SC,xC,Tg]}),i=Tf("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(i,location.origin);if(location.origin===o.origin){let s=BI(o.toString());Og(t,s,()=>s(t.currentUser)),Eg(t,l=>s(l));}}let r=o1("auth");return r&&Mg(t,`http://${r}`),t;}function VI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document;}Pk({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let o=Mi("internal-error");o.customData=r,t(o);},i.type="text/javascript",i.charset="UTF-8",VI().appendChild(i);});},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});LI("Browser");var kC="auth",Er=class{constructor(e){return e;}},Fg=class{constructor(){return Hh(kC);}};var Rg=new bc("angularfire2.auth-instances");function IA(n,e){let t=Wf(kC,n,e);return t&&new Er(t);}function AA(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Er(i);};}var FA={provide:Fg,deps:[[new To(),Rg]]},RA={provide:Er,useFactory:IA,deps:[[new To(),Rg],Go]};function IC(n,...e){return en("angularfire",oa.full,"auth"),xc([RA,FA,{provide:Rg,useFactory:AA(n),multi:!0,deps:[Yr,Wr,sa,Cl,[new To(),Gh],...e]}]);}var AC=aa(Ag,!0);var FC=aa(Ig,!0,2);var nr=class n{constructor(e,t,i){this.afAuth=e;this.router=t;this.platform=i;this.platform.browser(()=>{this.afAuth.onIdTokenChanged(r=>{this.user.next(r);}),this.user.pipe(st(r=>{r||(console.log("User is not logged in"),this.token.set(null));}),Vt(r=>!!r),$n(r=>r.getIdToken())).subscribe(r=>{this.token.set(r);});});}user=new So(1);token=G(null);logout(){this.afAuth.signOut(),this.router.navigate(["/admin/login"]);}static fac=function(t){return new(t||n)(Qt(Er),Qt(gt),Qt(it));};static prov=tn({token:n,factory:n.fac,providedIn:"root"});};var ha=class n{constructor(e,t,i){this.router=e;this.auth=t;this.platform=i;}canActivate(e,t){if((e.routeConfig?.path||"").indexOf("admin/moderate")!==-1)return!0;if(this.platform.server())return console.log("On server, skipping auth guard"),!1;let r=e.queryParams.workspace||null;return r?(console.log("Redirecting to workspace-specific admin:",r),this.router.navigate(["/admin/moderate"],{queryParams:D({},e.queryParams)}),!1):this.auth.user.pipe(Xt(1),Jt(o=>!!o),st(o=>{o||(console.log("User not logged in, redirecting to login"),this.router.navigate(["/admin/login"]));}));}static fac=function(t){return new(t||n)(Qt(gt),Qt(nr),Qt(it));};static prov=tn({token:n,factory:n.fac,providedIn:"root"});};function W(n,e,t){return(e=function(i){var r=function(o,s){if(typeof o!="object"||!o)return o;var l=o[Symbol.toPrimitive];if(l!==void 0){var c=l.call(o,s);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.");}return(s==="string"?String:Number)(o);}(i,"string");return typeof r=="symbol"?r:r+"";}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n;}var Md=class{constructor(){W(this,"browserShadowBlurConstant",1),W(this,"DPI",96),W(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),W(this,"perfLimitSizeTotal",2097152),W(this,"maxCacheSideLimit",4096),W(this,"minCacheSideLimit",256),W(this,"disableStyleCopyPaste",!1),W(this,"enableGLFiltering",!0),W(this,"textureSize",4096),W(this,"forceGLPutImageData",!1),W(this,"cachesBoundsOfCurve",!1),W(this,"fontPaths",{}),W(this,"NUM_FRACTION_DIGITS",4);}},Ze=new class extends Md{constructor(n){super(),this.configure(n);}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n);}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=D(D({},this.fontPaths),n);}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>{delete this.fontPaths[n];});}clearFonts(){this.fontPaths={};}restoreDefaults(n){let e=new Md(),t=n?.reduce((i,r)=>(i[r]=e[r],i),{})||e;this.configure(t);}}(),Lr=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return console[n]("fabric",...t);},Zn=class extends Error{constructor(e,t){super(`fabric: ${e}`,t);}},Sd=class extends Zn{constructor(e){super(`${e} 'options.signal' is in 'aborted' state`);}},qg=class{},Zg=class extends qg{testPrecision(e,t){let i=`precision ${t} float;
void main(){}`,r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,i),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS));}queryWebGL(e){let t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(i=>this.testPrecision(t,i)),t.getExtension("WEBGL_lose_context").loseContext(),Lr("log",`WebGL: max texture size ${this.maxTextureSize}`));}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e;}},LA={},LC;var ar=()=>LC||(LC={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new Zg(),dispose(){},copyPasteData:LA}),Ma=()=>ar().document,Yl=()=>ar().window,cb=()=>{var n;return Math.max((n=Ze.devicePixelRatio)!==null&&n!==void 0?n:Yl().devicePixelRatio,1);},Ll=new class{constructor(){W(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map();}getFontCache(n){let{fontFamily:e,fontStyle:t,fontWeight:i}=n;e=e.toLowerCase();let r=this.charWidthsCache;r.has(e)||r.set(e,new Map());let o=r.get(e),s=`${t.toLowerCase()}_${(i+"").toLowerCase()}`;return o.has(s)||o.set(s,new Map()),o.get(s);}clearFontCache(n){n?this.charWidthsCache.delete((n||"").toLowerCase()):this.charWidthsCache=new Map();}limitDimsByArea(n){let{perfLimitSizeTotal:e}=Ze,t=Math.sqrt(e*n);return[Math.floor(t),Math.floor(e/t)];}}(),Kg="7.1.0";function bd(){}var fo=Math.PI/2,DA=Math.PI/4,ki=2*Math.PI,Im=Math.PI/180,Pn=Object.freeze([1,0,0,1,0,0]),Am=16,ao=.4477152502,De="center",ot="left",Rn="top",Jg="bottom",Ft="right",xn="none",Fm=/\r?\n/,hb="moving",tu="scaling",db="rotating",Rm="rotate",ub="skewing",ya="resizing",pb="modifyPoly",NA="modifyPath",Ed="changed",nu="scale",wn="scaleX",Kn="scaleY",Sa="skewX",Ea="skewY",Gt="fill",Ln="stroke",Od="modified",Ko="ltr",Tr="rtl",Qg="normal",da="json",Lg="svg",Ce=new class{constructor(){this[da]=new Map(),this[Lg]=new Map();}has(n){return this[da].has(n);}getClass(n){let e=this[da].get(n);if(!e)throw new Zn(`No class registered for ${n}`);return e;}setClass(n,e){e?this[da].set(e,n):(this[da].set(n.type,n),this[da].set(n.type.toLowerCase(),n));}getSVGClass(n){return this[Lg].get(n);}setSVGClass(n,e){this[Lg].set(e??n.type.toLowerCase(),n);}}(),Td=new class extends Array{remove(n){let e=this.indexOf(n);e>-1&&this.splice(e,1);}cancelAll(){let n=this.splice(0);return n.forEach(e=>e.abort()),n;}cancelByCanvas(n){if(!n)return[];let e=this.filter(t=>{var i;return t.target===n||typeof t.target=="object"&&((i=t.target)===null||i===void 0?void 0:i.canvas)===n;});return e.forEach(t=>t.abort()),e;}cancelByTarget(n){if(!n)return[];let e=this.filter(t=>t.target===n);return e.forEach(t=>t.abort()),e;}}(),em=class{constructor(){W(this,"__eventListeners",{});}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(i=>{let[r,o]=i;this.on(r,o);}),()=>this.off(e);if(t){let i=e;return this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(t),()=>this.off(i,t);}return()=>!1;}once(e,t){if(typeof e=="object"){let i=[];return Object.entries(e).forEach(r=>{let[o,s]=r;i.push(this.once(o,s));}),()=>i.forEach(r=>r());}if(t){let i=this.on(e,function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];t.call(this,...o),i();});return i;}return()=>!1;}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){let i=this.__eventListeners[e],r=i.indexOf(t);r>-1&&i.splice(r,1);}else this.__eventListeners[e]=[];}off(e,t){if(this.__eventListeners)if(e===void 0)for(let i in this.__eventListeners)this._removeEventListener(i);else typeof e=="object"?Object.entries(e).forEach(i=>{let[r,o]=i;this._removeEventListener(r,o);}):this._removeEventListener(e,t);}fire(e,t){var i;if(!this.__eventListeners)return;let r=(i=this.__eventListeners[e])===null||i===void 0?void 0:i.concat();if(r)for(let o=0;o<r.length;o++)r[o].call(this,t||{});}},Jo=(n,e)=>{let t=n.indexOf(e);return t!==-1&&n.splice(t,1),n;},Ii=n=>{if(n===0)return 1;switch(Math.abs(n)/fo){case 1:case 3:return 0;case 2:return-1;}return Math.cos(n);},Ai=n=>{if(n===0)return 0;let e=n/fo,t=Math.sign(n);switch(e){case 1:return t;case 2:return 0;case 3:return-t;}return Math.sin(n);},ne=class n{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t);}add(e){return new n(this.x+e.x,this.y+e.y);}addEquals(e){return this.x+=e.x,this.y+=e.y,this;}scalarAdd(e){return new n(this.x+e,this.y+e);}scalarAddEquals(e){return this.x+=e,this.y+=e,this;}subtract(e){return new n(this.x-e.x,this.y-e.y);}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this;}scalarSubtract(e){return new n(this.x-e,this.y-e);}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this;}multiply(e){return new n(this.x*e.x,this.y*e.y);}scalarMultiply(e){return new n(this.x*e,this.y*e);}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this;}divide(e){return new n(this.x/e.x,this.y/e.y);}scalarDivide(e){return new n(this.x/e,this.y/e);}scalarDivideEquals(e){return this.x/=e,this.y/=e,this;}eq(e){return this.x===e.x&&this.y===e.y;}lt(e){return this.x<e.x&&this.y<e.y;}lte(e){return this.x<=e.x&&this.y<=e.y;}gt(e){return this.x>e.x&&this.y>e.y;}gte(e){return this.x>=e.x&&this.y>=e.y;}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new n(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t);}distanceFrom(e){let t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i);}midPointFrom(e){return this.lerp(e);}min(e){return new n(Math.min(this.x,e.x),Math.min(this.y,e.y));}max(e){return new n(Math.max(this.x,e.x),Math.max(this.y,e.y));}toString(){return`${this.x},${this.y}`;}setXY(e,t){return this.x=e,this.y=t,this;}setX(e){return this.x=e,this;}setY(e){return this.y=e,this;}setFromPoint(e){return this.x=e.x,this.y=e.y,this;}swap(e){let t=this.x,i=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=i;}clone(){return new n(this.x,this.y);}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lm,i=Ai(e),r=Ii(e),o=this.subtract(t);return new n(o.x*r-o.y*i,o.x*i+o.y*r).add(t);}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new n(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]));}},Lm=new ne(0,0),xd=n=>!!n&&Array.isArray(n._objects);function fb(n){class e extends n{constructor(){super(...arguments),W(this,"_objects",[]);}_onObjectAdded(i){}_onObjectRemoved(i){}_onStackOrderChanged(i){}add(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];let s=this._objects.push(...r);return r.forEach(l=>this._onObjectAdded(l)),s;}insertAt(i){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return this._objects.splice(i,0,...o),o.forEach(l=>this._onObjectAdded(l)),this._objects.length;}remove(){let i=this._objects,r=[];for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return s.forEach(c=>{let d=i.indexOf(c);d!==-1&&(i.splice(d,1),r.push(c),this._onObjectRemoved(c));}),r;}forEachObject(i){this.getObjects().forEach((r,o,s)=>i(r,o,s));}getObjects(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return r.length===0?[...this._objects]:this._objects.filter(s=>s.isType(...r));}item(i){return this._objects[i];}isEmpty(){return this._objects.length===0;}size(){return this._objects.length;}contains(i,r){return!!this._objects.includes(i)||!!r&&this._objects.some(o=>o instanceof e&&o.contains(i,!0));}complexity(){return this._objects.reduce((i,r)=>i+=r.complexity?r.complexity():0,0);}sendObjectToBack(i){return!(!i||i===this._objects[0])&&(Jo(this._objects,i),this._objects.unshift(i),this._onStackOrderChanged(i),!0);}bringObjectToFront(i){return!(!i||i===this._objects[this._objects.length-1])&&(Jo(this._objects,i),this._objects.push(i),this._onStackOrderChanged(i),!0);}sendObjectBackwards(i,r){if(!i)return!1;let o=this._objects.indexOf(i);if(o!==0){let s=this.findNewLowerIndex(i,o,r);return Jo(this._objects,i),this._objects.splice(s,0,i),this._onStackOrderChanged(i),!0;}return!1;}bringObjectForward(i,r){if(!i)return!1;let o=this._objects.indexOf(i);if(o!==this._objects.length-1){let s=this.findNewUpperIndex(i,o,r);return Jo(this._objects,i),this._objects.splice(s,0,i),this._onStackOrderChanged(i),!0;}return!1;}moveObjectTo(i,r){return i!==this._objects[r]&&(Jo(this._objects,i),this._objects.splice(r,0,i),this._onStackOrderChanged(i),!0);}findNewLowerIndex(i,r,o){let s;if(o){s=r;for(let l=r-1;l>=0;--l)if(i.isOverlapping(this._objects[l])){s=l;break;}}else s=r-1;return s;}findNewUpperIndex(i,r,o){let s;if(o){s=r;for(let l=r+1;l<this._objects.length;++l)if(i.isOverlapping(this._objects[l])){s=l;break;}}else s=r+1;return s;}collectObjects(i){let{left:r,top:o,width:s,height:l}=i,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=[],u=new ne(r,o),g=u.add(new ne(s,l));for(let f=this._objects.length-1;f>=0;f--){let m=this._objects[f];m.selectable&&m.visible&&(c&&m.intersectsWithRect(u,g)||m.isContainedWithinRect(u,g)||c&&m.containsPoint(u)||c&&m.containsPoint(g))&&d.push(m);}return d;}}return e;}var kd=class extends em{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(let t in e)this.set(t,e[t]);}_setObject(e){for(let t in e)this._set(t,e[t]);}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this;}_set(e,t){this[e]=t;}toggle(e){let t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this;}get(e){return this[e];}};function Dl(n){return Yl().requestAnimationFrame(n);}function gb(n){return Yl().cancelAnimationFrame(n);}var BA=0,go=()=>BA++,lr=()=>{let n=Ma().createElement("canvas");if(!n||n.getContext===void 0)throw new Zn("Failed to create `canvas` element");return n;},mb=()=>Ma().createElement("img"),Jn=n=>{let e=lr();return e.width=n.width,e.height=n.height,e;},Dm=(n,e,t)=>n.toDataURL(`image/${e}`,t),Nm=(n,e,t)=>new Promise((i,r)=>{n.toBlob(i,`image/${e}`,t);}),Tt=n=>n*Im,Dr=n=>n/Im,_b=n=>n.every((e,t)=>e===Pn[t]),cn=(n,e,t)=>new ne(n).transform(e,t),Fn=n=>{let e=1/(n[0]*n[3]-n[1]*n[2]),t=[e*n[3],-e*n[1],-e*n[2],e*n[0],0,0],{x:i,y:r}=new ne(n[4],n[5]).transform(t,!0);return t[4]=-i,t[5]=-r,t;},St=(n,e,t)=>[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],t?0:n[0]*e[4]+n[2]*e[5]+n[4],t?0:n[1]*e[4]+n[3]*e[5]+n[5]],iu=(n,e)=>n.reduceRight((t,i)=>i&&t?St(i,t,e):i||t,void 0)||Pn.concat(),vb=n=>{let[e,t]=n;return Math.atan2(t,e);},ys=n=>{let e=vb(n),t=Math.pow(n[0],2)+Math.pow(n[1],2),i=Math.sqrt(t),r=(n[0]*n[3]-n[2]*n[1])/i,o=Math.atan2(n[0]*n[2]+n[1]*n[3],t);return{angle:Dr(e),scaleX:i,scaleY:r,skewX:Dr(o),skewY:0,translateX:n[4]||0,translateY:n[5]||0};},Oa=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0];};function Ps(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Tt(n),r=Ii(i),o=Ai(i);return[r,o,-o,r,e?e-(r*e-o*t):0,t?t-(o*e+r*t):0];}var ru=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0];},yb=n=>Math.tan(Tt(n)),Bm=n=>[1,0,yb(n),1,0,0],Vm=n=>[1,yb(n),0,1,0,0],Xl=n=>{let{scaleX:e=1,scaleY:t=1,flipX:i=!1,flipY:r=!1,skewX:o=0,skewY:s=0}=n,l=ru(i?-e:e,r?-t:t);return o&&(l=St(l,Bm(o),!0)),s&&(l=St(l,Vm(s),!0)),l;},Cb=n=>{let{translateX:e=0,translateY:t=0,angle:i=0}=n,r=Oa(e,t);i&&(r=St(r,Ps({angle:i})));let o=Xl(n);return _b(o)||(r=St(r,o)),r;},Nl=function(n){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(i,r){if(e&&e.aborted)return r(new Sd("loadImage"));let o=mb(),s;e&&(s=function(c){o.src="",r(c);},e.addEventListener("abort",s,{once:!0}));let l=function(){o.onload=o.onerror=null,s&&e?.removeEventListener("abort",s),i(o);};n?(o.onload=l,o.onerror=function(){s&&e?.removeEventListener("abort",s),r(new Zn(`Error loading ${o.src}`));},t&&(o.crossOrigin=t),o.src=n):l();});},Ca=function(n){let{signal:e,reviver:t=bd}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((i,r)=>{let o=[];e&&e.addEventListener("abort",r,{once:!0}),Promise.all(n.map(s=>Ce.getClass(s.type).fromObject(s,{signal:e}).then(l=>(t(s,l),o.push(l),l)))).then(i).catch(s=>{o.forEach(l=>{l.dispose&&l.dispose();}),r(s);}).finally(()=>{e&&e.removeEventListener("abort",r);});});},ql=function(n){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,i)=>{let r=[];e&&e.addEventListener("abort",i,{once:!0});let o=Object.values(n).map(l=>l&&l.type&&Ce.has(l.type)?Ca([l],{signal:e}).then(c=>{let[d]=c;return r.push(d),d;}):l),s=Object.keys(n);Promise.all(o).then(l=>l.reduce((c,d,u)=>(c[s[u]]=d,c),{})).then(t).catch(l=>{r.forEach(c=>{c.dispose&&c.dispose();}),i(l);}).finally(()=>{e&&e.removeEventListener("abort",i);});});},ws=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in n&&(e[t]=n[t]),e),{});},zm=(n,e)=>Object.keys(n).reduce((t,i)=>(e(n[i],i,n)&&(t[i]=n[i]),t),{}),pt=(n,e)=>parseFloat(Number(n).toFixed(e)),ba=n=>"matrix("+n.map(e=>pt(e,Ze.NUM_FRACTION_DIGITS)).join(" ")+")",di=n=>!!n&&n.toLive!==void 0,DC=n=>!!n&&typeof n.toObject=="function",NC=n=>!!n&&n.offsetX!==void 0&&"source"in n,Qo=n=>!!n&&"multiSelectionStacking"in n;function bb(n){let e=n&&Ei(n),t=0,i=0;if(!n||!e)return{left:t,top:i};let r=n,o=e.documentElement,s=e.body||{scrollLeft:0,scrollTop:0};for(;r&&(r.parentNode||r.host)&&(r=r.parentNode||r.host,r===e?(t=s.scrollLeft||o.scrollLeft||0,i=s.scrollTop||o.scrollTop||0):(t+=r.scrollLeft||0,i+=r.scrollTop||0),r.nodeType!==1||r.style.position!=="fixed"););return{left:t,top:i};}var Ei=n=>n.ownerDocument||null,xb=n=>{var e;return((e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null;},Pb=function(n,e,t){let{width:i,height:r}=t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=i,n.height=r,o>1&&(n.setAttribute("width",(i*o).toString()),n.setAttribute("height",(r*o).toString()),e.scale(o,o));},tm=(n,e)=>{let{width:t,height:i}=e;t&&(n.style.width=typeof t=="number"?`${t}px`:t),i&&(n.style.height=typeof i=="number"?`${i}px`:i);};function BC(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=xn,n;}var Id=class{constructor(e){W(this,"_originalCanvasStyle",void 0),W(this,"lower",void 0);let t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")};}createLowerCanvas(e){let t=(i=e)&&i.getContext!==void 0?e:e&&Ma().getElementById(e)||lr();var i;if(t.hasAttribute("data-fabric"))throw new Zn("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t;}cleanupDOM(e){let{width:t,height:i}=e,{el:r}=this.lower;r.classList.remove("lower-canvas"),r.removeAttribute("data-fabric"),r.setAttribute("width",`${t}`),r.setAttribute("height",`${i}`),r.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0;}setDimensions(e,t){let{el:i,ctx:r}=this.lower;Pb(i,r,e,t);}setCSSDimensions(e){tm(this.lower.el,e);}calcOffset(){return function(e){var t;let i=e&&Ei(e),r={left:0,top:0};if(!i)return r;let o=((t=xb(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};r.left+=parseInt(o.borderLeftWidth,10)||0,r.top+=parseInt(o.borderTopWidth,10)||0,r.left+=parseInt(o.paddingLeft,10)||0,r.top+=parseInt(o.paddingTop,10)||0;let s={left:0,top:0},l=i.documentElement;e.getBoundingClientRect!==void 0&&(s=e.getBoundingClientRect());let c=bb(e);return{left:s.left+c.left-(l.clientLeft||0)+r.left,top:s.top+c.top-(l.clientTop||0)+r.top};}(this.lower.el);}dispose(){ar().dispose(this.lower.el),delete this.lower;}},VA={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Pn],patternQuality:"best"},jl=class n extends fb(kd){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el;}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx;}static getDefaults(){return n.ownDefaults;}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries();}initElements(e){this.elements=new Id(e);}add(){let e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e;}insertAt(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];let o=super.insertAt(e,...i);return i.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),o;}remove(){let e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e;}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Lr("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this});}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this});}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll();}getRetinaScaling(){return this.enableRetinaScaling?cb():1;}calcOffset(){return this._offset=this.elements.calcOffset();}getWidth(){return this.width;}getHeight(){return this.height;}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){let r=D({width:this.width,height:this.height},e);this.elements.setDimensions(r,this.getRetinaScaling()),this.hasLostContext=!0,this.width=r.width,this.height=r.height;}i||this.elements.setCSSDimensions(e),this.calcOffset();}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll();}getZoom(){return this.viewportTransform[0];}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll();}zoomToPoint(e,t){let i=e,r=[...this.viewportTransform],o=cn(e,Fn(r));r[0]=t,r[3]=t;let s=cn(o,r);r[4]+=i.x-s.x,r[5]+=i.y-s.y,this.setViewportTransform(r);}setZoom(e){this.zoomToPoint(new ne(0,0),e);}absolutePan(e){let t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t);}relativePan(e){return this.absolutePan(new ne(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]));}getElement(){return this.elements.lower.el;}clearContext(e){e.clearRect(0,0,this.width,this.height);}getContext(){return this.elements.lower.ctx;}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll();}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects);}renderAndReset(){this.nextRenderHandle=0,this.renderAll();}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Dl(()=>this.renderAndReset()));}calcViewportBoundaries(){let e=this.width,t=this.height,i=Fn(this.viewportTransform),r=cn({x:0,y:0},i),o=cn({x:e,y:t},i),s=r.min(o),l=r.max(o);return this.vptCoords={tl:s,tr:new ne(l.x,s.y),bl:new ne(s.x,l.y),br:l};}cancelRequestedRender(){this.nextRenderHandle&&(gb(this.nextRenderHandle),this.nextRenderHandle=0);}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;let i=this.viewportTransform,r=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality=this.patternQuality,this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),r&&(r._set("canvas",this),r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,r)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0);}drawClipPathOnCanvas(e,t){let i=this.viewportTransform;e.save(),e.transform(...i),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore();}_renderObjects(e,t){for(let i=0,r=t.length;i<r;++i)t[i]&&t[i].render(e);}_renderBackgroundOrOverlay(e,t){let i=this[`${t}Color`],r=this[`${t}Image`],o=this.viewportTransform,s=this[`${t}Vpt`];if(!i&&!r)return;let l=di(i);if(i){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=l?i.toLive(e):i,s&&e.transform(...o),l){e.transform(1,0,0,1,i.offsetX||0,i.offsetY||0);let c=i.gradientTransform||i.patternTransform;c&&e.transform(...c);}e.fill(),e.restore();}if(r){e.save();let{skipOffscreen:c}=this;this.skipOffscreen=s,s&&e.transform(...o),r.render(e),this.skipOffscreen=c,e.restore();}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background");}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay");}getCenterPoint(){return new ne(this.width/2,this.height/2);}centerObjectH(e){return this._centerObject(e,new ne(this.getCenterPoint().x,e.getCenterPoint().y));}centerObjectV(e){return this._centerObject(e,new ne(e.getCenterPoint().x,this.getCenterPoint().y));}centerObject(e){return this._centerObject(e,this.getCenterPoint());}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter());}viewportCenterObjectH(e){return this._centerObject(e,new ne(this.getVpCenter().x,e.getCenterPoint().y));}viewportCenterObjectV(e){return this._centerObject(e,new ne(e.getCenterPoint().x,this.getVpCenter().y));}getVpCenter(){return cn(this.getCenterPoint(),Fn(this.viewportTransform));}_centerObject(e,t){e.setXY(t,De,De),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll();}toDatalessJSON(e){return this.toDatalessObject(e);}toObject(e){return this._toObjectMethod("toObject",e);}toJSON(){return this.toObject();}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e);}_toObjectMethod(e,t){let i=this.clipPath,r=i&&!i.excludeFromExport?this._toObject(i,e,t):null;return D(D(se(D({version:Kg},ws(this,t)),{objects:this._objects.filter(o=>!o.excludeFromExport).map(o=>this._toObject(o,e,t))}),this.__serializeBgOverlay(e,t)),r?{clipPath:r}:null);}_toObject(e,t,i){let r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);let o=e[t](i);return this.includeDefaultValues||(e.includeDefaultValues=!!r),o;}__serializeBgOverlay(e,t){let i={},r=this.backgroundImage,o=this.overlayImage,s=this.backgroundColor,l=this.overlayColor;return di(s)?s.excludeFromExport||(i.background=s.toObject(t)):s&&(i.background=s),di(l)?l.excludeFromExport||(i.overlay=l.toObject(t)):l&&(i.overlay=l),r&&!r.excludeFromExport&&(i.backgroundImage=this._toObject(r,e,t)),o&&!o.excludeFromExport&&(i.overlayImage=this._toObject(o,e,t)),i;}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;let i=[];return this._setSVGPreamble(i,e),this._setSVGHeader(i,e),this.clipPath&&i.push(`<g clip-path="url(#${this.clipPath.clipPathId})" >
`),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",t),this._setSVGObjects(i,t),this.clipPath&&i.push(`</g>
`),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",t),i.push("</svg>"),i.join("");}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`);}_setSVGHeader(e,t){let i=t.width||`${this.width}`,r=t.height||`${this.height}`,o=Ze.NUM_FRACTION_DIGITS,s=t.viewBox,l;if(s)l=`viewBox="${s.x} ${s.y} ${s.width} ${s.height}" `;else if(this.svgViewportTransformation){let c=this.viewportTransform;l=`viewBox="${pt(-c[4]/c[0],o)} ${pt(-c[5]/c[3],o)} ${pt(this.width/c[0],o)} ${pt(this.height/c[3],o)}" `;}else l=`viewBox="0 0 ${this.width} ${this.height}" `;e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',r,'" ',l,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Kg,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`);}createSVGClipPathMarkup(e){let t=this.clipPath;return t?(t.clipPathId=`CLIPPATH_${go()}`,`<clipPath id="${t.clipPathId}" >
${t.toClipPathSVG(e.reviver)}</clipPath>
`):"";}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{let t=this[`${e}Color`];if(di(t)){let i=this[`${e}Vpt`],r=this.viewportTransform,o={isType:()=>!1,width:this.width/(i?r[0]:1),height:this.height/(i?r[3]:1)};return t.toSVG(o,{additionalTransform:i?ba(r):""});}}).join("");}createSVGFontFacesMarkup(){let e=[],t={},i=Ze.fontPaths;this._objects.forEach(function o(s){e.push(s),xd(s)&&s._objects.forEach(o);}),e.forEach(o=>{if(!(s=o)||typeof s._renderText!="function")return;var s;let{styles:l,fontFamily:c}=o;!t[c]&&i[c]&&(t[c]=!0,l&&Object.values(l).forEach(d=>{Object.values(d).forEach(u=>{let{fontFamily:g=""}=u;!t[g]&&i[g]&&(t[g]=!0);});}));});let r=Object.keys(t).map(o=>`		@font-face {
			font-family: '${o}';
			src: url('${i[o]}');
		}
`).join("");return r?`	<style type="text/css"><![CDATA[
${r}]]></style>
`:"";}_setSVGObjects(e,t){this.forEachObject(i=>{i.excludeFromExport||this._setSVGObject(e,i,t);});}_setSVGObject(e,t,i){e.push(t.toSVG(i));}_setSVGBgOverlayImage(e,t,i){let r=this[t];r&&!r.excludeFromExport&&r.toSVG&&e.push(r.toSVG(i));}_setSVGBgOverlayColor(e,t){let i=this[`${t}Color`];if(i)if(di(i)){let r=i.repeat||"",o=this.width,s=this.height,l=this[`${t}Vpt`]?ba(Fn(this.viewportTransform)):"";e.push(`<rect transform="${l} translate(${o/2},${s/2})" x="${i.offsetX-o/2}" y="${i.offsetY-s/2}" width="${r!=="repeat-y"&&r!=="no-repeat"||!NC(i)?o:i.source.width}" height="${r!=="repeat-x"&&r!=="no-repeat"||!NC(i)?s:i.source.height}" fill="url(#SVGID_${i.id})"></rect>
`);}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',i,'"',`></rect>
`);}loadFromJSON(e,t){let{signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Zn("`json` is undefined"));let f=typeof e=="string"?JSON.parse(e):e,{objects:r=[]}=f,o=lt(f,["objects"]),{backgroundImage:s,background:l,overlayImage:c,overlay:d,clipPath:u}=o,g=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Ca(r,{reviver:t,signal:i}),ql({backgroundImage:s,backgroundColor:l,overlayImage:c,overlayColor:d,clipPath:u},{signal:i})]).then(m=>{let[_,y]=m;return this.clear(),this.add(..._),this.set(o),this.set(y),this.renderOnAddRemove=g,this;});}clone(e){let t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t);}cloneWithoutData(){let e=Jn(this);return new this.constructor(e);}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:t="png",quality:i=1,multiplier:r=1,enableRetinaScaling:o=!1}=e,s=r*(o?this.getRetinaScaling():1);return Dm(this.toCanvasElement(s,e),t,i);}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:t="png",quality:i=1,multiplier:r=1,enableRetinaScaling:o=!1}=e,s=r*(o?this.getRetinaScaling():1);return Nm(this.toCanvasElement(s,e),t,i);}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:i,left:r,top:o,filter:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=(t||this.width)*e,c=(i||this.height)*e,d=this.getZoom(),u=this.width,g=this.height,f=this.skipControlsDrawing,m=d*e,_=this.viewportTransform,y=[m,0,0,m,(_[4]-(r||0))*e,(_[5]-(o||0))*e],E=this.enableRetinaScaling,C=Jn({width:l,height:c}),b=s?this._objects.filter(x=>s(x)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=y,this.width=l,this.height=c,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(C.getContext("2d"),b),this.viewportTransform=_,this.width=u,this.height=g,this.calcViewportBoundaries(),this.enableRetinaScaling=E,this.skipControlsDrawing=f,C;}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Td.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{let i=()=>{this.destroy(),e(!0);};i.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=i:i();});}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose();}toString(){return`#<Canvas (${this.complexity()}): { objects: ${this._objects.length} }>`;}};W(jl,"ownDefaults",VA);var zA=["touchstart","touchmove","touchend"],wb=n=>{let e=bb(n.target),t=function(i){let r=i.changedTouches;return r&&r[0]?r[0]:i;}(n);return new ne(t.clientX+e.left,t.clientY+e.top);},Ad=n=>zA.includes(n.type)||n.pointerType==="touch",VC=n=>{n.preventDefault(),n.stopPropagation();},sr=n=>{let e=0,t=0,i=0,r=0;for(let o=0,s=n.length;o<s;o++){let{x:l,y:c}=n[o];(l>i||!o)&&(i=l),(l<e||!o)&&(e=l),(c>r||!o)&&(r=c),(c<t||!o)&&(t=c);}return{left:e,top:t,width:i-e,height:r-t};},Mb=(n,e)=>xa(n,St(e,n.calcOwnMatrix())),xa=(n,e)=>{let c=ys(e),{translateX:t,translateY:i,scaleX:r,scaleY:o}=c,s=lt(c,["translateX","translateY","scaleX","scaleY"]),l=new ne(t,i);n.flipX=!1,n.flipY=!1,Object.assign(n,s),n.set({scaleX:r,scaleY:o}),n.setPositionByOrigin(l,De,De);},Sb=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0);},jm=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),ou=(n,e,t)=>{let i=n/2,r=e/2,o=[new ne(-i,-r),new ne(i,-r),new ne(-i,r),new ne(i,r)].map(l=>l.transform(t)),s=sr(o);return new ne(s.width,s.height);},Zl=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pn;return St(Fn(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pn),n);},Nr=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pn,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pn;return n.transform(Zl(e,t));},Eb=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pn,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pn;return n.transform(Zl(e,t),!0);},nm=(n,e,t)=>{let i=Zl(e,t);return xa(n,St(i,n.calcOwnMatrix())),i;},jA={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Cn=n=>typeof n=="string"?jA[n]:n-.5,$A=new ne(1,0),Ob=new ne(),$m=(n,e)=>n.rotate(e),$l=(n,e)=>new ne(e).subtract(n),Fd=n=>n.distanceFrom(Ob),Rd=(n,e)=>Math.atan2(_a(n,e),Tb(n,e)),Um=n=>Rd($A,n),su=n=>n.eq(Ob)?n:n.scalarDivide(Fd(n)),Hm=function(n){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return su(new ne(-n.y,n.x).scalarMultiply(e?1:-1));},_a=(n,e)=>n.x*e.y-n.y*e.x,Tb=(n,e)=>n.x*e.x+n.y*e.y,im=(n,e,t)=>{if(n.eq(e)||n.eq(t))return!0;let i=_a(e,t),r=_a(e,n),o=_a(t,n);return i>=0?r>=0&&o<=0:!(r<=0&&o>=0);},Ld="not-allowed";function kb(n){return Cn(n.originX)===Cn(De)&&Cn(n.originY)===Cn(De);}function zC(n){return .5-Cn(n);}var Ti=(n,e)=>n[e],Wm=(n,e,t,i)=>({e:n,transform:e,pointer:new ne(t,i)});function Ib(n,e,t){let i=t,r=Nr(n.getCenterPoint(),n.canvas.viewportTransform,void 0),o=Um($l(r,i))+ki;return Math.round(o%ki/DA);}function au(n,e,t,i,r){var o;let{target:s,corner:l}=n,c=s.controls[l],d=((o=s.canvas)===null||o===void 0?void 0:o.getZoom())||1,u=s.padding/d,g=function(f,m,_,y){let E=f.getRelativeCenterPoint(),C=_!==void 0&&y!==void 0?f.translateToGivenOrigin(E,De,De,_,y):new ne(f.left,f.top);return(f.angle?m.rotate(-Tt(f.angle),E):m).subtract(C);}(s,new ne(i,r),e,t);return g.x>=u&&(g.x-=u),g.x<=-u&&(g.x+=u),g.y>=u&&(g.y-=u),g.y<=u&&(g.y+=u),g.x-=c.offsetX,g.y-=c.offsetY,g;}var Dd=n=>n.replace(/\s+/g," "),jC={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Dg=(n,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n),$C=(n,e,t,i)=>{n/=255,e/=255,t/=255;let r=Math.max(n,e,t),o=Math.min(n,e,t),s,l,c=(r+o)/2;if(r===o)s=l=0;else{let d=r-o;switch(l=c>.5?d/(2-r-o):d/(r+o),r){case n:s=(e-t)/d+(e<t?6:0);break;case e:s=(t-n)/d+2;break;case t:s=(n-e)/d+4;}s/=6;}return[Math.round(360*s),Math.round(100*l),Math.round(100*c),i];},UC=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1);},fd=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),HC=n=>{let[e,t,i,r=1]=n,o=Math.round(.3*e+.59*t+.11*i);return[o,o,o,r];},Dn=class n{constructor(e){if(W(this,"isUnrecognised",!1),e){if(e instanceof n)this.setSource([...e._source]);else if(Array.isArray(e)){let[t,i,r,o=1]=e;this.setSource([t,i,r,o]);}else this.setSource(this._tryParsingColor(e));}else this.setSource([0,0,0,1]);}_tryParsingColor(e){return(e=e.toLowerCase())in jC&&(e=jC[e]),e==="transparent"?[255,255,255,0]:n.sourceFromHex(e)||n.sourceFromRgb(e)||n.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1];}getSource(){return this._source;}setSource(e){this._source=e;}toRgb(){let[e,t,i]=this.getSource();return`rgb(${e},${t},${i})`;}toRgba(){return`rgba(${this.getSource().join(",")})`;}toHsl(){let[e,t,i]=$C(...this.getSource());return`hsl(${e},${t}%,${i}%)`;}toHsla(){let[e,t,i,r]=$C(...this.getSource());return`hsla(${e},${t}%,${i}%,${r})`;}toHex(){return this.toHexa().slice(0,6);}toHexa(){let[e,t,i,r]=this.getSource();return`${fd(e)}${fd(t)}${fd(i)}${fd(Math.round(255*r))}`;}getAlpha(){return this.getSource()[3];}setAlpha(e){return this._source[3]=e,this;}toGrayscale(){return this.setSource(HC(this.getSource())),this;}toBlackWhite(e){let[t,,,i]=HC(this.getSource()),r=t<(e||127)?0:255;return this.setSource([r,r,r,i]),this;}overlayWith(e){e instanceof n||(e=new n(e));let t=this.getSource(),i=e.getSource(),[r,o,s]=t.map((l,c)=>Math.round(.5*l+.5*i[c]));return this.setSource([r,o,s,t[3]]),this;}static fromRgb(e){return n.fromRgba(e);}static fromRgba(e){return new n(n.sourceFromRgb(e));}static sourceFromRgb(e){let t=Dd(e).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(t){let[i,r,o]=t.slice(1,4).map(s=>{let l=parseFloat(s);return s.endsWith("%")?Math.round(2.55*l):l;});return[i,r,o,UC(t[4])];}}static fromHsl(e){return n.fromHsla(e);}static fromHsla(e){return new n(n.sourceFromHsl(e));}static sourceFromHsl(e){let t=Dd(e).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!t)return;let i=(n.parseAngletoDegrees(t[1])%360+360)%360/360,r=parseFloat(t[2])/100,o=parseFloat(t[3])/100,s,l,c;if(r===0)s=l=c=o;else{let d=o<=.5?o*(r+1):o+r-o*r,u=2*o-d;s=Dg(u,d,i+1/3),l=Dg(u,d,i),c=Dg(u,d,i-1/3);}return[Math.round(255*s),Math.round(255*l),Math.round(255*c),UC(t[4])];}static fromHex(e){return new n(n.sourceFromHex(e));}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){let t=e.slice(e.indexOf("#")+1),i;i=t.length<=4?t.split("").map(c=>c+c):t.match(/.{2}/g);let[r,o,s,l=255]=i.map(c=>parseInt(c,16));return[r,o,s,l/255];}}static parseAngletoDegrees(e){let t=e.toLowerCase(),i=parseFloat(t);return t.includes("rad")?Dr(i):t.includes("turn")?360*i:i;}},yn=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Am,t=/\D{0,2}$/.exec(n),i=parseFloat(n),r=Ze.DPI;switch(t?.[0]){case"mm":return i*r/25.4;case"cm":return i*r/2.54;case"in":return i*r;case"pt":return i*r/72;case"pc":return i*r/72*12;case"em":return i*e;default:return i;}},Gm=n=>{let[e,t]=n.trim().split(" "),[i,r]=(o=e)&&o!==xn?[o.slice(1,4),o.slice(5,8)]:o===xn?[o,o]:["Mid","Mid"];var o;return{meetOrSlice:t||"meet",alignX:i,alignY:r};},Ul=function(n,e){let t,i,r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e){if(e.toLive)t=`url(#SVGID_${e.id})`;else{let o=new Dn(e),s=o.getAlpha();t=o.toRgb(),s!==1&&(i=s.toString());}}else t="none";return r?`${n}: ${t}; ${i?`${n}-opacity: ${i}; `:""}`:`${n}="${t}" ${i?`${n}-opacity="${i}" `:""}`;},Nd=class{getSvgStyles(e){let t=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):xn,o=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",g=e?"":this.getSvgFilter(),f=Ul(Gt,this.fill);return[Ul(Ln,this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",c,"; ",f,"fill-rule: ",t,"; ","opacity: ",d,";",g,u].join("");}getSvgFilter(){return this.shadow?`filter: url(#SVGID_${this.shadow.id});`:"";}getSvgCommons(){return[this.id?`id="${this.id}" `:"",this.clipPath?`clip-path="url(#${this.clipPath.clipPathId})" `:""].join("");}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=e?this.calcTransformMatrix():this.calcOwnMatrix();return`${`transform="${ba(i)}`}${t}" `;}_toSVG(e){return[""];}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e});}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e});}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),o=e.indexOf("COMMON_PARTS");return e[o]=r,t?t(e.join("")):e.join("");}_createBaseSVGMarkup(e){let{noStyle:t,reviver:i,withShadow:r,additionalTransform:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t?"":`style="${this.getSvgStyles()}" `,l=r?`style="${this.getSvgFilter()}" `:"",c=this.clipPath,d=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,g=this.stroke,f=this.fill,m=this.shadow,_=[],y=e.indexOf("COMMON_PARTS"),E;c&&(c.clipPathId=`CLIPPATH_${go()}`,E=`<clipPath id="${c.clipPathId}" >
${c.toClipPathSVG(i)}</clipPath>
`),u&&_.push("<g ",l,this.getSvgCommons(),` >
`),_.push("<g ",this.getSvgTransform(!1),u?"":l+this.getSvgCommons(),` >
`);let C=[s,d,t?"":this.addPaintOrder()," ",o?`transform="${o}" `:""].join("");return e[y]=C,di(f)&&_.push(f.toSVG(this)),di(g)&&_.push(g.toSVG(this)),m&&_.push(m.toSVG(this)),c&&_.push(E),_.push(e.join("")),_.push(`</g>
`),u&&_.push(`</g>
`),i?i(_.join("")):_.join("");}addPaintOrder(){return this.paintFirst!==Gt?` paint-order="${this.paintFirst}" `:"";}};function lu(n){return new RegExp("^("+n.join("|")+")\\b","i");}var Cs="textDecorationThickness",Ab=["fontSize","fontWeight","fontFamily","fontStyle"],Fb=["underline","overline","linethrough"],Rb=[...Ab,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],Lb=[...Rb,...Fb,"textBackgroundColor","direction",Cs],UA=[...Ab,...Fb,Ln,"strokeWidth",Gt,"deltaY","textBackgroundColor",Cs],HA={_reNewline:Fm,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:Qg,fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:ot,fontStyle:Qg,lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:ot,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:Ko,CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[Cs]:66.667},or="justify",Bd="justify-left",Bl="justify-right",Vl="justify-center",Oi=String.raw`[-+]?(?:\d*\.\d+|\d+\.?)(?:[eE][-+]?\d+)?`,Ng=String.raw`(?:\s*,?\s+|\s*,\s*)`,rm="http://www.w3.org/2000/svg",WA=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Oi+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Oi+"))?\\s+(.*)"),GA={cx:ot,x:ot,r:"radius",cy:Rn,y:Rn,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":Cs},Bg="font-size",Vg="clip-path",YA=lu(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),XA=lu(["symbol","image","marker","pattern","view","svg"]),WC=lu(["symbol","g","a","svg","clipPath","defs"]),GC=new RegExp(String.raw`^\s*(${Oi})${Ng}(${Oi})${Ng}(${Oi})${Ng}(${Oi})\s*$`),YC="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",XC=new RegExp("(?:\\s|^)"+YC+YC+"("+Oi+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)"),po=class n{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=typeof e=="string"?n.parseShadow(e):e;Object.assign(this,n.ownDefaults,t),this.id=go();}static parseShadow(e){let t=e.trim(),[,i=0,r=0,o=0]=(XC.exec(t)||[]).map(s=>parseFloat(s)||0);return{color:(t.replace(XC,"")||"rgb(0,0,0)").trim(),offsetX:i,offsetY:r,blur:o};}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ");}toSVG(e){let t=$m(new ne(this.offsetX,this.offsetY),Tt(-e.angle)),i=new Dn(this.color),r=40,o=40;return e.width&&e.height&&(r=100*pt((Math.abs(t.x)+this.blur)/e.width,Ze.NUM_FRACTION_DIGITS)+20,o=100*pt((Math.abs(t.y)+this.blur)/e.height,Ze.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),`<filter id="SVGID_${this.id}" y="-${o}%" height="${100+2*o}%" x="-${r}%" width="${100+2*r}%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="${pt(this.blur?this.blur/2:0,Ze.NUM_FRACTION_DIGITS)}"></feGaussianBlur>
	<feOffset dx="${pt(t.x,Ze.NUM_FRACTION_DIGITS)}" dy="${pt(t.y,Ze.NUM_FRACTION_DIGITS)}" result="oBlur" ></feOffset>
	<feFlood flood-color="${i.toRgb()}" flood-opacity="${i.getAlpha()}"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`;}toObject(){let e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=n.ownDefaults;return this.includeDefaultValues?e:zm(e,(i,r)=>i!==t[r]);}static fromObject(e){return J(this,null,function*(){return new this(e);});}};W(po,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),W(po,"type","shadow"),Ce.setClass(po,"shadow");var bs=(n,e,t)=>Math.max(n,Math.min(e,t)),qA=[Rn,ot,wn,Kn,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Sa,Ea],Br=[Gt,Ln,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],ZA={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:De,originY:De,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Gt,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},zg=(n,e,t,i)=>(n<Math.abs(e)?(n=e,i=t/4):i=e===0&&n===0?t/ki*Math.asin(1):t/ki*Math.asin(e/n),{a:n,c:e,p:t,s:i}),qC=(n,e,t,i,r)=>n*Math.pow(2,10*(i-=1))*Math.sin((i*r-e)*ki/t),Db=(n,e,t,i)=>-t*Math.cos(n/i*fo)+t+e,om=(n,e,t,i)=>(n/=i)<1/2.75?t*(7.5625*n*n)+e:n<2/2.75?t*(7.5625*(n-=1.5/2.75)*n+.75)+e:n<2.5/2.75?t*(7.5625*(n-=2.25/2.75)*n+.9375)+e:t*(7.5625*(n-=2.625/2.75)*n+.984375)+e,ZC=(n,e,t,i)=>t-om(i-n,0,t,i)+e,KA=Object.freeze({__proto__:null,defaultEasing:Db,easeInBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(n/=i)*n*((r+1)*n-r)+e;},easeInBounce:ZC,easeInCirc:(n,e,t,i)=>-t*(Math.sqrt(1-(n/=i)*n)-1)+e,easeInCubic:(n,e,t,i)=>t*(n/i)**3+e,easeInElastic:(n,e,t,i)=>{let r=t,o=0;if(n===0)return e;if((n/=i)===1)return e+t;o||(o=.3*i);let{a:s,s:l,p:c}=zg(r,t,o,1.70158);return-qC(s,l,c,n,i)+e;},easeInExpo:(n,e,t,i)=>n===0?e:t*2**(10*(n/i-1))+e,easeInOutBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(n/=i/2)<1?t/2*(n*n*((1+(r*=1.525))*n-r))+e:t/2*((n-=2)*n*((1+(r*=1.525))*n+r)+2)+e;},easeInOutBounce:(n,e,t,i)=>n<i/2?.5*ZC(2*n,0,t,i)+e:.5*om(2*n-i,0,t,i)+.5*t+e,easeInOutCirc:(n,e,t,i)=>(n/=i/2)<1?-t/2*(Math.sqrt(1-n**2)-1)+e:t/2*(Math.sqrt(1-(n-=2)*n)+1)+e,easeInOutCubic:(n,e,t,i)=>(n/=i/2)<1?t/2*n**3+e:t/2*((n-2)**3+2)+e,easeInOutElastic:(n,e,t,i)=>{let r=t,o=0;if(n===0)return e;if((n/=i/2)===2)return e+t;o||(o=i*(.3*1.5));let{a:s,s:l,p:c,c:d}=zg(r,t,o,1.70158);return n<1?-.5*qC(s,l,c,n,i)+e:s*Math.pow(2,-10*(n-=1))*Math.sin((n*i-l)*ki/c)*.5+d+e;},easeInOutExpo:(n,e,t,i)=>n===0?e:n===i?e+t:(n/=i/2)<1?t/2*2**(10*(n-1))+e:t/2*-(2**(-10*--n)+2)+e,easeInOutQuad:(n,e,t,i)=>(n/=i/2)<1?t/2*n**2+e:-t/2*(--n*(n-2)-1)+e,easeInOutQuart:(n,e,t,i)=>(n/=i/2)<1?t/2*n**4+e:-t/2*((n-=2)*n**3-2)+e,easeInOutQuint:(n,e,t,i)=>(n/=i/2)<1?t/2*n**5+e:t/2*((n-2)**5+2)+e,easeInOutSine:(n,e,t,i)=>-t/2*(Math.cos(Math.PI*n/i)-1)+e,easeInQuad:(n,e,t,i)=>t*(n/=i)*n+e,easeInQuart:(n,e,t,i)=>t*(n/=i)*n**3+e,easeInQuint:(n,e,t,i)=>t*(n/i)**5+e,easeInSine:(n,e,t,i)=>-t*Math.cos(n/i*fo)+t+e,easeOutBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((n=n/i-1)*n*((r+1)*n+r)+1)+e;},easeOutBounce:om,easeOutCirc:(n,e,t,i)=>t*Math.sqrt(1-(n=n/i-1)*n)+e,easeOutCubic:(n,e,t,i)=>t*((n/i-1)**3+1)+e,easeOutElastic:(n,e,t,i)=>{let r=t,o=0;if(n===0)return e;if((n/=i)===1)return e+t;o||(o=.3*i);let{a:s,s:l,p:c,c:d}=zg(r,t,o,1.70158);return s*2**(-10*n)*Math.sin((n*i-l)*ki/c)+d+e;},easeOutExpo:(n,e,t,i)=>n===i?e+t:t*-(2**(-10*n/i)+1)+e,easeOutQuad:(n,e,t,i)=>-t*(n/=i)*(n-2)+e,easeOutQuart:(n,e,t,i)=>-t*((n=n/i-1)*n**3-1)+e,easeOutQuint:(n,e,t,i)=>t*((n/i-1)**5+1)+e,easeOutSine:(n,e,t,i)=>t*Math.sin(n/i*fo)+e}),JA=()=>!1,Hl=class{constructor(e){let{startValue:t,byValue:i,duration:r=500,delay:o=0,easing:s=Db,onStart:l=bd,onChange:c=bd,onComplete:d=bd,abort:u=JA,target:g}=e;W(this,"_state","pending"),W(this,"durationProgress",0),W(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=r,this.delay=o,this.easing=s,this._onStart=l,this._onChange=c,this._onComplete=d,this._abort=u,this.target=g,this.startValue=t,this.byValue=i,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value);}get state(){return this._state;}isDone(){return this._state==="aborted"||this._state==="completed";}start(){let e=t=>{this._state==="pending"&&(this.startTime=t||+new Date(),this._state="running",this._onStart(),this.tick(this.startTime));};this.register(),this.delay>0?setTimeout(()=>Dl(e),this.delay):Dl(e);}tick(e){let t=(e||+new Date())-this.startTime,i=Math.min(t,this.duration);this.durationProgress=i/this.duration;let{value:r,valueProgress:o}=this.calculate(i);this.value=Object.freeze(r),this.valueProgress=o,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Dl(this.tick)));}register(){Td.push(this);}unregister(){Td.remove(this);}abort(){this._state="aborted",this.unregister();}},sm=class extends Hl{constructor(e){let o=e,{startValue:t=0,endValue:i=100}=o,r=lt(o,["startValue","endValue"]);super(se(D({},r),{startValue:t,byValue:i-t}));}calculate(e){let t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)};}},am=class extends Hl{constructor(e){let o=e,{startValue:t=[0],endValue:i=[100]}=o,r=lt(o,["startValue","endValue"]);super(se(D({},r),{startValue:t,byValue:i.map((s,l)=>s-t[l])}));}calculate(e){let t=this.startValue.map((i,r)=>this.easing(e,i,this.byValue[r],this.duration,r));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])};}},QA=(n,e,t,i)=>e+t*(1-Math.cos(n/i*fo)),jg=n=>n&&((e,t,i)=>n(new Dn(e).toRgba(),t,i)),lm=class extends Hl{constructor(e){let g=e,{startValue:t,endValue:i,easing:r=QA,onChange:o,onComplete:s,abort:l}=g,c=lt(g,["startValue","endValue","easing","onChange","onComplete","abort"]),d=new Dn(t).getSource(),u=new Dn(i).getSource();super(se(D({},c),{startValue:d,byValue:u.map((f,m)=>f-d[m]),easing:r,onChange:jg(o),onComplete:jg(s),abort:jg(l)}));}calculate(e){let[t,i,r,o]=this.startValue.map((l,c)=>this.easing(e,l,this.byValue[c],this.duration,c)),s=[...[t,i,r].map(Math.round),bs(0,o,1)];return{value:s,valueProgress:s.map((l,c)=>this.byValue[c]!==0?Math.abs((l-this.startValue[c])/this.byValue[c]):0).find(l=>l!==0)||0};}};function Ym(n){let e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(n)?new am(n):new sm(n);return e.start(),e;}function Nb(n){let e=new lm(n);return e.start(),e;}var vs=class n{constructor(e){this.status=e,this.points=[];}includes(e){return this.points.some(t=>t.eq(e));}append(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.points=this.points.concat(t.filter(r=>!this.includes(r))),this;}static isPointContained(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(i))return e.eq(t);if(t.x===i.x)return e.x===t.x&&(r||e.y>=Math.min(t.y,i.y)&&e.y<=Math.max(t.y,i.y));if(t.y===i.y)return e.y===t.y&&(r||e.x>=Math.min(t.x,i.x)&&e.x<=Math.max(t.x,i.x));{let o=$l(t,i),s=$l(t,e).divide(o);return r?Math.abs(s.x)===Math.abs(s.y):s.x===s.y&&s.x>=0&&s.x<=1;}}static isPointInPolygon(e,t){let i=new ne(e).setX(Math.min(e.x-1,...t.map(o=>o.x))),r=0;for(let o=0;o<t.length;o++){let s=this.intersectSegmentSegment(t[o],t[(o+1)%t.length],e,i);if(s.includes(e))return!0;r+=+(s.status==="Intersection");}return r%2==1;}static intersectLineLine(e,t,i,r){let o=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],s=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],l=t.x-e.x,c=t.y-e.y,d=r.x-i.x,u=r.y-i.y,g=e.x-i.x,f=e.y-i.y,m=d*f-u*g,_=l*f-c*g,y=u*l-d*c;if(y!==0){let E=m/y,C=_/y;return(o||0<=E&&E<=1)&&(s||0<=C&&C<=1)?new n("Intersection").append(new ne(e.x+E*l,e.y+E*c)):new n();}if(m===0||_===0){let E=o||s||n.isPointContained(e,i,r)||n.isPointContained(t,i,r)||n.isPointContained(i,e,t)||n.isPointContained(r,e,t);return new n(E?"Coincident":void 0);}return new n("Parallel");}static intersectSegmentLine(e,t,i,r){return n.intersectLineLine(e,t,i,r,!1,!0);}static intersectSegmentSegment(e,t,i,r){return n.intersectLineLine(e,t,i,r,!1,!1);}static intersectLinePolygon(e,t,i){let r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],o=new n(),s=i.length;for(let l,c,d,u=0;u<s;u++){if(l=i[u],c=i[(u+1)%s],d=n.intersectLineLine(e,t,l,c,r,!1),d.status==="Coincident")return d;o.append(...d.points);}return o.points.length>0&&(o.status="Intersection"),o;}static intersectSegmentPolygon(e,t,i){return n.intersectLinePolygon(e,t,i,!1);}static intersectPolygonPolygon(e,t){let i=new n(),r=e.length,o=[];for(let s=0;s<r;s++){let l=e[s],c=e[(s+1)%r],d=n.intersectSegmentPolygon(l,c,t);d.status==="Coincident"?(o.push(d),i.append(l,c)):i.append(...d.points);}return o.length>0&&o.length===e.length?new n("Coincident"):(i.points.length>0&&(i.status="Intersection"),i);}static intersectPolygonRectangle(e,t,i){let r=t.min(i),o=t.max(i),s=new ne(o.x,r.y),l=new ne(r.x,o.y);return n.intersectPolygonPolygon(e,[r,s,o,l]);}},cm=class extends kd{getX(){return this.getXY().x;}setX(e){this.setXY(this.getXY().setX(e));}getY(){return this.getXY().y;}setY(e){this.setXY(this.getXY().setY(e));}getRelativeX(){return this.left;}setRelativeX(e){this.left=e;}getRelativeY(){return this.top;}setRelativeY(e){this.top=e;}getXY(){let e=this.getRelativeXY();return this.group?cn(e,this.group.calcTransformMatrix()):e;}setXY(e,t,i){this.group&&(e=cn(e,Fn(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,i);}getRelativeXY(){return new ne(this.left,this.top);}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,i);}isStrokeAccountedForInDimensions(){return!1;}getCoords(){let{tl:e,tr:t,br:i,bl:r}=this.aCoords||(this.aCoords=this.calcACoords()),o=[e,t,i,r];if(this.group){let s=this.group.calcTransformMatrix();return o.map(l=>cn(l,s));}return o;}intersectsWithRect(e,t){return vs.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection";}intersectsWithObject(e){let t=vs.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e);}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t));}isContainedWithinRect(e,t){let{left:i,top:r,width:o,height:s}=this.getBoundingRect();return i>=e.x&&i+o<=t.x&&r>=e.y&&r+s<=t.y;}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this);}containsPoint(e){return vs.isPointInPolygon(e,this.getCoords());}isOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(i=>i.x<=t.x&&i.x>=e.x&&i.y<=t.y&&i.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t));}isPartiallyOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(i=>(i.x>=t.x||i.x<=e.x)&&(i.y>=t.y||i.y<=e.y))&&this.containsPoint(e.midPointFrom(t));}getBoundingRect(){return sr(this.getCoords());}getScaledWidth(){return this._getTransformedDimensions().x;}getScaledHeight(){return this._getTransformedDimensions().y;}scale(e){this._set(wn,e),this._set(Kn,e),this.setCoords();}scaleToWidth(e){let t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t);}scaleToHeight(e){let t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t);}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1;}getTotalAngle(){return this.group?Dr(vb(this.calcTransformMatrix())):this.angle;}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Pn.concat();}calcACoords(){let e=Ps({angle:this.angle}),{x:t,y:i}=this.getRelativeCenterPoint(),r=Oa(t,i),o=St(r,e),s=this._getTransformedDimensions(),l=s.x/2,c=s.y/2;return{tl:cn({x:-l,y:-c},o),tr:cn({x:l,y:-c},o),bl:cn({x:-l,y:c},o),br:cn({x:l,y:c},o)};}setCoords(){this.aCoords=this.calcACoords();}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Cn(this.originX),Cn(this.originY)),t;}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;let i=this.transformMatrixKey(e),r=this.matrixCache;return r&&r.key.every((o,s)=>o===i[s])?r.value:(this.group&&(t=St(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:i,value:t},t);}calcOwnMatrix(){let e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key.every((s,l)=>s===e[l]))return t.value;let i=this.getRelativeCenterPoint(),r={angle:this.angle,translateX:i.x,translateY:i.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},o=Cb(r);return this.ownMatrixCache={key:e,value:o},o;}_getNonTransformedDimensions(){return new ne(this.width,this.height).scalarAdd(this.strokeWidth);}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding);}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=D({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),i=t.strokeWidth,r=i,o=0;this.strokeUniform&&(r=0,o=i);let s=t.width+r,l=t.height+r,c;return c=t.skewX===0&&t.skewY===0?new ne(s*t.scaleX,l*t.scaleY):ou(s,l,Xl(t)),c.scalarAdd(o);}translateToGivenOrigin(e,t,i,r,o){let s=e.x,l=e.y,c=Cn(r)-Cn(t),d=Cn(o)-Cn(i);if(c||d){let u=this._getTransformedDimensions();s+=c*u.x,l+=d*u.y;}return new ne(s,l);}translateToCenterPoint(e,t,i){if(t===De&&i===De)return e;let r=this.translateToGivenOrigin(e,t,i,De,De);return this.angle?r.rotate(Tt(this.angle),e):r;}translateToOriginPoint(e,t,i){let r=this.translateToGivenOrigin(e,De,De,t,i);return this.angle?r.rotate(Tt(this.angle),e):r;}getCenterPoint(){let e=this.getRelativeCenterPoint();return this.group?cn(e,this.group.calcTransformMatrix()):e;}getRelativeCenterPoint(){return this.translateToCenterPoint(new ne(this.left,this.top),this.originX,this.originY);}getPointByOrigin(e,t){return this.getPositionByOrigin(e,t);}getPositionByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t);}setPositionByOrigin(e,t,i){let r=this.translateToCenterPoint(e,t,i),o=this.translateToOriginPoint(r,this.originX,this.originY);this.set({left:o.x,top:o.y});}_getLeftTopCoords(){return this.getPositionByOrigin(ot,Rn);}positionByLeftTop(e){return this.setPositionByOrigin(e,ot,Rn);}},Or=class Pd extends cm{static getDefaults(){return Pd.ownDefaults;}get type(){let e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase();}set type(e){Lr("warn","Setting type has no effect",e);}constructor(e){super(),W(this,"_cacheContext",null),Object.assign(this,Pd.ownDefaults),this.setOptions(e);}_createCacheCanvas(){this._cacheCanvas=lr(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0;}_limitCacheSize(e){let t=e.width,i=e.height,r=Ze.maxCacheSideLimit,o=Ze.minCacheSideLimit;if(t<=r&&i<=r&&t*i<=Ze.perfLimitSizeTotal)return t<o&&(e.width=o),i<o&&(e.height=o),e;let s=t/i,[l,c]=Ll.limitDimsByArea(s),d=bs(o,l,r),u=bs(o,c,r);return t>d&&(e.zoomX/=t/d,e.width=d,e.capped=!0),i>u&&(e.zoomY/=i/u,e.height=u,e.capped=!0),e;}_getCacheCanvasDimensions(){let e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),i=t.x*e.x/this.scaleX,r=t.y*e.y/this.scaleY;return{width:Math.ceil(i+2),height:Math.ceil(r+2),zoomX:e.x,zoomY:e.y,x:i,y:r};}_updateCacheCanvas(){let e=this._cacheCanvas,t=this._cacheContext,{width:i,height:r,zoomX:o,zoomY:s,x:l,y:c}=this._limitCacheSize(this._getCacheCanvasDimensions()),d=i!==e.width||r!==e.height,u=this.zoomX!==o||this.zoomY!==s;if(!e||!t)return!1;if(d||u){i!==e.width||r!==e.height?(e.width=i,e.height=r):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));let g=l/2,f=c/2;return this.cacheTranslationX=Math.round(e.width/2-g)+g,this.cacheTranslationY=Math.round(e.height/2-f)+f,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(o,s),this.zoomX=o,this.zoomY=s,!0;}return!1;}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e);}transform(e){let t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,i=this.calcTransformMatrix(!t);e.transform(i[0],i[1],i[2],i[3],i[4],i[5]);}getObjectScaling(){if(!this.group)return new ne(Math.abs(this.scaleX),Math.abs(this.scaleY));let e=ys(this.calcTransformMatrix());return new ne(Math.abs(e.scaleX),Math.abs(e.scaleY));}getTotalObjectScaling(){let e=this.getObjectScaling();if(this.canvas){let t=this.canvas.getZoom(),i=this.getCanvasRetinaScaling();return e.scalarMultiply(t*i);}return e;}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e;}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e;}_set(e,t){e!==wn&&e!==Kn||(t=this._constrainScale(t)),e===wn&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof po||(t=new po(t));let i=this[e]!==t;return this[e]=t,i&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||i&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this;}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible;}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore());}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){let{zoomX:t,zoomY:i,cacheTranslationX:r,cacheTranslationY:o}=this,{width:s,height:l}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:i,cacheTranslationX:r,cacheTranslationY:o,width:s,height:l,parentClipPaths:[]}),this.dirty=!1;}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null;}hasStroke(){return!!this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0;}hasFill(){return!!this.fill&&this.fill!=="transparent";}needsItsOwnCache(){return!!(this.paintFirst===Ln&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath;}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching;}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0);}drawClipPathOnCache(e,t,i){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(i,0,0),e.restore();}drawObject(e,t,i){let r=this.fill,o=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,i),this.fill=r,this.stroke=o;}createClipPathLayer(e,t){let i=Jn(t),r=i.getContext("2d");if(r.translate(t.cacheTranslationX,t.cacheTranslationY),r.scale(t.zoomX,t.zoomY),e._cacheCanvas=i,t.parentClipPaths.forEach(o=>{o.transform(r);}),t.parentClipPaths.push(e),e.absolutePositioned){let o=Fn(this.calcTransformMatrix());r.transform(o[0],o[1],o[2],o[3],o[4],o[5]);}return e.transform(r),e.drawObject(r,!0,t),i;}_drawClipPath(e,t,i){if(!t)return;t._transformDone=!0;let r=this.createClipPathLayer(t,i);this.drawClipPathOnCache(e,t,r);}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY);}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;let t=this._cacheCanvas,i=this._cacheContext;return!(!t||!i||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&i&&!e&&(i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,t.width,t.height),i.restore()),!0);}_renderBackground(e){if(!this.backgroundColor)return;let t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e);}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity;}_setStrokeStyles(e,t){let i=t.stroke;i&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,di(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?this._applyPatternForTransformedGradient(e,i):(e.strokeStyle=i.toLive(e),this._applyPatternGradientTransform(e,i)):e.strokeStyle=t.stroke);}_setFillStyles(e,t){let{fill:i}=t;i&&(di(i)?(e.fillStyle=i.toLive(e),this._applyPatternGradientTransform(e,i)):e.fillStyle=i);}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000";}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t);}_setShadow(e){if(!this.shadow)return;let t=this.shadow,i=this.canvas,r=this.getCanvasRetinaScaling(),[o,,,s]=i?.viewportTransform||Pn,l=o*r,c=s*r,d=t.nonScaling?new ne(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Ze.browserShadowBlurConstant*(l+c)*(d.x+d.y)/4,e.shadowOffsetX=t.offsetX*l*d.x,e.shadowOffsetY=t.offsetY*c*d.y;}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0);}_applyPatternGradientTransform(e,t){if(!di(t))return{offsetX:0,offsetY:0};let i=t.gradientTransform||t.patternTransform,r=-this.width/2+t.offsetX||0,o=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,r,o):e.transform(1,0,0,1,r,o),i&&e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:r,offsetY:o};}_renderPaintInOrder(e){this.paintFirst===Ln?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e));}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore());}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){let t=this.getObjectScaling();e.scale(1/t.x,1/t.y);}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore();}}_applyPatternForTransformedGradient(e,t){var i;let r=this._limitCacheSize(this._getCacheCanvasDimensions()),o=this.getCanvasRetinaScaling(),s=r.x/this.scaleX/o,l=r.y/this.scaleY/o,c=Jn({width:Math.ceil(s),height:Math.ceil(l)}),d=c.getContext("2d");d&&(d.beginPath(),d.moveTo(0,0),d.lineTo(s,0),d.lineTo(s,l),d.lineTo(0,l),d.closePath(),d.translate(s/2,l/2),d.scale(r.zoomX/this.scaleX/o,r.zoomY/this.scaleY/o),this._applyPatternGradientTransform(d,t),d.fillStyle=t.toLive(e),d.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(o*this.scaleX/r.zoomX,o*this.scaleY/r.zoomY),e.strokeStyle=(i=d.createPattern(c,"no-repeat"))!==null&&i!==void 0?i:"");}_findCenterFromElement(){return new ne(this.left+this.width/2,this.top+this.height/2);}clone(e){let t=this.toObject(e);return this.constructor.fromObject(t);}cloneAsImage(e){let t=this.toCanvasElement(e);return new(Ce.getClass("image"))(t);}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=jm(this),i=this.group,r=this.shadow,o=Math.abs,s=e.enableRetinaScaling?cb():1,l=(e.multiplier||1)*s,c=e.canvasProvider||(b=>new jl(b,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&Sb(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&nm(this,this.getViewportTransform()),this.setCoords();let d=lr(),u=this.getBoundingRect(),g=this.shadow,f=new ne();if(g){let b=g.blur,x=g.nonScaling?new ne(1,1):this.getObjectScaling();f.x=2*Math.round(o(g.offsetX)+b)*o(x.x),f.y=2*Math.round(o(g.offsetY)+b)*o(x.y);}let m=u.width+f.x,_=u.height+f.y;d.width=Math.ceil(m),d.height=Math.ceil(_);let y=c(d);e.format==="jpeg"&&(y.backgroundColor="#fff"),this.setPositionByOrigin(new ne(y.width/2,y.height/2),De,De);let E=this.canvas;y._objects=[this],this.set("canvas",y),this.setCoords();let C=y.toCanvasElement(l||1,e);return this.set("canvas",E),this.shadow=r,i&&(this.group=i),this.set(t),this.setCoords(),y._objects=[],y.destroy(),C;}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Dm(this.toCanvasElement(e),e.format||"png",e.quality||1);}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Nm(this.toCanvasElement(e),e.format||"png",e.quality||1);}isType(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.includes(this.constructor.type)||t.includes(this.type);}complexity(){return 1;}toJSON(){return this.toObject();}rotate(e){let{centeredRotation:t,originX:i,originY:r}=this;if(t){let{x:o,y:s}=this.getRelativeCenterPoint();this.originX=De,this.originY=De,this.left=o,this.top=s;}if(this.set("angle",e),t){let{x:o,y:s}=this.getPositionByOrigin(i,r);this.left=o,this.top=s,this.originX=i,this.originY=r;}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation);}dispose(){Td.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&ar().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null;}animate(e,t){return Object.entries(e).reduce((i,r)=>{let[o,s]=r;return i[o]=this._animate(o,s,t),i;},{});}_animate(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.split("."),o=this.constructor.colorProperties.includes(r[r.length-1]),{abort:s,startValue:l,onChange:c,onComplete:d}=i,u=se(D({},i),{target:this,startValue:l??r.reduce((g,f)=>g[f],this),endValue:t,abort:s?.bind(this),onChange:(g,f,m)=>{r.reduce((_,y,E)=>(E===r.length-1&&(_[y]=g),_[y]),this),c&&c(g,f,m);},onComplete:(g,f,m)=>{this.setCoords(),d&&d(g,f,m);}});return o?Nb(u):Ym(u);}isDescendantOf(e){let{parent:t,group:i}=this;return t===e||i===e||!!t&&t.isDescendantOf(e)||!!i&&i!==t&&i.isDescendantOf(e);}getAncestors(){let e=[],t=this;do t=t.parent,t&&e.push(t);while(t);return e;}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};let t=this.getAncestors(),i=e.getAncestors();if(t.length===0&&i.length>0&&this===i[i.length-1])return{fork:[],otherFork:[e,...i.slice(0,i.length-1)],common:[this]};for(let r,o=0;o<t.length;o++){if(r=t[o],r===e)return{fork:[this,...t.slice(0,o)],otherFork:[],common:t.slice(o)};for(let s=0;s<i.length;s++){if(this===i[s])return{fork:[],otherFork:[e,...i.slice(0,s)],common:[this,...t]};if(r===i[s])return{fork:[this,...t.slice(0,o)],otherFork:[e,...i.slice(0,s)],common:t.slice(o)};}}return{fork:[this,...t],otherFork:[e,...i],common:[]};}hasCommonAncestors(e){let t=this.findCommonAncestors(e);return t&&!!t.common.length;}isInFrontOf(e){if(this===e)return;let t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;let i=t.common[0]||this.canvas;if(!i)return;let r=t.fork.pop(),o=t.otherFork.pop(),s=i._objects.indexOf(r),l=i._objects.indexOf(o);return s>-1&&s>l;}toObject(){let e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Pd.customProperties,this.constructor.customProperties||[]),t,i=Ze.NUM_FRACTION_DIGITS,{clipPath:r,fill:o,stroke:s,shadow:l,strokeDashArray:c,left:d,top:u,originX:g,originY:f,width:m,height:_,strokeWidth:y,strokeLineCap:E,strokeDashOffset:C,strokeLineJoin:b,strokeUniform:x,strokeMiterLimit:w,scaleX:T,scaleY:R,angle:V,flipX:B,flipY:Y,opacity:le,visible:ae,backgroundColor:ee,fillRule:ce,paintFirst:oe,globalCompositeOperation:re,skewX:A,skewY:z}=this;r&&!r.excludeFromExport&&(t=r.toObject(e.concat("inverted","absolutePositioned")));let O=H=>pt(H,i),k=D(se(D({},ws(this,e)),{type:this.constructor.type,version:Kg,originX:g,originY:f,left:O(d),top:O(u),width:O(m),height:O(_),fill:DC(o)?o.toObject():o,stroke:DC(s)?s.toObject():s,strokeWidth:O(y),strokeDashArray:c&&c.concat(),strokeLineCap:E,strokeDashOffset:C,strokeLineJoin:b,strokeUniform:x,strokeMiterLimit:O(w),scaleX:O(T),scaleY:O(R),angle:O(V),flipX:B,flipY:Y,opacity:O(le),shadow:l&&l.toObject(),visible:ae,backgroundColor:ee,fillRule:ce,paintFirst:oe,globalCompositeOperation:re,skewX:O(A),skewY:O(z)}),t?{clipPath:t}:null);return this.includeDefaultValues?k:this._removeDefaultValues(k);}toDatalessObject(e){return this.toObject(e);}_removeDefaultValues(e){let t=this.constructor.getDefaults(),i=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return zm(e,(r,o)=>{if(o===ot||o===Rn||o==="type")return!0;let s=i[o];return r!==s&&!(Array.isArray(r)&&Array.isArray(s)&&r.length===0&&s.length===0);});}toString(){return`#<${this.constructor.type}>`;}static _fromObject(e){let s=e,{type:t}=s,i=lt(s,["type"]),l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:r}=l,o=lt(l,["extraParam"]);return ql(i,o).then(c=>r?(delete c[r],new this(i[r],c)):new this(c));}static fromObject(e,t){return this._fromObject(e,t);}};W(Or,"stateProperties",qA),W(Or,"cacheProperties",Br),W(Or,"ownDefaults",ZA),W(Or,"type","FabricObject"),W(Or,"colorProperties",[Gt,Ln,"backgroundColor"]),W(Or,"customProperties",[]),Ce.setClass(Or),Ce.setClass(Or,"object");var Xm=(n,e)=>{var t;let{transform:{target:i}}=e;(t=i.canvas)===null||t===void 0||t.fire(`object:${n}`,se(D({},e),{target:i})),i.fire(n,e);},Vr=(n,e,t)=>(i,r,o,s)=>{let l=e(i,r,o,s);return l&&Xm(n,D(D({},Wm(i,r,o,s)),t)),l;};function mo(n){return(e,t,i,r)=>{let{target:o,originX:s,originY:l}=t,c=o.getPositionByOrigin(s,l),d=n(e,t,i,r);return o.setPositionByOrigin(c,t.originX,t.originY),d;};}var Bb=(n,e,t,i)=>(r,o,s,l)=>{let c=au(o,o.originX,o.originY,s,l)[t],d=Cn(o[e]);if(d===0||d>0&&c<0||d<0&&c>0){let{target:u}=o,g=u.strokeWidth/(u.strokeUniform?u[i]:1),f=kb(o)?2:1,m=u[n],_=Math.abs(c*f/u[i])-g;return u.set(n,Math.max(_,1)),m!==u[n];}return!1;},Vb=Bb("width","originX","x","scaleX"),zb=Bb("height","originY","y","scaleY"),hm=Vr(ya,mo(Vb)),eF=Vr(ya,mo(zb));function jb(n,e,t,i,r){n.save();let{stroke:o,xSize:s,ySize:l,opName:c}=this.commonRenderProps(n,e,t,r,i),d=s;s>l?n.scale(1,l/s):l>s&&(d=l,n.scale(s/l,1)),n.beginPath(),n.arc(0,0,d/2,0,ki,!1),n[c](),o&&n.stroke(),n.restore();}function $b(n,e,t,i,r){n.save();let{stroke:o,xSize:s,ySize:l,opName:c}=this.commonRenderProps(n,e,t,r,i),d=s/2,u=l/2;n[`${c}Rect`](-d,-u,s,l),o&&n.strokeRect(-d,-u,s,l),n.restore();}var vn=class{constructor(e){W(this,"visible",!0),W(this,"actionName",nu),W(this,"angle",0),W(this,"x",0),W(this,"y",0),W(this,"offsetX",0),W(this,"offsetY",0),W(this,"sizeX",0),W(this,"sizeY",0),W(this,"touchSizeX",0),W(this,"touchSizeY",0),W(this,"cursorStyle","crosshair"),W(this,"withConnection",!1),Object.assign(this,e);}shouldActivate(e,t,i,r){var o;let{tl:s,tr:l,br:c,bl:d}=r;return((o=t.canvas)===null||o===void 0?void 0:o.getActiveObject())===t&&t.isControlVisible(e)&&vs.isPointInPolygon(i,[s,l,c,d]);}getActionHandler(e,t,i){return this.actionHandler;}getMouseDownHandler(e,t,i){return this.mouseDownHandler;}getMouseUpHandler(e,t,i){return this.mouseUpHandler;}cursorStyleHandler(e,t,i,r){return t.cursorStyle;}getActionName(e,t,i){return t.actionName;}getVisibility(e,t){var i,r;return(i=(r=e._controlsVisibility)===null||r===void 0?void 0:r[t])!==null&&i!==void 0?i:this.visible;}setVisibility(e,t,i){this.visible=e;}positionHandler(e,t,i,r){return new ne(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t);}calcCornerCoords(e,t,i,r,o,s){let l=iu([Oa(i,r),Ps({angle:e}),ru((o?this.touchSizeX:this.sizeX)||t,(o?this.touchSizeY:this.sizeY)||t)]);return{tl:new ne(-.5,-.5).transform(l),tr:new ne(.5,-.5).transform(l),br:new ne(.5,.5).transform(l),bl:new ne(-.5,.5).transform(l)};}commonRenderProps(e,t,i,r){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},{cornerSize:s,cornerColor:l,transparentCorners:c,cornerStrokeColor:d}=o,u=s||r.cornerSize,g=this.sizeX||u,f=this.sizeY||u,m=c!==void 0?c:r.transparentCorners,_=m?Ln:Gt,y=d||r.cornerStrokeColor,E=!m&&!!y;return e.fillStyle=l||r.cornerColor||"",e.strokeStyle=y||"",e.translate(t,i),e.rotate(Tt(r.getTotalAngle())),{stroke:E,xSize:g,ySize:f,transparentCorners:m,opName:_};}render(e,t,i,r,o){((r=r||{}).cornerStyle||o.cornerStyle)==="circle"?jb.call(this,e,t,i,r,o):$b.call(this,e,t,i,r,o);}},Ub=(n,e,t)=>t.lockRotation?Ld:e.cursorStyle,Hb=Vr(db,mo((n,e,t,i)=>{let{target:r,ex:o,ey:s,theta:l,originX:c,originY:d}=e,u=r.getPositionByOrigin(c,d);if(Ti(r,"lockRotation"))return!1;let g=Math.atan2(s-u.y,o-u.x),f=Math.atan2(i-u.y,t-u.x),m=Dr(f-g+l);if(r.snapAngle&&r.snapAngle>0){let y=r.snapAngle,E=r.snapThreshold||y,C=Math.ceil(m/y)*y,b=Math.floor(m/y)*y;Math.abs(m-b)<E?m=b:Math.abs(m-C)<E&&(m=C);}m<0&&(m=360+m),m%=360;let _=r.angle!==m;return r.angle=m,_;}));function Wb(n,e){let t=e.canvas,i=n[t.uniScaleKey];return t.uniformScaling&&!i||!t.uniformScaling&&i;}function Gb(n,e,t){let i=Ti(n,"lockScalingX"),r=Ti(n,"lockScalingY");if(i&&r||!e&&(i||r)&&t||i&&e==="x"||r&&e==="y")return!0;let{width:o,height:s,strokeWidth:l}=n;return o===0&&l===0&&e!=="y"||s===0&&l===0&&e!=="x";}var tF=["e","se","s","sw","w","nw","n","ne","e"],ua=(n,e,t,i)=>{let r=Wb(n,t);if(Gb(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",r))return Ld;let o=Ib(t,0,i);return`${tF[o]}-resize`;};function qm(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},o=e.target,s=r.by,l=Wb(n,o),c,d,u,g,f,m;if(Gb(o,s,l))return!1;if(e.gestureScale)d=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(c=au(e,e.originX,e.originY,t,i),f=s!=="y"?Math.sign(c.x||e.signX||1):1,m=s!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=f),e.signY||(e.signY=m),Ti(o,"lockScalingFlip")&&(e.signX!==f||e.signY!==m))return!1;if(g=o._getTransformedDimensions(),l&&!s){let E=Math.abs(c.x)+Math.abs(c.y),{original:C}=e,b=E/(Math.abs(g.x*C.scaleX/o.scaleX)+Math.abs(g.y*C.scaleY/o.scaleY));d=C.scaleX*b,u=C.scaleY*b;}else d=Math.abs(c.x*o.scaleX/g.x),u=Math.abs(c.y*o.scaleY/g.y);kb(e)&&(d*=2,u*=2),e.signX!==f&&s!=="y"&&(e.originX=zC(e.originX),d*=-1,e.signX=f),e.signY!==m&&s!=="x"&&(e.originY=zC(e.originY),u*=-1,e.signY=m);}let _=o.scaleX,y=o.scaleY;return s?(s==="x"&&o.set(wn,d),s==="y"&&o.set(Kn,u)):(!Ti(o,"lockScalingX")&&o.set(wn,d),!Ti(o,"lockScalingY")&&o.set(Kn,u)),_!==o.scaleX||y!==o.scaleY;}var Fl=Vr(tu,mo((n,e,t,i)=>qm(n,e,t,i))),Yb=Vr(tu,mo((n,e,t,i)=>qm(n,e,t,i,{by:"x"}))),Xb=Vr(tu,mo((n,e,t,i)=>qm(n,e,t,i,{by:"y"}))),$g={x:{counterAxis:"y",scale:wn,skew:Sa,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Kn,skew:Ea,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},nF=["ns","nesw","ew","nwse"],qb=(n,e,t,i)=>{if(e.x!==0&&Ti(t,"lockSkewingY")||e.y!==0&&Ti(t,"lockSkewingX"))return Ld;let r=Ib(t,0,i)%4;return`${nF[r]}-resize`;};function Zb(n,e,t,i,r){let{target:o}=t,{counterAxis:s,origin:l,lockSkewing:c,skew:d,flip:u}=$g[n];if(Ti(o,c))return!1;let{origin:g,flip:f}=$g[s],m=Cn(t[g])*(o[f]?-1:1),_=-Math.sign(m)*(o[u]?-1:1),y=.5*-((o[d]===0&&au(t,De,De,i,r)[n]>0||o[d]>0?1:-1)*_)+.5;return Vr(ub,mo((C,b,x,w)=>function(T,R,V){let pe=R,{target:B,ex:Y,ey:le,skewingSide:ae}=pe,ee=lt(pe,["target","ex","ey","skewingSide"]),{skew:ce}=$g[T],oe=V.subtract(new ne(Y,le)).divide(new ne(B.scaleX,B.scaleY))[T],re=B[ce],A=ee[ce],z=Math.tan(Tt(A)),O=T==="y"?B._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:B._getTransformedDimensions({scaleX:1,scaleY:1}).y,k=2*oe*ae/Math.max(O,1)+z,H=Dr(Math.atan(k));B.set(ce,H);let U=re!==B[ce];if(U&&T==="y"){let{skewX:me,scaleX:fe}=B,Fe=B._getTransformedDimensions({skewY:re}),Te=B._getTransformedDimensions(),qe=me!==0?Fe.x/Te.x:1;qe!==1&&B.set(wn,qe*fe);}return U;}(n,b,new ne(x,w))))(e,se(D({},t),{[l]:y,skewingSide:_}),i,r);}var Kb=(n,e,t,i)=>Zb("x",n,e,t,i),Jb=(n,e,t,i)=>Zb("y",n,e,t,i);function cu(n,e){return n[e.canvas.altActionKey];}var Rl=(n,e,t)=>{let i=cu(n,t);return e.x===0?i?Sa:Kn:e.y===0?i?Ea:wn:"";},ts=(n,e,t,i)=>cu(n,t)?qb(0,e,t,i):ua(n,e,t,i),dm=(n,e,t,i)=>cu(n,e.target)?Jb(n,e,t,i):Yb(n,e,t,i),um=(n,e,t,i)=>cu(n,e.target)?Kb(n,e,t,i):Xb(n,e,t,i),Zm=()=>({ml:new vn({x:-.5,y:0,cursorStyleHandler:ts,actionHandler:dm,getActionName:Rl}),mr:new vn({x:.5,y:0,cursorStyleHandler:ts,actionHandler:dm,getActionName:Rl}),mb:new vn({x:0,y:.5,cursorStyleHandler:ts,actionHandler:um,getActionName:Rl}),mt:new vn({x:0,y:-.5,cursorStyleHandler:ts,actionHandler:um,getActionName:Rl}),tl:new vn({x:-.5,y:-.5,cursorStyleHandler:ua,actionHandler:Fl}),tr:new vn({x:.5,y:-.5,cursorStyleHandler:ua,actionHandler:Fl}),bl:new vn({x:-.5,y:.5,cursorStyleHandler:ua,actionHandler:Fl}),br:new vn({x:.5,y:.5,cursorStyleHandler:ua,actionHandler:Fl}),mtr:new vn({x:0,y:-.5,actionHandler:Hb,cursorStyleHandler:Ub,offsetY:-40,withConnection:!0,actionName:Rm})}),Qb=()=>({mr:new vn({x:.5,y:0,actionHandler:hm,cursorStyleHandler:ts,actionName:ya}),ml:new vn({x:-.5,y:0,actionHandler:hm,cursorStyleHandler:ts,actionName:ya})}),ex=()=>D(D({},Zm()),Qb()),Vd=class n extends Or{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(e){super(),Object.assign(this,this.constructor.createControls(),n.ownDefaults),this.setOptions(e);}static createControls(){return{controls:Zm()};}_updateCacheCanvas(){let e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){let t=e._currentTransform,i=t.target,r=t.action;if(this===i&&r&&r.startsWith(nu))return!1;}return super._updateCacheCanvas();}getActiveControl(){let e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0;}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;let i=Object.entries(this.oCoords);for(let r=i.length-1;r>=0;r--){let[o,s]=i[r],l=this.controls[o];if(l.shouldActivate(o,this,e,t?s.touchCorner:s.corner))return this.__corner=o,{key:o,control:l,coord:this.oCoords[o]};}}calcOCoords(){let e=this.getViewportTransform(),t=this.getCenterPoint(),i=Oa(t.x,t.y),r=Ps({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),o=St(i,r),s=St(e,o),l=St(s,[1/e[0],0,0,1/e[3],0,0]),c=this.group?ys(this.calcTransformMatrix()):void 0;c&&(c.scaleX=Math.abs(c.scaleX),c.scaleY=Math.abs(c.scaleY));let d=this._calculateCurrentDimensions(c),u={};return this.forEachControl((g,f)=>{let m=g.positionHandler(d,l,this,g);u[f]=Object.assign(m,this._calcCornerCoords(g,m));}),u;}_calcCornerCoords(e,t){let i=this.getTotalAngle();return{corner:e.calcCornerCoords(i,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(i,this.touchCornerSize,t.x,t.y,!0,this)};}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords());}forEachControl(e){for(let t in this.controls)e(this.controls[t],t,this);}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();let t=this.getRelativeCenterPoint(),i=this._calculateCurrentDimensions(),r=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/r[0],1/r[3]),e.rotate(Tt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-i.x/2,-i.y/2,i.x,i.y),e.restore();}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y);}_drawBorders(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=D({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},i);e.save(),e.strokeStyle=r.borderColor,this._setLineDash(e,r.borderDashArray),this.strokeBorders(e,t),r.hasControls&&this.drawControlsConnectingLines(e,t),e.restore();}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{hasBorders:i,hasControls:r}=this,o=D({hasBorders:i,hasControls:r},t),s=this.getViewportTransform(),l=o.hasBorders,c=o.hasControls,d=St(s,this.calcTransformMatrix()),u=ys(d);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(Tt(this.group?u.angle:this.angle)),l&&this.drawBorders(e,u,t),c&&this.drawControls(e,t),e.restore();}drawBorders(e,t,i){let r;if(i&&i.forActiveSelection||this.group){let o=ou(this.width,this.height,Xl(t)),s=this.isStrokeAccountedForInDimensions()?Lm:(this.strokeUniform?new ne().scalarAdd(this.canvas?this.canvas.getZoom():1):new ne(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);r=o.add(s).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding);}else r=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,r,i);}drawControlsConnectingLines(e,t){let i=!1;e.beginPath(),this.forEachControl((r,o)=>{r.withConnection&&r.getVisibility(this,o)&&(i=!0,e.moveTo(r.x*t.x,r.y*t.y),e.lineTo(r.x*t.x+r.offsetX,r.y*t.y+r.offsetY));}),i&&e.stroke();}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();let i=this.getCanvasRetinaScaling(),{cornerStrokeColor:r,cornerDashArray:o,cornerColor:s}=this,l=D({cornerStrokeColor:r,cornerDashArray:o,cornerColor:s},t);e.setTransform(i,0,0,i,0,0),e.strokeStyle=e.fillStyle=l.cornerColor,this.transparentCorners||(e.strokeStyle=l.cornerStrokeColor),this._setLineDash(e,l.cornerDashArray),this.forEachControl((c,d)=>{if(c.getVisibility(this,d)){let u=this.oCoords[d];c.render(e,u.x,u.y,l,this);}}),e.restore();}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e);}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t;}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[i,r]=t;return this.setControlVisible(i,r);});}clearContextTop(e){if(!this.canvas)return;let t=this.canvas.contextTop;if(!t)return;let i=this.canvas.viewportTransform;t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(t);let r=this.width+4,o=this.height+4;return t.clearRect(-r/2,-o/2,r,o),e||t.restore(),t;}onDeselect(e){return!1;}onSelect(e){return!1;}shouldStartDragging(e){return!1;}onDragStart(e){return!1;}canDrop(e){return!1;}renderDragSourceEffect(e){}renderDropTargetEffect(e){}};function tx(n,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(i=>{i!=="constructor"&&Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i)||Object.create(null));});}),n;}W(Vd,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});var qt=class extends Vd{};tx(qt,[Nd]),Ce.setClass(qt),Ce.setClass(qt,"object");var nx=(n,e,t,i)=>{let r=2*(i=Math.round(i))+1,{data:o}=n.getImageData(e-i,t-i,r,r);for(let s=3;s<o.length;s+=4)if(o[s]>0)return!1;return!0;},zd=class{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new ne(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new ne(1/this.options.scaleX,1/this.options.scaleY):new ne(1,1);}createSideVector(e,t){let i=$l(e,t);return this.options.strokeUniform?i.multiply(this.scale):i;}projectOrthogonally(e,t,i){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,i)));}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0;}applySkew(e){let t=new ne(e);return t.y+=t.x*Math.tan(Tt(this.options.skewY)),t.x+=t.y*Math.tan(Tt(this.options.skewX)),t;}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t);}},iF=new ne(),jd=class n extends zd{static getOrthogonalRotationFactor(e,t){let i=t?Rd(e,t):Um(e);return Math.abs(i)<fo?-1:1;}constructor(e,t,i,r){super(r),W(this,"AB",void 0),W(this,"AC",void 0),W(this,"alpha",void 0),W(this,"bisector",void 0),this.A=new ne(e),this.B=new ne(t),this.C=new ne(i),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Rd(this.AB,this.AC),this.bisector=su($m(this.AB.eq(iF)?this.AC:this.AB,this.alpha/2));}calcOrthogonalProjection(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,r=this.createSideVector(e,t),o=Hm(r),s=n.getOrthogonalRotationFactor(o,this.bisector);return this.scaleUnitVector(o,i*s);}projectBevel(){let e=[];return(this.alpha%ki===0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude));}),e;}projectMiter(){let e=[],t=Math.abs(this.alpha),i=1/Math.sin(t/2),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*i),o=this.options.strokeUniform?Fd(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Fd(r)/this.strokeProjectionMagnitude<=o&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e;}projectRoundNoSkew(e,t){let i=[],r=new ne(n.getOrthogonalRotationFactor(this.bisector),n.getOrthogonalRotationFactor(new ne(this.bisector.y,this.bisector.x)));return[new ne(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r),new ne(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r)].forEach(o=>{im(o,e,t)&&i.push(this.A.add(o));}),i;}projectRoundWithSkew(e,t){let i=[],{skewX:r,skewY:o,scaleX:s,scaleY:l,strokeUniform:c}=this.options,d=new ne(Math.tan(Tt(r)),Math.tan(Tt(o))),u=this.strokeProjectionMagnitude,g=c?u/l/Math.sqrt(1/l**2+1/s**2*d.y**2):u/Math.sqrt(1+d.y**2),f=new ne(Math.sqrt(Math.max(u**2-g**2,0)),g),m=c?u/Math.sqrt(1+d.x**2*(1/l)**2/(1/s+1/s*d.x*d.y)**2):u/Math.sqrt(1+d.x**2/(1+d.x*d.y)**2),_=new ne(m,Math.sqrt(Math.max(u**2-m**2,0)));return[_,_.scalarMultiply(-1),f,f.scalarMultiply(-1)].map(y=>this.applySkew(c?y.multiply(this.strokeUniformScalar):y)).forEach(y=>{im(y,e,t)&&i.push(this.applySkew(this.A).add(y));}),i;}projectRound(){let e=[];e.push(...this.projectBevel());let t=this.alpha%ki===0,i=this.applySkew(this.A),r=e[t?0:2].subtract(i),o=e[t?1:0].subtract(i),s=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),l=_a(r,s)>0,c=l?r:o,d=l?o:r;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,d)):e.push(...this.projectRoundNoSkew(c,d)),e;}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel();}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}));}},$d=class extends zd{constructor(e,t,i){super(i),this.A=new ne(e),this.T=new ne(t);}calcOrthogonalProjection(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,r=this.createSideVector(e,t);return this.scaleUnitVector(Hm(r),i);}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)];}projectRound(){let e=[];if(!this.isSkewed()&&this.A.eq(this.T)){let t=new ne(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)));}else e.push(...new jd(this.A,this.T,this.T,this.options).projectRound());return e;}projectSquare(){let e=[];if(this.A.eq(this.T)){let t=new ne(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t));}else{let t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),i=this.scaleUnitVector(su(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),r=this.A.add(i);e.push(r.add(t),r.subtract(t));}return e.map(t=>this.applySkew(t));}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt();}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}));}},ix=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2],i=[];if(n.length===0)return i;let r=n.reduce((o,s)=>(o[o.length-1].eq(s)||o.push(new ne(s)),o),[new ne(n[0])]);if(r.length===1)t=!0;else if(!t){let o=r[0],s=((l,c)=>{for(let d=l.length-1;d>=0;d--)if(c(l[d],d,l))return d;return-1;})(r,l=>!l.eq(o));r.splice(s+1);}return r.forEach((o,s,l)=>{let c,d;s===0?(d=l[1],c=t?o:l[l.length-1]):s===l.length-1?(c=l[s-1],d=t?o:l[0]):(c=l[s-1],d=l[s+1]),t&&l.length===1?i.push(...new $d(o,o,e).project()):!t||s!==0&&s!==l.length-1?i.push(...new jd(o,c,d,e).project()):i.push(...new $d(o,s===0?d:c,e).project());}),i;},Km=n=>{let e={};return Object.keys(n).forEach(t=>{e[t]={},Object.keys(n[t]).forEach(i=>{e[t][i]=D({},n[t][i]);});}),e;},rx=n=>n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Il,hu=n=>{if(Il||Il||(Il="Intl"in Yl()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Il){let e=Il.segment(n);return Array.from(e).map(t=>{let{segment:i}=t;return i;});}return rF(n);},rF=n=>{let e=[];for(let t,i=0;i<n.length;i++)(t=oF(n,i))!==!1&&e.push(t);return e;},oF=(n,e)=>{let t=n.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return n.charAt(e);if(55296<=t&&t<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";let r=n.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1);}if(e===0)throw"Low surrogate without preceding high surrogate";let i=n.charCodeAt(e-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1;},sF=Object.freeze({__proto__:null,capitalize:function(n){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return`${n.charAt(0).toUpperCase()}${e?n.slice(1):n.slice(1).toLowerCase()}`;},escapeXml:rx,graphemeSplit:hu}),du=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==e.fill||n.stroke!==e.stroke||n.strokeWidth!==e.strokeWidth||n.fontSize!==e.fontSize||n.fontFamily!==e.fontFamily||n.fontWeight!==e.fontWeight||n.fontStyle!==e.fontStyle||n.textDecorationThickness!==e.textDecorationThickness||n.textBackgroundColor!==e.textBackgroundColor||n.deltaY!==e.deltaY||t&&(n.overline!==e.overline||n.underline!==e.underline||n.linethrough!==e.linethrough);},ox=(n,e)=>{let t=e.split(`
`),i=[],r=-1,o={};n=Km(n);for(let s=0;s<t.length;s++){let l=hu(t[s]);if(n[s])for(let c=0;c<l.length;c++){r++;let d=n[s][c];d&&Object.keys(d).length>0&&(du(o,d,!0)?i.push({start:r,end:r+1,style:d}):i[i.length-1].end++),o=d||{};}else r+=l.length,o={};}return i;},sx=(n,e)=>{if(!Array.isArray(n))return Km(n);let t=e.split(Fm),i={},r=-1,o=0;for(let s=0;s<t.length;s++){let l=hu(t[s]);for(let c=0;c<l.length;c++)r++,n[o]&&n[o].start<=r&&r<n[o].end&&(i[s]=i[s]||{},i[s][c]=D({},n[o].style),r===n[o].end-1&&o++);}return i;},_o=["display","transform",Gt,"fill-opacity","fill-rule","opacity",Ln,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function KC(n,e){let t=n.nodeName,i=n.getAttribute("class"),r=n.getAttribute("id"),o="(?![a-zA-Z\\-]+)",s;if(s=new RegExp("^"+t,"i"),e=e.replace(s,""),r&&e.length&&(s=new RegExp("#"+r+o,"i"),e=e.replace(s,"")),i&&e.length){let l=i.split(" ");for(let c=l.length;c--;)s=new RegExp("\\."+l[c]+o,"i"),e=e.replace(s,"");}return e.length===0;}function aF(n,e){let t=!0,i=KC(n,e.pop());return i&&e.length&&(t=function(r,o){let s,l=!0;for(;r.parentElement&&r.parentElement.nodeType===1&&o.length;)l&&(s=o.pop()),l=KC(r=r.parentElement,s);return o.length===0;}(n,e)),i&&t&&e.length===0;}function lF(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={};for(let i in e)aF(n,i.split(" "))&&(t=D(D({},t),e[i]));return t;}var cF=n=>{var e;return(e=GA[n])!==null&&e!==void 0?e:n;},hF=new RegExp(`(${Oi})`,"gi"),bn=`(${Oi})`,dF=String.raw`(skewX)\(${bn}\)`,uF=String.raw`(skewY)\(${bn}\)`,pF=String.raw`(rotate)\(${bn}(?: ${bn} ${bn})?\)`,fF=String.raw`(scale)\(${bn}(?: ${bn})?\)`,gF=String.raw`(translate)\(${bn}(?: ${bn})?\)`,Jm=`(?:${String.raw`(matrix)\(${bn} ${bn} ${bn} ${bn} ${bn} ${bn}\)`}|${gF}|${pF}|${fF}|${dF}|${uF})`,mF=`(?:${Jm}*)`,_F=String.raw`^\s*(?:${mF}?)\s*$`,vF=new RegExp(_F),yF=new RegExp(Jm),CF=new RegExp(Jm,"g");function Ud(n){let e=[];if(!(n=(t=>Dd(t.replace(hF," $1 ").replace(/,/gi," ")))(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!vF.test(n))return[...Pn];for(let t of n.matchAll(CF)){let i=yF.exec(t[0]);if(!i)continue;let r=Pn,o=i.filter(_=>!!_),[,s,...l]=o,[c,d,u,g,f,m]=l.map(_=>parseFloat(_));switch(s){case"translate":r=Oa(c,d);break;case Rm:r=Ps({angle:c},{x:d,y:u});break;case nu:r=ru(c,d);break;case Sa:r=Bm(c);break;case Ea:r=Vm(c);break;case"matrix":r=[c,d,u,g,f,m];}e.push(r);}return iu(e);}function bF(n,e,t,i){let r=Array.isArray(e),o,s=e;if(n!==Gt&&n!==Ln||e!==xn){if(n==="strokeUniform")return e==="non-scaling-stroke";if(n==="strokeDashArray")s=e===xn?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")s=t&&t.transformMatrix?St(t.transformMatrix,Ud(e)):Ud(e);else if(n==="visible")s=e!==xn&&e!=="hidden",t&&t.visible===!1&&(s=!1);else if(n==="opacity")s=parseFloat(e),t&&t.opacity!==void 0&&(s*=t.opacity);else if(n==="textAnchor")s=e==="start"?ot:e==="end"?Ft:De;else if(n==="charSpacing"||n===Cs)o=yn(e,i)/i*1e3;else if(n==="paintFirst"){let l=e.indexOf(Gt),c=e.indexOf(Ln);s=Gt,(l>-1&&c>-1&&c<l||l===-1&&c>-1)&&(s=Ln);}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return e;if(n==="imageSmoothing")return e==="optimizeQuality";o=r?e.map(yn):yn(e,i);}}else s="";return!r&&isNaN(o)?s:o;}function pm(n,e){n.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;let[i,r]=t.split(":");e[i.trim().toLowerCase()]=r.trim();});}function xF(n){let e={},t=n.getAttribute("style");return t&&(typeof t=="string"?pm(t,e):function(i,r){Object.entries(i).forEach(o=>{let[s,l]=o;l!==void 0&&(r[s.toLowerCase()]=l);});}(t,e)),e;}var PF={stroke:"strokeOpacity",fill:"fillOpacity"};function zr(n,e,t){if(!n)return{};let i,r={},o=Am;n.parentNode&&WC.test(n.parentNode.nodeName)&&(r=zr(n.parentElement,e,t),r.fontSize&&(i=o=yn(r.fontSize)));let s=D(D(D({},e.reduce((d,u)=>{let g=n.getAttribute(u);return g&&(d[u]=g),d;},{})),lF(n,t)),xF(n));s[Vg]&&n.setAttribute(Vg,s[Vg]),s[Bg]&&(i=yn(s[Bg],o),s[Bg]=`${i}`);let l={};for(let d in s){let u=cF(d),g=bF(u,s[d],r,i);l[u]=g;}l&&l.font&&function(d,u){let g=d.match(WA);if(!g)return;let f=g[1],m=g[3],_=g[4],y=g[5],E=g[6];f&&(u.fontStyle=f),m&&(u.fontWeight=isNaN(parseFloat(m))?m:parseFloat(m)),_&&(u.fontSize=yn(_)),E&&(u.fontFamily=E),y&&(u.lineHeight=y===Qg?1:y);}(l.font,l);let c=D(D({},r),l);return WC.test(n.nodeName)?c:function(d){let u=qt.getDefaults();return Object.entries(PF).forEach(g=>{let[f,m]=g;if(d[m]===void 0||d[f]==="")return;if(d[f]===void 0){if(!u[f])return;d[f]=u[f];}if(d[f].indexOf("url(")===0)return;let _=new Dn(d[f]);d[f]=_.setAlpha(pt(_.getAlpha()*d[m],2)).toRgba();}),d;}(c);}var ax=["rx","ry"],kr=class n extends qt{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(e){super(),Object.assign(this,n.ownDefaults),this.setOptions(e),this._initRxRy();}_initRxRy(){let{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t);}_render(e){let{width:t,height:i}=this,r=-t/2,o=-i/2,s=this.rx?Math.min(this.rx,t/2):0,l=this.ry?Math.min(this.ry,i/2):0,c=s!==0||l!==0;e.beginPath(),e.moveTo(r+s,o),e.lineTo(r+t-s,o),c&&e.bezierCurveTo(r+t-ao*s,o,r+t,o+ao*l,r+t,o+l),e.lineTo(r+t,o+i-l),c&&e.bezierCurveTo(r+t,o+i-ao*l,r+t-ao*s,o+i,r+t-s,o+i),e.lineTo(r+s,o+i),c&&e.bezierCurveTo(r+ao*s,o+i,r,o+i-ao*l,r,o+i-l),e.lineTo(r,o+l),c&&e.bezierCurveTo(r,o+ao*l,r+ao*s,o,r+s,o),e.closePath(),this._renderPaintInOrder(e);}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...ax,...e]);}_toSVG(){let{width:e,height:t,rx:i,ry:r}=this;return["<rect ","COMMON_PARTS",`x="${-e/2}" y="${-t/2}" rx="${i}" ry="${r}" width="${e}" height="${t}" />
`];}static fromElement(e,t,i){return J(this,null,function*(){let u=zr(e,this.ATTRIBUTE_NAMES,i),{left:r=0,top:o=0,width:s=0,height:l=0,visible:c=!0}=u,d=lt(u,["left","top","width","height","visible"]);return new this(se(D(D({},t),d),{left:r,top:o,width:s,height:l,visible:!!(c&&s&&l)}));});}};W(kr,"type","Rect"),W(kr,"cacheProperties",[...Br,...ax]),W(kr,"ownDefaults",{rx:0,ry:0}),W(kr,"ATTRIBUTE_NAMES",[..._o,"x","y","rx","ry","width","height"]),Ce.setClass(kr),Ce.setSVGClass(kr);var Ir="initialization",Hd="added",Qm="removed",Wd="imperative",lx=(n,e)=>{let{strokeUniform:t,strokeWidth:i,width:r,height:o,group:s}=e,l=s&&s!==n?Zl(s.calcTransformMatrix(),n.calcTransformMatrix()):null,c=l?e.getRelativeCenterPoint().transform(l):e.getRelativeCenterPoint(),d=!e.isStrokeAccountedForInDimensions(),u=t&&d?Eb(new ne(i,i),void 0,n.calcTransformMatrix()):Lm,g=!t&&d?i:0,f=ou(r+g,o+g,iu([l,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[c.subtract(f),c.add(f)];},Pa=class{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e);}shouldPerformLayout(e){let{type:t,prevStrategy:i,strategy:r}=e;return t===Ir||t===Wd||!!i&&r!==i;}shouldLayoutClipPath(e){let{type:t,target:{clipPath:i}}=e;return t!==Ir&&i&&!i.absolutePositioned;}getInitialSize(e,t){return t.size;}calcBoundingBox(e,t){let{type:i,target:r}=t;if(i===Wd&&t.overrides)return t.overrides;if(e.length===0)return;let{left:o,top:s,width:l,height:c}=sr(e.map(g=>lx(r,g)).reduce((g,f)=>g.concat(f),[])),d=new ne(l,c),u=new ne(o,s).add(d.scalarDivide(2));if(i===Ir){let g=this.getInitialSize(t,{size:d,center:u});return{center:u,relativeCorrection:new ne(0,0),size:g};}return{center:u.transform(r.calcOwnMatrix()),size:d};}};W(Pa,"type","strategy");var Wl=class extends Pa{shouldPerformLayout(e){return!0;}};W(Wl,"type","fit-content"),Ce.setClass(Wl);var cx="layoutManager",xs=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Wl();W(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map();}performLayout(e){let t=se(D({bubbles:!0,strategy:this.strategy},e),{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1;}});this.onBeforeLayout(t);let i=this.getLayoutResult(t);i&&this.commitLayout(t,i),this.onAfterLayout(t,i),this._prevLayoutStrategy=t.strategy;}attachHandlers(e,t){let{target:i}=t;return[Od,hb,ya,db,tu,ub,Ed,pb,NA].map(r=>e.on(r,o=>this.performLayout(r===Od?{type:"object_modified",trigger:r,e:o,target:i}:{type:"object_modifying",trigger:r,e:o,target:i})));}subscribe(e,t){this.unsubscribe(e,t);let i=this.attachHandlers(e,t);this._subscriptions.set(e,i);}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(i=>i()),this._subscriptions.delete(e);}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e));}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e));}onBeforeLayout(e){let{target:t,type:i}=e,{canvas:r}=t;if(i===Ir||i===Hd?this.subscribeTargets(e):i===Qm&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),i===Wd&&e.deep){let o=e,{strategy:s}=o,l=lt(o,["strategy"]);t.forEachObject(c=>c.layoutManager&&c.layoutManager.performLayout(se(D({},l),{bubbles:!1,target:c})));}}getLayoutResult(e){let{target:t,strategy:i,type:r}=e,o=i.calcLayoutResult(e,t.getObjects());if(!o)return;let s=r===Ir?new ne():t.getRelativeCenterPoint(),{center:l,correction:c=new ne(),relativeCorrection:d=new ne()}=o,u=s.subtract(l).add(c).transform(r===Ir?Pn:Fn(t.calcOwnMatrix()),!0).add(d);return{result:o,prevCenter:s,nextCenter:l,offset:u};}commitLayout(e,t){let{target:i}=e,{result:{size:r},nextCenter:o}=t;var s,l;i.set({width:r.x,height:r.y}),this.layoutObjects(e,t),e.type===Ir?i.set({left:(s=e.x)!==null&&s!==void 0?s:o.x+r.x*Cn(i.originX),top:(l=e.y)!==null&&l!==void 0?l:o.y+r.y*Cn(i.originY)}):(i.setPositionByOrigin(o,De,De),i.setCoords(),i.set("dirty",!0));}layoutObjects(e,t){let{target:i}=e;i.forEachObject(r=>{r.group===i&&this.layoutObject(e,t,r);}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,i.clipPath);}layoutObject(e,t,i){let{offset:r}=t;i.set({left:i.left+r.x,top:i.top+r.y});}onAfterLayout(e,t){let u=e,{target:i,strategy:r,bubbles:o,prevStrategy:s}=u,l=lt(u,["target","strategy","bubbles","prevStrategy"]),{canvas:c}=i;i.fire("layout:after",{context:e,result:t}),c&&c.fire("object:layout:after",{context:e,result:t,target:i});let d=i.parent;o&&d!=null&&d.layoutManager&&((l.path||(l.path=[])).push(i),d.layoutManager.performLayout(se(D({},l),{target:d}))),i.set("dirty",!0);}dispose(){let{_subscriptions:e}=this;e.forEach(t=>t.forEach(i=>i())),e.clear();}toObject(){return{type:cx,strategy:this.strategy.constructor.type};}toJSON(){return this.toObject();}};Ce.setClass(xs,cx);var fm=class extends xs{performLayout(){}},Rr=class n extends fb(qt){static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),W(this,"_activeObjects",[]),W(this,"__objectSelectionTracker",void 0),W(this,"__objectSelectionDisposer",void 0),Object.assign(this,n.ownDefaults),this.setOptions(t),this.groupInit(e,t);}groupInit(e,t){var i;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(r=>{this.enterGroup(r,!1);}),this.layoutManager=(i=t.layoutManager)!==null&&i!==void 0?i:new xs(),this.layoutManager.performLayout({type:Ir,target:this,targets:[...e],x:t.left,y:t.top});}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Lr("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Lr("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1);}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,i,r)=>this.canEnterGroup(t)&&r.indexOf(t)===i);}add(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let r=this._filterObjectsBeforeEnteringGroup(t),o=super.add(...r);return this._onAfterObjectsChange(Hd,r),o;}insertAt(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];let o=this._filterObjectsBeforeEnteringGroup(i),s=super.insertAt(e,...o);return this._onAfterObjectsChange(Hd,o),s;}remove(){let e=super.remove(...arguments);return this._onAfterObjectsChange(Qm,e),e;}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this});}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this});}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this});}_onStackOrderChanged(){this._set("dirty",!0);}_set(e,t){let i=this[e];return super._set(e,t),e==="canvas"&&i!==t&&(this._objects||[]).forEach(r=>{r._set(e,t);}),this;}_shouldSetNestedCoords(){return this.subTargetCheck;}removeAll(){return this._activeObjects=[],this.remove(...this._objects);}__objectSelectionMonitor(e,t){let{target:i}=t,r=this._activeObjects;if(e)r.push(i),this._set("dirty",!0);else if(r.length>0){let o=r.indexOf(i);o>-1&&(r.splice(o,1),this._set("dirty",!0));}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer));}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t);}_enterGroup(e,t){t&&xa(e,St(Fn(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);let i=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();i&&(i===e||e.isDescendantOf(i))&&this._activeObjects.push(e);}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0);}_exitGroup(e,t){e._set("group",void 0),t||(xa(e,St(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);let i=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;i>-1&&this._activeObjects.splice(i,1);}shouldCache(){let e=qt.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1;}return e;}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1;}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache();}drawObject(e,t,i){this._renderBackground(e);for(let o=0;o<this._objects.length;o++){var r;let s=this._objects[o];(r=this.canvas)!==null&&r!==void 0&&r.preserveObjectStacking&&s.group!==this?(e.save(),e.transform(...Fn(this.calcTransformMatrix())),s.render(e),e.restore()):s.group===this&&s.render(e);}this._drawClipPath(e,this.clipPath,i);}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords());}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(D({target:this,type:Wd},e));}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1;}__serializeObjects(e,t){let i=this.includeDefaultValues;return this._objects.filter(function(r){return!r.excludeFromExport;}).map(function(r){let o=r.includeDefaultValues;r.includeDefaultValues=i;let s=r[e||"toObject"](t);return r.includeDefaultValues=o,s;});}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.layoutManager.toObject();return se(D(D({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{objects:this.__serializeObjects("toObject",e)});}toString(){return`#<Group: (${this.complexity()})>`;}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose();}),super.dispose();}_createSVGBgRect(e){if(!this.backgroundColor)return"";let t=kr.prototype._toSVG.call(this),i=t.indexOf("COMMON_PARTS");t[i]='for="group" ';let r=t.join("");return e?e(r):r;}_toSVG(e){let t=["<g ","COMMON_PARTS",` >
`],i=this._createSVGBgRect(e);i&&t.push("		",i);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push(`</g>
`),t;}getSvgStyles(){let e=this.opacity!==void 0&&this.opacity!==1?`opacity: ${this.opacity};`:"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("");}toClipPathSVG(e){let t=[],i=this._createSVGBgRect(e);i&&t.push("	",i);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e});}static fromObject(e,t){let l=e,{type:i,objects:r=[],layoutManager:o}=l,s=lt(l,["type","objects","layoutManager"]);return Promise.all([Ca(r,t),ql(s,t)]).then(c=>{let[d,u]=c,g=new this(d,se(D(D({},s),u),{layoutManager:new fm()}));if(o){let f=Ce.getClass(o.type),m=Ce.getClass(o.strategy);g.layoutManager=new f(new m());}else g.layoutManager=new xs();return g.layoutManager.subscribeTargets({type:Ir,target:g,targets:g.getObjects()}),g.setCoords(),g;});}};W(Rr,"type","Group"),W(Rr,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),Ce.setClass(Rr);var hx=(n,e)=>Math.min(e.width/n.width,e.height/n.height),dx=(n,e)=>Math.max(e.width/n.width,e.height/n.height),gm="\\s*,?\\s*",Al=`${gm}(${Oi})`,wF=`${Al}${Al}${Al}${gm}([01])${gm}([01])${Al}${Al}`,MF={m:"l",M:"L"},SF=(n,e,t,i,r,o,s,l,c,d,u)=>{let g=Ii(n),f=Ai(n),m=Ii(e),_=Ai(e),y=t*r*m-i*o*_+s,E=i*r*m+t*o*_+l;return["C",d+c*(-t*r*f-i*o*g),u+c*(-i*r*f+t*o*g),y+c*(t*r*_+i*o*m),E+c*(i*r*_-t*o*m),y,E];},JC=(n,e,t,i)=>{let r=Math.atan2(e,n),o=Math.atan2(i,t);return o>=r?o-r:2*Math.PI-(r-o);};function mm(n,e,t,i,r,o,s,l){let c;if(Ze.cachesBoundsOfCurve&&(c=[...arguments].join(),Ll.boundsOfCurveCache[c]))return Ll.boundsOfCurveCache[c];let d=Math.sqrt,u=Math.abs,g=[],f=[[0,0],[0,0]],m=6*n-12*t+6*r,_=-3*n+9*t-9*r+3*s,y=3*t-3*n;for(let w=0;w<2;++w){if(w>0&&(m=6*e-12*i+6*o,_=-3*e+9*i-9*o+3*l,y=3*i-3*e),u(_)<1e-12){if(u(m)<1e-12)continue;let Y=-y/m;0<Y&&Y<1&&g.push(Y);continue;}let T=m*m-4*y*_;if(T<0)continue;let R=d(T),V=(-m+R)/(2*_);0<V&&V<1&&g.push(V);let B=(-m-R)/(2*_);0<B&&B<1&&g.push(B);}let E=g.length,C=E,b=px(n,e,t,i,r,o,s,l);for(;E--;){let{x:w,y:T}=b(g[E]);f[0][E]=w,f[1][E]=T;}f[0][C]=n,f[1][C]=e,f[0][C+1]=s,f[1][C+1]=l;let x=[new ne(Math.min(...f[0]),Math.min(...f[1])),new ne(Math.max(...f[0]),Math.max(...f[1]))];return Ze.cachesBoundsOfCurve&&(Ll.boundsOfCurveCache[c]=x),x;}var EF=(n,e,t)=>{let[i,r,o,s,l,c,d,u]=t,g=((f,m,_,y,E,C,b)=>{if(_===0||y===0)return[];let x=0,w=0,T=0,R=Math.PI,V=b*Im,B=Ai(V),Y=Ii(V),le=.5*(-Y*f-B*m),ae=.5*(-Y*m+B*f),ee=_**2,ce=y**2,oe=ae**2,re=le**2,A=ee*ce-ee*oe-ce*re,z=Math.abs(_),O=Math.abs(y);if(A<0){let We=Math.sqrt(1-A/(ee*ce));z*=We,O*=We;}else T=(E===C?-1:1)*Math.sqrt(A/(ee*oe+ce*re));let k=T*z*ae/O,H=-T*O*le/z,U=Y*k-B*H+.5*f,pe=B*k+Y*H+.5*m,me=JC(1,0,(le-k)/z,(ae-H)/O),fe=JC((le-k)/z,(ae-H)/O,(-le-k)/z,(-ae-H)/O);C===0&&fe>0?fe-=2*R:C===1&&fe<0&&(fe+=2*R);let Fe=Math.ceil(Math.abs(fe/R*2)),Te=[],qe=fe/Fe,bt=8/3*Math.sin(qe/4)*Math.sin(qe/4)/Math.sin(qe/2),It=me+qe;for(let We=0;We<Fe;We++)Te[We]=SF(me,It,Y,B,z,O,U,pe,bt,x,w),x=Te[We][5],w=Te[We][6],me=It,It+=qe;return Te;})(d-n,u-e,r,o,l,c,s);for(let f=0,m=g.length;f<m;f++)g[f][1]+=n,g[f][2]+=e,g[f][3]+=n,g[f][4]+=e,g[f][5]+=n,g[f][6]+=e;return g;},ux=n=>{let e=0,t=0,i=0,r=0,o=[],s,l=0,c=0;for(let d of n){let u=[...d],g;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],g=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],g=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],g=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],i=u[1],r=u[2],g=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":l=u[3],c=u[4],e=u[5],t=u[6],g=["C",u[1],u[2],l,c,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":s==="C"?(l=2*e-l,c=2*t-c):(l=e,c=t),e=u[3],t=u[4],g=["C",l,c,u[1],u[2],e,t],l=g[3],c=g[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":l=u[1],c=u[2],e=u[3],t=u[4],g=["Q",l,c,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":s==="Q"?(l=2*e-l,c=2*t-c):(l=e,c=t),e=u[1],t=u[2],g=["Q",l,c,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":EF(e,t,u).forEach(f=>o.push(f)),e=u[6],t=u[7];break;case"z":case"Z":e=i,t=r,g=["Z"];}g?(o.push(g),s=g[0]):s="";}return o;},Gd=(n,e,t,i)=>Math.sqrt((t-n)**2+(i-e)**2),px=(n,e,t,i,r,o,s,l)=>c=>{let d=c**3,u=(m=>3*m**2*(1-m))(c),g=(m=>3*m*(1-m)**2)(c),f=(m=>(1-m)**3)(c);return new ne(s*d+r*u+t*g+n*f,l*d+o*u+i*g+e*f);},fx=n=>n**2,gx=n=>2*n*(1-n),mx=n=>(1-n)**2,OF=(n,e,t,i,r,o,s,l)=>c=>{let d=fx(c),u=gx(c),g=mx(c),f=3*(g*(t-n)+u*(r-t)+d*(s-r)),m=3*(g*(i-e)+u*(o-i)+d*(l-o));return Math.atan2(m,f);},TF=(n,e,t,i,r,o)=>s=>{let l=fx(s),c=gx(s),d=mx(s);return new ne(r*l+t*c+n*d,o*l+i*c+e*d);},kF=(n,e,t,i,r,o)=>s=>{let l=1-s,c=2*(l*(t-n)+s*(r-t)),d=2*(l*(i-e)+s*(o-i));return Math.atan2(d,c);},QC=(n,e,t)=>{let i=new ne(e,t),r=0;for(let o=1;o<=100;o+=1){let s=n(o/100);r+=Gd(i.x,i.y,s.x,s.y),i=s;}return r;},IF=(n,e)=>{let t,i=0,r=0,o={x:n.x,y:n.y},s=D({},o),l=.01,c=0,d=n.iterator,u=n.angleFinder;for(;r<e&&l>1e-4;)s=d(i),c=i,t=Gd(o.x,o.y,s.x,s.y),t+r>e?(i-=l,l/=2):(o=s,i+=l,r+=t);return se(D({},s),{angle:u(c)});},e_=n=>{let e,t,i=0,r=0,o=0,s=0,l=0,c=[];for(let d of n){let u={x:r,y:o,command:d[0],length:0};switch(d[0]){case"M":t=u,t.x=s=r=d[1],t.y=l=o=d[2];break;case"L":t=u,t.length=Gd(r,o,d[1],d[2]),r=d[1],o=d[2];break;case"C":e=px(r,o,d[1],d[2],d[3],d[4],d[5],d[6]),t=u,t.iterator=e,t.angleFinder=OF(r,o,d[1],d[2],d[3],d[4],d[5],d[6]),t.length=QC(e,r,o),r=d[5],o=d[6];break;case"Q":e=TF(r,o,d[1],d[2],d[3],d[4]),t=u,t.iterator=e,t.angleFinder=kF(r,o,d[1],d[2],d[3],d[4]),t.length=QC(e,r,o),r=d[3],o=d[4];break;case"Z":t=u,t.destX=s,t.destY=l,t.length=Gd(r,o,s,l),r=s,o=l;}i+=t.length,c.push(t);}return c.push({length:i,x:r,y:o}),c;},_x=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e_(n),i=0;for(;e-t[i].length>0&&i<t.length-2;)e-=t[i].length,i++;let r=t[i],o=e/r.length,s=n[i];switch(r.command){case"M":return{x:r.x,y:r.y,angle:0};case"Z":return se(D({},new ne(r.x,r.y).lerp(new ne(r.destX,r.destY),o)),{angle:Math.atan2(r.destY-r.y,r.destX-r.x)});case"L":return se(D({},new ne(r.x,r.y).lerp(new ne(s[1],s[2]),o)),{angle:Math.atan2(s[2]-r.y,s[1]-r.x)});case"C":case"Q":return IF(r,e);}},AF=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),eb=new RegExp(wF,"g"),FF=new RegExp(Oi,"gi"),RF={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},vx=n=>{var e;let t=[],i=(e=n.match(AF))!==null&&e!==void 0?e:[];for(let r of i){let o=r[0];if(o==="z"||o==="Z"){t.push([o]);continue;}let s=RF[o.toLowerCase()],l=[];if(o==="a"||o==="A"){eb.lastIndex=0;for(let c=null;c=eb.exec(r);)l.push(...c.slice(1));}else l=r.match(FF)||[];for(let c=0;c<l.length;c+=s){let d=new Array(s),u=MF[o];d[0]=c>0&&u?u:o;for(let g=0;g<s;g++)d[g+1]=parseFloat(l[c+g]);t.push(d);}}return t;},yx=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new ne(n[0]),i=new ne(n[1]),r=1,o=0,s=[],l=n.length,c=l>2,d;for(c&&(r=n[2].x<i.x?-1:n[2].x===i.x?0:1,o=n[2].y<i.y?-1:n[2].y===i.y?0:1),s.push(["M",t.x-r*e,t.y-o*e]),d=1;d<l;d++){if(!t.eq(i)){let u=t.midPointFrom(i);s.push(["Q",t.x,t.y,u.x,u.y]);}t=n[d],d+1<n.length&&(i=n[d+1]);}return c&&(r=t.x>n[d-2].x?1:t.x===n[d-2].x?0:-1,o=t.y>n[d-2].y?1:t.y===n[d-2].y?0:-1),s.push(["L",t.x+r*e,t.y+o*e]),s;},t_=(n,e)=>n.map(t=>t.map((i,r)=>r===0||e===void 0?i:pt(i,e)).join(" ")).join(" "),LF=(n,e)=>Math.floor(Math.random()*(e-n+1))+n,wd=(n,e)=>{let t=n._findCenterFromElement();n.transformMatrix&&((i=>{if(i.transformMatrix){let{scaleX:r,scaleY:o,angle:s,skewX:l}=ys(i.transformMatrix);i.flipX=!1,i.flipY=!1,i.set(wn,r),i.set(Kn,o),i.angle=s,i.skewX=l,i.skewY=0;}})(n),t=t.transform(n.transformMatrix)),delete n.transformMatrix,e&&(n.scaleX*=e.scaleX,n.scaleY*=e.scaleY,n.cropX=e.cropX,n.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,n.width=e.width,n.height=e.height),n.setPositionByOrigin(t,De,De);},Cx=Object.freeze({__proto__:null,addTransformToObject:Mb,animate:Ym,animateColor:Nb,applyTransformToObject:xa,calcAngleBetweenVectors:Rd,calcDimensionsMatrix:Xl,calcPlaneChangeMatrix:Zl,calcVectorRotation:Um,cancelAnimFrame:gb,capValue:bs,composeMatrix:Cb,copyCanvasElement:n=>{var e;let t=Jn(n);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(n,0,0),t;},cos:Ii,createCanvasElement:lr,createImage:mb,createRotateMatrix:Ps,createScaleMatrix:ru,createSkewXMatrix:Bm,createSkewYMatrix:Vm,createTranslateMatrix:Oa,createVector:$l,crossProduct:_a,degreesToRadians:Tt,dotProduct:Tb,ease:KA,enlivenObjectEnlivables:ql,enlivenObjects:Ca,findScaleToCover:dx,findScaleToFit:hx,getBoundsOfCurve:mm,getOrthonormalVector:Hm,getPathSegmentsInfo:e_,getPointOnPath:_x,getPointer:wb,getRandomInt:LF,getRegularPolygonPath:(n,e)=>{let t=2*Math.PI/n,i=-fo;n%2==0&&(i+=t/2);let r=new Array(n+1);for(let o=0;o<n;o++){let s=o*t+i,{x:l,y:c}=new ne(Ii(s),Ai(s)).scalarMultiply(e);r[o]=[o===0?"M":"L",l,c];}return r[n]=["Z"],r;},getSmoothPathFromPoints:yx,getSvgAttributes:n=>{let e=["instantiated_by_use","style","id","class"];switch(n){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"]);}return e;},getUnitVector:su,groupSVGElements:(n,e)=>n&&n.length===1?n[0]:new Rr(n,e),hasStyleChanged:du,invertTransform:Fn,isBetweenVectors:im,isIdentityMatrix:_b,isTouchEvent:Ad,isTransparent:nx,joinPath:t_,loadImage:Nl,magnitude:Fd,makeBoundingBoxFromPoints:sr,makePathSimpler:ux,matrixToSVG:ba,mergeClipPaths:(n,e)=>{var t;let i=n,r=e;i.inverted&&!r.inverted&&(i=e,r=n),nm(r,(t=r.group)===null||t===void 0?void 0:t.calcTransformMatrix(),i.calcTransformMatrix());let o=i.inverted&&r.inverted;return o&&(i.inverted=r.inverted=!1),new Rr([i],{clipPath:r,inverted:o});},multiplyTransformMatrices:St,multiplyTransformMatrixArray:iu,parsePath:vx,parsePreserveAspectRatioAttribute:Gm,parseUnit:yn,pick:ws,projectStrokeOnPoints:ix,qrDecompose:ys,radiansToDegrees:Dr,removeFromArray:Jo,removeTransformFromObject:(n,e)=>{let t=Fn(e),i=St(t,n.calcOwnMatrix());xa(n,i);},removeTransformMatrixForSvgParsing:wd,requestAnimFrame:Dl,resetObjectTransform:Sb,rotateVector:$m,saveObjectTransform:jm,sendObjectToPlane:nm,sendPointToPlane:Nr,sendVectorToPlane:Eb,sin:Ai,sizeAfterTransform:ou,string:sF,stylesFromArray:sx,stylesToArray:ox,toBlob:Nm,toDataURL:Dm,toFixed:pt,transformPath:(n,e,t)=>(t&&(e=St(e,[1,0,0,1,-t.x,-t.y])),n.map(i=>{let r=[...i];for(let o=1;o<i.length-1;o+=2){let{x:s,y:l}=cn({x:i[o],y:i[o+1]},e);r[o]=s,r[o+1]=l;}return r;})),transformPoint:cn});function _m(n,e){let t=n.style;t&&Object.entries(e).forEach(i=>{let[r,o]=i;return t.setProperty(r,o);});}var vm=class extends Id{constructor(e){let{allowTouchScrolling:t=!1,containerClass:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),W(this,"upper",void 0),W(this,"container",void 0);let{el:r}=this.lower,o=this.createUpperCanvas();this.upper={el:o,ctx:o.getContext("2d")},this.applyCanvasStyle(r,{allowTouchScrolling:t}),this.applyCanvasStyle(o,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});let s=this.createContainerElement();s.classList.add(i),r.parentNode&&r.parentNode.replaceChild(s,r),s.append(r,o),this.container=s;}createUpperCanvas(){let{el:e}=this.lower,t=lr();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t;}createContainerElement(){let e=Ma().createElement("div");return e.setAttribute("data-fabric","wrapper"),_m(e,{position:"relative"}),BC(e),e;}applyCanvasStyle(e,t){let{styles:i,allowTouchScrolling:r}=t;_m(e,se(D({},i),{"touch-action":r?"manipulation":xn})),BC(e);}setDimensions(e,t){super.setDimensions(e,t);let{el:i,ctx:r}=this.upper;Pb(i,r,e,t);}setCSSDimensions(e){super.setCSSDimensions(e),tm(this.upper.el,e),tm(this.container,e);}cleanupDOM(e){let t=this.container,{el:i}=this.lower,{el:r}=this.upper;super.cleanupDOM(e),t.removeChild(r),t.removeChild(i),t.parentNode&&t.parentNode.replaceChild(i,t);}dispose(){super.dispose(),ar().dispose(this.upper.el),delete this.upper,delete this.container;}},bx=(n,e,t,i)=>{let{target:r,offsetX:o,offsetY:s}=e,l=t-o,c=i-s,d=!Ti(r,"lockMovementX")&&r.left!==l,u=!Ti(r,"lockMovementY")&&r.top!==c;return d&&r.set(ot,l),u&&r.set(Rn,c),(d||u)&&Xm(hb,Wm(n,e,t,i)),d||u;},xx=pb,tb=n=>function(e,t,i){let{points:r,pathOffset:o}=i;return new ne(r[n]).subtract(o).transform(St(i.getViewportTransform(),i.calcTransformMatrix()));},Px=(n,e,t,i)=>{let{target:r,pointIndex:o}=e,s=r,l=Nr(new ne(t,i),void 0,s.calcOwnMatrix());return s.points[o]=l.add(s.pathOffset),s.setDimensions(),s.set("dirty",!0),!0;},wx=(n,e)=>function(t,i,r,o){let s=i.target,l=new ne(s.points[(n>0?n:s.points.length)-1]),c=l.subtract(s.pathOffset).transform(s.calcOwnMatrix()),d=e(t,se(D({},i),{pointIndex:n}),r,o),u=l.subtract(s.pathOffset).transform(s.calcOwnMatrix()).subtract(c);return s.left-=u.x,s.top-=u.y,d;},nb=n=>Vr(xx,wx(n,Px)),ym=(n,e,t)=>{let{path:i,pathOffset:r}=n,o=i[e];return new ne(o[t]-r.x,o[t+1]-r.y).transform(St(n.getViewportTransform(),n.calcTransformMatrix()));};function DF(n,e,t){let{commandIndex:i,pointIndex:r}=this;return ym(t,i,r);}function NF(n,e,t,i){let{target:r}=e,{commandIndex:o,pointIndex:s}=this,l=((c,d,u,g,f)=>{let{path:m,pathOffset:_}=c,y=m[(g>0?g:m.length)-1],E=new ne(y[f],y[f+1]),C=E.subtract(_).transform(c.calcOwnMatrix()),b=Nr(new ne(d,u),void 0,c.calcOwnMatrix());m[g][f]=b.x+_.x,m[g][f+1]=b.y+_.y,c.setDimensions();let x=E.subtract(c.pathOffset).transform(c.calcOwnMatrix()).subtract(C);return c.left-=x.x,c.top-=x.y,c.set("dirty",!0),!0;})(r,t,i,o,s);return Xm(this.actionName,se(D({},Wm(n,e,t,i)),{commandIndex:o,pointIndex:s})),l;}var Yd=class extends vn{constructor(e){super(e);}render(e,t,i,r,o){let s=se(D({},r),{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,t,i,s,o);}},Cm=class extends Yd{constructor(e){super(e);}render(e,t,i,r,o){let{path:s}=o,{commandIndex:l,pointIndex:c,connectToCommandIndex:d,connectToPointIndex:u}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);let[g]=s[l],f=ym(o,d,u);if(g==="Q"){let m=ym(o,l,c+2);e.moveTo(m.x,m.y),e.lineTo(t,i);}else e.moveTo(t,i);e.lineTo(f.x,f.y),e.stroke(),e.restore(),super.render(e,t,i,r,o);}},gd=(n,e,t,i,r,o)=>new(t?Cm:Yd)(D(D({commandIndex:n,pointIndex:e,actionName:"modifyPath",positionHandler:DF,actionHandler:NF,connectToCommandIndex:r,connectToPointIndex:o},i),t?i.controlPointStyle:i.pointStyle)),tH=Object.freeze({__proto__:null,changeHeight:eF,changeObjectHeight:zb,changeObjectWidth:Vb,changeWidth:hm,createObjectDefaultControls:Zm,createPathControls:function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={},i="M";return n.path.forEach((r,o)=>{let s=r[0];switch(s!=="Z"&&(t[`c_${o}_${s}`]=gd(o,r.length-2,!1,e)),s){case"C":t[`c_${o}_C_CP_1`]=gd(o,1,!0,e,o-1,(l=>l==="C"?5:l==="Q"?3:1)(i)),t[`c_${o}_C_CP_2`]=gd(o,3,!0,e,o,5);break;case"Q":t[`c_${o}_Q_CP_1`]=gd(o,1,!0,e,o,3);}i=s;}),t;},createPolyActionHandler:nb,createPolyControls:function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={};for(let i=0;i<(typeof n=="number"?n:n.points.length);i++)t[`p${i}`]=new vn(D({actionName:xx,positionHandler:tb(i),actionHandler:nb(i)},e));return t;},createPolyPositionHandler:tb,createResizeControls:Qb,createTextboxDefaultControls:ex,dragHandler:bx,factoryPolyActionHandler:wx,getLocalPoint:au,polyActionHandler:Px,renderCircleControl:jb,renderSquareControl:$b,rotationStyleHandler:Ub,rotationWithSnapping:Hb,scaleCursorStyleHandler:ua,scaleOrSkewActionName:Rl,scaleSkewCursorStyleHandler:ts,scalingEqually:Fl,scalingX:Yb,scalingXOrSkewingY:dm,scalingY:Xb,scalingYOrSkewingX:um,skewCursorStyleHandler:qb,skewHandlerX:Kb,skewHandlerY:Jb,wrapWithFireEvent:Vr,wrapWithFixedAnchor:mo}),Xd=class n extends jl{constructor(){super(...arguments),W(this,"_hoveredTargets",[]),W(this,"_currentTransform",null),W(this,"_groupSelector",null),W(this,"contextTopDirty",!1);}static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el;}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx;}get wrapperEl(){return this.elements.container;}initElements(e){this.elements=new vm(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas();}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e);}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e);}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged();}_chooseObjectsToRender(){let e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects;}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender));}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore();}renderTop(){let e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e});}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;let t=this.getRetinaScaling(),i=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=i,this.pixelFindContext.scale(t,t);}isTargetTransparent(e,t,i){let r=this.targetFindTolerance,o=this.pixelFindContext;this.clearContext(o),o.save(),o.translate(-t+r,-i+r),o.transform(...this.viewportTransform);let s=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(o),e.selectionBackgroundColor=s,o.restore();let l=Math.round(r*this.getRetinaScaling());return nx(o,l,l,l);}_isSelectionKeyPressed(e){let t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(i=>!!i&&e[i]===!0):e[t]);}_shouldClearSelection(e,t){let i=this.getActiveObjects(),r=this._activeObject;return!!(!t||t&&r&&i.length>1&&i.indexOf(t)===-1&&r!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&r&&r!==t);}_shouldCenterTransform(e,t,i){if(!e)return;let r;return t===nu||t===wn||t===Kn||t===ya?r=this.centeredScaling||e.centeredScaling:t===Rm&&(r=this.centeredRotation||e.centeredRotation),r?!i:i;}_getOriginFromCorner(e,t){let i={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?i.x=Ft:["mr","tr","br"].includes(t)&&(i.x=ot),["tl","mt","tr"].includes(t)?i.y=Jg:["bl","mb","br"].includes(t)&&(i.y=Rn)),i;}_setupCurrentTransform(e,t,i){var r;let o=t.group?Nr(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:s="",control:l}=t.getActiveControl()||{},c=i&&l?(r=l.getActionHandler(e,t,l))===null||r===void 0?void 0:r.bind(l):bx,d=((B,Y,le,ae)=>{if(!Y||!B)return"drag";let ee=ae.controls[Y];return ee.getActionName(le,ee,ae);})(i,s,e,t),u=e[this.centeredKey],g=this._shouldCenterTransform(t,d,u)?{x:De,y:De}:this._getOriginFromCorner(t,s),{scaleX:f,scaleY:m,skewX:_,skewY:y,left:E,top:C,angle:b,width:x,height:w,cropX:T,cropY:R}=t,V={target:t,action:d,actionHandler:c,actionPerformed:!1,corner:s,scaleX:f,scaleY:m,skewX:_,skewY:y,offsetX:o.x-E,offsetY:o.y-C,originX:g.x,originY:g.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:Tt(b),width:x,height:w,shiftKey:e.shiftKey,altKey:u,original:se(D({},jm(t)),{originX:g.x,originY:g.y,cropX:T,cropY:R})};this._currentTransform=V,this.fire("before:transform",{e,transform:V});}setCursor(e){this.upperCanvasEl.style.cursor=e;}_drawSelection(e){let{x:t,y:i,deltaX:r,deltaY:o}=this._groupSelector,s=new ne(t,i).transform(this.viewportTransform),l=new ne(t+r,i+o).transform(this.viewportTransform),c=this.selectionLineWidth/2,d=Math.min(s.x,l.x),u=Math.min(s.y,l.y),g=Math.max(s.x,l.x),f=Math.max(s.y,l.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(d,u,g-d,f-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,d+=c,u+=c,g-=c,f-=c,qt.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(d,u,g-d,f-u));}findTarget(e){if(this._targetInfo)return this._targetInfo;if(this.skipTargetFind)return{subTargets:[],currentSubTargets:[]};let t=this.getScenePoint(e),i=this._activeObject,r=this.getActiveObjects(),o=this.searchPossibleTargets(this._objects,t),{subTargets:s,container:l,target:c}=o,d=se(D({},o),{currentSubTargets:s,currentContainer:l,currentTarget:c});if(!i)return d;let u=se(D({},this.searchPossibleTargets([i],t)),{currentSubTargets:s,currentContainer:l,currentTarget:c});return i.findControl(this.getViewportPoint(e),Ad(e))?se(D({},u),{target:i}):u.target&&(r.length>1||!this.preserveObjectStacking||this.preserveObjectStacking&&e[this.altSelectionKey])?u:d;}_pointIsInObjectSelectionArea(e,t){let i=e.getCoords(),r=this.getZoom(),o=e.padding/r;if(o){let[s,l,c,d]=i,u=Math.atan2(l.y-s.y,l.x-s.x),g=Ii(u)*o,f=Ai(u)*o,m=g+f,_=g-f;i=[new ne(s.x-_,s.y-m),new ne(l.x+m,l.y-_),new ne(c.x+_,c.y+m),new ne(d.x-m,d.y+_)];}return vs.isPointInPolygon(t,i);}_checkTarget(e,t){if(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;{let i=t.transform(this.viewportTransform);if(!this.isTargetTransparent(e,i.x,i.y))return!0;}}return!1;}_searchPossibleTargets(e,t,i){let r=e.length;for(;r--;){let o=e[r];if(this._checkTarget(o,t)){if(xd(o)&&o.subTargetCheck){let{target:s}=this._searchPossibleTargets(o._objects,t,i);s&&i.push(s);}return{target:o,subTargets:i};}}return{subTargets:[]};}searchPossibleTargets(e,t){let i=this._searchPossibleTargets(e,t,[]);i.container=i.target;let{container:r,subTargets:o}=i;if(r&&xd(r)&&r.interactive&&o[0]){for(let s=o.length-1;s>0;s--){let l=o[s];if(!xd(l)||!l.interactive)return i.target=l,i;}return i.target=o[0],i;}return i;}getViewportPoint(e){return this._viewportPoint?this._viewportPoint:this._getPointerImpl(e,!0);}getScenePoint(e){return this._scenePoint?this._scenePoint:this._getPointerImpl(e);}_getPointerImpl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.upperCanvasEl,r=i.getBoundingClientRect(),o=wb(e),s=r.width||0,l=r.height||0;s&&l||(Rn in r&&Jg in r&&(l=Math.abs(r.top-r.bottom)),Ft in r&&ot in r&&(s=Math.abs(r.right-r.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,t||(o=Nr(o,void 0,this.viewportTransform));let c=this.getRetinaScaling();c!==1&&(o.x/=c,o.y/=c);let d=s===0||l===0?new ne(1,1):new ne(i.width/s,i.height/l);return o.multiply(d);}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop);}_createCacheCanvas(){this.pixelFindCanvasEl=lr(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance);}getTopContext(){return this.elements.upper.ctx;}getSelectionContext(){return this.elements.upper.ctx;}getSelectionElement(){return this.elements.upper.el;}getActiveObject(){return this._activeObject;}getActiveObjects(){let e=this._activeObject;return Qo(e)?e.getObjects():e?[e]:[];}_fireSelectionEvents(e,t){let i=!1,r=!1,o=this.getActiveObjects(),s=[],l=[];e.forEach(c=>{o.includes(c)||(i=!0,c.fire("deselected",{e:t,target:c}),l.push(c));}),o.forEach(c=>{e.includes(c)||(i=!0,c.fire("selected",{e:t,target:c}),s.push(c));}),e.length>0&&o.length>0?(r=!0,i&&this.fire("selection:updated",{e:t,selected:s,deselected:l})):o.length>0?(r=!0,this.fire("selection:created",{e:t,selected:s})):e.length>0&&(r=!0,this.fire("selection:cleared",{e:t,deselected:l})),r&&(this._objectsToRender=void 0);}setActiveObject(e,t){let i=this.getActiveObjects(),r=this._setActiveObject(e,t);return this._fireSelectionEvents(i,t),r;}_setActiveObject(e,t){let i=this._activeObject;return i!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Qo(e)&&i!==e&&e.set("canvas",this),e.setCoords(),!0);}_discardActiveObject(e,t){let i=this._activeObject;return!!i&&!i.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===i&&this.endCurrentTransform(e),Qo(i)&&i===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0);}discardActiveObject(e){let t=this.getActiveObjects(),i=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[i]});let r=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),r;}endCurrentTransform(e){let t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null;}_finalizeCurrentTransform(e){let t=this._currentTransform,i=t.target,r={e,target:i,transform:t,action:t.action};i._scaling&&(i._scaling=!1),i.setCoords(),t.actionPerformed&&(this.fire("object:modified",r),i.fire(Od,r));}setViewportTransform(e){super.setViewportTransform(e);let t=this._activeObject;t&&t.setCoords();}destroy(){let e=this._activeObject;Qo(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0;}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear();}drawControls(e){let t=this._activeObject;t&&t._renderControls(e);}_toObject(e,t,i){let r=this._realizeGroupTransformOnObject(e),o=super._toObject(e,t,i);return e.set(r),o;}_realizeGroupTransformOnObject(e){let{group:t}=e;if(t&&Qo(t)&&this._activeObject===t){let i=ws(e,["angle","flipX","flipY",ot,wn,Kn,Sa,Ea,Rn]);return Mb(e,t.calcOwnMatrix()),i;}return{};}_setSVGObject(e,t,i){let r=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,i),t.set(r);}};W(Xd,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!0,fireRightClick:!0,fireMiddleClick:!0,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!0});var bm=class{constructor(e){W(this,"targets",[]),W(this,"__disposer",void 0);let t=()=>{let{hiddenTextarea:r}=e.getActiveObject()||{};r&&r.focus();},i=e.upperCanvasEl;i.addEventListener("click",t),this.__disposer=()=>i.removeEventListener("click",t);}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing();});}add(e){this.targets.push(e);}remove(e){this.unregister(e),Jo(this.targets,e);}register(e){this.target=e;}unregister(e){e===this.target&&(this.target=void 0);}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e);}clear(){this.targets=[],this.target=void 0;}dispose(){this.clear(),this.__disposer(),delete this.__disposer;}},Xn={passive:!1},Zo=(n,e)=>({viewportPoint:n.getViewportPoint(e),scenePoint:n.getScenePoint(e)}),lo=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return n.addEventListener(...t);},ci=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return n.removeEventListener(...t);},BF={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}},wa=class extends Xd{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),W(this,"_isClick",void 0),W(this,"textEditingManager",new bm(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this);}),this.addOrRemove(lo);}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse";}addOrRemove(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.upperCanvasEl,r=this._getEventPrefix();e(xb(i),"resize",this._onResize),e(i,r+"down",this._onMouseDown),e(i,`${r}move`,this._onMouseMove,Xn),e(i,`${r}out`,this._onMouseOut),e(i,`${r}enter`,this._onMouseEnter),e(i,"wheel",this._onMouseWheel,{passive:!1}),e(i,"contextmenu",this._onContextMenu),t||(e(i,"click",this._onClick),e(i,"dblclick",this._onClick)),e(i,"dragstart",this._onDragStart),e(i,"dragend",this._onDragEnd),e(i,"dragover",this._onDragOver),e(i,"dragenter",this._onDragEnter),e(i,"dragleave",this._onDragLeave),e(i,"drop",this._onDrop),this.enablePointerEvents||e(i,"touchstart",this._onTouchStart,Xn);}removeListeners(){this.addOrRemove(ci);let e=this._getEventPrefix(),t=Ei(this.upperCanvasEl);ci(t,`${e}up`,this._onMouseUp),ci(t,"touchend",this._onTouchEnd,Xn),ci(t,`${e}move`,this._onMouseMove,Xn),ci(t,"touchmove",this._onMouseMove,Xn),clearTimeout(this._willAddMouseDown);}_onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData();}_onMouseOut(e){let t=this._hoveredTarget,i=D({e},Zo(this,e));this.fire("mouse:out",se(D({},i),{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",D({},i)),this._hoveredTargets.forEach(r=>{this.fire("mouse:out",se(D({},i),{target:r})),r&&r.fire("mouseout",D({},i));}),this._hoveredTargets=[];}_onMouseEnter(e){let{target:t}=this.findTarget(e);this._currentTransform||t||(this.fire("mouse:over",D({e},Zo(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[]);}_onDragStart(e){this._isClick=!1;let t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;let i={e,target:t};return this.fire("dragstart",i),t.fire("dragstart",i),void lo(this.upperCanvasEl,"drag",this._onDragProgress);}VC(e);}_renderDragEffects(e,t,i){let r=!1,o=this._dropTarget;o&&o!==t&&o!==i&&(o.clearContextTop(),r=!0),t?.clearContextTop(),i!==t&&i?.clearContextTop();let s=this.contextTop;s.save(),s.transform(...this.viewportTransform),t&&(s.save(),t.transform(s),t.renderDragSourceEffect(e),s.restore(),r=!0),i&&(s.save(),i.transform(s),i.renderDropTargetEffect(e),s.restore(),r=!0),s.restore(),r&&(this.contextTopDirty=!0);}_onDragEnd(e){let{currentSubTargets:t}=this.findTarget(e),i=!!e.dataTransfer&&e.dataTransfer.dropEffect!==xn,r=i?this._activeObject:void 0,o={e,target:this._dragSource,subTargets:t,dragSource:this._dragSource,didDrop:i,dropTarget:r};ci(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",o),this._dragSource&&this._dragSource.fire("dragend",o),delete this._dragSource,this._onMouseUp(e);}_onDragProgress(e){let t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t);}_onDragOver(e){let t="dragover",{currentContainer:i,currentSubTargets:r}=this.findTarget(e),o=this._dragSource,s={e,target:i,subTargets:r,dragSource:o,canDrop:!1,dropTarget:void 0},l;this.fire(t,s),this._fireEnterLeaveEvents(e,i,s),i&&(i.canDrop(e)&&(l=i),i.fire(t,s));for(let c=0;c<r.length;c++){let d=r[c];d.canDrop(e)&&(l=d),d.fire(t,s);}this._renderDragEffects(e,o,l),this._dropTarget=l;}_onDragEnter(e){let{currentContainer:t,currentSubTargets:i}=this.findTarget(e),r={e,target:t,subTargets:i,dragSource:this._dragSource};this.fire("dragenter",r),this._fireEnterLeaveEvents(e,t,r);}_onDragLeave(e){let{currentSubTargets:t}=this.findTarget(e),i={e,target:this._draggedoverTarget,subTargets:t,dragSource:this._dragSource};this.fire("dragleave",i),this._fireEnterLeaveEvents(e,void 0,i),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this._hoveredTargets=[];}_onDrop(e){let{currentContainer:t,currentSubTargets:i}=this.findTarget(e),r=this._basicEventHandler("drop:before",D({e,target:t,subTargets:i,dragSource:this._dragSource},Zo(this,e)));r.didDrop=!1,r.dropTarget=void 0,this._basicEventHandler("drop",r),this.fire("drop:after",r);}_onContextMenu(e){let{target:t,subTargets:i}=this.findTarget(e),r=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:i});return this.stopContextMenu&&VC(e),this._basicEventHandler("contextmenu",r),!1;}_onClick(e){let t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData());}fireEventFromPointerEvent(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._cacheTransformEventData(e);let{target:o,subTargets:s}=this.findTarget(e),l=D(se(D({e,target:o,subTargets:s},Zo(this,e)),{transform:this._currentTransform}),r);this.fire(t,l),o&&o.fire(i,l);for(let c=0;c<s.length;c++)s[c]!==o&&s[c].fire(i,l);this._resetTransformEventData();}getPointerId(e){let t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1;}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId);}_onTouchStart(e){this._cacheTransformEventData(e);let t=!this.allowTouchScrolling,i=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e);let{target:r}=this.findTarget(e);(this.isDrawingMode||i&&r===i)&&(t=!0),t&&e.preventDefault();let o=this.upperCanvasEl,s=this._getEventPrefix(),l=Ei(o);lo(l,"touchend",this._onTouchEnd,Xn),t&&lo(l,"touchmove",this._onMouseMove,Xn),ci(o,`${s}down`,this._onMouseDown),this._resetTransformEventData();}_onMouseDown(e){this._cacheTransformEventData(e),this.__onMouseDown(e);let t=this.upperCanvasEl,i=this._getEventPrefix();ci(t,`${i}move`,this._onMouseMove,Xn);let r=Ei(t);lo(r,`${i}up`,this._onMouseUp),lo(r,`${i}move`,this._onMouseMove,Xn),this._resetTransformEventData();}_onTouchEnd(e){if(e.touches.length>0)return;this._cacheTransformEventData(e),this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;let t=this._getEventPrefix(),i=Ei(this.upperCanvasEl);ci(i,"touchend",this._onTouchEnd,Xn),ci(i,"touchmove",this._onMouseMove,Xn),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{lo(this.upperCanvasEl,`${t}down`,this._onMouseDown),this._willAddMouseDown=0;},400);}_onMouseUp(e){this._cacheTransformEventData(e),this.__onMouseUp(e);let t=this.upperCanvasEl,i=this._getEventPrefix();if(this._isMainEvent(e)){let r=Ei(this.upperCanvasEl);ci(r,`${i}up`,this._onMouseUp),ci(r,`${i}move`,this._onMouseMove,Xn),lo(t,`${i}move`,this._onMouseMove,Xn);}this._resetTransformEventData();}_onMouseMove(e){this._cacheTransformEventData(e);let t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e),this._resetTransformEventData();}_onResize(){this.calcOffset(),this._resetTransformEventData();}_shouldRender(e){let t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e;}__onMouseUp(e){var t;this._handleEvent(e,"up:before");let i=this._currentTransform,r=this._isClick,{target:o}=this.findTarget(e),{button:s}=e;if(s)return void((this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"up"));if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let l,c,d=!1;if(i&&(this._finalizeCurrentTransform(e),d=i.actionPerformed),!r){let u=o===this._activeObject;this.handleSelection(e),d||(d=this._shouldRender(o)||!u&&o===this._activeObject);}if(o){let u=o.findControl(this.getViewportPoint(e),Ad(e)),{key:g,control:f}=u||{};if(c=g,o.selectable&&o!==this._activeObject&&o.activeOn==="up")this.setActiveObject(o,e),d=!0;else if(f){let m=f.getMouseUpHandler(e,o,f);m&&(l=this.getScenePoint(e),m.call(f,e,i,l.x,l.y));}o.isMoving=!1;}if(i&&(i.target!==o||i.corner!==c)){let u=i.target&&i.target.controls[i.corner],g=u&&u.getMouseUpHandler(e,i.target,u);l=l||this.getScenePoint(e),g&&g.call(u,e,i,l.x,l.y);}this._setCursorFromEvent(e,o),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,o&&(o.__corner=void 0),d?this.requestRenderAll():r||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop();}_basicEventHandler(e,t){let{target:i,subTargets:r=[]}=t;this.fire(e,t),i&&i.fire(e,t);for(let o=0;o<r.length;o++)r[o]!==i&&r[o].fire(e,t);return t;}_handleEvent(e,t,i){let{target:r,subTargets:o}=this.findTarget(e),s=D(se(D({e,target:r,subTargets:o},Zo(this,e)),{transform:this._currentTransform}),t==="down:before"||t==="down"?i:{});t!=="up:before"&&t!=="up"||(s.isClick=this._isClick),this.fire(`mouse:${t}`,s),r&&r.fire(`mouse${t}`,s);for(let l=0;l<o.length;l++)o[l]!==r&&o[l].fire(`mouse${t}`,s);}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1});}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t});}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move");}_onMouseUpInDrawingMode(e){let t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up");}__onMouseDown(e){this._isClick=!0,this._handleEvent(e,"down:before");let{target:t}=this.findTarget(e),i=!!t&&t===this._activeObject,{button:r}=e;if(r)return void((this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down",{alreadySelected:i}));if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let o=this._shouldRender(t),s=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,s=!0,o=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){let l=this.getScenePoint(e);this._groupSelector={x:l.x,y:l.y,deltaY:0,deltaX:0};}if(i=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);let l=t.findControl(this.getViewportPoint(e),Ad(e));if(t===this._activeObject&&(l||!s)){this._setupCurrentTransform(e,t,i);let c=l?l.control:void 0,d=this.getScenePoint(e),u=c&&c.getMouseDownHandler(e,t,c);u&&u.call(c,e,this._currentTransform,d.x,d.y);}}o&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:i}),o&&this.requestRenderAll();}_resetTransformEventData(){this._targetInfo=this._viewportPoint=this._scenePoint=void 0;}_cacheTransformEventData(e){this._resetTransformEventData(),this._viewportPoint=this.getViewportPoint(e),this._scenePoint=Nr(this._viewportPoint,void 0,this.viewportTransform),this._targetInfo=this.findTarget(e),this._currentTransform&&(this._targetInfo.target=this._currentTransform.target);}__onMouseMove(e){if(this._isClick=!1,this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;let t=this._groupSelector;if(t){let i=this.getScenePoint(e);t.deltaX=i.x-t.x,t.deltaY=i.y-t.y,this.renderTop();}else if(this._currentTransform)this._transformObject(e);else{let{target:i}=this.findTarget(e);this._setCursorFromEvent(e,i),this._fireOverOutEvents(e,i);}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move");}_fireOverOutEvents(e,t){let{_hoveredTarget:i,_hoveredTargets:r}=this,{subTargets:o}=this.findTarget(e),s=Math.max(r.length,o.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:i,fireCanvas:!0});for(let l=0;l<s;l++)o[l]===t||r[l]&&r[l]===i||this.fireSyntheticInOutEvents("mouse",{e,target:o[l],oldTarget:r[l]});this._hoveredTarget=t,this._hoveredTargets=o;}_fireEnterLeaveEvents(e,t,i){let r=this._draggedoverTarget,o=this._hoveredTargets,{subTargets:s}=this.findTarget(e),l=Math.max(o.length,s.length);this.fireSyntheticInOutEvents("drag",se(D({},i),{target:t,oldTarget:r,fireCanvas:!0}));for(let c=0;c<l;c++)this.fireSyntheticInOutEvents("drag",se(D({},i),{target:s[c],oldTarget:o[c]}));this._draggedoverTarget=t;}fireSyntheticInOutEvents(e,t){let m=t,{target:i,oldTarget:r,fireCanvas:o,e:s}=m,l=lt(m,["target","oldTarget","fireCanvas","e"]),{targetIn:c,targetOut:d,canvasIn:u,canvasOut:g}=BF[e],f=r!==i;if(r&&f){let _=D(se(D({},l),{e:s,target:r,nextTarget:i}),Zo(this,s));o&&this.fire(g,_),r.fire(d,_);}if(i&&f){let _=D(se(D({},l),{e:s,target:i,previousTarget:r}),Zo(this,s));o&&this.fire(u,_),i.fire(c,_);}}_transformObject(e){let t=this.getScenePoint(e),i=this._currentTransform,r=i.target,o=r.group?Nr(t,void 0,r.group.calcTransformMatrix()):t;i.shiftKey=e.shiftKey,i.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,i,o),i.actionPerformed&&this.requestRenderAll();}_performTransformAction(e,t,i){let{action:r,actionHandler:o,target:s}=t,l=!!o&&o(e,t,i.x,i.y);l&&s.setCoords(),r==="drag"&&l&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||l;}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let i=t.hoverCursor||this.hoverCursor,r=Qo(this._activeObject)?this._activeObject:null,o=(!r||t.group!==r)&&t.findControl(this.getViewportPoint(e));if(o){let{control:s,coord:l}=o;this.setCursor(s.cursorStyleHandler(e,s,t,l));}else{if(t.subTargetCheck){let{subTargets:s}=this.findTarget(e);s.concat().reverse().forEach(l=>{i=l.hoverCursor||i;});}this.setCursor(i);}}handleMultiSelection(e,t){let i=this._activeObject,r=Qo(i);if(i&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(i!==t||r)&&(r||!t.isDescendantOf(i)&&!i.isDescendantOf(t))&&!t.onSelect({e})&&!i.getActiveControl()){if(r){let o=i.getObjects(),s=[];if(t===i){let l=this.getScenePoint(e),c=this.searchPossibleTargets(o,l);if(c.target?(t=c.target,s=c.subTargets):(c=this.searchPossibleTargets(this._objects,l),t=c.target,s=c.subTargets),!t||!t.selectable)return!1;}t.group===i?(i.remove(t),this._hoveredTarget=t,this._hoveredTargets=s,i.size()===1&&this._setActiveObject(i.item(0),e)):(i.multiSelectAdd(t),this._hoveredTarget=i,this._hoveredTargets=s),this._fireSelectionEvents(o,e);}else{i.isEditing&&i.exitEditing();let o=new(Ce.getClass("ActiveSelection"))([],{canvas:this});o.multiSelectAdd(i,t),this._hoveredTarget=o,this._setActiveObject(o,e),this._fireSelectionEvents([i],e);}return!0;}return!1;}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;let{x:t,y:i,deltaX:r,deltaY:o}=this._groupSelector,s=new ne(t,i),l=s.add(new ne(r,o)),c=s.min(l),d=s.max(l).subtract(c),u=this.collectObjects({left:c.x,top:c.y,width:d.x,height:d.y},{includeIntersecting:!this.selectionFullyContained}),g=s.eq(l)?u[0]?[u[0]]:[]:u.length>1?u.filter(f=>!f.onSelect({e})).reverse():u;if(g.length===1)this.setActiveObject(g[0],e);else if(g.length>1){let f=Ce.getClass("ActiveSelection");this.setActiveObject(new f(g,{canvas:this}),e);}return this._groupSelector=null,!0;}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,{upper:i}=this.elements;i.ctx=void 0;let r=super.toCanvasElement(e,t);return i.ctx=i.el.getContext("2d"),r;}clear(){this.textEditingManager.clear(),super.clear();}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy();}},Mx={x1:0,y1:0,x2:0,y2:0},VF=se(D({},Mx),{r1:0,r2:0}),pa=(n,e)=>isNaN(n)&&typeof e=="number"?e:n;function Sx(n){return n&&/%$/.test(n)&&Number.isFinite(parseFloat(n));}function Ex(n,e){let t=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(Sx(n)?100:1):NaN;return bs(0,pa(t,e),1);}var zF=/\s*;\s*/,jF=/\s*:\s*/;function $F(n,e){let t,i,r=n.getAttribute("style");if(r){let s=r.split(zF);s[s.length-1]===""&&s.pop();for(let l=s.length;l--;){let[c,d]=s[l].split(jF).map(u=>u.trim());c==="stop-color"?t=d:c==="stop-opacity"&&(i=d);}}t=t||n.getAttribute("stop-color")||"rgb(0,0,0)",i=pa(parseFloat(i||n.getAttribute("stop-opacity")||""),1);let o=new Dn(t);return o.setAlpha(o.getAlpha()*i*e),{offset:Ex(n.getAttribute("offset"),0),color:o.toRgba()};}function UF(n,e){let t=[],i=n.getElementsByTagName("stop"),r=Ex(e,1);for(let o=i.length;o--;)t.push($F(i[o],r));return t;}function Ox(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial";}function Tx(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage";}function Si(n,e){return n.getAttribute(e);}function HF(n,e){return function(t,i){let r,{width:o,height:s,gradientUnits:l}=i;return Object.entries(t).reduce((c,d)=>{let[u,g]=d;if(g==="Infinity")r=1;else if(g==="-Infinity")r=0;else{let f=typeof g=="string";r=f?parseFloat(g):g,f&&Sx(g)&&(r*=.01,l==="pixels"&&(u!=="x1"&&u!=="x2"&&u!=="r2"||(r*=o),u!=="y1"&&u!=="y2"||(r*=s)));}return c[u]=r,c;},{});}(Ox(n)==="linear"?function(t){return{x1:Si(t,"x1")||0,y1:Si(t,"y1")||0,x2:Si(t,"x2")||"100%",y2:Si(t,"y2")||0};}(n):function(t){return{x1:Si(t,"fx")||Si(t,"cx")||"50%",y1:Si(t,"fy")||Si(t,"cy")||"50%",r1:0,x2:Si(t,"cx")||"50%",y2:Si(t,"cy")||"50%",r2:Si(t,"r")||"50%"};}(n),se(D({},e),{gradientUnits:Tx(n)}));}var ns=class{constructor(e){let{type:t="linear",gradientUnits:i="pixels",coords:r={},colorStops:o=[],offsetX:s=0,offsetY:l=0,gradientTransform:c,id:d}=e||{};Object.assign(this,{type:t,gradientUnits:i,coords:D(D({},t==="radial"?VF:Mx),r),colorStops:o,offsetX:s,offsetY:l,gradientTransform:c,id:d?`${d}_${go()}`:go()});}addColorStop(e){for(let t in e)this.colorStops.push({offset:parseFloat(t),color:e[t]});return this;}toObject(e){return se(D({},ws(this,e)),{type:this.type,coords:D({},this.coords),colorStops:this.colorStops.map(t=>D({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0});}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=[],r=this.gradientTransform?this.gradientTransform.concat():Pn.concat(),o=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",s=this.colorStops.map(g=>D({},g)).sort((g,f)=>g.offset-f.offset),l=-this.offsetX,c=-this.offsetY;var d;o==="objectBoundingBox"?(l/=e.width,c/=e.height):(l+=e.width/2,c+=e.height/2),(d=e)&&typeof d._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(l-=e.pathOffset.x,c-=e.pathOffset.y),r[4]-=l,r[5]-=c;let u=[`id="SVGID_${this.id}"`,`gradientUnits="${o}"`,`gradientTransform="${t?t+" ":""}${ba(r)}"`,""].join(" ");if(this.type==="linear"){let{x1:g,y1:f,x2:m,y2:_}=this.coords;i.push("<linearGradient ",u,' x1="',g,'" y1="',f,'" x2="',m,'" y2="',_,`">
`);}else if(this.type==="radial"){let{x1:g,y1:f,x2:m,y2:_,r1:y,r2:E}=this.coords,C=y>E;i.push("<radialGradient ",u,' cx="',C?g:m,'" cy="',C?f:_,'" r="',C?y:E,'" fx="',C?m:g,'" fy="',C?_:f,`">
`),C&&(s.reverse(),s.forEach(x=>{x.offset=1-x.offset;}));let b=Math.min(y,E);if(b>0){let x=b/Math.max(y,E);s.forEach(w=>{w.offset+=x*(1-w.offset);});}}return s.forEach(g=>{let{color:f,offset:m}=g;i.push(`<stop offset="${100*m}%" style="stop-color:${f};"/>
`);}),i.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),i.join("");}toLive(e){let{x1:t,y1:i,x2:r,y2:o,r1:s,r2:l}=this.coords,c=this.type==="linear"?e.createLinearGradient(t,i,r,o):e.createRadialGradient(t,i,s,r,o,l);return this.colorStops.forEach(d=>{let{color:u,offset:g}=d;c.addColorStop(g,u);}),c;}static fromObject(e){return J(this,null,function*(){let{colorStops:t,gradientTransform:i}=e;return new this(se(D({},e),{colorStops:t?t.map(r=>D({},r)):void 0,gradientTransform:i?[...i]:void 0}));});}static fromElement(e,t,i){let r=Tx(e),o=t._findCenterFromElement();return new this(D({id:e.getAttribute("id")||void 0,type:Ox(e),coords:HF(e,{width:i.viewBoxWidth||i.width,height:i.viewBoxHeight||i.height}),colorStops:UF(e,i.opacity),gradientUnits:r,gradientTransform:Ud(e.getAttribute("gradientTransform")||"")},r==="pixels"?{offsetX:t.width/2-o.x,offsetY:t.height/2-o.y}:{offsetX:0,offsetY:0}));}};W(ns,"type","Gradient"),Ce.setClass(ns,"gradient"),Ce.setClass(ns,"linear"),Ce.setClass(ns,"radial");var zl=class{get type(){return"pattern";}set type(e){Lr("warn","Setting type has no effect",e);}constructor(e){W(this,"repeat","repeat"),W(this,"offsetX",0),W(this,"offsetY",0),W(this,"crossOrigin",""),this.id=go(),Object.assign(this,e);}isImageSource(){return!!this.source&&typeof this.source.src=="string";}isCanvasSource(){return!!this.source&&!!this.source.toDataURL;}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():"";}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null;}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],{repeat:t,crossOrigin:i}=this;return se(D({},ws(this,e)),{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:i,offsetX:pt(this.offsetX,Ze.NUM_FRACTION_DIGITS),offsetY:pt(this.offsetY,Ze.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null});}toSVG(e){let{width:t,height:i}=e,{source:r,repeat:o,id:s}=this,l=pa(this.offsetX/t,0),c=pa(this.offsetY/i,0);return[`<pattern id="SVGID_${s}" x="${l}" y="${c}" width="${o==="repeat-y"||o==="no-repeat"?1+Math.abs(l||0):pa(r.width/t,0)}" height="${o==="repeat-x"||o==="no-repeat"?1+Math.abs(c||0):pa(r.height/i,0)}">`,`<image x="0" y="0" width="${r.width}" height="${r.height}" xlink:href="${this.sourceToString()}"></image>`,"</pattern>",""].join(`
`);}static fromObject(e,t){return J(this,null,function*(){let c=e,{type:i,source:r,patternTransform:o}=c,s=lt(c,["type","source","patternTransform"]),l=yield Nl(r,se(D({},t),{crossOrigin:s.crossOrigin}));return new this(se(D({},s),{patternTransform:o&&o.slice(0),source:l}));});}};W(zl,"type","Pattern"),Ce.setClass(zl),Ce.setClass(zl,"pattern");var xm=class{constructor(e){W(this,"color","rgb(0, 0, 0)"),W(this,"width",1),W(this,"shadow",null),W(this,"strokeLineCap","round"),W(this,"strokeLineJoin","round"),W(this,"strokeMiterLimit",10),W(this,"strokeDashArray",null),W(this,"limitedToCanvasSize",!1),this.canvas=e;}_setBrushStyles(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[]);}_saveAndTransform(e){let t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5]);}needsFullRender(){return new Dn(this.color).getAlpha()<1||!!this.shadow;}_setShadow(){if(!this.shadow||!this.canvas)return;let e=this.canvas,t=this.shadow,i=e.contextTop,r=e.getZoom()*e.getRetinaScaling();i.shadowColor=t.color,i.shadowBlur=t.blur*r,i.shadowOffsetX=t.offsetX*r,i.shadowOffsetY=t.offsetY*r;}_resetShadow(){let e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0;}_isOutSideCanvas(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight();}},rr=class n extends qt{constructor(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:t,left:i,top:r}=s,o=lt(s,["path","left","top"]);super(),Object.assign(this,n.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof i=="number"&&this.set(ot,i),typeof r=="number"&&this.set(Rn,r);}_setPath(e,t){this.path=ux(Array.isArray(e)?e:vx(e)),this.setBoundingBox(t);}_findCenterFromElement(){let e=this._calcBoundsFromPath();return new ne(e.left+e.width/2,e.top+e.height/2);}_renderPathCommands(e){let t=-this.pathOffset.x,i=-this.pathOffset.y;e.beginPath();for(let r of this.path)switch(r[0]){case"L":e.lineTo(r[1]+t,r[2]+i);break;case"M":e.moveTo(r[1]+t,r[2]+i);break;case"C":e.bezierCurveTo(r[1]+t,r[2]+i,r[3]+t,r[4]+i,r[5]+t,r[6]+i);break;case"Q":e.quadraticCurveTo(r[1]+t,r[2]+i,r[3]+t,r[4]+i);break;case"Z":e.closePath();}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e);}toString(){return`#<Path (${this.complexity()}): { "top": ${this.top}, "left": ${this.left} }>`;}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return se(D({},super.toObject(e)),{path:this.path.map(t=>t.slice())});}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t;}_toSVG(){return["<path ","COMMON_PARTS",`d="${t_(this.path,Ze.NUM_FRACTION_DIGITS)}" stroke-linecap="round" />
`];}_getOffsetTransform(){let e=Ze.NUM_FRACTION_DIGITS;return` translate(${pt(-this.pathOffset.x,e)}, ${pt(-this.pathOffset.y,e)})`;}toClipPathSVG(e){let t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t});}toSVG(e){let t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t});}complexity(){return this.path.length;}setDimensions(){this.setBoundingBox();}setBoundingBox(e){let{width:t,height:i,pathOffset:r}=this._calcDimensions();this.set({width:t,height:i,pathOffset:r}),e&&this.setPositionByOrigin(r,De,De);}_calcBoundsFromPath(){let e=[],t=0,i=0,r=0,o=0;for(let s of this.path)switch(s[0]){case"L":r=s[1],o=s[2],e.push({x:t,y:i},{x:r,y:o});break;case"M":r=s[1],o=s[2],t=r,i=o;break;case"C":e.push(...mm(r,o,s[1],s[2],s[3],s[4],s[5],s[6])),r=s[5],o=s[6];break;case"Q":e.push(...mm(r,o,s[1],s[2],s[1],s[2],s[3],s[4])),r=s[3],o=s[4];break;case"Z":r=t,o=i;}return sr(e);}_calcDimensions(){let e=this._calcBoundsFromPath();return se(D({},e),{pathOffset:new ne(e.left+e.width/2,e.top+e.height/2)});}static fromObject(e){return this._fromObject(e,{extraParam:"path"});}static fromElement(e,t,i){return J(this,null,function*(){let s=zr(e,this.ATTRIBUTE_NAMES,i),{d:r}=s,o=lt(s,["d"]);return new this(r,se(D(D({},o),t),{left:void 0,top:void 0}));});}};W(rr,"type","Path"),W(rr,"cacheProperties",[...Br,"path","fillRule"]),W(rr,"ATTRIBUTE_NAMES",[..._o,"d"]),Ce.setClass(rr),Ce.setSVGClass(rr);var qd=class n extends xm{constructor(e){super(e),W(this,"decimate",.4),W(this,"drawStraightLine",!1),W(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1;}needsFullRender(){return super.needsFullRender()||this._hasStraightLine;}static drawSegment(e,t,i){let r=t.midPointFrom(i);return e.quadraticCurveTo(t.x,t.y,r.x,r.y),r;}onMouseDown(e,t){let{e:i}=t;this.canvas._isMainEvent(i)&&(this.drawStraightLine=!!this.straightLineKey&&i[this.straightLineKey],this._prepareForDrawing(e),this._addPoint(e),this._render());}onMouseMove(e,t){let{e:i}=t;if(this.canvas._isMainEvent(i)&&(this.drawStraightLine=!!this.straightLineKey&&i[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(e))&&this._addPoint(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{let r=this._points,o=r.length,s=this.canvas.contextTop;this._saveAndTransform(s),this.oldEnd&&(s.beginPath(),s.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=n.drawSegment(s,r[o-2],r[o-1]),s.stroke(),s.restore();}}onMouseUp(e){let{e:t}=e;return!this.canvas._isMainEvent(t)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1);}_prepareForDrawing(e){this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y);}_addPoint(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0);}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1;}_render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,t=this._points[0],i=this._points[1];if(this._saveAndTransform(e),e.beginPath(),this._points.length===2&&t.x===i.x&&t.y===i.y){let r=this.width/1e3;t.x-=r,i.x+=r;}e.moveTo(t.x,t.y);for(let r=1;r<this._points.length;r++)n.drawSegment(e,t,i),t=this._points[r],i=this._points[r+1];e.lineTo(t.x,t.y),e.stroke(),e.restore();}convertPointsToSVGPath(e){let t=this.width/1e3;return yx(e,t);}createPath(e){let t=new rr(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new po(this.shadow)),t;}decimatePoints(e,t){if(e.length<=2)return e;let i,r=e[0],o=this.canvas.getZoom(),s=Math.pow(t/o,2),l=e.length-1,c=[r];for(let d=1;d<l-1;d++)i=Math.pow(r.x-e[d].x,2)+Math.pow(r.y-e[d].y,2),i>=s&&(r=e[d],c.push(r));return c.push(e[l]),c;}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));let e=this.convertPointsToSVGPath(this._points);if(function(i){return t_(i)==="M 0 0 Q 0 0 0 0 L 0 0";}(e))return void this.canvas.requestRenderAll();let t=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.requestRenderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t});}},kx=["radius","startAngle","endAngle","counterClockwise"],co=class n extends qt{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(e){super(),Object.assign(this,n.ownDefaults),this.setOptions(e);}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this;}_render(e){e.beginPath(),e.arc(0,0,this.radius,Tt(this.startAngle),Tt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e);}getRadiusX(){return this.get("radius")*this.get(wn);}getRadiusY(){return this.get("radius")*this.get(Kn);}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e});}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...kx,...e]);}_toSVG(){let e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',`${this.radius}`,`" />
`];{let{radius:t}=this,i=Tt(this.startAngle),r=Tt(this.endAngle),o=Ii(i)*t,s=Ai(i)*t,l=Ii(r)*t,c=Ai(r)*t;return[`<path d="M ${o} ${s} A ${t} ${t} 0 ${e>180?1:0} ${this.counterClockwise?0:1} ${l} ${c}" `,"COMMON_PARTS",` />
`];}}static fromElement(e,t,i){return J(this,null,function*(){let c=zr(e,this.ATTRIBUTE_NAMES,i),{left:r=0,top:o=0,radius:s=0}=c,l=lt(c,["left","top","radius"]);return new this(se(D({},l),{radius:s,left:r-s,top:o-s}));});}static fromObject(e){return super._fromObject(e);}};W(co,"type","Circle"),W(co,"cacheProperties",[...Br,...kx]),W(co,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),W(co,"ATTRIBUTE_NAMES",["cx","cy","r",..._o]),Ce.setClass(co),Ce.setSVGClass(co);var Pm=["x1","x2","y1","y2"],es=class n extends qt{constructor(){let[e,t,i,r]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,n.ownDefaults),this.setOptions(o),this.x1=e,this.x2=i,this.y1=t,this.y2=r,this._setWidthHeight();let{left:s,top:l}=o;typeof s=="number"&&this.set(ot,s),typeof l=="number"&&this.set(Rn,l);}_setWidthHeight(){let{x1:e,y1:t,x2:i,y2:r}=this;this.width=Math.abs(i-e),this.height=Math.abs(r-t);let{left:o,top:s,width:l,height:c}=sr([{x:e,y:t},{x:i,y:r}]),d=new ne(o+l/2,s+c/2);this.setPositionByOrigin(d,De,De);}_set(e,t){return super._set(e,t),Pm.includes(e)&&this._setWidthHeight(),this;}_render(e){e.beginPath();let t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;let i=e.strokeStyle;var r;di(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(r=this.stroke)!==null&&r!==void 0?r:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=i;}_findCenterFromElement(){return new ne((this.x1+this.x2)/2,(this.y1+this.y2)/2);}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return D(D({},super.toObject(e)),this.calcLinePoints());}_getNonTransformedDimensions(){let e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e;}calcLinePoints(){let{x1:e,x2:t,y1:i,y2:r,width:o,height:s}=this,l=e<=t?-1:1,c=i<=r?-1:1;return{x1:l*o/2,x2:l*-o/2,y1:c*s/2,y2:c*-s/2};}_toSVG(){let{x1:e,x2:t,y1:i,y2:r}=this.calcLinePoints();return["<line ","COMMON_PARTS",`x1="${e}" y1="${i}" x2="${t}" y2="${r}" />
`];}static fromElement(e,t,i){return J(this,null,function*(){let d=zr(e,this.ATTRIBUTE_NAMES,i),{x1:r=0,y1:o=0,x2:s=0,y2:l=0}=d,c=lt(d,["x1","y1","x2","y2"]);return new this([r,o,s,l],c);});}static fromObject(e){let l=e,{x1:t,y1:i,x2:r,y2:o}=l,s=lt(l,["x1","y1","x2","y2"]);return this._fromObject(se(D({},s),{points:[t,i,r,o]}),{extraParam:"points"});}};W(es,"type","Line"),W(es,"cacheProperties",[...Br,...Pm]),W(es,"ATTRIBUTE_NAMES",_o.concat(Pm)),Ce.setClass(es),Ce.setSVGClass(es);var fa=class n extends qt{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(e){super(),Object.assign(this,n.ownDefaults),this.setOptions(e);}_render(e){let t=this.width/2,i=this.height/2;e.beginPath(),e.moveTo(-t,i),e.lineTo(0,-i),e.lineTo(t,i),e.closePath(),this._renderPaintInOrder(e);}_toSVG(){let e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',`${-e} ${t},0 ${-t},${e} ${t}`,'" />'];}};W(fa,"type","Triangle"),W(fa,"ownDefaults",{width:100,height:100}),Ce.setClass(fa),Ce.setSVGClass(fa);var Ix=["rx","ry"],ho=class n extends qt{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(e){super(),Object.assign(this,n.ownDefaults),this.setOptions(e);}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t);}return this;}getRx(){return this.get("rx")*this.get(wn);}getRy(){return this.get("ry")*this.get(Kn);}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Ix,...e]);}_toSVG(){return["<ellipse ","COMMON_PARTS",`cx="0" cy="0" rx="${this.rx}" ry="${this.ry}" />
`];}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,ki,!1),e.restore(),this._renderPaintInOrder(e);}static fromElement(e,t,i){return J(this,null,function*(){let r=zr(e,this.ATTRIBUTE_NAMES,i);return r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,new this(r);});}};W(ho,"type","Ellipse"),W(ho,"cacheProperties",[...Br,...Ix]),W(ho,"ownDefaults",{rx:0,ry:0}),W(ho,"ATTRIBUTE_NAMES",[..._o,"cx","cy","rx","ry"]),Ce.setClass(ho),Ce.setSVGClass(ho);var Ax={exactBoundingBox:!1},ir=class n extends qt{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),W(this,"strokeDiff",void 0),Object.assign(this,n.ownDefaults),this.setOptions(t),this.points=e;let{left:i,top:r}=t;this.initialized=!0,this.setBoundingBox(!0),typeof i=="number"&&this.set(ot,i),typeof r=="number"&&this.set(Rn,r);}isOpen(){return!0;}_projectStrokeOnPoints(e){return ix(this.points,e,this.isOpen());}_calcDimensions(e){e=D({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});let t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(d=>d.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new ne(),strokeOffset:new ne(),strokeDiff:new ne()};let i=sr(t),r=Xl(se(D({},e),{scaleX:1,scaleY:1})),o=sr(this.points.map(d=>cn(d,r,!0))),s=new ne(this.scaleX,this.scaleY),l=i.left+i.width/2,c=i.top+i.height/2;return this.exactBoundingBox&&(l-=c*Math.tan(Tt(this.skewX)),c-=l*Math.tan(Tt(this.skewY))),se(D({},i),{pathOffset:new ne(l,c),strokeOffset:new ne(o.left,o.top).subtract(new ne(i.left,i.top)).multiply(s),strokeDiff:new ne(i.width,i.height).subtract(new ne(o.width,o.height)).multiply(s)});}_findCenterFromElement(){let e=sr(this.points);return new ne(e.left+e.width/2,e.top+e.height/2);}setDimensions(){this.setBoundingBox();}setBoundingBox(e){let{left:t,top:i,width:r,height:o,pathOffset:s,strokeOffset:l,strokeDiff:c}=this._calcDimensions();this.set({width:r,height:o,pathOffset:s,strokeOffset:l,strokeDiff:c}),e&&this.setPositionByOrigin(new ne(t+r/2,i+o/2),De,De);}isStrokeAccountedForInDimensions(){return this.exactBoundingBox;}_getNonTransformedDimensions(){return this.exactBoundingBox?new ne(this.width,this.height):super._getNonTransformedDimensions();}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let s;if(Object.keys(e).some(l=>this.strokeUniform||this.constructor.layoutProperties.includes(l))){var t,i;let{width:l,height:c}=this._calcDimensions(e);s=new ne((t=e.width)!==null&&t!==void 0?t:l,(i=e.height)!==null&&i!==void 0?i:c);}else{var r,o;s=new ne((r=e.width)!==null&&r!==void 0?r:this.width,(o=e.height)!==null&&o!==void 0?o:this.height);}return s.multiply(new ne(e.scaleX||this.scaleX,e.scaleY||this.scaleY));}return super._getTransformedDimensions(e);}_set(e,t){let i=this.initialized&&this[e]!==t,r=super._set(e,t);return this.exactBoundingBox&&i&&((e===wn||e===Kn)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),r;}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return se(D({},super.toObject(e)),{points:this.points.map(t=>{let{x:i,y:r}=t;return{x:i,y:r};})});}_toSVG(){let e=[],t=this.pathOffset.x,i=this.pathOffset.y,r=Ze.NUM_FRACTION_DIGITS;for(let o=0,s=this.points.length;o<s;o++)e.push(pt(this.points[o].x-t,r),",",pt(this.points[o].y-i,r)," ");return[`<${this.constructor.type.toLowerCase()} `,"COMMON_PARTS",`points="${e.join("")}" />
`];}_render(e){let t=this.points.length,i=this.pathOffset.x,r=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-i,this.points[0].y-r);for(let o=0;o<t;o++){let s=this.points[o];e.lineTo(s.x-i,s.y-r);}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e);}}complexity(){return this.points.length;}static fromElement(e,t,i){return J(this,null,function*(){let r=function(d){if(!d)return[];let u=d.replace(/,/g," ").trim().split(/\s+/),g=[];for(let f=0;f<u.length;f+=2)g.push({x:parseFloat(u[f]),y:parseFloat(u[f+1])});return g;}(e.getAttribute("points")),c=zr(e,this.ATTRIBUTE_NAMES,i),{left:o,top:s}=c,l=lt(c,["left","top"]);return new this(r,D(D({},l),t));});}static fromObject(e){return this._fromObject(e,{extraParam:"points"});}};W(ir,"ownDefaults",Ax),W(ir,"type","Polyline"),W(ir,"layoutProperties",[Sa,Ea,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),W(ir,"cacheProperties",[...Br,"points"]),W(ir,"ATTRIBUTE_NAMES",[..._o]),Ce.setClass(ir),Ce.setSVGClass(ir);var ga=class extends ir{isOpen(){return!1;}};W(ga,"ownDefaults",Ax),W(ga,"type","Polygon"),Ce.setClass(ga),Ce.setSVGClass(ga);var Zd=class extends qt{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;let t=e===void 0?this.styles:{line:this.styles[e]};for(let i in t)for(let r in t[i])for(let o in t[i][r])return!1;return!0;}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;let i=t===void 0?this.styles:{0:this.styles[t]};for(let r in i)for(let o in i[r])if(i[r][o][e]!==void 0)return!0;return!1;}cleanStyle(e){if(!this.styles)return!1;let t=this.styles,i,r,o=0,s=!0,l=0;for(let c in t){i=0;for(let d in t[c]){let u=t[c][d]||{};o++,u[e]!==void 0?(r?u[e]!==r&&(s=!1):r=u[e],u[e]===this[e]&&delete u[e]):s=!1,Object.keys(u).length!==0?i++:delete t[c][d];}i===0&&delete t[c];}for(let c=0;c<this._textLines.length;c++)l+=this._textLines[c].length;s&&o===l&&(this[e]=r,this.removeStyle(e));}removeStyle(e){if(!this.styles)return;let t=this.styles,i,r,o;for(r in t){for(o in i=t[r],i)delete i[o][e],Object.keys(i[o]).length===0&&delete i[o];Object.keys(i).length===0&&delete t[r];}}_extendStyles(e,t){let{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e);this._getLineStyle(i)||this._setLineStyle(i);let o=zm(D(D({},this._getStyleDeclaration(i,r)),t),s=>s!==void 0);this._setStyleDeclaration(i,r,o);}getSelectionStyles(e,t,i){let r=[];for(let o=e;o<(t||e);o++)r.push(this.getStyleAtPosition(o,i));return r;}getStyleAtPosition(e,t){let{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(i,r):this._getStyleDeclaration(i,r);}setSelectionStyles(e,t,i){for(let r=t;r<(i||t);r++)this._extendStyles(r,e);this._forceClearCache=!0;}_getStyleDeclaration(e,t){var i;let r=this.styles&&this.styles[e];return r&&(i=r[t])!==null&&i!==void 0?i:{};}getCompleteStyleDeclaration(e,t){return D(D({},ws(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t));}_setStyleDeclaration(e,t,i){this.styles[e][t]=i;}_deleteStyleDeclaration(e,t){delete this.styles[e][t];}_getLineStyle(e){return!!this.styles[e];}_setLineStyle(e){this.styles[e]={};}_deleteLineStyle(e){delete this.styles[e];}};W(Zd,"_styleProperties",UA);var WF=/  +/g,GF=/"/g;function Ug(n,e,t,i,r){return`		${function(o,s){let{left:l,top:c,width:d,height:u}=s,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ze.NUM_FRACTION_DIGITS,f=Ul(Gt,o,!1),[m,_,y,E]=[l,c,d,u].map(C=>pt(C,g));return`<rect ${f} x="${m}" y="${_}" width="${y}" height="${E}"></rect>`;}(n,{left:e,top:t,width:i,height:r})}
`;}var Hg,hi=class n extends Zd{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(e,t){super(),W(this,"__charBounds",[]),Object.assign(this,n.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords();}setPathInfo(){let e=this.path;e&&(e.segmentsInfo=e_(e.path));}_splitText(){let e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e;}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(or)&&this.enlargeSpaces();}enlargeSpaces(){let e,t,i,r,o,s,l;for(let c=0,d=this._textLines.length;c<d;c++)if((this.textAlign===or||c!==d-1&&!this.isEndOfWrapping(c))&&(r=0,o=this._textLines[c],t=this.getLineWidth(c),t<this.width&&(l=this.textLines[c].match(this._reSpacesAndTabs)))){i=l.length,e=(this.width-t)/i;for(let u=0;u<=o.length;u++)s=this.__charBounds[c][u],this._reSpaceAndTab.test(o[u])?(s.width+=e,s.kernedWidth+=e,s.left+=r,r+=e):s.left+=r;}}isEndOfWrapping(e){return e===this._textLines.length-1;}missingNewlineOffset(e){return 1;}get2DCursorLocation(e,t){let i=t?this._unwrappedTextLines:this._textLines,r;for(r=0;r<i.length;r++){if(e<=i[r].length)return{lineIndex:r,charIndex:e};e-=i[r].length+this.missingNewlineOffset(r,t);}return{lineIndex:r-1,charIndex:i[r-1].length<e?i[r-1].length:e};}toString(){return`#<Text (${this.complexity()}): { "text": "${this.text}", "fontFamily": "${this.fontFamily}" }>`;}_getCacheCanvasDimensions(){let e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e;}_render(e){let t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough");}_renderText(e){this.paintFirst===Ln?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e));}_setTextStyles(e,t,i){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case De:e.textBaseline="middle";break;case"ascender":e.textBaseline=Rn;break;case"descender":e.textBaseline=Jg;}e.font=this._getFontDeclaration(t,i);}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,i=this._textLines.length;t<i;t++){let r=this.getLineWidth(t);r>e&&(e=r);}return e;}_renderTextLine(e,t,i,r,o,s){this._renderChars(e,t,i,r,o,s);}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;let t=e.fillStyle,i=this._getLeftOffset(),r=this._getTopOffset();for(let o=0,s=this._textLines.length;o<s;o++){let l=this.getHeightOfLine(o);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",o)){r+=l;continue;}let c=this._textLines[o].length,d=this._getLineLeftOffset(o),u,g,f=0,m=0,_=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),y=this.getHeightOfLineImpl(o);for(let E=0;E<c;E++){let C=this.__charBounds[o][E];g=this.getValueOfPropertyAt(o,E,"textBackgroundColor"),this.path?(e.save(),e.translate(C.renderLeft,C.renderTop),e.rotate(C.angle),e.fillStyle=g,g&&e.fillRect(-C.width/2,-y*(1-this._fontSizeFraction),C.width,y),e.restore()):g!==_?(u=i+d+m,this.direction===Tr&&(u=this.width-u-f),e.fillStyle=_,_&&e.fillRect(u,r,f,y),m=C.left,f=C.width,_=g):f+=C.kernedWidth;}g&&!this.path&&(u=i+d+m,this.direction===Tr&&(u=this.width-u-f),e.fillStyle=g,e.fillRect(u,r,f,y)),r+=l;}e.fillStyle=t,this._removeShadow(e);}_measureChar(e,t,i,r){let o=Ll.getFontCache(t),s=this._getFontDeclaration(t),l=i?i+e:e,c=i&&s===this._getFontDeclaration(r),d=t.fontSize/this.CACHE_FONT_SIZE,u,g,f,m;if(i&&o.has(i)&&(f=o.get(i)),o.has(e)&&(m=u=o.get(e)),c&&o.has(l)&&(g=o.get(l),m=g-f),u===void 0||f===void 0||g===void 0){let _=function(){return Hg||(Hg=Jn({width:0,height:0}).getContext("2d")),Hg;}();this._setTextStyles(_,t,!0),u===void 0&&(m=u=_.measureText(e).width,o.set(e,u)),f===void 0&&c&&i&&(f=_.measureText(i).width,o.set(i,f)),c&&g===void 0&&(g=_.measureText(l).width,o.set(l,g),m=g-f);}return{width:u*d,kernedWidth:m*d};}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize");}measureLine(e){let t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t;}_measureLine(e){let t,i,r=0,o=this.pathSide===Ft,s=this.path,l=this._textLines[e],c=l.length,d=new Array(c);this.__charBounds[e]=d;for(let u=0;u<c;u++){let g=l[u];i=this._getGraphemeBox(g,e,u,t),d[u]=i,r+=i.kernedWidth,t=g;}if(d[c]={left:i?i.left+i.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},s&&s.segmentsInfo){let u=0,g=s.segmentsInfo[s.segmentsInfo.length-1].length;switch(this.textAlign){case ot:u=o?g-r:0;break;case De:u=(g-r)/2;break;case Ft:u=o?0:g-r;}u+=this.pathStartOffset*(o?-1:1);for(let f=o?c-1:0;o?f>=0:f<c;o?f--:f++)i=d[f],u>g?u%=g:u<0&&(u+=g),this._setGraphemeOnPath(u,i),u+=i.kernedWidth;}return{width:r,numOfSpaces:0};}_setGraphemeOnPath(e,t){let i=e+t.kernedWidth/2,r=this.path,o=_x(r.path,i,r.segmentsInfo);t.renderLeft=o.x-r.pathOffset.x,t.renderTop=o.y-r.pathOffset.y,t.angle=o.angle+(this.pathSide===Ft?Math.PI:0);}_getGraphemeBox(e,t,i,r,o){let s=this.getCompleteStyleDeclaration(t,i),l=r?this.getCompleteStyleDeclaration(t,i-1):{},c=this._measureChar(e,s,r,l),d,u=c.kernedWidth,g=c.width;this.charSpacing!==0&&(d=this._getWidthOfCharSpacing(),g+=d,u+=d);let f={width:g,left:0,height:s.fontSize,kernedWidth:u,deltaY:s.deltaY};if(i>0&&!o){let m=this.__charBounds[t][i-1];f.left=m.left+m.width+c.kernedWidth-c.width;}return f;}getHeightOfLineImpl(e){let t=this.__lineHeights;if(t[e])return t[e];let i=this.getHeightOfChar(e,0);for(let r=1,o=this._textLines[e].length;r<o;r++)i=Math.max(this.getHeightOfChar(e,r),i);return t[e]=i*this._fontSizeMult;}getHeightOfLine(e){return this.getHeightOfLineImpl(e)*this.lineHeight;}calcTextHeight(){let e=0;for(let t=0,i=this._textLines.length;t<i;t++)e+=t===i-1?this.getHeightOfLineImpl(t):this.getHeightOfLine(t);return e;}_getLeftOffset(){return this.direction===Ko?-this.width/2:this.width/2;}_getTopOffset(){return-this.height/2;}_renderTextCommon(e,t){e.save();let i=0,r=this._getLeftOffset(),o=this._getTopOffset();for(let s=0,l=this._textLines.length;s<l;s++)this._renderTextLine(t,e,this._textLines[s],r+this._getLineLeftOffset(s),o+i+this.getHeightOfLineImpl(s),s),i+=this.getHeightOfLine(s);e.restore();}_renderTextFill(e){(this.fill||this.styleHas(Gt))&&this._renderTextCommon(e,"fillText");}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore());}_renderChars(e,t,i,r,o,s){let l=this.textAlign.includes(or),c=this.path,d=!l&&this.charSpacing===0&&this.isEmptyStyles(s)&&!c,u=this.direction===Ko,g=this.direction===Ko?1:-1,f=t.direction,m,_,y,E,C,b="",x=0;if(t.save(),f!==this.direction&&(t.canvas.setAttribute("dir",u?Ko:Tr),t.direction=u?Ko:Tr,t.textAlign=u?ot:Ft),o-=this.getHeightOfLineImpl(s)*this._fontSizeFraction,d)return this._renderChar(e,t,s,0,i.join(""),r,o),void t.restore();for(let w=0,T=i.length-1;w<=T;w++)E=w===T||this.charSpacing||c,b+=i[w],y=this.__charBounds[s][w],x===0?(r+=g*(y.kernedWidth-y.width),x+=y.width):x+=y.kernedWidth,l&&!E&&this._reSpaceAndTab.test(i[w])&&(E=!0),E||(m=m||this.getCompleteStyleDeclaration(s,w),_=this.getCompleteStyleDeclaration(s,w+1),E=du(m,_,!1)),E&&(c?(t.save(),t.translate(y.renderLeft,y.renderTop),t.rotate(y.angle),this._renderChar(e,t,s,w,b,-x/2,0),t.restore()):(C=r,this._renderChar(e,t,s,w,b,C,o)),b="",m=_,r+=g*x,x=0);t.restore();}_applyPatternGradientTransformText(e){let t=this.width+this.strokeWidth,i=this.height+this.strokeWidth,r=Jn({width:t,height:i}),o=r.getContext("2d");return r.width=t,r.height=i,o.beginPath(),o.moveTo(0,0),o.lineTo(t,0),o.lineTo(t,i),o.lineTo(0,i),o.closePath(),o.translate(t/2,i/2),o.fillStyle=e.toLive(o),this._applyPatternGradientTransform(o,e),o.fill(),o.createPattern(r,"no-repeat");}handleFiller(e,t,i){let r,o;return di(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(r=-this.width/2,o=-this.height/2,e.translate(r,o),e[t]=this._applyPatternGradientTransformText(i),{offsetX:r,offsetY:o}):(e[t]=i.toLive(e),this._applyPatternGradientTransform(e,i)):(e[t]=i,{offsetX:0,offsetY:0});}_setStrokeStyles(e,t){let{stroke:i,strokeWidth:r}=t;return e.lineWidth=r,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",i);}_setFillStyles(e,t){let{fill:i}=t;return this.handleFiller(e,"fillStyle",i);}_renderChar(e,t,i,r,o,s,l){let c=this._getStyleDeclaration(i,r),d=this.getCompleteStyleDeclaration(i,r),u=e==="fillText"&&d.fill,g=e==="strokeText"&&d.stroke&&d.strokeWidth;if(g||u){if(t.save(),t.font=this._getFontDeclaration(d),c.textBackgroundColor&&this._removeShadow(t),c.deltaY&&(l+=c.deltaY),u){let f=this._setFillStyles(t,d);t.fillText(o,s-f.offsetX,l-f.offsetY);}if(g){let f=this._setStrokeStyles(t,d);t.strokeText(o,s-f.offsetX,l-f.offsetY);}t.restore();}}setSuperscript(e,t){this._setScript(e,t,this.superscript);}setSubscript(e,t){this._setScript(e,t,this.subscript);}_setScript(e,t,i){let r=this.get2DCursorLocation(e,!0),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),s=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),l={fontSize:o*i.size,deltaY:s+o*i.baseline};this.setSelectionStyles(l,e,t);}_getLineLeftOffset(e){let t=this.getLineWidth(e),i=this.width-t,r=this.textAlign,o=this.direction,s=this.isEndOfWrapping(e),l=0;return r===or||r===Vl&&!s||r===Bl&&!s||r===Bd&&!s?0:(r===De&&(l=i/2),r===Ft&&(l=i),r===Vl&&(l=i/2),r===Bl&&(l=i),o===Tr&&(r===Ft||r===Bl?l=0:r===ot||r===Bd?l=-i:r!==De&&r!==Vl||(l=-i/2)),l);}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[];}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];let{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t;}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0;}getValueOfPropertyAt(e,t,i){var r;return(r=this._getStyleDeclaration(e,t)[i])!==null&&r!==void 0?r:this[i];}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let i=this._getTopOffset(),r=this._getLeftOffset(),o=this.path,s=this._getWidthOfCharSpacing(),l=t==="linethrough"?.5:t==="overline"?1:0,c=this.offsets[t];for(let d=0,u=this._textLines.length;d<u;d++){let g=this.getHeightOfLine(d);if(!this[t]&&!this.styleHas(t,d)){i+=g;continue;}let f=this._textLines[d],m=g/this.lineHeight,_=this._getLineLeftOffset(d),y=0,E=0,C=this.getValueOfPropertyAt(d,0,t),b=this.getValueOfPropertyAt(d,0,Gt),x=this.getValueOfPropertyAt(d,0,Cs),w=C,T=b,R=x,V=i+m*(1-this._fontSizeFraction),B=this.getHeightOfChar(d,0),Y=this.getValueOfPropertyAt(d,0,"deltaY");for(let ee=0,ce=f.length;ee<ce;ee++){let oe=this.__charBounds[d][ee];w=this.getValueOfPropertyAt(d,ee,t),T=this.getValueOfPropertyAt(d,ee,Gt),R=this.getValueOfPropertyAt(d,ee,Cs);let re=this.getHeightOfChar(d,ee),A=this.getValueOfPropertyAt(d,ee,"deltaY");if(o&&w&&T){let z=this.fontSize*R/1e3;e.save(),e.fillStyle=b,e.translate(oe.renderLeft,oe.renderTop),e.rotate(oe.angle),e.fillRect(-oe.kernedWidth/2,c*re+A-l*z,oe.kernedWidth,z),e.restore();}else if((w!==C||T!==b||re!==B||R!==x||A!==Y)&&E>0){let z=this.fontSize*x/1e3,O=r+_+y;this.direction===Tr&&(O=this.width-O-E),C&&b&&x&&(e.fillStyle=b,e.fillRect(O,V+c*B+Y-l*z,E,z)),y=oe.left,E=oe.width,C=w,x=R,b=T,B=re,Y=A;}else E+=oe.kernedWidth;}let le=r+_+y;this.direction===Tr&&(le=this.width-le-E),e.fillStyle=T;let ae=this.fontSize*R/1e3;w&&T&&R&&e.fillRect(le,V+c*B+Y-l*ae,E-s,ae),i+=g;}this._removeShadow(e);}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:i=this.fontWeight,fontSize:r=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,s=e.includes("'")||e.includes('"')||e.includes(",")||n.genericFonts.includes(e.toLowerCase())?e:`"${e}"`;return[t,i,`${o?this.CACHE_FONT_SIZE:r}px`,s].join(" ");}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)));}graphemeSplit(e){return hu(e);}_splitTextIntoLines(e){let t=e.split(this._reNewline),i=new Array(t.length),r=[`
`],o=[];for(let s=0;s<t.length;s++)i[s]=this.graphemeSplit(t[s]),o=o.concat(i[s],r);return o.pop(),{_unwrappedLines:i,lines:t,graphemeText:o,graphemeLines:i};}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return D(se(D({},super.toObject([...Lb,...e])),{styles:ox(this.styles,this.text)}),this.path?{path:this.path.toObject()}:{});}set(e,t){let{textLayoutProperties:i}=this.constructor;super.set(e,t);let r=!1,o=!1;if(typeof e=="object")for(let s in e)s==="path"&&this.setPathInfo(),r=r||i.includes(s),o=o||s==="path";else r=i.includes(e),o=e==="path";return o&&this.setPathInfo(),r&&this.initialized&&(this.initDimensions(),this.setCoords()),this;}complexity(){return 1;}static fromElement(e,t,i){return J(this,null,function*(){let r=zr(e,n.ATTRIBUTE_NAMES,i),x=D(D({},t),r),{textAnchor:o=ot,textDecoration:s="",dx:l=0,dy:c=0,top:d=0,left:u=0,fontSize:g=Am,strokeWidth:f=1}=x,m=lt(x,["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"]),_=new this(Dd(e.textContent||"").trim(),D({left:u+l,top:d+c,underline:s.includes("underline"),overline:s.includes("overline"),linethrough:s.includes("line-through"),strokeWidth:0,fontSize:g},m)),y=_.getScaledHeight()/_.height,E=((_.height+_.strokeWidth)*_.lineHeight-_.height)*y,C=_.getScaledHeight()+E,b=0;return o===De&&(b=_.getScaledWidth()/2),o===Ft&&(b=_.getScaledWidth()),_.set({left:_.left-b,top:_.top-(C-_.fontSize*(.07+_._fontSizeFraction))/_.lineHeight,strokeWidth:f}),_;});}static fromObject(e){return this._fromObject(se(D({},e),{styles:sx(e.styles||{},e.text)}),{extraParam:"text"});}};W(hi,"textLayoutProperties",Rb),W(hi,"cacheProperties",[...Br,...Lb]),W(hi,"ownDefaults",HA),W(hi,"type","Text"),W(hi,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),W(hi,"ATTRIBUTE_NAMES",_o.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),tx(hi,[class extends Nd{_toSVG(){let n=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(e);}toSVG(n){let e=this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:n,withShadow:!0,additionalTransform:ba(this.calcOwnMatrix())}):e;}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)};}_wrapSVGTextAndBg(n){let{textBgRects:e,textSpans:t}=n,i=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',`font-family="${this.fontFamily.replace(GF,"'")}" `,`font-size="${this.fontSize}" `,this.fontStyle?`font-style="${this.fontStyle}" `:"",this.fontWeight?`font-weight="${this.fontWeight}" `:"",i?`text-decoration="${i}" `:"",this.direction==="rtl"?`direction="${this.direction}" `:"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`];}_getSVGTextAndBg(n,e){let t=[],i=[],r,o=n;this.backgroundColor&&i.push(...Ug(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let s=0,l=this._textLines.length;s<l;s++)r=this._getLineLeftOffset(s),this.direction==="rtl"&&(r+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",s))&&this._setSVGTextLineBg(i,s,e+r,o),this._setSVGTextLineText(t,s,e+r,o),o+=this.getHeightOfLine(s);return{textSpans:t,textBgRects:i};}_createTextCharSpan(n,e,t,i,r){let o=Ze.NUM_FRACTION_DIGITS,s=this.getSvgSpanStyles(e,n!==n.trim()||!!n.match(WF)),l=s?`style="${s}"`:"",c=e.deltaY,d=c?` dy="${pt(c,o)}" `:"",{angle:u,renderLeft:g,renderTop:f,width:m}=r,_="";if(g!==void 0){let y=m/2;u&&(_=` rotate="${pt(Dr(u),o)}"`);let E=Ps({angle:Dr(u)});E[4]=g,E[5]=f;let C=new ne(-y,0).transform(E);t=C.x,i=C.y;}return`<tspan x="${pt(t,o)}" y="${pt(i,o)}" ${d}${_}${l}>${rx(n)}</tspan>`;}_setSVGTextLineText(n,e,t,i){let r=this.getHeightOfLine(e),o=this.textAlign.includes(or),s=this._textLines[e],l,c,d,u,g,f="",m=0;i+=r*(1-this._fontSizeFraction)/this.lineHeight;for(let _=0,y=s.length-1;_<=y;_++)g=_===y||this.charSpacing||this.path,f+=s[_],d=this.__charBounds[e][_],m===0?(t+=d.kernedWidth-d.width,m+=d.width):m+=d.kernedWidth,o&&!g&&this._reSpaceAndTab.test(s[_])&&(g=!0),g||(l=l||this.getCompleteStyleDeclaration(e,_),c=this.getCompleteStyleDeclaration(e,_+1),g=du(l,c,!0)),g&&(u=this._getStyleDeclaration(e,_),n.push(this._createTextCharSpan(f,u,t,i,d)),f="",l=c,this.direction==="rtl"?t-=m:t+=m,m=0);}_setSVGTextLineBg(n,e,t,i){let r=this._textLines[e],o=this.getHeightOfLine(e)/this.lineHeight,s,l=0,c=0,d=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<r.length;u++){let{left:g,width:f,kernedWidth:m}=this.__charBounds[e][u];s=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),s!==d?(d&&n.push(...Ug(d,t+c,i,l,o)),c=g,l=f,d=s):l+=m;}s&&n.push(...Ug(d,t+c,i,l,o));}getSvgStyles(n){return`${super.getSvgStyles(n)} text-decoration-thickness: ${pt(this.textDecorationThickness*this.getObjectScaling().y/10,Ze.NUM_FRACTION_DIGITS)}%; white-space: pre;`;}getSvgSpanStyles(n,e){let{fontFamily:t,strokeWidth:i,stroke:r,fill:o,fontSize:s,fontStyle:l,fontWeight:c,textDecorationThickness:d,linethrough:u,overline:g,underline:f}=n,m=this.getSvgTextDecoration({underline:f??this.underline,overline:g??this.overline,linethrough:u??this.linethrough}),_=d||this.textDecorationThickness;return[r?Ul(Ln,r):"",i?`stroke-width: ${i}; `:"",t?`font-family: ${t.includes("'")||t.includes('"')?t:`'${t}'`}; `:"",s?`font-size: ${s}px; `:"",l?`font-style: ${l}; `:"",c?`font-weight: ${c}; `:"",m?`text-decoration: ${m}; text-decoration-thickness: ${pt(_*this.getObjectScaling().y/10,Ze.NUM_FRACTION_DIGITS)}%; `:"",o?Ul(Gt,o):"",e?"white-space: pre; ":""].join("");}getSvgTextDecoration(n){return["overline","underline","line-through"].filter(e=>n[e.replace("-","")]).join(" ");}}]),Ce.setClass(hi),Ce.setSVGClass(hi);var wm=class{constructor(e){W(this,"target",void 0),W(this,"__mouseDownInPlace",!1),W(this,"__dragStartFired",!1),W(this,"__isDraggingOver",!1),W(this,"__dragStartSelection",void 0),W(this,"__dragImageDisposer",void 0),W(this,"_dispose",void 0),this.target=e;let t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(i=>i()),this._dispose=void 0;};}isPointerOverSelection(e){let t=this.target,i=t.getSelectionStartFromPointer(e);return t.isEditing&&i>=t.selectionStart&&i<=t.selectionEnd&&t.selectionStart<t.selectionEnd;}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e);}isActive(){return this.__mouseDownInPlace;}end(e){let t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t;}getDragStartSelection(){return this.__dragStartSelection;}setDragImage(e,t){var i;let{selectionStart:r,selectionEnd:o}=t,s=this.target,l=s.canvas,c=new ne(s.flipX?-1:1,s.flipY?-1:1),d=s._getCursorBoundaries(r),u=new ne(d.left+d.leftOffset,d.top+d.topOffset).multiply(c).transform(s.calcTransformMatrix()),g=l.getScenePoint(e).subtract(u),f=s.getCanvasRetinaScaling(),m=s.getBoundingRect(),_=u.subtract(new ne(m.left,m.top)),y=l.viewportTransform,E=_.add(g).transform(y,!0),C=s.backgroundColor,b=Km(s.styles);s.backgroundColor="";let x={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};s.setSelectionStyles(x,0,r),s.setSelectionStyles(x,o,s.text.length),s.dirty=!0;let w=s.toCanvasElement({enableRetinaScaling:l.enableRetinaScaling,viewportTransform:!0});s.backgroundColor=C,s.styles=b,s.dirty=!0,_m(w,{position:"fixed",left:-w.width+"px",border:xn,width:w.width/f+"px",height:w.height/f+"px"}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{w.remove();},Ei(e.target||this.target.hiddenTextarea).body.appendChild(w),(i=e.dataTransfer)===null||i===void 0||i.setDragImage(w,E.x,E.y);}onDragStart(e){this.__dragStartFired=!0;let t=this.target,i=this.isActive();if(i&&e.dataTransfer){let r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},o=t._text.slice(r.selectionStart,r.selectionEnd).join(""),s=D({text:t.text,value:o},r);e.dataTransfer.setData("text/plain",o),e.dataTransfer.setData("application/fabric",JSON.stringify({value:o,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,s);}return t.abortCursorAnimation(),i;}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){let t=this.target.getSelectionStartFromPointer(e),i=this.__dragStartSelection;return t<i.selectionStart||t>i.selectionEnd;}return!0;}return!1;}targetCanDrop(e){return this.target.canDrop(e);}dragEnterHandler(e){let{e:t}=e,i=this.targetCanDrop(t);!this.__isDraggingOver&&i&&(this.__isDraggingOver=!0);}dragOverHandler(e){let{e:t}=e,i=this.targetCanDrop(t);!this.__isDraggingOver&&i?this.__isDraggingOver=!0:this.__isDraggingOver&&!i&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target);}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1);}dropHandler(e){var t;let{e:i}=e,r=i.defaultPrevented;this.__isDraggingOver=!1,i.preventDefault();let o=(t=i.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(o&&!r){let s=this.target,l=s.canvas,c=s.getSelectionStartFromPointer(i),{styles:d}=i.dataTransfer.types.includes("application/fabric")?JSON.parse(i.dataTransfer.getData("application/fabric")):{},u=o[Math.max(0,o.length-1)],g=0;if(this.__dragStartSelection){let f=this.__dragStartSelection.selectionStart,m=this.__dragStartSelection.selectionEnd;c>f&&c<=m?c=f:c>m&&(c-=m-f),s.removeChars(f,m),delete this.__dragStartSelection;}s._reNewline.test(u)&&(s._reNewline.test(s._text[c])||c===s._text.length)&&(o=o.trimEnd()),e.didDrop=!0,e.dropTarget=s,s.insertChars(o,d,c),l.setActiveObject(s),s.enterEditing(i),s.selectionStart=Math.min(c+g,s._text.length),s.selectionEnd=Math.min(s.selectionStart+o.length,s._text.length),s.hiddenTextarea.value=s.text,s._updateTextarea(),s.hiddenTextarea.focus(),s.fire(Ed,{index:c+g,action:"drop"}),l.fire("text:changed",{target:s}),l.contextTopDirty=!0,l.requestRenderAll();}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var i;let r=this.target,o=this.target.canvas,{selectionStart:s,selectionEnd:l}=this.__dragStartSelection,c=((i=t.dataTransfer)===null||i===void 0?void 0:i.dropEffect)||xn;c===xn?(r.selectionStart=s,r.selectionEnd=l,r._updateTextarea(),r.hiddenTextarea.focus()):(r.clearContextTop(),c==="move"&&(r.removeChars(s,l),r.selectionStart=r.selectionEnd=s,r.hiddenTextarea&&(r.hiddenTextarea.value=r.text),r._updateTextarea(),r.fire(Ed,{index:s,action:"dragend"}),o.fire("text:changed",{target:r}),o.requestRenderAll()),r.exitEditing());}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1;}dispose(){this._dispose&&this._dispose();}},ib=/[ \n\.,;!\?\-]/,Mm=class extends hi{constructor(){super(...arguments),W(this,"_currentCursorOpacity",1);}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this);}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e);}_animateCursor(e){let{toValue:t,duration:i,delay:r,onComplete:o}=e;return Ym({startValue:this._currentCursorOpacity,endValue:t,duration:i,delay:r,onComplete:o,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:s=>{this._currentCursorOpacity=s,this.renderCursorOrSelection();}});}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete});}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick});}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay);}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort());}),this._currentCursorOpacity=1,e&&this.clearContextTop();}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor();}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this;}cmdAll(){this.selectAll(),this.renderCursorOrSelection();}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("");}findWordBoundaryLeft(e){let t=0,i=e-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)t++,i--;for(;/\S/.test(this._text[i])&&i>-1;)t++,i--;return e-t;}findWordBoundaryRight(e){let t=0,i=e;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)t++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)t++,i++;return e+t;}findLineBoundaryLeft(e){let t=0,i=e-1;for(;!/\n/.test(this._text[i])&&i>-1;)t++,i--;return e-t;}findLineBoundaryRight(e){let t=0,i=e;for(;!/\n/.test(this._text[i])&&i<this._text.length;)t++,i++;return e+t;}searchWordBoundary(e,t){let i=this._text,r=e>0&&this._reSpace.test(i[e])&&(t===-1||!Fm.test(i[e-1]))?e-1:e,o=i[r];for(;r>0&&r<i.length&&!ib.test(o);)r+=t,o=i[r];return t===-1&&ib.test(o)&&r++,r;}selectWord(e){e=e??this.selectionStart;let t=this.searchWordBoundary(e,-1),i=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection();}selectLine(e){e=e??this.selectionStart;let t=this.findLineBoundaryLeft(e),i=this.findLineBoundaryRight(e);this.selectionStart=t,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea();}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()));}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick();}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;let t=this.hiddenTextarea;Ei(t).activeElement!==t&&t.focus();let i=this.getSelectionStartFromPointer(e),r=this.selectionStart,o=this.selectionEnd;(i===this.__selectionStartOnMouseDown&&r!==o||r!==i&&o!==i)&&(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===o||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()));}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0;}fromStringToGraphemeSelection(e,t,i){let r=i.slice(0,e),o=this.graphemeSplit(r).length;if(e===t)return{selectionStart:o,selectionEnd:o};let s=i.slice(e,t);return{selectionStart:o,selectionEnd:o+this.graphemeSplit(s).length};}fromGraphemeToStringSelection(e,t,i){let r=i.slice(0,e).join("").length;return e===t?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+i.slice(e,t).join("").length};}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){let e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd;}this.updateTextareaPosition();}}updateFromTextArea(){let{hiddenTextarea:e,direction:t,textAlign:i,inCompositionMode:r}=this;if(!e)return;let o=i!==or?i.replace("justify-",""):t===Ko?ot:Ft,s=this.getPositionByOrigin(o,"top");this.cursorOffsetCache={},this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setPositionByOrigin(s,o,"top"),this.setCoords();let l=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=l.selectionEnd,r||(this.selectionStart=l.selectionStart),this.updateTextareaPosition();}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){let e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top;}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};let e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),i=this.get2DCursorLocation(e),r=i.lineIndex,o=i.charIndex,s=this.getValueOfPropertyAt(r,o,"fontSize")*this.lineHeight,l=t.leftOffset,c=this.getCanvasRetinaScaling(),d=this.canvas.upperCanvasEl,u=d.width/c,g=d.height/c,f=u-s,m=g-s,_=new ne(t.left+l,t.top+t.topOffset+s).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new ne(d.clientWidth/u,d.clientHeight/g));return _.x<0&&(_.x=0),_.x>f&&(_.x=f),_.y<0&&(_.y=0),_.y>m&&(_.y=m),_.x+=this.canvas._offset.left,_.y+=this.canvas._offset.top,{left:`${_.x}px`,top:`${_.y}px`,fontSize:`${s}px`,charHeight:s};}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor};}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps);}exitEditingImpl(){let e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords());}exitEditing(){let e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(Od),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this;}_removeExtraneousStyles(){for(let e in this.styles)this._textLines[e]||delete this.styles[e];}removeStyleFromTo(e,t){let{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e,!0),{lineIndex:o,charIndex:s}=this.get2DCursorLocation(t,!0);if(i!==o){if(this.styles[i])for(let l=r;l<this._unwrappedTextLines[i].length;l++)delete this.styles[i][l];if(this.styles[o])for(let l=s;l<this._unwrappedTextLines[o].length;l++){let c=this.styles[o][l];c&&(this.styles[i]||(this.styles[i]={}),this.styles[i][r+l-s]=c);}for(let l=i+1;l<=o;l++)delete this.styles[l];this.shiftLineStyles(o,i-o);}else if(this.styles[i]){let l=this.styles[i],c=s-r;for(let d=r;d<s;d++)delete l[d];for(let d in this.styles[i]){let u=parseInt(d,10);u>=s&&(l[u-c]=l[d],delete l[d]);}}}shiftLineStyles(e,t){let i=Object.assign({},this.styles);for(let r in this.styles){let o=parseInt(r,10);o>e&&(this.styles[o+t]=i[o],i[o-t]||delete this.styles[o]);}}insertNewlineStyleObject(e,t,i,r){let o={},s=this._unwrappedTextLines[e].length,l=s===t,c=!1;i||(i=1),this.shiftLineStyles(e,i);let d=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(let g in this.styles[e]){let f=parseInt(g,10);f>=t&&(c=!0,o[f-t]=this.styles[e][g],l&&t===0||delete this.styles[e][g]);}let u=!1;for(c&&!l&&(this.styles[e+i]=o,u=!0),(u||s>t)&&i--;i>0;)r&&r[i-1]?this.styles[e+i]={0:D({},r[i-1])}:d?this.styles[e+i]={0:D({},d)}:delete this.styles[e+i],i--;this._forceClearCache=!0;}insertCharStyleObject(e,t,i,r){this.styles||(this.styles={});let o=this.styles[e],s=o?D({},o):{};i||(i=1);for(let c in s){let d=parseInt(c,10);d>=t&&(o[d+i]=s[d],s[d-i]||delete o[d]);}if(this._forceClearCache=!0,r){for(;i--;)Object.keys(r[i]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+i]=D({},r[i]));return;}if(!o)return;let l=o[t?t-1:1];for(;l&&i--;)this.styles[e][t+i]=D({},l);}insertNewStyleBlock(e,t,i){let r=this.get2DCursorLocation(t,!0),o=[0],s,l=0;for(let c=0;c<e.length;c++)e[c]===`
`?(l++,o[l]=0):o[l]++;for(o[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,o[0],i),i=i&&i.slice(o[0]+1)),l&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+o[0],l),s=1;s<l;s++)o[s]>0?this.insertCharStyleObject(r.lineIndex+s,0,o[s],i):i&&this.styles[r.lineIndex+s]&&i[0]&&(this.styles[r.lineIndex+s][0]=i[0]),i=i&&i.slice(o[s]+1);o[s]>0&&this.insertCharStyleObject(r.lineIndex+s,0,o[s],i);}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles();}insertChars(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;r>i&&this.removeStyleFromTo(i,r);let o=this.graphemeSplit(e);this.insertNewStyleBlock(o,i,t),this._text=[...this._text.slice(0,i),...o,...this._text.slice(r)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles();}setSelectionStartEndWithShift(e,t,i){i<=e?(t===e?this._selectionDirection=ot:this._selectionDirection===Ft&&(this._selectionDirection=ot,this.selectionEnd=e),this.selectionStart=i):i>e&&i<t?this._selectionDirection===Ft?this.selectionEnd=i:this.selectionStart=i:(t===e?this._selectionDirection=Ft:this._selectionDirection===ot&&(this._selectionDirection=Ft,this.selectionStart=t),this.selectionEnd=i);}},Sm=class extends Mm{initHiddenTextarea(){let e=this.canvas&&Ei(this.canvas.getElement())||Ma(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map(s=>{let[l,c]=s;return t.setAttribute(l,c);});let{top:i,left:r,fontSize:o}=this._calcTextareaPosition();t.style.cssText=`position: absolute; top: ${i}; left: ${r}; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ${o};`,(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(s=>{let[l,c]=s;return t.addEventListener(l,this[c].bind(this));}),this.hiddenTextarea=t;}blur(){this.abortCursorAnimation();}onKeyDown(e){if(!this.isEditing)return;let t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e);}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll();}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll());}onInput(e){let t=this.fromPaste,{value:i,selectionStart:r,selectionEnd:o}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;let s=()=>{this.updateFromTextArea(),this.fire(Ed),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());};if(this.hiddenTextarea.value==="")return this.styles={},void s();let l=this._splitTextIntoLines(i).graphemeText,c=this._text.length,d=l.length,u=this.selectionStart,g=this.selectionEnd,f=u!==g,m,_,y,E,C=d-c,b=this.fromStringToGraphemeSelection(r,o,i),x=u>b.selectionStart;f?(_=this._text.slice(u,g),C+=g-u):d<c&&(_=x?this._text.slice(g+C,g):this._text.slice(u,u-C));let w=l.slice(b.selectionEnd-C,b.selectionEnd);if(_&&_.length&&(w.length&&(m=this.getSelectionStyles(u,u+1,!1),m=w.map(()=>m[0])),f?(y=u,E=g):x?(y=g-_.length,E=g):(y=g,E=g+_.length),this.removeStyleFromTo(y,E)),w.length){let{copyPasteData:T}=ar();t&&w.join("")===T.copiedText&&!Ze.disableStyleCopyPaste&&(m=T.copiedTextStyle),this.insertNewStyleBlock(w,u,m);}s();}onCompositionStart(){this.inCompositionMode=!0;}onCompositionEnd(){this.inCompositionMode=!1;}onCompositionUpdate(e){let{target:t}=e,{selectionStart:i,selectionEnd:r}=t;this.compositionStart=i,this.compositionEnd=r,this.updateTextareaPosition();}copy(){if(this.selectionStart===this.selectionEnd)return;let{copyPasteData:e}=ar();e.copiedText=this.getSelectedText(),Ze.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0;}paste(){this.fromPaste=!0;}_getWidthBeforeCursor(e,t){let i,r=this._getLineLeftOffset(e);return t>0&&(i=this.__charBounds[e][t-1],r+=i.left+i.width),r;}getDownCursorOffset(e,t){let i=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(i),o=r.lineIndex;if(o===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-i;let s=r.charIndex,l=this._getWidthBeforeCursor(o,s),c=this._getIndexOnLine(o+1,l);return this._textLines[o].slice(s).length+c+1+this.missingNewlineOffset(o);}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart;}getUpCursorOffset(e,t){let i=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(i),o=r.lineIndex;if(o===0||e.metaKey||e.keyCode===33)return-i;let s=r.charIndex,l=this._getWidthBeforeCursor(o,s),c=this._getIndexOnLine(o-1,l),d=this._textLines[o].slice(0,s),u=this.missingNewlineOffset(o-1);return-this._textLines[o-1].length+c-d.length+(1-u);}_getIndexOnLine(e,t){let i=this._textLines[e],r,o,s=this._getLineLeftOffset(e),l=0;for(let c=0,d=i.length;c<d;c++)if(r=this.__charBounds[e][c].width,s+=r,s>t){o=!0;let u=s-r,g=s,f=Math.abs(u-t);l=Math.abs(g-t)<f?c:c-1;break;}return o||(l=i.length-1),l;}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e);}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e);}_moveCursorUpOrDown(e,t){let i=this[`get${e}CursorOffset`](t,this._selectionDirection===Ft);if(t.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),i!==0){let r=this.text.length;this.selectionStart=bs(0,this.selectionStart,r),this.selectionEnd=bs(0,this.selectionEnd,r),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea();}}moveCursorWithShift(e){let t=this._selectionDirection===ot?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0;}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0;}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e);}_move(e,t,i){let r;if(e.altKey)r=this[`findWordBoundary${i}`](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=i==="Left"?-1:1,!0;r=this[`findLineBoundary${i}`](this[t]);}return r!==void 0&&this[t]!==r&&(this[t]=r,!0);}_moveLeft(e,t){return this._move(e,t,"Left");}_moveRight(e,t){return this._move(e,t,"Right");}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=ot,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t;}moveCursorLeftWithShift(e){return this._selectionDirection===Ft&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=ot,this._moveLeft(e,"selectionStart")):void 0;}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e);}_moveCursorLeftOrRight(e,t){let i=`moveCursor${e}${t.shiftKey?"WithShift":"WithoutShift"}`;this._currentCursorOpacity=1,this[i](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea());}moveCursorRightWithShift(e){return this._selectionDirection===ot&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Ft,this._moveRight(e,"selectionEnd")):void 0;}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Ft,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t;}},rb=n=>!!n.button,Em=class extends Sm{constructor(){super(...arguments),W(this,"draggableTextDelegate",void 0);}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new wm(this),super.initBehavior();}shouldStartDragging(){return this.draggableTextDelegate.isActive();}onDragStart(e){return this.draggableTextDelegate.onDragStart(e);}canDrop(e){return this.draggableTextDelegate.canDrop(e);}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection());}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection());}_mouseDownHandler(e){let{e:t,alreadySelected:i}=e;this.canvas&&this.editable&&!rb(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),i&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=i||this.isEditing)));}mouseUpHandler(e){let{e:t,transform:i}=e,r=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);let o=this.canvas._activeObject;if(o&&o!==this)return;}!this.editable||this.group&&!this.group.interactive||i&&i.actionPerformed||rb(t)||r||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection());}setCursorByClick(e){let t=this.getSelectionStartFromPointer(e),i=this.selectionStart,r=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(i,r,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea());}getSelectionStartFromPointer(e){let t=this.canvas.getScenePoint(e).transform(Fn(this.calcTransformMatrix())).add(new ne(-this._getLeftOffset(),-this._getTopOffset())),i=0,r=0,o=0;for(let d=0;d<this._textLines.length&&i<=t.y;d++)i+=this.getHeightOfLine(d),o=d,d>0&&(r+=this._textLines[d-1].length+this.missingNewlineOffset(d-1));let s=Math.abs(this._getLineLeftOffset(o)),l=this._textLines[o].length,c=this.__charBounds[o];for(let d=0;d<l;d++){let u=s+c[d].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-s)&&r++;break;}s=u,r++;}return Math.min(this.flipX?l-r:r,this._text.length);}},md="moveCursorUp",_d="moveCursorDown",vd="moveCursorLeft",yd="moveCursorRight",Cd="exitEditing",sb=(n,e)=>{let t=e.getRetinaScaling();n.setTransform(t,0,0,t,0,0);let i=e.viewportTransform;n.transform(i[0],i[1],i[2],i[3],i[4],i[5]);},YF={selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Cd,27:Cd,33:md,34:_d,35:yd,36:vd,37:vd,38:md,39:yd,40:_d},keysMapRtl:{9:Cd,27:Cd,33:md,34:_d,35:vd,36:yd,37:yd,38:md,39:vd,40:_d},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"},_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1},uo=class n extends Em{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}get type(){let e=super.type;return e==="itext"?"i-text":e;}constructor(e,t){super(e,D(D({},n.ownDefaults),t)),this.initBehavior();}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof wa&&this.canvas.textEditingManager.remove(this),t instanceof wa&&t.textEditingManager.add(this)),super._set(e,t));}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e);}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e);}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea();}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this});}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions();}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,i=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,i);}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,i);}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t);}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection();}toCanvasElement(e){let t=this.isEditing;this.isEditing=!1;let i=super.toCanvasElement(e);return this.isEditing=t,i;}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;let e=this.clearContextTop(!0);if(!e)return;let t=this._getCursorBoundaries(),i=this.findAncestorsWithClipPath(),r=i.length>0,o,s=e;if(r){o=Jn(e.canvas),s=o.getContext("2d"),sb(s,this.canvas);let l=this.calcTransformMatrix();s.transform(l[0],l[1],l[2],l[3],l[4],l[5]);}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(s,t):this.renderCursor(s,t),r)for(let l of i){let c=l.clipPath,d=Jn(e.canvas),u=d.getContext("2d");if(sb(u,this.canvas),!c.absolutePositioned){let g=l.calcTransformMatrix();u.transform(g[0],g[1],g[2],g[3],g[4],g[5]);}c.transform(u),c.drawObject(u,!0,{}),this.drawClipPathOnCache(s,c,d);}r&&(e.setTransform(1,0,0,1,0,0),e.drawImage(o,0,0)),this.canvas.contextTopDirty=!0,e.restore();}findAncestorsWithClipPath(){let e=[],t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e;}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0,i=this._getLeftOffset(),r=this._getTopOffset(),o=this._getCursorBoundariesOffsets(e,t);return{left:i,top:r,leftOffset:o.left,topOffset:o.top};}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e);}__getCursorBoundariesOffsets(e){let t=0,i=0,{charIndex:r,lineIndex:o}=this.get2DCursorLocation(e),{textAlign:s,direction:l}=this;for(let g=0;g<o;g++)t+=this.getHeightOfLine(g);let c=this._getLineLeftOffset(o),d=this.__charBounds[o][r];d&&(i=d.left),this.charSpacing!==0&&r===this._textLines[o].length&&(i-=this._getWidthOfCharSpacing());let u=c+(i>0?i:0);return l===Tr&&(s===Ft||s===or||s===Bl?u*=-1:s===ot||s===Bd?u=c-(i>0?i:0):s!==De&&s!==Vl||(u=c-(i>0?i:0))),{top:t,left:u};}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e);}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart);}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e),i=this.get2DCursorLocation(e),r=i.lineIndex,o=i.charIndex>0?i.charIndex-1:0,s=this.getValueOfPropertyAt(r,o,"fontSize"),l=this.getObjectScaling().x*this.canvas.getZoom(),c=this.cursorWidth/l,d=this.getValueOfPropertyAt(r,o,"deltaY"),u=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-s*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(r,o,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-c/2,top:u+t.top+d,width:c,height:s};}_renderCursor(e,t,i){let{color:r,opacity:o,left:s,top:l,width:c,height:d}=this.getCursorRenderingData(i,t);e.fillStyle=r,e.globalAlpha=o,e.fillRect(s,l,c,d);}renderSelection(e,t){let i={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,i,t);}renderDragSourceEffect(){let e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0));}renderDropTargetEffect(e){let t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t);}_renderSelection(e,t,i){let{textAlign:r,direction:o}=this,s=t.selectionStart,l=t.selectionEnd,c=r.includes(or),d=this.get2DCursorLocation(s),u=this.get2DCursorLocation(l),g=d.lineIndex,f=u.lineIndex,m=d.charIndex<0?0:d.charIndex,_=u.charIndex<0?0:u.charIndex;for(let y=g;y<=f;y++){let E=this._getLineLeftOffset(y)||0,C=this.getHeightOfLine(y),b=0,x=0,w=0;if(y===g&&(x=this.__charBounds[g][m].left),y>=g&&y<f)w=c&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===f)if(_===0)w=this.__charBounds[f][_].left;else{let Y=this._getWidthOfCharSpacing();w=this.__charBounds[f][_-1].left+this.__charBounds[f][_-1].width-Y;}b=C,(this.lineHeight<1||y===f&&this.lineHeight>1)&&(C/=this.lineHeight);let T=i.left+E+x,R=C,V=0,B=w-x;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",R=1,V=C):e.fillStyle=this.selectionColor,o===Tr&&(r===Ft||r===or||r===Bl?T=this.width-T-B:r===ot||r===Bd?T=i.left+E-w:r!==De&&r!==Vl||(T=i.left+E-w)),e.fillRect(T,i.top+i.topOffset+V,B,R),i.topOffset+=b;}}getCurrentCharFontSize(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize");}getCurrentCharColor(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Gt);}_getCurrentCharIndex(){let e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t};}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose();}};W(uo,"ownDefaults",YF),W(uo,"type","IText"),Ce.setClass(uo),Ce.setClass(uo,"i-text");var Ar=class n extends uo{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(e,t){super(e,D(D({},n.ownDefaults),t));}static createControls(){return{controls:ex()};}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(or)&&this.enlargeSpaces(),this.height=this.calcTextHeight());}_generateStyleMap(e){let t=0,i=0,r=0,o={};for(let s=0;s<e.graphemeLines.length;s++)e.graphemeText[r]===`
`&&s>0?(i=0,r++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[r])&&s>0&&(i++,r++),o[s]={line:t,offset:i},r+=e.graphemeLines[s].length,i+=e.graphemeLines[s].length;return o;}styleHas(e,t){if(this._styleMap&&!this.isWrapping){let i=this._styleMap[t];i&&(t=i.line);}return super.styleHas(e,t);}isEmptyStyles(e){if(!this.styles)return!0;let t,i=0,r=e+1,o=!1,s=this._styleMap[e],l=this._styleMap[e+1];s&&(e=s.line,i=s.offset),l&&(r=l.line,o=r===e,t=l.offset);let c=e===void 0?this.styles:{line:this.styles[e]};for(let d in c)for(let u in c[d]){let g=parseInt(u,10);if(g>=i&&(!o||g<t))for(let f in c[d][u])return!1;}return!0;}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){let i=this._styleMap[e];if(!i)return{};e=i.line,t=i.offset+t;}return super._getStyleDeclaration(e,t);}_setStyleDeclaration(e,t,i){let r=this._styleMap[e];super._setStyleDeclaration(r.line,r.offset+t,i);}_deleteStyleDeclaration(e,t){let i=this._styleMap[e];super._deleteStyleDeclaration(i.line,i.offset+t);}_getLineStyle(e){let t=this._styleMap[e];return!!this.styles[t.line];}_setLineStyle(e){let t=this._styleMap[e];super._setLineStyle(t.line);}_wrapText(e,t){this.isWrapping=!0;let i=this.getGraphemeDataForRender(e),r=[];for(let o=0;o<i.wordsData.length;o++)r.push(...this._wrapLine(o,t,i));return this.isWrapping=!1,r;}getGraphemeDataForRender(e){let t=this.splitByGrapheme,i=t?"":" ",r=0;return{wordsData:e.map((o,s)=>{let l=0,c=t?this.graphemeSplit(o):this.wordSplit(o);return c.length===0?[{word:[],width:0}]:c.map(d=>{let u=t?[d]:this.graphemeSplit(d),g=this._measureWord(u,s,l);return r=Math.max(g,r),l+=u.length+i.length,{word:u,width:g};});}),largestWordWidth:r};}_measureWord(e,t){let i,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=0;for(let s=0,l=e.length;s<l;s++)o+=this._getGraphemeBox(e[s],t,s+r,i,!0).kernedWidth,i=e[s];return o;}wordSplit(e){return e.split(this._wordJoiners);}_wrapLine(e,t,i){let{largestWordWidth:r,wordsData:o}=i,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,l=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,d=[],u=c?"":" ",g=0,f=[],m=0,_=0,y=!0;t-=s;let E=Math.max(t,r,this.dynamicMinWidth),C=o[e],b;for(m=0,b=0;b<C.length;b++){let{word:x,width:w}=C[b];m+=x.length,g+=_+w-l,g>E&&!y?(d.push(f),f=[],g=w,y=!0):g+=l,y||c||f.push(u),f=f.concat(x),_=c?0:this._measureWord([u],e,m),m++,y=!1;}return b&&d.push(f),r+s>this.dynamicMinWidth&&(this.dynamicMinWidth=r-l+s),d;}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line;}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1;}_splitTextIntoLines(e){let t=super._splitTextIntoLines(e),i=this._wrapText(t.lines,this.width),r=new Array(i.length);for(let o=0;o<i.length;o++)r[o]=i[o].join("");return t.lines=r,t.graphemeLines=i,t;}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth);}_removeExtraneousStyles(){let e=new Map();for(let t in this._styleMap){let i=parseInt(t,10);if(this._textLines[i]){let r=this._styleMap[t].line;e.set(`${r}`,!0);}}for(let t in this.styles)e.has(t)||delete this.styles[t];}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e]);}};W(Ar,"type","Textbox"),W(Ar,"textLayoutProperties",[...uo.textLayoutProperties,"width"]),W(Ar,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),Ce.setClass(Ar);var Kd=class extends Pa{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e);}shouldLayoutClipPath(){return!1;}calcLayoutResult(e,t){let{target:i}=e,{clipPath:r,group:o}=i;if(!r||!this.shouldPerformLayout(e))return;let{width:s,height:l}=sr(lx(i,r)),c=new ne(s,l);if(r.absolutePositioned)return{center:Nr(r.getRelativeCenterPoint(),void 0,o?o.calcTransformMatrix():void 0),size:c};{let d=r.getRelativeCenterPoint().transform(i.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){let{center:u=new ne(),correction:g=new ne()}=this.calcBoundingBox(t,e)||{};return{center:u.add(d),correction:g.subtract(d),size:c};}return{center:i.getRelativeCenterPoint().add(d),size:c};}}};W(Kd,"type","clip-path"),Ce.setClass(Kd);var Jd=class extends Pa{getInitialSize(e,t){let{target:i}=e,{size:r}=t;return new ne(i.width||r.x,i.height||r.y);}};W(Jd,"type","fixed"),Ce.setClass(Jd);var Om=class extends xs{subscribeTargets(e){let t=e.target;e.targets.reduce((i,r)=>(r.parent&&i.add(r.parent),i),new Set()).forEach(i=>{i.layoutManager.subscribeTargets({target:i,targets:[t]});});}unsubscribeTargets(e){let t=e.target,i=t.getObjects();e.targets.reduce((r,o)=>(o.parent&&r.add(o.parent),r),new Set()).forEach(r=>{!i.some(o=>o.parent===r)&&r.layoutManager.unsubscribeTargets({target:r,targets:[t]});});}},ma=class n extends Rr{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,n.ownDefaults),this.setOptions(t);let{left:i,top:r,layoutManager:o}=t;this.groupInit(e,{left:i,top:r,layoutManager:o??new Om()});}_shouldSetNestedCoords(){return!0;}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(r=>{let o=this._objects.findIndex(l=>l.isInFrontOf(r)),s=o===-1?this.size():o;this.insertAt(s,r);});}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(Lr("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e);}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t);}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0);}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);let i=new Set();t.forEach(r=>{let{parent:o}=r;o&&i.add(o);}),e===Qm?i.forEach(r=>{r._onAfterObjectsChange(Hd,t);}):i.forEach(r=>{r._set("dirty",!0);});}onDeselect(){return this.removeAll(),!1;}toString(){return`#<ActiveSelection: (${this.complexity()})>`;}shouldCache(){return!1;}isOnACache(){return!1;}_renderControls(e,t,i){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;let r=se(D({hasControls:!1},i),{forActiveSelection:!0});for(let o=0;o<this._objects.length;o++)this._objects[o]._renderControls(e,r);super._renderControls(e,t),e.restore();}};W(ma,"type","ActiveSelection"),W(ma,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),Ce.setClass(ma),Ce.setClass(ma,"activeSelection");var Tm=class{constructor(){W(this,"resources",{});}applyFilters(e,t,i,r,o){let s=o.getContext("2d",{willReadFrequently:!0,desynchronized:!0});if(!s)return;s.drawImage(t,0,0,i,r);let l={sourceWidth:i,sourceHeight:r,imageData:s.getImageData(0,0,i,r),originalEl:t,originalImageData:s.getImageData(0,0,i,r),canvasEl:o,ctx:s,filterBackend:this};e.forEach(d=>{d.applyTo(l);});let{imageData:c}=l;return c.width===i&&c.height===r||(o.width=c.width,o.height=c.height),s.putImageData(c,0,0),l;}},Qd=class{constructor(){let{tileSize:e=Ze.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),W(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo();}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t);}createWebGLCanvas(e,t){let i=Jn({width:e,height:t}),r=i.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});r&&(r.clearColor(0,0,0,0),this.canvas=i,this.gl=r);}applyFilters(e,t,i,r,o,s){let l=this.gl,c=o.getContext("2d");if(!l||!c)return;let d;s&&(d=this.getCachedTexture(s,t));let u={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:i,sourceHeight:r,destinationWidth:i,destinationHeight:r,context:l,sourceTexture:this.createTexture(l,i,r,d?void 0:t),targetTexture:this.createTexture(l,i,r),originalTexture:d||this.createTexture(l,i,r,d?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:o},g=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,g),e.forEach(f=>{f&&f.applyTo(u);}),function(f){let m=f.targetCanvas,_=m.width,y=m.height,E=f.destinationWidth,C=f.destinationHeight;_===E&&y===C||(m.width=E,m.height=C);}(u),this.copyGLTo2D(l,u),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(u.sourceTexture),l.deleteTexture(u.targetTexture),l.deleteFramebuffer(g),c.setTransform(1,0,0,1,0,0),u;}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches();}clearWebGLCaches(){this.programCache={},this.textureCache={};}createTexture(e,t,i,r,o){let{NEAREST:s,TEXTURE_2D:l,RGBA:c,UNSIGNED_BYTE:d,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:g,TEXTURE_MIN_FILTER:f,TEXTURE_WRAP_S:m,TEXTURE_WRAP_T:_}=e,y=e.createTexture();return e.bindTexture(l,y),e.texParameteri(l,g,o||s),e.texParameteri(l,f,o||s),e.texParameteri(l,m,u),e.texParameteri(l,_,u),r?e.texImage2D(l,0,c,c,d,r):e.texImage2D(l,0,c,t,i,0,c,d,null),y;}getCachedTexture(e,t,i){let{textureCache:r}=this;if(r[e])return r[e];{let o=this.createTexture(this.gl,t.width,t.height,t,i);return o&&(r[e]=o),o;}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e]);}copyGLTo2D(e,t){let i=e.canvas,r=t.targetCanvas,o=r.getContext("2d");if(!o)return;o.translate(0,r.height),o.scale(1,-1);let s=i.height-r.height;o.drawImage(i,0,s,r.width,r.height,0,0,r.width,r.height);}copyGLTo2DPutImageData(e,t){let i=t.targetCanvas.getContext("2d"),r=t.destinationWidth,o=t.destinationHeight,s=r*o*4;if(!i)return;let l=new Uint8Array(this.imageBuffer,0,s),c=new Uint8ClampedArray(this.imageBuffer,0,s);e.readPixels(0,0,r,o,e.RGBA,e.UNSIGNED_BYTE,l);let d=new ImageData(c,r,o);i.putImageData(d,0,0);}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;let e=this.gl,t={renderer:"",vendor:""};if(!e)return t;let i=e.getExtension("WEBGL_debug_renderer_info");if(i){let r=e.getParameter(i.UNMASKED_RENDERER_WEBGL),o=e.getParameter(i.UNMASKED_VENDOR_WEBGL);r&&(t.renderer=r.toLowerCase()),o&&(t.vendor=o.toLowerCase());}return this.gpuInfo=t,t;}},Wg;function XF(){let{WebGLProbe:n}=ar();return n.queryWebGL(lr()),Ze.enableGLFiltering&&n.isSupported(Ze.textureSize)?new Qd({tileSize:Ze.textureSize}):new Tm();}function Gg(){return!Wg&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Wg=XF()),Wg;}var Fx=["cropX","cropY"],qn=class n extends qt{static getDefaults(){return D(D({},super.getDefaults()),n.ownDefaults);}constructor(e,t){super(),W(this,"_lastScaleX",1),W(this,"_lastScaleY",1),W(this,"_filterScalingX",1),W(this,"_filterScalingY",1),this.filters=[],Object.assign(this,n.ownDefaults),this.setOptions(t),this.cacheKey=`texture${go()}`,this.setElement(typeof e=="string"?(this.canvas&&Ei(this.canvas.getElement())||Ma()).getElementById(e):e,t);}getElement(){return this._element;}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._element=e,this._originalElement=e,this._setWidthHeight(t),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters();}removeTexture(e){let t=Gg(!1);t instanceof Qd&&t.evictCachesForKey(e);}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{let t=this[e];t&&ar().dispose(t),this[e]=void 0;});}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null);}getOriginalSize(){let e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0};}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;let t=this.width/2,i=this.height/2;e.beginPath(),e.moveTo(-t,-i),e.lineTo(t,-i),e.lineTo(t,i),e.lineTo(-t,i),e.lineTo(-t,-i),e.closePath();}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=[];return this.filters.forEach(i=>{i&&t.push(i.toObject());}),D(se(D({},super.toObject([...Fx,...e])),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t}),this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{});}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height;}_toSVG(){let e=[],t=this._element,i=-this.width/2,r=-this.height/2,o=[],s=[],l="",c="";if(!t)return[];if(this.hasCrop()){let d=go();o.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+i+'" y="'+r+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+d+')" ';}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",`xlink:href="${this.getSvgSrc(!0)}" x="${i-this.cropX}" y="${r-this.cropY}" width="${t.width||t.naturalWidth}" height="${t.height||t.naturalHeight}"${c}${l}></image>
`),this.stroke||this.strokeDashArray){let d=this.fill;this.fill=null,s=[`	<rect x="${i}" y="${r}" width="${this.width}" height="${this.height}" style="${this.getSvgStyles()}" />
`],this.fill=d;}return o=this.paintFirst!==Gt?o.concat(s,e):o.concat(e,s),o;}getSrc(e){let t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||"";}getSvgSrc(e){return this.getSrc(e);}setSrc(e){let{crossOrigin:t,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Nl(e,{crossOrigin:t,signal:i}).then(r=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(r);});}toString(){return`#<Image: { src: "${this.getSrc()}" }>`;}applyResizeFilters(){let e=this.resizeFilter,t=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),r=i.x,o=i.y,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||r>t&&o>t)return this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=o);let l=Jn(s),{width:c,height:d}=s;this._element=l,this._lastScaleX=e.scaleX=r,this._lastScaleY=e.scaleY=o,Gg().applyFilters([e],s,c,d,this._element),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height;}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(o=>o&&!o.isNeutralState()),this.set("dirty",!0),this.removeTexture(`${this.cacheKey}_filtered`),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);let t=this._originalElement,i=t.naturalWidth||t.width,r=t.naturalHeight||t.height;if(this._element===this._originalElement){let o=Jn({width:i,height:r});this._element=o,this._filteredEl=o;}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,r),this._lastScaleX=1,this._lastScaleY=1);Gg().applyFilters(e,this._originalElement,i,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height);}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e);}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e);}shouldCache(){return this.needsItsOwnCache();}_renderFill(e){let t=this._element;if(!t)return;let i=this._filterScalingX,r=this._filterScalingY,o=this.width,s=this.height,l=Math.max(this.cropX,0),c=Math.max(this.cropY,0),d=t.naturalWidth||t.width,u=t.naturalHeight||t.height,g=l*i,f=c*r,m=Math.min(o*i,d-g),_=Math.min(s*r,u-f),y=-o/2,E=-s/2,C=Math.min(o,d/i-l),b=Math.min(s,u/r-c);t&&e.drawImage(t,g,f,m,_,y,E,C,b);}_needsResize(){let e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY;}_resetWidthHeight(){this.set(this.getOriginalSize());}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=this.getOriginalSize();this.width=e||i.width,this.height=t||i.height;}parsePreserveAspectRatioAttribute(){let e=Gm(this.preserveAspectRatio||""),t=this.width,i=this.height,r={width:t,height:i},o,s=this._element.width,l=this._element.height,c=1,d=1,u=0,g=0,f=0,m=0;return!e||e.alignX===xn&&e.alignY===xn?(c=t/s,d=i/l):(e.meetOrSlice==="meet"&&(c=d=hx(this._element,r),o=(t-s*c)/2,e.alignX==="Min"&&(u=-o),e.alignX==="Max"&&(u=o),o=(i-l*d)/2,e.alignY==="Min"&&(g=-o),e.alignY==="Max"&&(g=o)),e.meetOrSlice==="slice"&&(c=d=dx(this._element,r),o=s-t/c,e.alignX==="Mid"&&(f=o/2),e.alignX==="Max"&&(f=o),o=l-i/d,e.alignY==="Mid"&&(m=o/2),e.alignY==="Max"&&(m=o),s=t/c,l=i/d)),{width:s,height:l,scaleX:c,scaleY:d,offsetLeft:u,offsetTop:g,cropX:f,cropY:m};}static fromObject(e,t){let d=e,{filters:i,resizeFilter:r,src:o,crossOrigin:s,type:l}=d,c=lt(d,["filters","resizeFilter","src","crossOrigin","type"]);return Promise.all([Nl(o,se(D({},t),{crossOrigin:s})),i&&Ca(i,t),r?Ca([r],t):[],ql(c,t)]).then(u=>{let[g,f=[],[m],_={}]=u;return new this(g,D(se(D({},c),{src:o,filters:f,resizeFilter:m}),_));});}static fromURL(e){let{crossOrigin:t=null,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return Nl(e,{crossOrigin:t,signal:i}).then(o=>new this(o,r));}static fromElement(t){return J(this,arguments,function*(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,o=zr(e,this.ATTRIBUTE_NAMES,r);return this.fromURL(o["xlink:href"]||o.href,i,o).catch(s=>(Lr("log","Unable to parse Image",s),null));});}};function Yg(n){if(!XA.test(n.nodeName))return{};let e=n.getAttribute("viewBox"),t,i,r=1,o=1,s=0,l=0,c=n.getAttribute("width"),d=n.getAttribute("height"),u=n.getAttribute("x")||0,g=n.getAttribute("y")||0,f=!(e&&GC.test(e)),m=!c||!d||c==="100%"||d==="100%",_="",y=0,E=0;if(f&&(u||g)&&n.parentNode&&n.parentNode.nodeName!=="#document"&&(_=" translate("+yn(u||"0")+" "+yn(g||"0")+") ",t=(n.getAttribute("transform")||"")+_,n.setAttribute("transform",t),n.removeAttribute("x"),n.removeAttribute("y")),f&&m)return{width:0,height:0};let C={width:0,height:0};if(f)return C.width=yn(c),C.height=yn(d),C;let b=e.match(GC);s=-parseFloat(b[1]),l=-parseFloat(b[2]);let x=parseFloat(b[3]),w=parseFloat(b[4]);C.minX=s,C.minY=l,C.viewBoxWidth=x,C.viewBoxHeight=w,m?(C.width=x,C.height=w):(C.width=yn(c),C.height=yn(d),r=C.width/x,o=C.height/w);let T=Gm(n.getAttribute("preserveAspectRatio")||"");if(T.alignX!==xn&&(T.meetOrSlice==="meet"&&(o=r=r>o?o:r),T.meetOrSlice==="slice"&&(o=r=r>o?r:o),y=C.width-x*r,E=C.height-w*r,T.alignX==="Mid"&&(y/=2),T.alignY==="Mid"&&(E/=2),T.alignX==="Min"&&(y=0),T.alignY==="Min"&&(E=0)),r===1&&o===1&&s===0&&l===0&&u===0&&g===0)return C;if((u||g)&&n.parentNode.nodeName!=="#document"&&(_=" translate("+yn(u||"0")+" "+yn(g||"0")+") "),t=_+" matrix("+r+" 0 0 "+o+" "+(s*r+y)+" "+(l*o+E)+") ",n.nodeName==="svg"){for(i=n.ownerDocument.createElementNS(rm,"g");n.firstChild;)i.appendChild(n.firstChild);n.appendChild(i);}else i=n,i.removeAttribute("x"),i.removeAttribute("y"),t=i.getAttribute("transform")+t;return i.setAttribute("transform",t),C;}W(qn,"type","Image"),W(qn,"cacheProperties",[...Br,...Fx]),W(qn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),W(qn,"ATTRIBUTE_NAMES",[..._o,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),Ce.setClass(qn),Ce.setSVGClass(qn);var eu=n=>n.tagName.replace("svg:",""),qF=lu(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);function Rx(n,e){let t,i,r,o,s=[];for(r=0,o=e.length;r<o;r++)t=e[r],i=n.getElementsByTagNameNS("http://www.w3.org/2000/svg",t),s=s.concat(Array.from(i));return s;}var ZF=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],Xg="xlink:href";function Lx(n,e){var t;let i=((t=e.getAttribute(Xg))===null||t===void 0?void 0:t.slice(1))||"",r=n.getElementById(i);if(r&&r.getAttribute(Xg)&&Lx(n,r),r&&(ZF.forEach(o=>{let s=r.getAttribute(o);!e.hasAttribute(o)&&s&&e.setAttribute(o,s);}),!e.children.length)){let o=r.cloneNode(!0);for(;o.firstChild;)e.appendChild(o.firstChild);}e.removeAttribute(Xg);}var KF=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],ab=n=>Ce.getSVGClass(eu(n).toLowerCase()),km=class{constructor(e,t,i,r,o){this.elements=e,this.options=t,this.reviver=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=r,this.clipPaths=o,this.gradientDefs=function(s){let l=Rx(s,KF),c={},d=l.length;for(;d--;){let u=l[d];u.getAttribute("xlink:href")&&Lx(s,u);let g=u.getAttribute("id");g&&(c[g]=u);}return c;}(r),this.cssRules=function(s){let l=s.getElementsByTagName("style"),c={};for(let d=0;d<l.length;d++){let u=(l[d].textContent||"").replace(/\/\*[\s\S]*?\*\//g,"");u.trim()!==""&&u.split("}").filter((g,f,m)=>m.length>1&&g.trim()).forEach(g=>{if((g.match(/{/g)||[]).length>1&&g.trim().startsWith("@"))return;let f=g.split("{"),m={},_=f[1].trim().split(";").filter(function(y){return y.trim();});for(let y=0;y<_.length;y++){let E=_[y].split(":"),C=E[0].trim(),b=E[1].trim();m[C]=b;}(g=f[0].trim()).split(",").forEach(y=>{(y=y.replace(/^svg/i,"").trim())!==""&&(c[y]=D(D({},c[y]||{}),m));});});}return c;}(r);}parse(){return Promise.all(this.elements.map(e=>this.createObject(e)));}createObject(e){return J(this,null,function*(){let t=ab(e);if(t){let i=yield t.fromElement(e,this.options,this.cssRules);return this.resolveGradient(i,e,Gt),this.resolveGradient(i,e,Ln),i instanceof qn&&i._originalElement?wd(i,i.parsePreserveAspectRatioAttribute()):wd(i),yield this.resolveClipPath(i,e),this.reviver&&this.reviver(e,i),i;}return null;});}extractPropertyDefinition(e,t,i){let r=e[t],o=this.regexUrl;if(!o.test(r))return;o.lastIndex=0;let s=o.exec(r)[1];return o.lastIndex=0,i[s];}resolveGradient(e,t,i){let r=this.extractPropertyDefinition(e,i,this.gradientDefs);if(r){let o=t.getAttribute(i+"-opacity"),s=ns.fromElement(r,e,se(D({},this.options),{opacity:o}));e.set(i,s);}}resolveClipPath(e,t,i){return J(this,null,function*(){let r=this.extractPropertyDefinition(e,"clipPath",this.clipPaths);if(r){let o=Fn(e.calcTransformMatrix()),s=r[0].parentElement,l=t;for(;!i&&l.parentElement&&l.getAttribute("clip-path")!==e.clipPath;)l=l.parentElement;l.parentElement.appendChild(s);let c=Ud(`${l.getAttribute("transform")||""} ${s.getAttribute("originalTransform")||""}`);s.setAttribute("transform",`matrix(${c.join(",")})`);let d=yield Promise.all(r.map(b=>ab(b).fromElement(b,this.options,this.cssRules).then(x=>(wd(x),x.fillRule=x.clipRule,delete x.clipRule,x)))),u=d.length===1?d[0]:new Rr(d),g=St(o,u.calcTransformMatrix());u.clipPath&&(yield this.resolveClipPath(u,l,s.getAttribute("clip-path")?l:void 0));let{scaleX:f,scaleY:m,angle:_,skewX:y,translateX:E,translateY:C}=ys(g);u.set({flipX:!1,flipY:!1}),u.set({scaleX:f,scaleY:m,angle:_,skewX:y,skewY:0}),u.setPositionByOrigin(new ne(E,C),De,De),e.clipPath=u;}else delete e.clipPath;});}},lb=n=>YA.test(eu(n));function JF(t,i){return J(this,arguments,function*(n,e){let{crossOrigin:r,signal:o}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(o&&o.aborted)return Lr("log",new Sd("parseSVGDocument")),{objects:[],elements:[],options:{},allElements:[]};let s=n.documentElement;(function(f){let m=Rx(f,["use","svg:use"]),_=["x","y","xlink:href","href","transform"];for(let y of m){let E=y.attributes,C={};for(let ae of E)ae.value&&(C[ae.name]=ae.value);let b=(C["xlink:href"]||C.href||"").slice(1);if(b==="")return;let x=f.getElementById(b);if(x===null)return;let w=x.cloneNode(!0),T=w.attributes,R={};for(let ae of T)ae.value&&(R[ae.name]=ae.value);let{x:V=0,y:B=0,transform:Y=""}=C,le=`${Y} ${R.transform||""} translate(${V}, ${B})`;if(Yg(w),/^svg$/i.test(w.nodeName)){let ae=w.ownerDocument.createElementNS(rm,"g");Object.entries(R).forEach(ee=>{let[ce,oe]=ee;return ae.setAttributeNS(rm,ce,oe);}),ae.append(...w.childNodes),w=ae;}for(let ae of E){if(!ae)continue;let{name:ee,value:ce}=ae;if(!_.includes(ee))if(ee==="style"){let oe={};pm(ce,oe),Object.entries(R).forEach(A=>{let[z,O]=A;oe[z]=O;}),pm(R.style||"",oe);let re=Object.entries(oe).map(A=>A.join(":")).join(";");w.setAttribute(ee,re);}else!R[ee]&&w.setAttribute(ee,ce);}w.setAttribute("transform",le),w.setAttribute("instantiated_by_use","1"),w.removeAttribute("id"),y.parentNode.replaceChild(w,y);}})(n);let l=Array.from(s.getElementsByTagName("*")),c=se(D({},Yg(s)),{crossOrigin:r,signal:o}),d=l.filter(f=>(Yg(f),lb(f)&&!function(m){let _=m;for(;_&&(_=_.parentElement);)if(_&&_.nodeName&&qF.test(eu(_))&&!_.getAttribute("instantiated_by_use"))return!0;return!1;}(f)));if(!d||d&&!d.length)return{objects:[],elements:[],options:{},allElements:[],options:c,allElements:l};let u={};return l.filter(f=>eu(f)==="clipPath").forEach(f=>{f.setAttribute("originalTransform",f.getAttribute("transform")||"");let m=f.getAttribute("id");u[m]=Array.from(f.getElementsByTagName("*")).filter(_=>lb(_));}),{objects:yield new km(d,c,e,n,u).parse(),elements:d,options:c,allElements:l};});}function QF(n,e,t){return JF(new(Yl().DOMParser)().parseFromString(n.trim(),"text/xml"),e,t);}function Dx(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return fetch(n.replace(/^\n\s*/,"").trim(),{signal:t.signal}).then(i=>{if(!i.ok)throw new Zn(`HTTP error! status: ${i.status}`);return i.text();}).then(i=>QF(i,e,t)).catch(()=>({objects:[],elements:[],options:{},allElements:[]}));}var uu=n=>n.webgl!==void 0;var n_="precision highp float",eR=`
    ${n_};
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`,tR=new RegExp(n_,"g"),kt=class{get type(){return this.constructor.type;}constructor(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{type:e}=i,t=lt(i,["type"]);Object.assign(this,this.constructor.defaults,t);}getFragmentSource(){return eR;}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`;}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource(),{WebGLProbe:{GLPrecision:r="highp"}}=ar();r!=="highp"&&(t=t.replace(tR,n_.replace("highp",r)));let o=e.createShader(e.VERTEX_SHADER),s=e.createShader(e.FRAGMENT_SHADER),l=e.createProgram();if(!o||!s||!l)throw new Zn("Vertex, fragment shader or program creation error");if(e.shaderSource(o,i),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Zn(`Vertex shader compile error for ${this.type}: ${e.getShaderInfoLog(o)}`);if(e.shaderSource(s,t),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Zn(`Fragment shader compile error for ${this.type}: ${e.getShaderInfoLog(s)}`);if(e.attachShader(l,o),e.attachShader(l,s),e.linkProgram(l),!e.getProgramParameter(l,e.LINK_STATUS))throw new Zn(`Shader link error for "${this.type}" ${e.getProgramInfoLog(l)}`);let c=this.getUniformLocations(e,l)||{};return c.uStepW=e.getUniformLocation(l,"uStepW"),c.uStepH=e.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:this.getAttributeLocations(e,l),uniformLocations:c};}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")};}getUniformLocations(e,t){let i=this.constructor.uniformLocations,r={};for(let o=0;o<i.length;o++)r[i[o]]=e.getUniformLocation(t,i[o]);return r;}sendAttributeData(e,t,i){let r=t.aPosition,o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);}_setupFrameBuffer(e){let t=e.context;if(e.passes>1){let i=e.destinationWidth,r=e.destinationHeight;e.sourceWidth===i&&e.sourceHeight===r||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,i,r)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0);}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish();}_swapTextures(e){e.passes--,e.pass++;let t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t;}isNeutralState(e){return!1;}applyTo(e){uu(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e);}applyTo2d(e){}getCacheKey(){return this.type;}retrieveShader(e){let t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t];}applyToWebGL(e){let t=e.context,i=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(i.program),this.sendAttributeData(t,i.attributeLocations,e.aPosition),t.uniform1f(i.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(i.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,i.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4);}bindAdditionalTexture(e,t,i){e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0);}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0);}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){let{sourceWidth:t,sourceHeight:i}=e,r=Jn({width:t,height:i});e.helpLayer=r;}}toObject(){let e=Object.keys(this.constructor.defaults||{});return D({type:this.type},e.reduce((t,i)=>(t[i]=this[i],t),{}));}toJSON(){return this.toObject();}static fromObject(e,t){return J(this,null,function*(){let o=e,{type:i}=o,r=lt(o,["type"]);return new this(r);});}};W(kt,"type","BaseFilter"),W(kt,"uniformLocations",[]);var nR={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `},is=class extends kt{getCacheKey(){return`${this.type}_${this.mode}`;}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          ${nR[this.mode]}
        }
      }
      `;}applyTo2d(e){let{imageData:{data:t}}=e,i=new Dn(this.color).getSource(),r=this.alpha,o=i[0]*r,s=i[1]*r,l=i[2]*r,c=1-r;for(let d=0;d<t.length;d+=4){let u=t[d],g=t[d+1],f=t[d+2],m,_,y;switch(this.mode){case"multiply":m=u*o/255,_=g*s/255,y=f*l/255;break;case"screen":m=255-(255-u)*(255-o)/255,_=255-(255-g)*(255-s)/255,y=255-(255-f)*(255-l)/255;break;case"add":m=u+o,_=g+s,y=f+l;break;case"difference":m=Math.abs(u-o),_=Math.abs(g-s),y=Math.abs(f-l);break;case"subtract":m=u-o,_=g-s,y=f-l;break;case"darken":m=Math.min(u,o),_=Math.min(g,s),y=Math.min(f,l);break;case"lighten":m=Math.max(u,o),_=Math.max(g,s),y=Math.max(f,l);break;case"overlay":m=o<128?2*u*o/255:255-2*(255-u)*(255-o)/255,_=s<128?2*g*s/255:255-2*(255-g)*(255-s)/255,y=l<128?2*f*l/255:255-2*(255-f)*(255-l)/255;break;case"exclusion":m=o+u-2*o*u/255,_=s+g-2*s*g/255,y=l+f-2*l*f/255;break;case"tint":m=o+u*c,_=s+g*c,y=l+f*c;}t[d]=m,t[d+1]=_,t[d+2]=y;}}sendUniformData(e,t){let i=new Dn(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,e.uniform4fv(t.uColor,i);}};W(is,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),W(is,"type","BlendColor"),W(is,"uniformLocations",["uColor"]),Ce.setClass(is);var iR={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},rs=class extends kt{getCacheKey(){return`${this.type}_${this.mode}`;}getFragmentSource(){return iR[this.mode];}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `;}applyToWebGL(e){let t=e.context,i=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,i,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1);}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement());}calculateMatrix(){let e=this.image,{width:t,height:i}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/i,1];}applyTo2d(e){let{imageData:{data:t,width:i,height:r},filterBackend:{resources:o}}=e,s=this.image;o.blendImage||(o.blendImage=lr());let l=o.blendImage,c=l.getContext("2d");l.width!==i||l.height!==r?(l.width=i,l.height=r):c.clearRect(0,0,i,r),c.setTransform(s.scaleX,0,0,s.scaleY,s.left,s.top),c.drawImage(s.getElement(),0,0,i,r);let d=c.getImageData(0,0,i,r).data;for(let u=0;u<t.length;u+=4){let g=t[u],f=t[u+1],m=t[u+2],_=t[u+3],y=d[u],E=d[u+1],C=d[u+2],b=d[u+3];switch(this.mode){case"multiply":t[u]=g*y/255,t[u+1]=f*E/255,t[u+2]=m*C/255,t[u+3]=_*b/255;break;case"mask":t[u+3]=b;}}}sendUniformData(e,t){let i=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,i);}toObject(){return se(D({},super.toObject()),{image:this.image&&this.image.toObject()});}static fromObject(e,t){return J(this,null,function*(){let s=e,{type:i,image:r}=s,o=lt(s,["type","image"]);return qn.fromObject(r,t).then(l=>new this(se(D({},o),{image:l})));});}};W(rs,"type","BlendImage"),W(rs,"defaults",{mode:"multiply",alpha:1}),W(rs,"uniformLocations",["uTransformMatrix","uImage"]),Ce.setClass(rs);var os=class extends kt{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `;}applyTo(e){uu(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e);}applyTo2d(e){let{imageData:{data:t,width:i,height:r}}=e;this.aspectRatio=i/r,this.horizontal=!0;let o=this.getBlurValue()*i,s=new Uint8ClampedArray(t),l=15,c=4*i;for(let d=0;d<t.length;d+=4){let u=0,g=0,f=0,m=0,_=0,y=d-d%c,E=y+c;for(let C=-14;C<l;C++){let b=C/l,x=4*Math.floor(o*b),w=1-Math.abs(b),T=d+x;T<y?T=y:T>E&&(T=E);let R=t[T+3]*w;u+=t[T]*R,g+=t[T+1]*R,f+=t[T+2]*R,m+=R,_+=w;}s[d]=u/m,s[d+1]=g/m,s[d+2]=f/m,s[d+3]=m/_;}this.horizontal=!1,o=this.getBlurValue()*r;for(let d=0;d<s.length;d+=4){let u=0,g=0,f=0,m=0,_=0,y=d%c,E=s.length-c+y;for(let C=-14;C<l;C++){let b=C/l,x=Math.floor(o*b)*c,w=1-Math.abs(b),T=d+x;T<y?T=y:T>E&&(T=E);let R=s[T+3]*w;u+=s[T]*R,g+=s[T+1]*R,f+=s[T+2]*R,m+=R,_+=w;}t[d]=u/m,t[d+1]=g/m,t[d+2]=f/m,t[d+3]=m/_;}}sendUniformData(e,t){let i=this.chooseRightDelta();e.uniform2fv(t.uDelta,i);}isNeutralState(){return this.blur===0;}getBlurValue(){let e=1,{horizontal:t,aspectRatio:i}=this;return t?i>1&&(e=1/i):i<1&&(e=i),e*this.blur*.12;}chooseRightDelta(){let e=this.getBlurValue();return this.horizontal?[e,0]:[0,e];}};W(os,"type","Blur"),W(os,"defaults",{blur:0}),W(os,"uniformLocations",["uDelta"]),Ce.setClass(os);var ss=class extends kt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`;}applyTo2d(e){let{imageData:{data:t}}=e,i=Math.round(255*this.brightness);for(let r=0;r<t.length;r+=4)t[r]+=i,t[r+1]+=i,t[r+2]+=i;}isNeutralState(){return this.brightness===0;}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness);}};W(ss,"type","Brightness"),W(ss,"defaults",{brightness:0}),W(ss,"uniformLocations",["uBrightness"]),Ce.setClass(ss);var Nx={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0},Fr=class extends kt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`;}applyTo2d(e){let t=e.imageData.data,i=this.matrix,r=this.colorsOnly;for(let o=0;o<t.length;o+=4){let s=t[o],l=t[o+1],c=t[o+2];if(t[o]=s*i[0]+l*i[1]+c*i[2]+255*i[4],t[o+1]=s*i[5]+l*i[6]+c*i[7]+255*i[9],t[o+2]=s*i[10]+l*i[11]+c*i[12]+255*i[14],!r){let d=t[o+3];t[o]+=d*i[3],t[o+1]+=d*i[8],t[o+2]+=d*i[13],t[o+3]=s*i[15]+l*i[16]+c*i[17]+d*i[18]+255*i[19];}}}sendUniformData(e,t){let i=this.matrix,r=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],o=[i[4],i[9],i[14],i[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,r),e.uniform4fv(t.uConstants,o);}toObject(){return se(D({},super.toObject()),{matrix:[...this.matrix]});}};function Ms(n,e){var t;let i=(W(t=class extends Fr{toObject(){return{type:this.type,colorsOnly:this.colorsOnly};}},"type",n),W(t,"defaults",{colorsOnly:!1,matrix:e}),t);return Ce.setClass(i,n),i;}W(Fr,"type","ColorMatrix"),W(Fr,"defaults",Nx),W(Fr,"uniformLocations",["uColorMatrix","uConstants"]),Ce.setClass(Fr);var rR=Ms("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),oR=Ms("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),sR=Ms("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),aR=Ms("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),lR=Ms("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),cR=Ms("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),hR=Ms("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]),Gl=class extends kt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[];}applyTo(e){uu(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e);});}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())};}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState());}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(i=>Ce.getClass(i.type).fromObject(i,t))).then(i=>new this({subFilters:i}));}};W(Gl,"type","Composed"),Ce.setClass(Gl);var as=class extends kt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`;}isNeutralState(){return this.contrast===0;}applyTo2d(e){let{imageData:{data:t}}=e,i=Math.floor(255*this.contrast),r=259*(i+255)/(255*(259-i));for(let o=0;o<t.length;o+=4)t[o]=r*(t[o]-128)+128,t[o+1]=r*(t[o+1]-128)+128,t[o+2]=r*(t[o+2]-128)+128;}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast);}};W(as,"type","Contrast"),W(as,"defaults",{contrast:0}),W(as,"uniformLocations",["uContrast"]),Ce.setClass(as);var dR={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `},ls=class extends kt{getCacheKey(){return`${this.type}_${Math.sqrt(this.matrix.length)}_${this.opaque?1:0}`;}getFragmentSource(){return dR[this.getCacheKey()];}applyTo2d(e){let t=e.imageData,i=t.data,r=this.matrix,o=Math.round(Math.sqrt(r.length)),s=Math.floor(o/2),l=t.width,c=t.height,d=e.ctx.createImageData(l,c),u=d.data,g=this.opaque?1:0,f,m,_,y,E,C,b,x,w,T,R,V,B;for(R=0;R<c;R++)for(T=0;T<l;T++){for(E=4*(R*l+T),f=0,m=0,_=0,y=0,B=0;B<o;B++)for(V=0;V<o;V++)b=R+B-s,C=T+V-s,b<0||b>=c||C<0||C>=l||(x=4*(b*l+C),w=r[B*o+V],f+=i[x]*w,m+=i[x+1]*w,_+=i[x+2]*w,g||(y+=i[x+3]*w));u[E]=f,u[E+1]=m,u[E+2]=_,u[E+3]=g?i[E+3]:y;}e.imageData=d;}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix);}toObject(){return se(D({},super.toObject()),{opaque:this.opaque,matrix:[...this.matrix]});}};W(ls,"type","Convolute"),W(ls,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),W(ls,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),Ce.setClass(ls);var Bx="Gamma",cs=class extends kt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`;}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat();}applyTo2d(e){let{imageData:{data:t}}=e,i=this.gamma,r=1/i[0],o=1/i[1],s=1/i[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});let l=this.rgbValues;for(let c=0;c<256;c++)l.r[c]=255*Math.pow(c/255,r),l.g[c]=255*Math.pow(c/255,o),l.b[c]=255*Math.pow(c/255,s);for(let c=0;c<t.length;c+=4)t[c]=l.r[t[c]],t[c+1]=l.g[t[c+1]],t[c+2]=l.b[t[c+2]];}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma);}isNeutralState(){let{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1;}toObject(){return{type:Bx,gamma:this.gamma.concat()};}};W(cs,"type",Bx),W(cs,"defaults",{gamma:[1,1,1]}),W(cs,"uniformLocations",["uGamma"]),Ce.setClass(cs);var uR={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `},hs=class extends kt{applyTo2d(e){let{imageData:{data:t}}=e;for(let i,r=0;r<t.length;r+=4){let o=t[r],s=t[r+1],l=t[r+2];switch(this.mode){case"average":i=(o+s+l)/3;break;case"lightness":i=(Math.min(o,s,l)+Math.max(o,s,l))/2;break;case"luminosity":i=.21*o+.72*s+.07*l;}t[r+2]=t[r+1]=t[r]=i;}}getCacheKey(){return`${this.type}_${this.mode}`;}getFragmentSource(){return uR[this.mode];}sendUniformData(e,t){e.uniform1i(t.uMode,1);}isNeutralState(){return!1;}};W(hs,"type","Grayscale"),W(hs,"defaults",{mode:"average"}),W(hs,"uniformLocations",["uMode"]),Ce.setClass(hs);var pR=se(D({},Nx),{rotation:0}),va=class extends Fr{calculateMatrix(){let e=this.rotation*Math.PI,t=Ii(e),i=Ai(e),r=1/3,o=Math.sqrt(r)*i,s=1-t;this.matrix=[t+s/3,r*s-o,r*s+o,0,0,r*s+o,t+r*s,r*s-o,0,0,r*s-o,r*s+o,t+r*s,0,0,0,0,0,1,0];}isNeutralState(){return this.rotation===0;}applyTo(e){this.calculateMatrix(),super.applyTo(e);}toObject(){return{type:this.type,rotation:this.rotation};}};W(va,"type","HueRotation"),W(va,"defaults",pR),Ce.setClass(va);var ds=class extends kt{applyTo2d(e){let{imageData:{data:t}}=e;for(let i=0;i<t.length;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2],this.alpha&&(t[i+3]=255-t[i+3]);}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`;}isNeutralState(){return!this.invert;}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha));}};W(ds,"type","Invert"),W(ds,"defaults",{alpha:!1,invert:!0}),W(ds,"uniformLocations",["uInvert","uAlpha"]),Ce.setClass(ds);var us=class extends kt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`;}applyTo2d(e){let{imageData:{data:t}}=e,i=this.noise;for(let r=0;r<t.length;r+=4){let o=(.5-Math.random())*i;t[r]+=o,t[r+1]+=o,t[r+2]+=o;}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random());}isNeutralState(){return this.noise===0;}};W(us,"type","Noise"),W(us,"defaults",{noise:0}),W(us,"uniformLocations",["uNoise","uSeed"]),Ce.setClass(us);var ps=class extends kt{applyTo2d(e){let{imageData:{data:t,width:i,height:r}}=e;for(let o=0;o<r;o+=this.blocksize)for(let s=0;s<i;s+=this.blocksize){let l=4*o*i+4*s,c=t[l],d=t[l+1],u=t[l+2],g=t[l+3];for(let f=o;f<Math.min(o+this.blocksize,r);f++)for(let m=s;m<Math.min(s+this.blocksize,i);m++){let _=4*f*i+4*m;t[_]=c,t[_+1]=d,t[_+2]=u,t[_+3]=g;}}}isNeutralState(){return this.blocksize===1;}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`;}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize);}};W(ps,"type","Pixelate"),W(ps,"defaults",{blocksize:4}),W(ps,"uniformLocations",["uBlocksize"]),Ce.setClass(ps);var fs=class extends kt{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`;}applyTo2d(e){let{imageData:{data:t}}=e,i=255*this.distance,r=new Dn(this.color).getSource(),o=[r[0]-i,r[1]-i,r[2]-i],s=[r[0]+i,r[1]+i,r[2]+i];for(let l=0;l<t.length;l+=4){let c=t[l],d=t[l+1],u=t[l+2];c>o[0]&&d>o[1]&&u>o[2]&&c<s[0]&&d<s[1]&&u<s[2]&&(t[l+3]=0);}}sendUniformData(e,t){let i=new Dn(this.color).getSource(),r=this.distance,o=[0+i[0]/255-r,0+i[1]/255-r,0+i[2]/255-r,1],s=[i[0]/255+r,i[1]/255+r,i[2]/255+r,1];e.uniform4fv(t.uLow,o),e.uniform4fv(t.uHigh,s);}};W(fs,"type","RemoveColor"),W(fs,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),W(fs,"uniformLocations",["uLow","uHigh"]),Ce.setClass(fs);var gs=class extends kt{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps);}getFilterWindow(){let e=this.tempScale;return Math.ceil(this.lanczosLobes/e);}getCacheKey(){let e=this.getFilterWindow();return`${this.type}_${e}`;}getFragmentSource(){let e=this.getFilterWindow();return this.generateShader(e);}getTaps(){let e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,i=this.getFilterWindow(),r=new Array(i);for(let o=1;o<=i;o++)r[o-1]=e(o*t);return r;}generateShader(e){let t=new Array(e);for(let i=1;i<=e;i++)t[i-1]=`${i}.0 * uDelta`;return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[${e}];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        ${t.map((i,r)=>`
              color += texture2D(uTexture, vTexCoord + ${i}) * uTaps[${r}] + texture2D(uTexture, vTexCoord - ${i}) * uTaps[${r}];
              sum += 2.0 * uTaps[${r}];
            `).join(`
`)}
        gl_FragColor = color / sum;
      }
    `;}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight;}applyTo(e){uu(e)?this.applyToForWebgl(e):this.applyTo2d(e);}isNeutralState(){return this.scaleX===1&&this.scaleY===1;}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;let i=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(i)/i;};}applyTo2d(e){let t=e.imageData,i=this.scaleX,r=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/r;let o=t.width,s=t.height,l=Math.round(o*i),c=Math.round(s*r),d;d=this.resizeType==="sliceHack"?this.sliceByTwo(e,o,s,l,c):this.resizeType==="hermite"?this.hermiteFastResize(e,o,s,l,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,o,s,l,c):this.resizeType==="lanczos"?this.lanczosResize(e,o,s,l,c):new ImageData(l,c),e.imageData=d;}sliceByTwo(e,t,i,r,o){let s=e.imageData,l=.5,c=!1,d=!1,u=t*l,g=i*l,f=e.filterBackend.resources,m=0,_=0,y=t,E=0;f.sliceByTwo||(f.sliceByTwo=lr());let C=f.sliceByTwo;(C.width<1.5*t||C.height<i)&&(C.width=1.5*t,C.height=i);let b=C.getContext("2d");for(b.clearRect(0,0,1.5*t,i),b.putImageData(s,0,0),r=Math.floor(r),o=Math.floor(o);!c||!d;)t=u,i=g,r<Math.floor(u*l)?u=Math.floor(u*l):(u=r,c=!0),o<Math.floor(g*l)?g=Math.floor(g*l):(g=o,d=!0),b.drawImage(C,m,_,t,i,y,E,u,g),m=y,_=E,E+=g;return b.getImageData(m,_,r,o);}lanczosResize(e,t,i,r,o){let s=e.imageData.data,l=e.ctx.createImageData(r,o),c=l.data,d=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,g=this.rcpScaleY,f=2/this.rcpScaleX,m=2/this.rcpScaleY,_=Math.ceil(u*this.lanczosLobes/2),y=Math.ceil(g*this.lanczosLobes/2),E={},C={x:0,y:0},b={x:0,y:0};return function x(w){let T,R,V,B,Y,le,ae,ee,ce,oe,re;for(C.x=(w+.5)*u,b.x=Math.floor(C.x),T=0;T<o;T++){for(C.y=(T+.5)*g,b.y=Math.floor(C.y),Y=0,le=0,ae=0,ee=0,ce=0,R=b.x-_;R<=b.x+_;R++)if(!(R<0||R>=t)){oe=Math.floor(1e3*Math.abs(R-C.x)),E[oe]||(E[oe]={});for(let A=b.y-y;A<=b.y+y;A++)A<0||A>=i||(re=Math.floor(1e3*Math.abs(A-C.y)),E[oe][re]||(E[oe][re]=d(Math.sqrt(Math.pow(oe*f,2)+Math.pow(re*m,2))/1e3)),V=E[oe][re],V>0&&(B=4*(A*t+R),Y+=V,le+=V*s[B],ae+=V*s[B+1],ee+=V*s[B+2],ce+=V*s[B+3]));}B=4*(T*r+w),c[B]=le/Y,c[B+1]=ae/Y,c[B+2]=ee/Y,c[B+3]=ce/Y;}return++w<r?x(w):l;}(0);}bilinearFiltering(e,t,i,r,o){let s,l,c,d,u,g,f,m,_,y,E,C,b,x=0,w=this.rcpScaleX,T=this.rcpScaleY,R=4*(t-1),V=e.imageData.data,B=e.ctx.createImageData(r,o),Y=B.data;for(f=0;f<o;f++)for(m=0;m<r;m++)for(u=Math.floor(w*m),g=Math.floor(T*f),_=w*m-u,y=T*f-g,b=4*(g*t+u),E=0;E<4;E++)s=V[b+E],l=V[b+4+E],c=V[b+R+E],d=V[b+R+4+E],C=s*(1-_)*(1-y)+l*_*(1-y)+c*y*(1-_)+d*_*y,Y[x++]=C;return B;}hermiteFastResize(e,t,i,r,o){let s=this.rcpScaleX,l=this.rcpScaleY,c=Math.ceil(s/2),d=Math.ceil(l/2),u=e.imageData.data,g=e.ctx.createImageData(r,o),f=g.data;for(let m=0;m<o;m++)for(let _=0;_<r;_++){let y=4*(_+m*r),E=0,C=0,b=0,x=0,w=0,T=0,R=0,V=(m+.5)*l;for(let B=Math.floor(m*l);B<(m+1)*l;B++){let Y=Math.abs(V-(B+.5))/d,le=(_+.5)*s,ae=Y*Y;for(let ee=Math.floor(_*s);ee<(_+1)*s;ee++){let ce=Math.abs(le-(ee+.5))/c,oe=Math.sqrt(ae+ce*ce);oe>1&&oe<-1||(E=2*oe*oe*oe-3*oe*oe+1,E>0&&(ce=4*(ee+B*t),R+=E*u[ce+3],b+=E,u[ce+3]<255&&(E=E*u[ce+3]/250),x+=E*u[ce],w+=E*u[ce+1],T+=E*u[ce+2],C+=E));}}f[y]=x/C,f[y+1]=w/C,f[y+2]=T/C,f[y+3]=R/b;}return g;}};W(gs,"type","Resize"),W(gs,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),W(gs,"uniformLocations",["uDelta","uTaps"]),Ce.setClass(gs);var ms=class extends kt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`;}applyTo2d(e){let{imageData:{data:t}}=e,i=-this.saturation;for(let r=0;r<t.length;r+=4){let o=t[r],s=t[r+1],l=t[r+2],c=Math.max(o,s,l);t[r]+=c!==o?(c-o)*i:0,t[r+1]+=c!==s?(c-s)*i:0,t[r+2]+=c!==l?(c-l)*i:0;}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation);}isNeutralState(){return this.saturation===0;}};W(ms,"type","Saturation"),W(ms,"defaults",{saturation:0}),W(ms,"uniformLocations",["uSaturation"]),Ce.setClass(ms);var _s=class extends kt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`;}applyTo2d(e){let{imageData:{data:t}}=e,i=-this.vibrance;for(let r=0;r<t.length;r+=4){let o=t[r],s=t[r+1],l=t[r+2],c=Math.max(o,s,l),d=(o+s+l)/3,u=2*Math.abs(c-d)/255*i;t[r]+=c!==o?(c-o)*u:0,t[r+1]+=c!==s?(c-s)*u:0,t[r+2]+=c!==l?(c-l)*u:0;}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance);}isNeutralState(){return this.vibrance===0;}};W(_s,"type","Vibrance"),W(_s,"defaults",{vibrance:0}),W(_s,"uniformLocations",["uVibrance"]),Ce.setClass(_s);var nH=Object.freeze({__proto__:null,BaseFilter:kt,BlackWhite:hR,BlendColor:is,BlendImage:rs,Blur:os,Brightness:ss,Brownie:rR,ColorMatrix:Fr,Composed:Gl,Contrast:as,Convolute:ls,Gamma:cs,Grayscale:hs,HueRotation:va,Invert:ds,Kodachrome:sR,Noise:us,Pixelate:ps,Polaroid:lR,RemoveColor:fs,Resize:gs,Saturation:ms,Sepia:cR,Technicolor:aR,Vibrance:_s,Vintage:oR});function Vx(n,e,t,i=r=>r){return n*i(.5-e*(.5-t));}function gR(n){return[-n[0],-n[1]];}function Ri(n,e){return[n[0]+e[0],n[1]+e[1]];}function ui(n,e){return[n[0]-e[0],n[1]-e[1]];}function Fi(n,e){return[n[0]*e,n[1]*e];}function mR(n,e){return[n[0]/e,n[1]/e];}function Kl(n){return[n[1],-n[0]];}function zx(n,e){return n[0]*e[0]+n[1]*e[1];}function _R(n,e){return n[0]===e[0]&&n[1]===e[1];}function vR(n){return Math.hypot(n[0],n[1]);}function yR(n){return n[0]*n[0]+n[1]*n[1];}function jx(n,e){return yR(ui(n,e));}function Hx(n){return mR(n,vR(n));}function CR(n,e){return Math.hypot(n[1]-e[1],n[0]-e[0]);}function Jl(n,e,t){let i=Math.sin(t),r=Math.cos(t),o=n[0]-e[0],s=n[1]-e[1],l=o*r-s*i,c=o*i+s*r;return[l+e[0],c+e[1]];}function i_(n,e,t){return Ri(n,Fi(ui(e,n),t));}function $x(n,e,t){return Ri(n,Fi(e,t));}var{min:Ta,PI:bR}=Math,Ux=.275,Ql=bR+1e-4;function xR(n,e={}){let{size:t=16,smoothing:i=.5,thinning:r=.5,simulatePressure:o=!0,easing:s=z=>z,start:l={},end:c={},last:d=!1}=e,{cap:u=!0,easing:g=z=>z*(2-z)}=l,{cap:f=!0,easing:m=z=>--z*z*z+1}=c;if(n.length===0||t<=0)return[];let _=n[n.length-1].runningLength,y=l.taper===!1?0:l.taper===!0?Math.max(t,_):l.taper,E=c.taper===!1?0:c.taper===!0?Math.max(t,_):c.taper,C=Math.pow(t*i,2),b=[],x=[],w=n.slice(0,10).reduce((z,O)=>{let k=O.pressure;if(o){let H=Ta(1,O.distance/t),U=Ta(1,1-H);k=Ta(1,z+(U-z)*(H*Ux));}return(z+k)/2;},n[0].pressure),T=Vx(t,r,n[n.length-1].pressure,s),R,V=n[0].vector,B=n[0].point,Y=B,le=B,ae=Y,ee=!1;for(let z=0;z<n.length;z++){let{pressure:O}=n[z],{point:k,vector:H,distance:U,runningLength:pe}=n[z];if(z<n.length-1&&_-pe<3)continue;if(r){if(o){let We=Ta(1,U/t),_t=Ta(1,1-We);O=Ta(1,w+(_t-w)*(We*Ux));}T=Vx(t,r,O,s);}else T=t/2;R===void 0&&(R=T);let me=pe<y?g(pe/y):1,fe=_-pe<E?m((_-pe)/E):1;T=Math.max(.01,T*Math.min(me,fe));let Fe=(z<n.length-1?n[z+1]:n[z]).vector,Te=z<n.length-1?zx(H,Fe):1,qe=zx(H,V)<0&&!ee,bt=Te!==null&&Te<0;if(qe||bt){let We=Fi(Kl(V),T);for(let _t=1/13,Rt=0;Rt<=1;Rt+=_t)le=Jl(ui(k,We),k,Ql*Rt),b.push(le),ae=Jl(Ri(k,We),k,Ql*-Rt),x.push(ae);B=le,Y=ae,bt&&(ee=!0);continue;}if(ee=!1,z===n.length-1){let We=Fi(Kl(H),T);b.push(ui(k,We)),x.push(Ri(k,We));continue;}let It=Fi(Kl(i_(Fe,H,Te)),T);le=ui(k,It),(z<=1||jx(B,le)>C)&&(b.push(le),B=le),ae=Ri(k,It),(z<=1||jx(Y,ae)>C)&&(x.push(ae),Y=ae),w=O,V=H;}let ce=n[0].point.slice(0,2),oe=n.length>1?n[n.length-1].point.slice(0,2):Ri(n[0].point,[1,1]),re=[],A=[];if(n.length===1){if(!(y||E)||d){let z=$x(ce,Hx(Kl(ui(ce,oe))),-(R||T)),O=[];for(let k=1/13,H=k;H<=1;H+=k)O.push(Jl(z,ce,Ql*2*H));return O;}}else{if(!(y||E&&n.length===1))if(u)for(let O=1/13,k=O;k<=1;k+=O){let H=Jl(x[0],ce,Ql*k);re.push(H);}else{let O=ui(b[0],x[0]),k=Fi(O,.5),H=Fi(O,.51);re.push(ui(ce,k),ui(ce,H),Ri(ce,H),Ri(ce,k));}let z=Kl(gR(n[n.length-1].vector));if(E||y&&n.length===1)A.push(oe);else if(f){let O=$x(oe,z,T);for(let k=1/29,H=k;H<1;H+=k)A.push(Jl(O,oe,Ql*3*H));}else A.push(Ri(oe,Fi(z,T)),Ri(oe,Fi(z,T*.99)),ui(oe,Fi(z,T*.99)),ui(oe,Fi(z,T)));}return b.concat(A,x.reverse(),re);}function PR(n,e={}){var t;let{streamline:i=.5,size:r=16,last:o=!1}=e;if(n.length===0)return[];let s=.15+(1-i)*.85,l=Array.isArray(n[0])?n:n.map(({x:m,y:_,pressure:y=.5})=>[m,_,y]);if(l.length===2){let m=l[1];l=l.slice(0,-1);for(let _=1;_<5;_++)l.push(i_(l[0],m,_/4));}l.length===1&&(l=[...l,[...Ri(l[0],[1,1]),...l[0].slice(2)]]);let c=[{point:[l[0][0],l[0][1]],pressure:l[0][2]>=0?l[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],d=!1,u=0,g=c[0],f=l.length-1;for(let m=1;m<l.length;m++){let _=o&&m===f?l[m].slice(0,2):i_(g.point,l[m],s);if(_R(g.point,_))continue;let y=CR(_,g.point);if(u+=y,m<f&&!d){if(u<r)continue;d=!0;}g={point:_,pressure:l[m][2]>=0?l[m][2]:.5,vector:Hx(ui(g.point,_)),distance:y,runningLength:u},c.push(g);}return c[0].vector=((t=c[1])==null?void 0:t.vector)||[0,0],c;}function r_(n,e={}){return xR(PR(n,e),e);}var wR=["canvasEl"],MR=()=>["/prescan"],SR=(n,e)=>e.id;function ER(n,e){if(n&1){let t=ve();P(0,"div",20),Z("click",function(){let r=X(t).$index,o=j(2);return o.currentTemplateIndex.set(r),q(o.useCurrentTemplate());}),P(1,"div",21),te(2,"img",22),P(3,"div",23),N(4),S()()();}if(n&2){let t=e.$implicit,i=e.$index,r=j(2);Se("active",i===r.currentTemplateIndex())("expanding",r.isTemplateExpanding()&&i===r.currentTemplateIndex()),I(2),K("src",t.preview,Ue)("alt",t.name),I(2),Ve(t.name);}}function OR(n,e){if(n&1){let t=ve();P(0,"div",5),te(1,"div",6),P(2,"div",7)(3,"div",8)(4,"button",9),ke(),P(5,"svg",10),te(6,"path",11),S()(),Ye(),P(7,"h1",12),be(8,1),S(),te(9,"div",13),S(),P(10,"div",14)(11,"div",15),Z("touchstart",function(r){X(t);let o=j();return q(o.onCarouselTouchStart(r));})("touchmove",function(r){X(t);let o=j();return q(o.onCarouselTouchMove(r));})("touchend",function(){X(t);let r=j();return q(r.onCarouselTouchEnd());}),ze(12,ER,5,7,"div",16,SR),S()(),P(14,"div",17)(15,"button",18),Z("click",function(){X(t);let r=j();return q(r.previousTemplate());}),N(16,"\u2039"),S(),P(17,"button",19),Z("click",function(){X(t);let r=j();return q(r.nextTemplate());}),N(18,"\u203A"),S()()()();}if(n&2){let t=j();Se("transitioning",t.isTransitioning()),I(4),K("routerLink",yt(11,MR)),I(7),Et("transform",t.carouselTransform())("transition",t.carouselTransition()),Se("animating",t.isCarouselAnimating()),I(),je(t.templates()),I(3),K("disabled",t.isCarouselAnimating()),I(2),K("disabled",t.isCarouselAnimating());}}function TR(n,e){n&1&&(ke(),P(0,"svg",28),te(1,"line",53)(2,"line",54)(3,"line",55)(4,"line",56),S());}function kR(n,e){n&1&&(ke(),P(0,"svg",28),te(1,"line",53)(2,"line",57)(3,"line",58)(4,"line",59),S());}function IR(n,e){n&1&&(ke(),P(0,"svg",28),te(1,"line",53)(2,"line",60)(3,"line",61)(4,"line",62),S());}function AR(n,e){if(n&1){let t=ve();P(0,"button",52),Z("click",function(){X(t);let r=j(2);return q(r.toggleAlignment());}),ge(1,TR,5,0,":svg:svg",28)(2,kR,5,0,":svg:svg",28)(3,IR,5,0,":svg:svg",28),S();}if(n&2){let t=j(2);K("title","Align: "+t.activeTextboxAlignment()),I(),he(t.activeTextboxAlignment()==="left"?1:t.activeTextboxAlignment()==="center"?2:3);}}function FR(n,e){if(n&1){let t=ve();P(0,"button",63),Z("click",function(){X(t);let r=j(2);return q(r.addText());}),ke(),P(1,"svg",28),te(2,"line",64)(3,"line",65)(4,"line",66)(5,"line",67)(6,"line",68),S()();}}function RR(n,e){if(n&1){let t=ve();P(0,"button",69),Z("click",function(){X(t);let r=j(2);return q(r.setMode("type"));}),ke(),P(1,"svg",70),te(2,"line",71)(3,"line",72)(4,"line",73)(5,"line",74),S()();}}function LR(n,e){if(n&1){let t=ve();P(0,"div",24)(1,"div",25),te(2,"canvas",null,0),S(),P(4,"div",26)(5,"button",27),Z("click",function(){X(t);let r=j();return q(r.showTemplateGallery.set(!0));}),ke(),P(6,"svg",28),te(7,"path",29),S()(),ge(8,AR,4,2,"button",30)(9,FR,7,0,"button",31)(10,RR,6,0,"button",32),Ye(),P(11,"button",33),Z("click",function(){X(t);let r=j();return q(r.setMode("draw"));}),ke(),P(12,"svg",28),te(13,"path",34),S()(),Ye(),P(14,"button",35),Z("click",function(){X(t);let r=j();return q(r.cycleColor());}),ke(),P(15,"svg",28)(16,"g",36),te(17,"path",37)(18,"path",38)(19,"path",39)(20,"path",40)(21,"path",41),S(),te(22,"circle",42),P(23,"defs")(24,"clipPath",43),te(25,"rect",44),S()()()(),Ye(),P(26,"button",45),Z("click",function(){X(t);let r=j();return q(r.submit());}),ke(),P(27,"svg",46),te(28,"rect",47),P(29,"g",48),te(30,"path",49),S(),P(31,"defs")(32,"clipPath",50),te(33,"rect",51),S()()()()()();}if(n&2){let t=j();Se("entering",t.isEditorShowing()),I(8),he(t.showAlignmentToggle()?8:-1),I(),he(t.currentMode()==="type"?9:10),I(2),Se("active",t.currentMode()==="draw"),I(3),Et("--color",t.currentColor()),I(12),K("disabled",!t.hasContent());}}var pu=class n{constructor(e,t,i,r,o,s,l){this.el=e;this.platform=t;this.destroyRef=i;this.state=r;this.router=o;this.route=s;this.api=l;this.api.updateFromRoute(this.route.snapshot),this.currentColor.set(this.markerColors[Math.floor(Math.random()*this.markerColors.length)]);let c=this.api.locale;c==="he"?this.selectedFont.set("Gadi Almog, Miriam Libre, serif"):c==="ar"&&this.selectedFont.set("Mikhak, Readex Pro, sans-serif"),this.preloadFonts(),Hr(window,"resize").pipe(gr(250),Bt(this.destroyRef)).subscribe(()=>{this.resizeCanvas();}),Hr(window,"keydown").pipe(Bt(this.destroyRef)).subscribe(d=>{this.handleKeyboardEvent(d);});}canvasEl;colorPalette=["#FF0000","#0066FF","#00BB00","#FF6600","#BB00FF","#FF0099","#00CCFF","#FFAA00"];canvas=G(null);selectedTemplate=G(null);isTemplateExpanding=G(!1);isTransitioning=G(!1);isEditorShowing=G(!1);currentMode=G("draw");currentColor=G(this.colorPalette[0]);currentColorIndex=G(0);hasContent=G(!1);showTemplateGallery=G(!0);showModeSelection=G(!1);transitionChoice=G(null);currentTemplateIndex=G(0);isCarouselAnimating=G(!1);carouselDragOffset=G(0);carouselDragging=G(!1);carouselTransform=_e(()=>{let e=this.currentTemplateIndex(),t=this.carouselDragOffset(),i=12.5-e*75,r=t/window.innerWidth*100;return`translateX(calc(${i}vw + ${r}vw))`;});carouselTransition=_e(()=>this.carouselDragging()?"none":"transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)");drawerState=G("default");selectedFont=G("Caveat, cursive");selectedLineHeight=G(1.16);selectedHeight=G(40);activeTextboxAlignment=G("left");showAlignmentToggle=G(!1);drawerDragOffset=G(0);drawerDragging=G(!1);touchStartX=null;touchDeltaX=0;isSwiping=!1;drawerTouchStartY=null;drawerTouchDeltaY=0;placeholderTexts=[];templateBaseWidth=1060;templateBaseHeight=2e3;templateScaleX=1;templateScaleY=1;CANVAS_CONTAINER_PADDING=16;FONT_SCALE_HEBREW=.65;FONT_SCALE_ARABIC=.65;FONT_SCALE_ENGLISH=1;LINE_HEIGHT_SCALE_HEBREW=1.38;LINE_HEIGHT_SCALE_ARABIC=1.38;LINE_HEIGHT_SCALE_ENGLISH=1;injector=zt(Wr);allTemplates=[{id:"post",name:"Post",url:"/templates/FS_template_post.png",preview:"/templates/FS_template_post.png"},{id:"chat",name:"Chat",url:"/templates/FS_template_chat.png",preview:"/templates/FS_template_chat.png"},{id:"notification",name:"Notification",url:"/templates/FS_template_notification.png",preview:"/templates/FS_template_notification.png"},{id:"review",name:"Review",url:"/templates/FS_template_review.png",preview:"/templates/FS_template_review.png"},{id:"prompt",name:"Prompt",url:"/templates/FS_template_prompt.png",preview:"/templates/FS_template_prompt.png"},{id:"photo",name:"Photo",url:"/templates/FS_template_photo.png",preview:"/templates/FS_template_photo.png"},{id:"sign",name:"Sign",url:"/templates/FS_template_sign.png",preview:"/templates/FS_template_sign.png"},{id:"world",name:"World",url:"/templates/FS_template_world.png",preview:"/templates/FS_template_world.png"},{id:"us",name:"United States",url:"/templates/FS_template_US.png",preview:"/templates/FS_template_US.png"},{id:"europe",name:"Europe",url:"/templates/FS_template_europe.png",preview:"/templates/FS_template_europe.png"}];templates=_e(()=>this.allTemplates);templatePresets={post:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[80,604]},properties:{id:"textbox-0",placeholder:"transition","line-height":.75,width:175,height:32,textAlign:"center",originY:"bottom"}},{type:"Feature",geometry:{type:"Point",coordinates:[80,55]},properties:{id:"textbox-1",placeholder:"Name","line-height":1,width:202,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[46,114]},properties:{id:"textbox-2",placeholder:"Type here...","line-height":1,width:243,height:32}}]},chat:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[80,610]},properties:{id:"textbox-0",placeholder:"transition","line-height":1,width:156,height:32,textAlign:"center",originY:"bottom"}},{type:"Feature",geometry:{type:"Point",coordinates:[72,79]},properties:{id:"textbox-1",placeholder:"Type here...","line-height":1,width:225,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[42,300]},properties:{id:"textbox-2",placeholder:"and here...","line-height":1,width:222,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[69,494]},properties:{id:"textbox-3",placeholder:"maybe here","line-height":1,width:220,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[73,46]},properties:{id:"textbox-4",placeholder:"Name-1","line-height":1,width:219,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[43,268]},properties:{id:"textbox-5",placeholder:"Name-2","line-height":1,width:217,height:32}}]},notification:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[80,604]},properties:{id:"textbox-0",placeholder:"transition","line-height":1,width:175,height:32,textAlign:"center",originY:"bottom"}},{type:"Feature",geometry:{type:"Point",coordinates:[81,203]},properties:{id:"textbox-1",placeholder:"App name","line-height":1,width:202,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[44,251]},properties:{id:"textbox-2",placeholder:"Type here...","line-height":1,width:247,height:32}}]},world:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[80,604]},properties:{id:"textbox-0",placeholder:"transition","line-height":.75,width:175,height:59,textAlign:"center",originY:"bottom"}}]},photo:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[80,604]},properties:{id:"textbox-0",placeholder:"transition","line-height":.75,width:175,height:59,textAlign:"center",originY:"bottom"}}]},review:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[71,600]},properties:{id:"textbox-0",placeholder:"transition","line-height":1,width:175,height:32,textAlign:"center",originY:"bottom"}},{type:"Feature",geometry:{type:"Point",coordinates:[118,62]},properties:{id:"textbox-1",placeholder:"Title","line-height":1,width:160,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[43,205]},properties:{id:"textbox-2",placeholder:"factor a","line-height":1,width:132,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[42,232]},properties:{id:"textbox-3",placeholder:"factor b","line-height":1,width:126,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[42,260]},properties:{id:"textbox-4",placeholder:"factor c","line-height":1,width:123,height:32}},{type:"Feature",geometry:{type:"Point",coordinates:[42,306]},properties:{id:"textbox-5",placeholder:"Review here...","line-height":1.1,width:247,height:32}}]},prompt:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[71,600]},properties:{id:"textbox-0",placeholder:"transition","line-height":1,width:175,height:32,textAlign:"center",originY:"bottom"}},{type:"Feature",geometry:{type:"Point",coordinates:[41,157]},properties:{id:"textbox-1",placeholder:"Type here...","line-height":1,width:253,height:32}}]},sign:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[71,600]},properties:{id:"textbox-0",placeholder:"transition","line-height":.75,width:175,height:59,textAlign:"center",originY:"bottom"}}]},holyland:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[71,600]},properties:{id:"textbox-0",placeholder:"transition","line-height":.75,width:175,height:59,textAlign:"center",originY:"bottom"}}]},jerusalem:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[71,600]},properties:{id:"textbox-0",placeholder:"transition","line-height":.75,width:175,height:59,textAlign:"center",originY:"bottom"}}]},europe:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[71,600]},properties:{id:"textbox-0",placeholder:"transition","line-height":.75,width:175,height:59,textAlign:"center",originY:"bottom"}}]},us:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[71,600]},properties:{id:"textbox-0",placeholder:"transition","line-height":.75,width:175,height:59,textAlign:"center",originY:"bottom"}}]}};currentTemplate=_e(()=>this.templates()[this.currentTemplateIndex()]);markerColors=["#4E02B2","#B969FF","#698CFF","#F73C3C","#FF6B35","#2A9D8F"];handwritingFonts=["Caveat, cursive","Permanent Marker, cursive","Shadows Into Light, cursive","Indie Flower, cursive","Gadi Almog, Miriam Libre, serif","Mikhak, Readex Pro, sans-serif"];ngAfterViewInit(){if(!this.platform.browser())return;let e=this.route.snapshot.queryParamMap.get("template_id");if(e&&this.templates().length>0){let t=this.templates().findIndex(i=>i.id===e);if(t>=0){this.currentTemplateIndex.set(t),this.useCurrentTemplate(),setTimeout(()=>{this.restoreCanvasState();},500);return;}}this.spinCarouselToRandomTemplate();}handleKeyboardEvent(e){if(e.ctrlKey&&e.shiftKey&&e.key==="E"&&(e.preventDefault(),this.exportTextboxesAsGeoJSON()),e.key==="Escape"&&this.currentMode()==="draw"){e.preventDefault();let t=this.canvas();t&&(t.discardActiveObject(),t.isDrawingMode=!1),this.setMode("type");}}resizeCanvas(){let e=this.canvas();if(!e||!this.canvasEl?.nativeElement)return;let i=this.canvasEl.nativeElement.parentElement;if(!i)return;let r=i.clientWidth,o=i.clientHeight,s=Math.max(100,r-this.CANVAS_CONTAINER_PADDING),l=Math.max(100,o-this.CANVAS_CONTAINER_PADDING),u=1060/2e3,g=e.getWidth(),f=e.getHeight();if(!g||!f||g===0||f===0)return;let m=s,_=m/u;if(_>l&&(_=l,m=_*u),Math.abs(m-g)<1&&Math.abs(_-f)<1)return;let y=m/g,E=_/f;e.setDimensions({width:m,height:_}),e.getObjects().forEach(b=>{b.scaleX&&b.scaleY&&b.left!==void 0&&b.top!==void 0&&(b.scaleX=b.scaleX*y,b.scaleY=b.scaleY*E,b.left=b.left*y,b.top=b.top*E,b.setCoords());}),this.templateScaleX=m/this.templateBaseWidth,this.templateScaleY=_/this.templateBaseHeight;let C=e.backgroundImage;C&&typeof C!="string"&&"scaleX"in C&&"scaleY"in C&&(C.scaleX=this.templateScaleX,C.scaleY=this.templateScaleY),e.renderAll();}selectTemplate(e){this.selectedTemplate.set(e),this.showTemplateGallery.set(!1),this.showModeSelection.set(!1),_0(()=>{this.initCanvas();},{injector:this.injector});}previousTemplate(){if(this.isCarouselAnimating()||this.carouselDragging())return;let e=this.currentTemplateIndex();this.currentTemplateIndex.set(e>0?e-1:this.templates().length-1);}nextTemplate(){if(this.isCarouselAnimating()||this.carouselDragging())return;let e=this.currentTemplateIndex();this.currentTemplateIndex.set((e+1)%this.templates().length);}backToGallery(){this.showTemplateGallery.set(!0),this.isEditorShowing.set(!1);}cycleColor(){let e=(this.currentColorIndex()+1)%this.colorPalette.length;if(this.currentColorIndex.set(e),this.currentColor.set(this.colorPalette[e]),this.currentMode()==="draw"){let t=this.canvas();t&&this.setupRoughBrush(t);}}useCurrentTemplate(){let e=this.currentTemplate();this.selectTemplate(e),this.isTemplateExpanding.set(!0),this.isTransitioning.set(!0),setTimeout(()=>{this.isEditorShowing.set(!0);},50),setTimeout(()=>{this.showTemplateGallery.set(!1),this.isTemplateExpanding.set(!1),this.isTransitioning.set(!1);},800);}spinCarouselToRandomTemplate(){if(!this.platform.browser())return;let e=Math.floor(Math.random()*this.templates().length),t=e+Math.floor(Math.random()*1+1)*this.templates().length,i=2500;this.isCarouselAnimating.set(!0);let r=0,o=Date.now(),s=()=>{let l=Date.now()-o,c=Math.min(l/i,1),d=1-Math.pow(1-c,4),u=Math.round(t*d);this.currentTemplateIndex.set(u%this.templates().length),c<1?requestAnimationFrame(s):(this.currentTemplateIndex.set(e),this.isCarouselAnimating.set(!1));};requestAnimationFrame(s);}setMode(e){this.currentMode.set(e);let t=this.canvas();t&&(t.isDrawingMode=e==="draw",e==="draw"&&this.setupRoughBrush(t),this.updatePlaceholderVisibility(e==="type"));}selectMode(e){this.currentMode.set(e),this.showModeSelection.set(!1),this.initCanvas();}initCanvas(){return J(this,null,function*(){if(!this.canvasEl||!this.canvasEl.nativeElement){console.error("Canvas element not available");return;}let e=this.canvasEl.nativeElement,t=e.parentElement;yield new Promise(_=>setTimeout(_,0));let i=t?.clientWidth||0,r=t?.clientHeight||0;(i===0||r===0)&&(yield new Promise(_=>setTimeout(_,100)),i=t?.clientWidth||window.innerWidth,r=t?.clientHeight||window.innerHeight);let o=Math.max(100,i-this.CANVAS_CONTAINER_PADDING),s=Math.max(100,r-this.CANVAS_CONTAINER_PADDING);console.log("Canvas dimensions - Container:",i,"x",r,"| Available:",o,"x",s);let d=1060/2e3,u=o,g=u/d;g>s&&(g=s,u=g*d),console.log("Canvas display size:",u,"x",g),e.width=u,e.height=g;let f=new wa(e,{width:u,height:g,backgroundColor:"#f5f0e7",isDrawingMode:this.currentMode()==="draw",enableRetinaScaling:!1}),m=this.selectedTemplate();if(m)if(m.url.endsWith(".svg")){let{objects:y,options:E}=yield Dx(m.url),C=y.filter(x=>x!==null),b=Cx.groupSVGElements(C,E);this.templateBaseWidth=b.width||this.templateBaseWidth,this.templateBaseHeight=b.height||this.templateBaseHeight,this.templateScaleX=f.width/this.templateBaseWidth,this.templateScaleY=f.height/this.templateBaseHeight,b.set({scaleX:this.templateScaleX,scaleY:this.templateScaleY,left:0,top:0,originX:"left",originY:"top",selectable:!1,evented:!1}),f.set("backgroundImage",b),f.renderAll();}else{let y=yield qn.fromURL(m.url);this.templateBaseWidth=y.width||this.templateBaseWidth,this.templateBaseHeight=y.height||this.templateBaseHeight,this.templateScaleX=f.width/this.templateBaseWidth,this.templateScaleY=f.height/this.templateBaseHeight,y.set({scaleX:this.templateScaleX,scaleY:this.templateScaleY,left:0,top:0,originX:"left",originY:"top",selectable:!1,evented:!1}),f.set("backgroundImage",y),f.renderAll();}this.canvas.set(f),this.placeholderTexts=[],this.setupRoughBrush(f),this.setupSelectionModeTracking(f),this.placeInitialChatBoxes(f),this.updatePlaceholderVisibility(this.currentMode()==="type"),window.textboxDebug={getLineHeight:()=>{let _=this.canvas()?.getActiveObject();if(_)return _.lineHeight;console.warn("No textbox selected");},setLineHeight:_=>{this.setLineHeight(_);},getHeight:()=>{let _=this.canvas()?.getActiveObject();if(_)return _.height;console.warn("No textbox selected");},setHeight:_=>{this.setHeight(_);},showAll:()=>{},export:()=>{this.exportTextboxesAsGeoJSON();}};});}setupRoughBrush(e){let t=this.currentColor(),i=this,r=i,o=qd;class s extends o{color=t;width=3;points=[];started=!1;_resolvePointer(c,d){if(c&&typeof c.x=="number"&&typeof c.y=="number")return c;let u=this.canvas;return u&&typeof u.getPointer=="function"&&d?.e?u.getPointer(d.e,!1):null;}onMouseDown(c,d){let u=this._resolvePointer(c,d);if(!u){console.warn("pointer is undefined in onMouseDown");return;}let g=this.canvas.findTarget(d.e,!1);if(g&&g.type==="textbox"){this.canvas.isDrawingMode=!1,i.currentMode.set("type"),this.canvas.setActiveObject(g),this.canvas.renderAll();return;}this.started=!0,this.points=[[u.x,u.y,.5]],this._render();}onMouseMove(c,d){if(!this.started)return;let u=this._resolvePointer(c,d);u&&(this.points.push([u.x,u.y,.5]),this._render());}onMouseUp(){this.started&&(this.started=!1,this._finalizeAndAddPath());}_render(){let c=this.canvas,d=c.contextTop;if(d.clearRect(0,0,c.width,c.height),this.points.length>1){let u=r_(this.points,{size:4,thinning:.6,smoothing:.5,streamline:.5});this._drawStroke(d,u);}}_drawStroke(c,d){if(!(d.length<2)){c.fillStyle=this.color,c.beginPath(),c.moveTo(d[0][0],d[0][1]);for(let u=1;u<d.length;u++)c.lineTo(d[u][0],d[u][1]);c.closePath(),c.fill();}}_finalizeAndAddPath(){if(this.points.length<2){this.points=[];return;}let c=r_(this.points,{size:4,thinning:.6,smoothing:.5,streamline:.5});if(c.length>2){let d=c.map(E=>E[0]),u=c.map(E=>E[1]),g=Math.min(...d),f=Math.min(...u),m=c.map(([E,C])=>[E-g,C-f]),_=this._outlineToSvgPath(m),y=new rr(_,{fill:this.color,strokeWidth:0,left:g,top:f,originX:"left",originY:"top",selectable:!1,evented:!1,objectCaching:!1,globalCompositeOperation:"multiply"});this.canvas.add(y),this.canvas.requestRenderAll();}r.hasContent.set(!0),this.points=[];}_outlineToSvgPath(c){if(c.length<2)return"";let d=c.length,u=[];for(let g=0;g<d;g++){let[f,m]=c[g],[_,y]=c[(g+1)%d];u.push(`${f},${m} ${(f+_)/2},${(m+y)/2}`);}return`M ${u[0]} Q ${u.slice(1).join(" ")} Z`;}}e.freeDrawingBrush=new s(e),e.freeDrawingBrush.color=t,e.freeDrawingBrush.width=3;}addText(){this.canvas()&&this.addTextboxAt(100,100,!0);}setupSelectionModeTracking(e){let t=this,i=null,r=null;e.on("mouse:down",o=>{let s=o.pointer||o.scenePoint;if(!s){i=null,r=null;return;}i={x:s.x,y:s.y};let l=o.target;l&&l.type==="textbox"?(e.isDrawingMode=!1,t.currentMode.set("type"),r=l):r=null;}),e.on("mouse:up",o=>{if(!i){r=null;return;}let s=o.pointer||o.scenePoint;if(!s){i=null,r=null;return;}if(Math.sqrt(Math.pow(s.x-i.x,2)+Math.pow(s.y-i.y,2))<5&&r&&r.type==="textbox")if(e.getActiveObject()!==r)e.setActiveObject(r),e.requestRenderAll();else{r.editable=!0,r.enterEditing();let d=r;setTimeout(()=>{d&&d.isEditing&&d.selectAll();},50);}i=null,r=null;}),e.on("selection:created",o=>{let s=o.selected?.[0];s&&s.type==="textbox"&&(e.isDrawingMode=!1,t.currentMode.set("type"),t.activeTextboxAlignment.set(s.textAlign||"left"),t.showAlignmentToggle.set(!1));}),e.on("selection:updated",o=>{let s=o.selected?.[0];s&&s.type==="textbox"&&(e.isDrawingMode=!1,t.currentMode.set("type"),t.activeTextboxAlignment.set(s.textAlign||"left"),t.showAlignmentToggle.set(!1),s.isEditing&&s.exitEditing());}),e.on("selection:cleared",()=>{e.isDrawingMode=!0,t.currentMode.set("draw"),t.setupRoughBrush(e),t.showAlignmentToggle.set(!1),e.renderAll();}),e.on("text:editing:exited",o=>{let s=o.target;s&&s.type==="textbox"&&(s.editable=!1,t.showAlignmentToggle.set(!1));}),e.on("text:editing:entered",o=>{let s=o.target;s&&s.type==="textbox"&&(t.activeTextboxAlignment.set(s.textAlign||"left"),t.showAlignmentToggle.set(!0));});}detectRTL(e){return /[\u0590-\u05FF\u0600-\u06FF]/.test(e);}getFontSizeScale(e){return e.includes("Gadi Almog")?this.FONT_SCALE_HEBREW:e.includes("Mikhak")?this.FONT_SCALE_ARABIC:this.FONT_SCALE_ENGLISH;}getLineHeightScale(e){return e.includes("Gadi Almog")?this.LINE_HEIGHT_SCALE_HEBREW:e.includes("Mikhak")?this.LINE_HEIGHT_SCALE_ARABIC:this.LINE_HEIGHT_SCALE_ENGLISH;}applyFontScaling(e,t){let i=e.fontFamily||this.selectedFont();if(i!==t){let r=this.getFontSizeScale(i),o=this.getFontSizeScale(t);e.fontSize=e.fontSize/r*o;let s=this.getLineHeightScale(i),l=this.getLineHeightScale(t);e.lineHeight=e.lineHeight/s*l;}}selectTransition(e){return J(this,null,function*(){this.transitionChoice.set(e);let t=this.canvas();if(!t)return;let i=60;e==="during"&&(i=180),e==="after"&&(i=300);let r=document.createElement("canvas");r.width=t.width,r.height=t.height;let o=r.getContext("2d");o.strokeStyle=this.currentColor(),o.lineWidth=3,o.beginPath(),o.arc(i,1930,60,0,Math.PI*2),o.stroke();let s=r.toDataURL(),l=yield qn.fromURL(s);l.set({left:0,top:0,selectable:!1,evented:!1,globalCompositeOperation:"multiply"}),t.add(l),t.renderAll();});}addTransitionText(){let e=this.canvas();if(!e)return;let t=this.selectedFont(),i=this.getLineHeightScale(t),r=this.selectedLineHeight()*i,o=new Ar("Type above transition...",{left:180,top:1850,fontFamily:t,fontSize:20,fill:this.currentColor(),textAlign:"center",width:320,lineHeight:r});this.configureTextbox(o),e.add(o),e.setActiveObject(o),o.enterEditing();}clearCanvas(){let e=this.canvas();e&&(e.getObjects().forEach(t=>{e.remove(t);}),this.hasContent.set(!1));}restart(){this.clearCanvas(),this.canvas.set(null),this.selectedTemplate.set(null),this.transitionChoice.set(null),this.showTemplateGallery.set(!0),this.showModeSelection.set(!1);}submit(){return J(this,null,function*(){if(!this.hasContent())return;let e=this.canvas();if(!e)return;let i=e.getObjects().filter(_=>_.type==="textbox").filter(_=>!_._placeholder&&_.text&&_.text.trim()!=="").map(_=>_.text.trim()).join(" | ");this.state.currentTextboxData.set(i||null);let r=JSON.stringify(e.toJSON(["globalCompositeOperation","paintFirst","_placeholder","_placeholderText"]));this.state.currentCanvasState.set(r);let o=this.placeholderTexts.filter(_=>_._placeholder||(_.text||"").trim()===(_._placeholderText||"Type here..."));o.length&&(o.forEach(_=>e.remove(_)),this.placeholderTexts=this.placeholderTexts.filter(_=>!o.includes(_)),e.requestRenderAll());let s=1060,l=2e3,c=s/e.width,d=e.toDataURL({format:"jpeg",quality:.95,multiplier:c}),g=yield(yield fetch(d)).blob(),f=new Blob([g],{type:"image/jpeg"});this.state.setImage(f);let m=this.selectedTemplate();this.router.navigate(["/confirm"],{queryParamsHandling:"merge",queryParams:{template:"true",template_id:m?.id}});});}undo(){let e=this.canvas();if(!e)return;let t=e.getObjects();t.length>0&&e.remove(t[t.length-1]);}onCarouselTouchStart(e){e.touches.length!==1||this.isCarouselAnimating()||(this.touchStartX=e.touches[0].clientX,this.touchDeltaX=0,this.isSwiping=!0,this.carouselDragging.set(!0),this.carouselDragOffset.set(0));}onCarouselTouchMove(e){!this.isSwiping||this.touchStartX===null||(this.touchDeltaX=e.touches[0].clientX-this.touchStartX,this.carouselDragOffset.set(this.touchDeltaX));}onCarouselTouchEnd(){if(!this.isSwiping)return;let e=75,t=Math.abs(this.touchDeltaX);this.isSwiping=!1,this.carouselDragging.set(!1),this.touchDeltaX>e||t>30&&this.touchDeltaX>0?this.previousTemplate():(this.touchDeltaX<-e||t>30&&this.touchDeltaX<0)&&this.nextTemplate(),this.touchStartX=null,this.touchDeltaX=0,this.carouselDragOffset.set(0);}toggleControls(){let e=this.drawerState();e==="default"?this.drawerState.set("full"):e==="full"?this.drawerState.set("minimal"):this.drawerState.set("default"),this.drawerDragOffset.set(0),this.drawerDragging.set(!1);}setFont(e){this.selectedFont.set(e),this.loadFont(e);let t=this.canvas();if(!t)return;let i=t.getActiveObject();i&&i.type==="textbox"&&(i.set("fontFamily",e),t.requestRenderAll());}toggleAlignment(){let e=this.canvas();if(!e)return;let t=e.getActiveObject();if(t&&t.type==="textbox"){let i=t.textAlign||"left",r="left";i==="left"?r="center":i==="center"?r="right":r="left";let o=r==="right";t.set({textAlign:r,direction:o?"rtl":"ltr"}),this.activeTextboxAlignment.set(r),e.requestRenderAll();}}setLineHeight(e){this.selectedLineHeight.set(e);let t=this.canvas();if(!t)return;let i=t.getActiveObject();if(i&&i.type==="textbox"){let r=i.fontFamily||this.selectedFont(),o=this.getLineHeightScale(r),s=e*o;i.set("lineHeight",s),t.requestRenderAll();}}setHeight(e){this.selectedHeight.set(e);let t=this.canvas();if(!t)return;let i=t.getActiveObject();i&&i.type==="textbox"&&(i.set("height",e),t.requestRenderAll());}addTextboxAt(e,t,i=!1,r="Type here...",o,s,l,c,d){let g=s||this.canvas();if(!g)return;let f="#9aa0a6",m=this.selectedFont(),_=this.getLineHeightScale(m),y=this.selectedLineHeight()*_,E=new Ar(r,{left:e,top:t,fontFamily:m,fontSize:28,fill:f,width:o||Math.min(360,g.getWidth()*.6),height:this.selectedHeight(),editable:!1,lineHeight:y,textAlign:l||"left",originY:c||"top",originX:d||"left",selectable:!0,evented:!0,_placeholder:!0,_placeholderText:r});return this.configureTextbox(E),E.on("editing:entered",()=>{E._placeholder&&(E.set({fill:this.currentColor(),_placeholder:!1}),E.selectAll(),g.requestRenderAll());}),E.on("changed",()=>{let C=E.text||"",b=this.detectRTL(C),x=this.selectedFont();if(b){let w=/[\u0590-\u05FF]/.test(C),T=/[\u0600-\u06FF]/.test(C);w?x="Gadi Almog, Miriam Libre, serif":T&&(x="Mikhak, Readex Pro, sans-serif");}this.applyFontScaling(E,x),E.set({direction:b?"rtl":"ltr",textAlign:b?"right":"left",fontFamily:x}),g.requestRenderAll();}),E.on("editing:exited",()=>{if((E.text||"").trim()===""){let b=E._placeholderText||"Type here...";E.set({text:b,fill:f,_placeholder:!0});}}),g.add(E),this.hasContent.set(!0),i&&(g.setActiveObject(E),E.enterEditing(),E._placeholder&&(E.set({fill:this.currentColor(),_placeholder:!1}),E.selectAll(),g.requestRenderAll())),E;}configureTextbox(e){e.editable=!1,e.lockMovementX=!1,e.lockMovementY=!1,e.set({globalCompositeOperation:"multiply"});let t=e.render;e.render=function(i){i.save(),i.globalCompositeOperation="multiply",t.call(this,i),i.restore();},e.setControlsVisibility({ml:!0,mr:!0,mt:!1,mb:!1,tl:!0,tr:!0,bl:!0,br:!0,mtr:!0}),e.on("scaling",i=>{let r=i.transform?.target;if(!r)return;let o=i.transform?.corner;if(o==="ml"||o==="mr"){let s=Math.max(80,r.width*r.scaleX);r.set({width:s,scaleX:1});}else(o==="mt"||o==="mb")&&r.set({scaleY:1});}),e.on("scaled",i=>{let r=i.transform?.target;if(!r)return;let o=i.transform?.corner;if(o==="tl"||o==="tr"||o==="bl"||o==="br"){let s=(r.scaleX+r.scaleY)/2,l=Math.max(8,Math.min(128,r.fontSize*s)),c=Math.max(80,r.width*s);r.set({fontSize:l,width:c,scaleX:1,scaleY:1}),r.setCoords();}else r.set({scaleX:1,scaleY:1});r.canvas?.requestRenderAll();});}placeInitialChatBoxes(e){if(this.placeholderTexts.length)return;let t=this.selectedTemplate();if(!t)return;let i=this.templateBaseWidth||1060,r=this.templateBaseHeight||2e3,o=320,s=o*(r/i),l=i/o,c=r/s,d=this.templateScaleX||(e?.getWidth?.()??i)/i,u=this.templateScaleY||(e?.getHeight?.()??r)/r,g=.95,f=0,m=0,_=this.templatePresets[t.id];if(_&&_.features&&t.id==="chat"){let C=_.features.find(b=>b.properties?.id==="textbox-0");if(C){let b=C.geometry.coordinates[0]*l,x=(C.properties?.width??0)*l,w=b+x/2;f=i/2-w,m=-(10*c);}}let E=.045*r;if(_&&_.features){let C=null,b=null,x=_.features.find(w=>w.properties?.id==="textbox-0");if(x){let w=x.geometry.coordinates[0],T=x.geometry.coordinates[1],R=w*l+f,V=T*c+m,B=(x.properties?.width??0)*l;C=R+B/2,b=V;}_.features.forEach(w=>{let T=w.properties,[R,V]=w.geometry.coordinates,B=R*l+f,Y=V*c+m;if(C!==null&&b!==null){let re=B-C,A=Y-b;B=C+g*re,Y=b+g*A;}Y-=E;let le=B*d,ae=Y*u,ee=T.width?T.width*l*d*g:void 0,ce=T.height?T.height*c*u*g:void 0;this.selectedLineHeight.set(T["line-height"]||1.16),this.selectedHeight.set(ce||T.height||40);let oe=this.addTextboxAt(le,ae,!1,T.placeholder,ee,e,T.textAlign,T.originY,T.originX);oe&&this.placeholderTexts.push(oe);});}else[{x:150*d,y:360*u},{x:150*d,y:640*u}].forEach(b=>{let x=this.addTextboxAt(b.x,b.y,!1,"Type here...",void 0,e);x&&this.placeholderTexts.push(x);});}loadFont(e){typeof document>"u"||!document.fonts?.load||document.fonts.load(`400 16px ${e}`).catch(()=>{});}preloadFonts(){this.handwritingFonts.forEach(e=>this.loadFont(e));}onDrawerTouchStart(e){e.touches.length===1&&(this.drawerTouchStartY=e.touches[0].clientY,this.drawerTouchDeltaY=0,this.drawerDragging.set(!0));}onDrawerTouchMove(e){if(this.drawerTouchStartY===null)return;this.drawerTouchDeltaY=e.touches[0].clientY-this.drawerTouchStartY;let t=Math.max(-100,Math.min(60,this.drawerTouchDeltaY));this.drawerDragOffset.set(t);}onDrawerTouchEnd(){this.drawerTouchDeltaY>30?this.openMoreDrawer():this.drawerTouchDeltaY<-30&&this.closeDrawerLevel(),this.drawerTouchStartY=null,this.drawerTouchDeltaY=0,this.drawerDragOffset.set(0),this.drawerDragging.set(!1);}openMoreDrawer(){let e=this.drawerState();e==="minimal"?this.drawerState.set("default"):e==="default"&&this.drawerState.set("full"),this.drawerDragOffset.set(0),this.drawerDragging.set(!1);}closeDrawerLevel(){let e=this.drawerState();e==="full"?this.drawerState.set("default"):e==="default"&&this.drawerState.set("minimal"),this.drawerDragOffset.set(0),this.drawerDragging.set(!1);}drawerTransform(){let e=this.drawerBaseOffset(),t=this.drawerDragOffset();return`translateY(${e+t}px)`;}drawerTransition(){return this.drawerDragging()?"none":"transform 0.22s cubic-bezier(0.25, 0.8, 0.3, 1)";}drawerBaseOffset(){let e=this.drawerState();return e==="full"?0:e==="default"?-30:-70;}updatePlaceholderVisibility(e){this.placeholderTexts.forEach(t=>{t.set({visible:!0});}),this.canvas()?.requestRenderAll();}restoreCanvasState(){let e=this.state.currentCanvasState();if(!e)return;let t=this.canvas();if(t)try{let i=JSON.parse(e);t.getObjects().forEach(o=>t.remove(o)),t.loadFromJSON(i,()=>{setTimeout(()=>{let o=t.getObjects(),s=[];o.forEach(c=>{if(c.type==="textbox"){s.push(c),this.configureTextbox(c),c._placeholder=!1;let d=c.fontFamily||this.selectedFont(),u=this.getLineHeightScale(d);c.lineHeight&&(c.lineHeight=c.lineHeight*u),c.on("editing:entered",()=>{c._placeholder&&(c.set({fill:this.currentColor(),_placeholder:!1}),c.selectAll(),t.requestRenderAll());}),c.on("changed",()=>{let g=c.text||"",f=this.detectRTL(g),m=this.selectedFont();if(f){let _=/[\u0590-\u05FF]/.test(g),y=/[\u0600-\u06FF]/.test(g);_?m="Gadi Almog, Miriam Libre, serif":y&&(m="Mikhak, Readex Pro, sans-serif");}this.applyFontScaling(c,m),c.set({direction:f?"rtl":"ltr",textAlign:f?"right":"left",fontFamily:m}),t.requestRenderAll();}),c.on("editing:exited",()=>{if((c.text||"").trim()===""){let f=c._placeholderText||"Type here...";c.set({text:f,fill:"#9aa0a6",_placeholder:!0});}});}}),this.placeholderTexts=s;let l=o.filter(c=>c.type!=="textbox"||!c._placeholder&&c.text&&c.text.trim()!=="");this.hasContent.set(l.length>0),t.renderAll(),console.log("Canvas state restored successfully with",s.length,"textboxes");},100);});}catch(i){console.error("Failed to restore canvas state:",i);}}exportTextboxesAsGeoJSON(){let e=this.canvas();if(!e){console.warn("Canvas not initialized");return;}let t=e.getObjects().filter(s=>s.type==="textbox");if(t.length===0){console.warn("No textboxes found on canvas");return;}let i=s=>Math.round(s??0),o={type:"FeatureCollection",features:t.map((s,l)=>({type:"Feature",geometry:{type:"Point",coordinates:[i(s.left),i(s.top)]},properties:D(D({id:`textbox-${l}`,placeholder:s._placeholderText||s.text||"message\u2026","line-height":i(s.lineHeight||1.16),width:i(s.width),height:i(s.height||40)},s.textAlign!=="left"&&{textAlign:s.textAlign}),s.originY!=="top"&&{originY:s.originY})}))};console.log("Textbox Positions (GeoJSON)"),console.log(JSON.stringify(o,null,2));}static fac=function(t){return new(t||n)(ue(Ns),ue(it),ue(ii),ue(Ot),ue(gt),ue(Ct),ue(rt));};static cmp=Me({type:n,selectors:[["app-canvas-creator"]],viewQuery:function(t,i){if(t&1&&Pt(wR,5),t&2){let r;wt(r=Mt())&&(i.canvasEl=r.first);}},decls:3,vars:2,consts:()=>{let e;return e="Choose a Template",[["canvasEl",""],e,[1,"canvas-creator"],[1,"template-gallery",3,"transitioning"],[1,"editor",3,"entering"],[1,"template-gallery"],[1,"gallery-background"],[1,"gallery-content"],[1,"gallery-header"],["queryParamsHandling","merge","aria-label","Back to prescan",1,"back-button",3,"routerLink"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M19 12H5M5 12L12 19M5 12L12 5","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"gallery-title"],[1,"spacer"],[1,"carousel-wrapper"],[1,"carousel",3,"touchstart","touchmove","touchend"],[1,"carousel-item",3,"active","expanding"],[1,"carousel-controls"],["aria-label","Previous template",1,"carousel-nav","prev",3,"click","disabled"],["aria-label","Next template",1,"carousel-nav","next",3,"click","disabled"],[1,"carousel-item",3,"click"],[1,"carousel-item-content"],["loading","lazy",3,"src","alt"],[1,"template-label"],[1,"editor"],[1,"canvas-container"],[1,"control-bar"],["aria-label","Close and return to template selection","title","Back to templates",1,"control-btn","close",3,"click"],["viewBox","0 0 36 36","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M9.78629 9.73336C10.2255 9.29423 10.9379 9.2944 11.3773 9.73336L18.0002 16.3563L24.6217 9.73475C25.0611 9.29541 25.7734 9.29541 26.2127 9.73475C26.652 10.1741 26.652 10.8864 26.2127 11.3257L19.5912 17.9473L26.2127 24.5688C26.652 25.0081 26.652 25.7204 26.2127 26.1598C25.7734 26.5991 25.0611 26.5991 24.6217 26.1598L18.0002 19.5383L11.3773 26.1612C10.9379 26.6001 10.2255 26.6003 9.78629 26.1612C9.34706 25.7219 9.34729 25.0095 9.78629 24.5702L16.4092 17.9473L9.78629 11.3244C9.34729 10.885 9.34706 10.1726 9.78629 9.73336Z","fill","white"],["aria-label","Toggle text alignment",1,"control-btn","alignment",3,"title"],["aria-label","Add text box","title","Add text",1,"control-btn","add-text"],["aria-label","Switch to text mode","title","Text mode",1,"control-btn","add-text"],["aria-label","Switch to drawing mode","title","Draw",1,"control-btn","draw",3,"click"],["d","M8.45996 19.2429C9.63746 17.5974 13.206 12.9219 17.3805 10.2924C20.52 8.31543 23.4855 10.9254 21.186 13.5534C18.9375 16.1244 15.921 19.6629 14.634 21.4194C13.299 23.2404 15.5835 25.4424 17.8695 23.3469C19.398 21.9459 20.9895 20.3349 22.6065 19.1439C24.7905 17.5374 26.664 18.9564 25.7115 20.7669C25.0215 22.0764 24.522 22.6539 23.9475 23.7564C23.3715 24.8574 23.9805 26.1789 24.852 26.2914C25.932 26.4324 26.616 25.6569 27.5385 24.4494","stroke","white","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["aria-label","Cycle through colors","title","Change color",1,"control-btn","color-cycle",3,"click"],["clip-path","url(#clip0_2835_214959)"],["d","M16.8125 29.4721C17.6592 29.57 18.4794 29.2095 19.0819 28.6047C19.4434 28.2419 19.6465 27.7507 19.6465 27.2385C19.6465 26.7263 19.4434 26.235 19.0819 25.8723C18.4794 25.2675 17.9875 24.3667 18.4425 23.6432C20.2592 20.7553 29.6602 27.3894 29.6602 17.9987C29.6602 11.6203 24.5111 6.44922 18.1407 6.44922C11.7704 6.44922 6.68681 11.6287 6.62121 17.9987C6.57621 22.3677 9.05203 25.8934 11.8826 27.8725","stroke","white","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M24.4765 19.1209C25.4308 19.1209 26.2044 18.3473 26.2044 17.393C26.2044 16.4387 25.4308 15.665 24.4765 15.665C23.5222 15.665 22.7485 16.4387 22.7485 17.393C22.7485 18.3473 23.5222 19.1209 24.4765 19.1209Z","stroke","white","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M11.8048 19.1209C12.7591 19.1209 13.5328 18.3473 13.5328 17.393C13.5328 16.4387 12.7591 15.665 11.8048 15.665C10.8505 15.665 10.0769 16.4387 10.0769 17.393C10.0769 18.3473 10.8505 19.1209 11.8048 19.1209Z","stroke","white","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M17.0877 12.2089C17.0877 12.6672 16.9056 13.1067 16.5816 13.4307C16.2575 13.7548 15.818 13.9368 15.3598 13.9368C14.9015 13.9368 14.462 13.7548 14.1379 13.4307C13.8139 13.1067 13.6318 12.6672 13.6318 12.2089C13.6318 11.7506 13.8139 11.3111 14.1379 10.9871C14.462 10.663 14.9015 10.481 15.3598 10.481C15.818 10.481 16.2575 10.663 16.5816 10.9871C16.9056 11.3111 17.0877 11.7506 17.0877 12.2089ZM22.7495 12.2089C22.7495 12.6672 22.5675 13.1067 22.2434 13.4307C21.9194 13.7548 21.4799 13.9368 21.0216 13.9368C20.5633 13.9368 20.1238 13.7548 19.7998 13.4307C19.4757 13.1067 19.2937 12.6672 19.2937 12.2089C19.2937 11.7506 19.4757 11.3111 19.7998 10.9871C20.1238 10.663 20.5633 10.481 21.0216 10.481C21.4799 10.481 21.9194 10.663 22.2434 10.9871C22.5675 11.3111 22.7495 11.7506 22.7495 12.2089Z","stroke","white","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M12.4999 23.2189L12.4999 28.8319L6.89216 28.8319","stroke","white","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["cx","27.7495","cy","30.9688","r","4.25","fill","var(--color)","stroke","white","stroke-width","1.5"],["id","clip0_2835_214959"],["width","36","height","36","fill","white"],["aria-label","Submit artwork","title","Submit",1,"control-btn","submit",3,"click","disabled"],["viewBox","0 0 44 44","fill","none","xmlns","http://www.w3.org/2000/svg"],["width","44","height","44","rx","22","fill","#FFFDF6"],["clip-path","url(#clip0_2834_214765)"],["d","M22 30V14M22 14L28 20M22 14L16 20","stroke","#4E02B2","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["id","clip0_2834_214765"],["width","24","height","24","fill","white","transform","translate(10 10)"],["aria-label","Toggle text alignment",1,"control-btn","alignment",3,"click","title"],["x1","7","y1","10","x2","29","y2","10","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","7","y1","15","x2","23","y2","15","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","7","y1","20","x2","27","y2","20","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","7","y1","25","x2","21","y2","25","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","11","y1","15","x2","25","y2","15","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","9","y1","20","x2","27","y2","20","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","13","y1","25","x2","23","y2","25","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","13","y1","15","x2","29","y2","15","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","9","y1","20","x2","29","y2","20","stroke","white","stroke-width","2","stroke-linecap","round"],["x1","15","y1","25","x2","29","y2","25","stroke","white","stroke-width","2","stroke-linecap","round"],["aria-label","Add text box","title","Add text",1,"control-btn","add-text",3,"click"],["x1","7.125","y1","10.125","x2","22.875","y2","10.125","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["x1","7.125","y1","14.625","x2","22.875","y2","14.625","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["x1","7.125","y1","19.125","x2","18.375","y2","19.125","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["x1","22.875","y1","28.875","x2","22.875","y2","19.125","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["x1","27.75","y1","23.625","x2","18","y2","23.625","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["aria-label","Switch to text mode","title","Text mode",1,"control-btn","add-text",3,"click"],["width","36","height","36","viewBox","0 0 36 36","fill","none","xmlns","http://www.w3.org/2000/svg"],["x1","7.125","y1","14.625","x2","28.875","y2","14.625","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["x1","7.125","y1","10.125","x2","28.875","y2","10.125","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["x1","7.125","y1","19.125","x2","28.875","y2","19.125","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"],["x1","7.125","y1","23.625","x2","18.375","y2","23.625","stroke","#FFFDF6","stroke-width","2.25","stroke-linecap","round","stroke-linejoin","round"]];},template:function(t,i){t&1&&(P(0,"div",2),ge(1,OR,19,12,"div",3)(2,LR,34,9,"div",4),S()),t&2&&(I(),he(i.showTemplateGallery()?1:-1),I(),he(i.selectedTemplate()&&!i.showTemplateGallery()?2:-1));},dependencies:[rn],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.background-image[_ngcontent-%COMP%] {
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}
.message[_ngcontent-%COMP%] {
  font-size: 18px;
  padding: 16px 24px;
  max-width: calc(100% - 32px);
  transition: border-radius 0.3s ease-in-out;
  z-index: 1;
}
.message[_ngcontent-%COMP%]     * {
  margin: 0;
}
.message[_ngcontent-%COMP%]     * a {
  color: inherit;
}
.message.ai[_ngcontent-%COMP%] {
  background-color: #E7CBFF;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 32px 2px;
  align-self: flex-start;
  animation: _ngcontent-%COMP%_fadeInLeft 0.08s ease-out;
}
.message.human[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: #FFFFFF;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  border-radius: 32px 32px 2px 32px;
  align-self: flex-end;
  animation: _ngcontent-%COMP%_fadeInRight 0.08s ease-out;
  margin-bottom: 4px;
}
.message.part[_ngcontent-%COMP%] {
  border-radius: 32px;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
@keyframes _ngcontent-%COMP%_fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_fadeInRight {
  from {
    opacity: 0;
    transform: translateX(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInUp2 {
  from {
    transform: translateY(200%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_slideInDown {
  from {
    transform: translateY(-100%);
  }
  to {
    transform: translateY(0);
  }
}
@keyframes _ngcontent-%COMP%_zoomToEditor {
  from {
    position: fixed;
    top: 50%;
    left: 50%;
    width: 75vw;
    transform: translate(-50%, -50%);
  }
  to {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    transform: translate(0, 0);
  }
}
@keyframes _ngcontent-%COMP%_fadeOutGallery {
  from {
    opacity: 1;
    pointer-events: auto;
  }
  to {
    opacity: 0;
    pointer-events: none;
  }
}
@keyframes _ngcontent-%COMP%_slideInDrawer {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}
.canvas-creator[_ngcontent-%COMP%] {
  width: 100%;
  height: 100vh;
  display: flex;
  flex-flow: column;
  background: #FFFDF6;
  overflow: hidden;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  display: flex;
  flex-flow: column;
  position: relative;
  background: #2a1a4d;
  transition: opacity 0.3s ease;
  pointer-events: auto;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery.transitioning[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_fadeOutGallery 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.3s forwards;
  pointer-events: none;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .gallery-background[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background:
    linear-gradient(
      135deg,
      #2a1a4d 0%,
      #3d2766 100%);
  z-index: 0;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .gallery-content[_ngcontent-%COMP%] {
  position: relative;
  z-index: 1;
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: flex-start;
  height: 100%;
  padding: 24px 16px;
  gap: 16px;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .gallery-header[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  flex-shrink: 0;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%] {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
  padding: 0;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
  width: 24px;
  height: 24px;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover {
  transform: scale(1.05);
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:active {
  transform: scale(0.95);
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:focus {
  outline: none;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%] {
  width: 40px;
  flex-shrink: 0;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .gallery-title[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 28px;
  font-weight: 700;
  color: #FFFFFF;
  margin: 0;
  text-align: center;
  letter-spacing: -0.5px;
  flex: 1;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-wrapper[_ngcontent-%COMP%] {
  position: relative;
  width: 100%;
  height: 75vh;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  flex: 1;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%] {
  width: 100vw;
  height: 100%;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-start;
  will-change: transform;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel.animating[_ngcontent-%COMP%]   .carousel-item[_ngcontent-%COMP%] {
  pointer-events: none;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item[_ngcontent-%COMP%] {
  flex: 0 0 75vw;
  width: 75vw;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: opacity 0.3s ease, transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  padding: 0;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item[_ngcontent-%COMP%]:not(.active) {
  opacity: 0.2;
  transform: scale(0.8);
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item.active[_ngcontent-%COMP%] {
  opacity: 1;
  transform: scale(1);
  z-index: 10;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item.active.expanding[_ngcontent-%COMP%] {
  position: fixed;
  top: 50%;
  left: 50%;
  width: 75vw;
  flex: none;
  z-index: 1500;
  animation: _ngcontent-%COMP%_zoomToEditor 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  border-radius: 0;
  transform: translate(-50%, -50%);
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item.active.expanding[_ngcontent-%COMP%]   .carousel-item-content[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item.active.expanding[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  max-height: none;
  border-radius: 0;
  box-shadow: none;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item[_ngcontent-%COMP%]   .carousel-item-content[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: center;
  gap: 16px;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 90%;
  height: auto;
  max-height: 85%;
  object-fit: contain;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
  transition: box-shadow 0.3s ease;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-item.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .template-label[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 20px;
  font-weight: 700;
  color: #FFFFFF;
  text-align: center;
  letter-spacing: -0.3px;
  flex-shrink: 0;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-controls[_ngcontent-%COMP%] {
  display: flex;
  gap: 16px;
  justify-content: center;
  align-items: center;
  flex-shrink: 0;
  margin-top: auto;
  margin-bottom: 24px;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-nav[_ngcontent-%COMP%] {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  border: 2px solid rgba(255, 255, 255, 0.5);
  color: #FFFFFF;
  font-size: 24px;
  font-weight: 700;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  flex-shrink: 0;
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-nav[_ngcontent-%COMP%]:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.3);
  border-color: #FFFFFF;
  transform: scale(1.05);
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-nav[_ngcontent-%COMP%]:active:not(:disabled) {
  transform: scale(0.95);
}
.canvas-creator[_ngcontent-%COMP%]   .template-gallery[_ngcontent-%COMP%]   .carousel-nav[_ngcontent-%COMP%]:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%] {
  width: 100%;
  height: 100vh;
  height: 100dvh;
  display: flex;
  flex-flow: column;
  position: relative;
  background: #F5F0E7;
}
.canvas-creator[_ngcontent-%COMP%]   .editor.entering[_ngcontent-%COMP%]   .control-bar[_ngcontent-%COMP%] {
  animation: _ngcontent-%COMP%_slideInUp 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.5s forwards;
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-bar[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 12px 16px;
  background: rgba(0, 0, 0, 0.75);
  border-radius: 16px 16px 0 0;
  z-index: 100;
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  transform: translateY(100%);
  padding-bottom: max(12px, env(safe-area-inset-bottom));
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%] {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: transparent;
  border: none;
  color: #FFFFFF;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.12s ease;
  flex-shrink: 0;
  padding: 0;
  font-size: 0;
  line-height: 1;
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
  width: 36px;
  height: 36px;
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.1);
  transform: scale(1.05);
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]:active:not(:disabled) {
  transform: scale(0.95);
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn.submit[_ngcontent-%COMP%] {
  width: 44px;
  height: 44px;
  background: transparent;
  border: none;
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn.submit[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
  width: 44px;
  height: 44px;
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn.submit[_ngcontent-%COMP%]:disabled {
  opacity: 0.25;
  cursor: not-allowed;
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn.submit[_ngcontent-%COMP%]:disabled:hover {
  background: transparent;
  transform: none;
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn.submit[_ngcontent-%COMP%]:not(:disabled):hover {
  background: rgba(255, 255, 255, 0.1);
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .control-btn.draw.active[_ngcontent-%COMP%] {
  background: rgba(255, 255, 255, 0.15);
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%] {
  flex: 1;
  width: 100%;
  overflow: hidden;
  background: #2a1a4d;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 8px;
  margin-bottom: calc(64px + env(safe-area-inset-bottom));
}
.canvas-creator[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%] {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  display: block;
}`]});};var fu=class n{constructor(e,t,i){this.afAuth=e;this.auth=t;this.router=i;}loginGoogle(){this.login(new Sg());}login(e){FC(this.afAuth,e),this.auth.user.pipe(Vt(t=>!!t),Xt(1)).subscribe(t=>{t&&this.router.navigate(["/admin"]);});}static fac=function(t){return new(t||n)(ue(Er),ue(nr),ue(gt));};static cmp=Me({type:n,selectors:[["app-login"]],decls:3,vars:0,consts:[[1,"container"],[3,"click"]],template:function(t,i){t&1&&(P(0,"div",0)(1,"button",1),Z("click",function(){return i.loginGoogle();}),N(2,"Login with Google"),S()());},styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 8px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
[_nghost-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}`]});};var gu=class n{preferenceOptions=["prefer","mostly prefer","uncertain","mostly prevent","prevent","none"];potentialOptions=["100","75","50","25","0","none"];applyFilters(e,t){let i=[...e];if(t.status.length>0&&(i=i.filter(r=>kn.matchesStatusFilter(r,t.status))),t.author!=="all"&&(t.author==="unattributed"?i=i.filter(r=>!r.author_id||r.author_id==="unknown"):i=i.filter(r=>r.author_id===t.author)),t.preference.length>0&&t.preference.length<this.preferenceOptions.length&&(i=i.filter(r=>{let o=r.favorable_future;return t.preference.includes("none")&&(!o||o===""||o==="none")?!0:t.preference.includes(o);})),t.potential.length>0&&t.potential.length<this.potentialOptions.length&&(i=i.filter(r=>{let o=r.plausibility;return t.potential.includes("none")&&(o==null||o===""||o==="none")?!0:t.potential.includes(String(o));})),t.type!=="all"&&(i=i.filter(r=>r.screenshot_type===t.type)),t.search){let r=t.search.toLowerCase();i=i.filter(o=>{let s=(o.future_scenario_tagline||"").toLowerCase(),l=(o.future_scenario_description||"").toLowerCase(),c=(o.content||"").toLowerCase();return s.includes(r)||l.includes(r)||c.includes(r);});}return i;}sortItems(e,t,i){let r=[...e];switch(t){case"date":return r.sort((o,s)=>{let l=new Date(o.created_at||0).getTime();return new Date(s.created_at||0).getTime()-l;});case"status":return r.sort((o,s)=>(s._private_moderation||0)-(o._private_moderation||0));case"author":return r.sort((o,s)=>{let l=o.author_id||"unknown",c=s.author_id||"unknown";if(l==="unknown"&&c!=="unknown")return 1;if(l!=="unknown"&&c==="unknown")return-1;if(i){let d=i.get(l)||0;return(i.get(c)||0)-d;}return l.localeCompare(c);});case"confidence":return r.sort((o,s)=>this.getAIConfidence(s)-this.getAIConfidence(o));case"type":return r.sort((o,s)=>{let l=o.screenshot_type||"",c=s.screenshot_type||"";return l.localeCompare(c);});case"preference":return r.sort((o,s)=>{let l=["prefer","mostly prefer","uncertain","mostly prevent","prevent"],c=o.favorable_future||"uncertain",d=s.favorable_future||"uncertain";return l.indexOf(c)-l.indexOf(d);});default:return r;}}calculateFilterCounts(e){let t=new Map(),i=new Map(),r=new Map(),o=new Map(),s=new Map();return e.forEach(l=>{let c=kn.getStatusKey(l);t.set(c,(t.get(c)||0)+1);let d=l.author_id||"unknown";if(i.set(d,(i.get(d)||0)+1),l.favorable_future&&r.set(l.favorable_future,(r.get(l.favorable_future)||0)+1),l.plausibility!==null&&l.plausibility!==void 0){let u=String(l.plausibility);o.set(u,(o.get(u)||0)+1);}l.screenshot_type&&s.set(l.screenshot_type,(s.get(l.screenshot_type)||0)+1);}),{status:t,author:i,preference:r,potential:o,type:s};}getAIConfidence(e){let t=e.content_certainty||0,i=e.transition_bar_certainty||0;return Math.round((t+i)/2);}static fac=function(t){return new(t||n)();};static prov=tn({token:n,factory:n.fac,providedIn:"root"});};var cr=class n{constructor(e,t){this.http=e;this.auth=t;}CHRONOMAPS_API_URL="https://chronomaps-api-qjzuw7ypfq-ez.a.run.app";listWorkspaces(){let e={Authorization:"Bearer "+this.auth.token()};return this.http.get(`${this.CHRONOMAPS_API_URL}/`,{headers:e}).pipe(Jt(t=>t.workspaces||[]),Eo(t=>(console.error("Error fetching workspaces:",t),tp([]))));}getWorkspace(e,t){return this.http.get(`${this.CHRONOMAPS_API_URL}/${e}`,{headers:{Authorization:`${t}`}});}getItems(e,t,i,r){let o={page:i,page_size:500};return r?o.filters=r:o.order_by="",this.http.get(`${this.CHRONOMAPS_API_URL}/${e}/items`,{params:o,headers:{Authorization:`${t}`}}).pipe(Eo(s=>(console.error("Error fetching items:",s.error),tp(s.error))));}updateItem(e,t,i,r){return this.http.put(`${this.CHRONOMAPS_API_URL}/${e}/${i}`,r,{headers:{Authorization:`${t}`}});}updateItemModeration(e,t,i,r){let o={_private_moderation:r};return this.http.put(`${this.CHRONOMAPS_API_URL}/${e}/${i}`,o,{headers:{Authorization:`${t}`}});}createWorkspace(e){let t={Authorization:"Bearer "+this.auth.token()};return this.http.post(`${this.CHRONOMAPS_API_URL}/`,e.metadata,{headers:t}).pipe($n(i=>{let r={id:i.workspace_id,metadata:i.config.metadata,keys:i.config.keys};return console.log("Created workspace:",r),this.updateWorkspace(r.id,r.keys.admin,{metadata:null,public:e.public,collaborate:e.collaborate}).pipe(Jt(()=>r));}));}updateWorkspace(e,t,i){let r={Authorization:t},o={};return o.public=i.public,o.collaborate=i.collaborate,this.http.put(`${this.CHRONOMAPS_API_URL}/${e}`,i.metadata||{},{headers:r,params:o});}static fac=function(t){return new(t||n)(Qt(Ui),Qt(nr));};static prov=tn({token:n,factory:n.fac,providedIn:"root"});};function DR(n,e){n&1&&(P(0,"span"),N(1,"Split View"),S());}function NR(n,e){n&1&&(P(0,"span"),N(1,"Slider View"),S());}function BR(n,e){if(n&1){let t=ve();P(0,"div",3)(1,"div",8),te(2,"img",9),P(3,"div",10),te(4,"img",11),S()(),P(5,"input",12),Z("input",function(r){X(t);let o=j();return q(o.onSliderChange(r));}),S(),P(6,"div",13)(7,"span",14),N(8,"Current"),S(),P(9,"span",15),N(10,"New"),S()()();}if(n&2){let t=j();I(2),K("src",t.currentImage(),Ue),I(),Et("clip-path","polygon(0 0, "+t.sliderPosition()+"% 0, "+t.sliderPosition()+"% 100%, 0 100%)"),I(),K("src",t.newImage(),Ue),I(),K("value",t.sliderPosition());}}function VR(n,e){if(n&1&&(P(0,"div",4)(1,"div",16)(2,"div",17),te(3,"img",18),P(4,"label"),N(5,"Current"),S()(),P(6,"div",17),te(7,"img",11),P(8,"label"),N(9,"New"),S()()()()),n&2){let t=j();I(3),K("src",t.currentImage(),Ue),I(4),K("src",t.newImage(),Ue);}}var mu=class n{currentImage=nn.required();newImage=nn.required();approved=Xr();cancelled=Xr();viewMode=G("split");sliderPosition=G(50);onApprove(){this.approved.emit();}onCancel(){this.cancelled.emit();}toggleViewMode(){this.viewMode.set(this.viewMode()==="slider"?"split":"slider");}onSliderChange(e){let t=e.target;this.sliderPosition.set(parseFloat(t.value));}static fac=function(t){return new(t||n)();};static cmp=Me({type:n,selectors:[["app-image-comparison"]],inputs:{currentImage:[1,"currentImage"],newImage:[1,"newImage"]},outputs:{approved:"approved",cancelled:"cancelled"},decls:14,vars:2,consts:[[1,"comparison-container"],[1,"comparison-header"],["aria-label","Toggle between slider and split view",1,"mode-toggle",3,"click"],[1,"slider-comparison"],[1,"split-comparison"],[1,"comparison-actions"],["aria-label","Cancel replacement",1,"button","secondary",3,"click"],["aria-label","Approve replacement",1,"button","primary",3,"click"],[1,"comparison-image"],["alt","Current image",1,"base-image",3,"src"],[1,"overlay-image"],["alt","New image",3,"src"],["type","range","min","0","max","100","aria-label","Compare images slider",1,"slider",3,"input","value"],[1,"labels"],[1,"current"],[1,"new"],[1,"split-image-container"],[1,"split-image"],["alt","Current image",3,"src"]],template:function(t,i){t&1&&(P(0,"div",0)(1,"div",1)(2,"h3"),N(3,"Review Image Replacement"),S(),P(4,"button",2),Z("click",function(){return i.toggleViewMode();}),ge(5,DR,2,0,"span")(6,NR,2,0,"span"),S()(),ge(7,BR,11,5,"div",3)(8,VR,10,2,"div",4),P(9,"div",5)(10,"button",6),Z("click",function(){return i.onCancel();}),N(11," Cancel "),S(),P(12,"button",7),Z("click",function(){return i.onApprove();}),N(13," Approve Replacement "),S()()()),t&2&&(I(5),he(i.viewMode()==="slider"?5:6),I(2),he(i.viewMode()==="slider"?7:8));},dependencies:[ri],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 8px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
.comparison-container[_ngcontent-%COMP%] {
  padding: 20px;
  background: white;
  border-radius: 12px;
  box-shadow: none;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
.comparison-container[_ngcontent-%COMP%]   .comparison-header[_ngcontent-%COMP%] {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}
.comparison-container[_ngcontent-%COMP%]   .comparison-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {
  margin: 0;
  font-size: 18px;
  font-weight: 700;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.comparison-container[_ngcontent-%COMP%]   .comparison-header[_ngcontent-%COMP%]   .mode-toggle[_ngcontent-%COMP%] {
  padding: 8px 16px;
  border: 1px solid #F1E5F3;
  background: #FBF5F6;
  color: #4E02B2;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 14px;
}
.comparison-container[_ngcontent-%COMP%]   .comparison-header[_ngcontent-%COMP%]   .mode-toggle[_ngcontent-%COMP%]:hover {
  background: #4E02B2;
  color: white;
}
.slider-comparison[_ngcontent-%COMP%] {
  margin-bottom: 20px;
  flex: 1;
  display: flex;
  flex-direction: column;
}
.slider-comparison[_ngcontent-%COMP%]   .comparison-image[_ngcontent-%COMP%] {
  position: relative;
  width: 100%;
  max-width: 800px;
  margin: 0 auto 16px;
  border-radius: 8px;
  overflow: hidden;
  background: #9B90AA;
}
.slider-comparison[_ngcontent-%COMP%]   .comparison-image[_ngcontent-%COMP%]   .base-image[_ngcontent-%COMP%] {
  display: block;
  width: 100%;
  height: auto;
}
.slider-comparison[_ngcontent-%COMP%]   .comparison-image[_ngcontent-%COMP%]   .overlay-image[_ngcontent-%COMP%] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.slider-comparison[_ngcontent-%COMP%]   .comparison-image[_ngcontent-%COMP%]   .overlay-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.slider-comparison[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%] {
  display: block;
  width: 100%;
  max-width: 800px;
  margin: 0 auto 16px;
  cursor: pointer;
  height: 6px;
  border-radius: 3px;
  background: #F1E5F3;
  outline: none;
  -webkit-appearance: none;
  appearance: none;
}
.slider-comparison[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: #4E02B2;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  transition: transform 0.2s;
}
.slider-comparison[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]::-webkit-slider-thumb:hover {
  transform: scale(1.2);
}
.slider-comparison[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]::-moz-range-thumb {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: #4E02B2;
  cursor: pointer;
  border: none;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  transition: transform 0.2s;
}
.slider-comparison[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]::-moz-range-thumb:hover {
  transform: scale(1.2);
}
.slider-comparison[_ngcontent-%COMP%]   .labels[_ngcontent-%COMP%] {
  display: flex;
  justify-content: space-between;
  max-width: 800px;
  margin: 0 auto;
  font-size: 12px;
  color: #9B90AA;
  font-weight: 600;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.slider-comparison[_ngcontent-%COMP%]   .labels[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%] {
  text-align: left;
}
.slider-comparison[_ngcontent-%COMP%]   .labels[_ngcontent-%COMP%]   .new[_ngcontent-%COMP%] {
  text-align: right;
}
.split-comparison[_ngcontent-%COMP%] {
  margin-bottom: 20px;
  flex: 1;
  display: flex;
  flex-direction: column;
}
.split-comparison[_ngcontent-%COMP%]   .split-image-container[_ngcontent-%COMP%] {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  max-width: 800px;
  margin: 0 auto;
}
.split-comparison[_ngcontent-%COMP%]   .split-image-container[_ngcontent-%COMP%]   .split-image[_ngcontent-%COMP%] {
  position: relative;
  border-radius: 8px;
  overflow: hidden;
  background: #9B90AA;
}
.split-comparison[_ngcontent-%COMP%]   .split-image-container[_ngcontent-%COMP%]   .split-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  display: block;
  width: 100%;
  height: auto;
  max-height: 400px;
  object-fit: cover;
}
.split-comparison[_ngcontent-%COMP%]   .split-image-container[_ngcontent-%COMP%]   .split-image[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 12px;
  background: rgba(0, 0, 0, 0.5);
  color: white;
  font-weight: 600;
  font-size: 14px;
  text-align: center;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.comparison-actions[_ngcontent-%COMP%] {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  max-width: 800px;
  margin: 24px auto 0;
}
.comparison-actions[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  padding: 10px 20px;
  border-radius: 6px;
  border: none;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 14px;
}
.comparison-actions[_ngcontent-%COMP%]   .button.secondary[_ngcontent-%COMP%] {
  background: #FBF5F6;
  color: #4E02B2;
  border: 1px solid #F1E5F3;
}
.comparison-actions[_ngcontent-%COMP%]   .button.secondary[_ngcontent-%COMP%]:hover {
  background: #F1E5F3;
}
.comparison-actions[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  background: #4E02B2;
  color: white;
}
.comparison-actions[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%]:hover {
  background: #380180;
  box-shadow: 0 2px 8px rgba(107, 55, 180, 0.3);
}
@media (max-width: 768px) {
  .split-comparison[_ngcontent-%COMP%]   .split-image-container[_ngcontent-%COMP%] {
    grid-template-columns: 1fr;
  }
}`],changeDetection:0});};var zR=(n,e)=>e._id;function jR(n,e){n&1&&(P(0,"p",6),N(1,"No other items with images found in this workspace."),S());}function $R(n,e){if(n&1&&(P(0,"div",14),N(1),S()),n&2){let t,i=j(3);I(),Ve((t=i.currentItem())==null?null:t.future_scenario_tagline);}}function UR(n,e){if(n&1&&(P(0,"div",20),N(1),S()),n&2){let t=j().$implicit;I(),Ve(t.future_scenario_tagline);}}function HR(n,e){if(n&1){let t=ve();P(0,"div",18),Z("click",function(){let r=X(t).$implicit,o=j(3);return q(o.selectExistingImage(r._id));}),te(1,"img",19),ge(2,UR,2,1,"div",20),S();}if(n&2){let t=e.$implicit,i=j(3);Se("selected",i.selectedItemId()===t._id),I(),K("src",t.screenshot_url,Ue)("alt",t.future_scenario_tagline||"Item image"),I(),he(t.future_scenario_tagline?2:-1);}}function WR(n,e){if(n&1&&(P(0,"div",7)(1,"div",11)(2,"h4"),N(3,"Current Image"),S(),P(4,"div",12),te(5,"img",13),ge(6,$R,2,1,"div",14),S()(),P(7,"div",15)(8,"h4"),N(9,"Choose Replacement"),S(),P(10,"div",16),ze(11,HR,3,5,"div",17,zR),S()()()),n&2){let t,i=j(2);I(5),K("src",i.currentImageUrl(),Ue),I(),he((t=i.currentItem())!=null&&t.future_scenario_tagline?6:-1),I(5),je(i.workspaceItems());}}function GR(n,e){n&1&&N(0," Replacing... ");}function YR(n,e){n&1&&N(0," Compare Images ");}function XR(n,e){if(n&1){let t=ve();P(0,"div",4)(1,"h3"),N(2,"Select Existing Image"),S(),P(3,"p"),N(4,"Choose an image from another item in this workspace:"),S(),ge(5,jR,2,0,"p",6)(6,WR,13,2,"div",7),P(7,"div",8)(8,"button",9),Z("click",function(){X(t);let r=j();return q(r.scanAgain());}),N(9," Scan New Image "),S(),P(10,"button",10),Z("click",function(){X(t);let r=j();return q(r.confirmExistingImage());}),ge(11,GR,1,0)(12,YR,1,0),S()()();}if(n&2){let t=j();I(5),he(t.workspaceItems().length===0&&!t.loading()?5:6),I(3),K("disabled",t.loading()),I(2),K("disabled",!t.selectedItemId()||t.loading()),I(),he(t.loading()?11:12);}}function qR(n,e){if(n&1){let t=ve();P(0,"div",5)(1,"app-image-comparison",21),Z("approved",function(){X(t);let r=j();return q(r.onExistingComparisonApproved());})("cancelled",function(){X(t);let r=j();return q(r.onComparisonCancelled());}),S()();}if(n&2){let t=j();I(),K("currentImage",t.currentImageUrl())("newImage",t.pendingNewImage());}}var _u=class n{workspaceId=nn.required();apiKey=nn.required();itemId=nn.required();currentImageUrl=nn.required();closed=Xr();imageReplaced=Xr();workspaceItems=G([]);currentItem=G(null);selectedItemId=G(null);loading=G(!1);pendingNewImage=G(null);showComparison=G(!1);router=zt(gt);adminApi=zt(cr);constructor(){at(()=>{let e=this.workspaceId(),t=this.apiKey();e&&t&&this.workspaceItems().length===0&&this.loadWorkspaceItems();});}loadWorkspaceItems(){this.loading.set(!0),this.adminApi.getItems(this.workspaceId(),this.apiKey(),0,"").subscribe({next:e=>{if(Array.isArray(e)){let t=e.find(s=>s._id===this.itemId()),i=t?.screenshot_type||null;this.currentItem.set(t||null);let r=e.filter(s=>s._id!==this.itemId()&&!!s.screenshot_url).map(s=>se(D({},s),{screenshot_url:this.fixUrl(s.screenshot_url)})),o=[];if(i){let s=this.sortByDateDesc(r.filter(d=>d.screenshot_type===i)),l=r.filter(d=>d.screenshot_type!==i),c=t&&Array.isArray(t.embedding)?this.sortBySimilarity(l,t.embedding):this.sortByDateDesc(l);o=[...s,...c];}else o=t&&Array.isArray(t?.embedding)?this.sortBySimilarity(r,t.embedding):this.sortByDateDesc(r);this.workspaceItems.set(o);}this.loading.set(!1);},error:e=>{console.error("Error fetching workspace items:",e),this.workspaceItems.set([]),this.loading.set(!1);}});}sortBySimilarity(e,t){return e.sort((i,r)=>{let o=this.computeSimilarity(t,i.embedding);return this.computeSimilarity(t,r.embedding)-o;});}sortByDateDesc(e){return e.sort((t,i)=>this.getTimestamp(i)-this.getTimestamp(t));}getTimestamp(e){let t=e?.created_at||e?.createdAt||e?.created||e?._created||e?.updated_at||e?.updatedAt||0;return new Date(t||0).getTime();}computeSimilarity(e,t){if(!t||!Array.isArray(t))return 0;let i=0,r=0,o=0,s=Math.min(e.length,t.length);for(let l=0;l<s;l++)i+=e[l]*t[l],r+=e[l]*e[l],o+=t[l]*t[l];return r=Math.sqrt(r),o=Math.sqrt(o),r===0||o===0?0:i/(r*o);}close(){this.closed.emit();}onComparisonCancelled(){this.showComparison.set(!1),this.pendingNewImage.set(null);}selectExistingImage(e){this.selectedItemId.set(e);}confirmExistingImage(){let e=this.selectedItemId();if(!e)return;let t=this.workspaceItems().find(i=>i._id===e);t&&(this.pendingNewImage.set(t.screenshot_url),this.showComparison.set(!0));}onExistingComparisonApproved(){let e=this.selectedItemId();if(!e)return;let t=this.workspaceItems().find(r=>r._id===e);if(!t||!t.screenshot_url)return;this.loading.set(!0);let i={screenshot_url:t.screenshot_url};this.adminApi.updateItem(this.workspaceId(),this.apiKey(),this.itemId(),i).subscribe({next:()=>{this.loading.set(!1),this.imageReplaced.emit({screenshot_url:t.screenshot_url}),this.close();},error:r=>{console.error("Error updating item screenshot:",r),this.loading.set(!1),alert("Failed to replace image. Please try again.");}});}scanAgain(){this.router.navigate(["/scan"],{queryParams:{workspace:this.workspaceId(),api_key:this.apiKey(),replace_item:this.itemId()}});}fixUrl(e){return e.replace("https://storage.googleapis.com/chronomaps3.firebasestorage.app/","https://storage.googleapis.com/chronomaps3-eu/");}static fac=function(t){return new(t||n)();};static cmp=Me({type:n,selectors:[["app-image-replacement-modal"]],inputs:{workspaceId:[1,"workspaceId"],apiKey:[1,"apiKey"],itemId:[1,"itemId"],currentImageUrl:[1,"currentImageUrl"]},outputs:{closed:"closed",imageReplaced:"imageReplaced"},decls:9,vars:1,consts:[[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],["aria-label","Close dialog",1,"close-button",3,"click"],[1,"modal-body"],[1,"modal-body","comparison-modal"],[1,"no-items"],[1,"replacement-layout"],[1,"buttons"],[1,"button",3,"click","disabled"],[1,"button","primary",3,"click","disabled"],[1,"current-image-section"],[1,"current-image-container"],["alt","Current image to be replaced",3,"src"],[1,"current-image-label"],[1,"replacement-options-section"],[1,"items-grid"],[1,"item-thumbnail",3,"selected"],[1,"item-thumbnail",3,"click"],[3,"src","alt"],[1,"item-label"],[3,"approved","cancelled","currentImage","newImage"]],template:function(t,i){t&1&&(P(0,"div",0),Z("click",function(){return i.close();}),P(1,"div",1),Z("click",function(o){return o.stopPropagation();}),P(2,"div",2)(3,"h2"),N(4,"Replace Image"),S(),P(5,"button",3),Z("click",function(){return i.close();}),N(6,"\xD7"),S()(),ge(7,XR,13,4,"div",4)(8,qR,2,2,"div",5),S()()),t&2&&(I(7),he(i.showComparison()?8:7));},dependencies:[ri,on,mu],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 8px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
.modal-overlay[_ngcontent-%COMP%] {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  padding: 16px;
}
.modal-content[_ngcontent-%COMP%] {
  background: white;
  border-radius: 16px;
  max-width: 90vw;
  max-height: 90vh;
  width: 100%;
  height: 100%;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;
}
.modal-header[_ngcontent-%COMP%] {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  border-bottom: 1px solid #e0e0e0;
}
.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {
  margin: 0;
  font-size: 20px;
  font-weight: 700;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] {
  background: none;
  border: none;
  font-size: 32px;
  color: #9B90AA;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  transition: color 0.2s;
}
.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover {
  color: #4E02B2;
}
.modal-body[_ngcontent-%COMP%] {
  padding: 24px;
  flex: 1;
  overflow: auto;
}
.modal-body.comparison-modal[_ngcontent-%COMP%] {
  padding: 0;
  overflow: hidden;
  display: flex;
}
.modal-body[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {
  margin: 0 0 16px 0;
  font-size: 18px;
  font-weight: 700;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {
  margin: 0 0 16px 0;
  font-size: 16px;
  color: #333;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-body[_ngcontent-%COMP%]   p.no-items[_ngcontent-%COMP%] {
  text-align: center;
  padding: 32px 16px;
  color: #9B90AA;
  font-style: italic;
}
.modal-body[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%] {
  display: block;
  width: 100%;
  padding: 12px;
  border: 2px dashed #9B90AA;
  border-radius: 8px;
  margin-bottom: 16px;
  cursor: pointer;
  font-size: 14px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-body[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
.modal-body[_ngcontent-%COMP%]   .replacement-layout[_ngcontent-%COMP%] {
  display: flex;
  gap: 24px;
  margin-bottom: 16px;
  height: 450px;
}
.modal-body[_ngcontent-%COMP%]   .replacement-layout[_ngcontent-%COMP%]   .current-image-section[_ngcontent-%COMP%] {
  flex: 0 0 280px;
  display: flex;
  flex-direction: column;
}
.modal-body[_ngcontent-%COMP%]   .replacement-layout[_ngcontent-%COMP%]   .current-image-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {
  margin: 0 0 12px 0;
  font-size: 16px;
  font-weight: 600;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-body[_ngcontent-%COMP%]   .replacement-layout[_ngcontent-%COMP%]   .current-image-section[_ngcontent-%COMP%]   .current-image-container[_ngcontent-%COMP%] {
  flex: 1;
  position: relative;
  border: 3px solid #4E02B2;
  border-radius: 8px;
  overflow: hidden;
  background-color: #f5f5f5;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}
.modal-body[_ngcontent-%COMP%]   .replacement-layout[_ngcontent-%COMP%]   .current-image-section[_ngcontent-%COMP%]   .current-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  object-fit: contain;
  display: block;
}
.modal-body[_ngcontent-%COMP%]   .replacement-layout[_ngcontent-%COMP%]   .current-image-section[_ngcontent-%COMP%]   .current-image-container[_ngcontent-%COMP%]   .current-image-label[_ngcontent-%COMP%] {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background:
    linear-gradient(
      to top,
      rgba(0, 0, 0, 0.8),
      transparent);
  color: white;
  padding: 24px 12px 12px;
  font-size: 13px;
  font-weight: 600;
  text-align: center;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-body[_ngcontent-%COMP%]   .replacement-layout[_ngcontent-%COMP%]   .replacement-options-section[_ngcontent-%COMP%] {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
}
.modal-body[_ngcontent-%COMP%]   .replacement-layout[_ngcontent-%COMP%]   .replacement-options-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {
  margin: 0 0 12px 0;
  font-size: 16px;
  font-weight: 600;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-body[_ngcontent-%COMP%]   .items-grid[_ngcontent-%COMP%] {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(106px, 106px));
  gap: 8px;
  overflow-y: auto;
  flex: 1;
}
.modal-body[_ngcontent-%COMP%]   .items-grid[_ngcontent-%COMP%]   .item-thumbnail[_ngcontent-%COMP%] {
  position: relative;
  border: 2px solid #F1E5F3;
  border-radius: 2px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.2s;
  width: 106px;
  height: 200px;
}
.modal-body[_ngcontent-%COMP%]   .items-grid[_ngcontent-%COMP%]   .item-thumbnail[_ngcontent-%COMP%]:hover {
  border-color: #4E02B2;
  transform: scale(1.02);
}
.modal-body[_ngcontent-%COMP%]   .items-grid[_ngcontent-%COMP%]   .item-thumbnail.selected[_ngcontent-%COMP%] {
  border-color: #4E02B2;
  box-shadow: 0 0 0 3px rgba(78, 2, 178, 0.3);
}
.modal-body[_ngcontent-%COMP%]   .items-grid[_ngcontent-%COMP%]   .item-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}
.modal-body[_ngcontent-%COMP%]   .items-grid[_ngcontent-%COMP%]   .item-thumbnail[_ngcontent-%COMP%]   .item-label[_ngcontent-%COMP%] {
  display: none;
}
.modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  align-items: center;
  flex-wrap: wrap;
}
.modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%] {
  display: flex;
  gap: 12px;
}
.modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  padding: 10px 20px;
  border-radius: 6px;
  border: 1px solid #F1E5F3;
  background: white;
  color: #4E02B2;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 14px;
}
.modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover:not(:disabled) {
  background: #FBF5F6;
  border-color: #4E02B2;
}
.modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
.modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  background: #4E02B2;
  color: white;
  border-color: #4E02B2;
}
.modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%]:hover:not(:disabled) {
  background: #380180;
  box-shadow: 0 2px 8px rgba(107, 55, 180, 0.3);
}
@media (max-width: 600px) {
  .modal-content[_ngcontent-%COMP%] {
    max-width: calc(100vw - 32px);
  }
  .modal-body[_ngcontent-%COMP%] {
    padding: 16px;
  }
  .modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%] {
    flex-direction: column;
  }
  .modal-body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
    width: 100%;
  }
}`],changeDetection:0});};var Wx=a0(pw());function ZR(n,e){if(n&1&&(P(0,"div",6),te(1,"img",11),S()),n&2){let t=j();I(),K("src",t.qrCodeUrl(),Ue);}}function KR(n,e){n&1&&(P(0,"div",7)(1,"p"),N(2,"Generating QR code..."),S()());}function JR(n,e){n&1&&N(0," Link Copied! ");}function QR(n,e){n&1&&N(0," Copy Link ");}var vu=class n{workspaceId=nn.required();apiKey=nn.required();itemId=nn.required();closed=Xr();qrCodeUrl=G(null);copying=G(!1);platform=zt(it);ngOnInit(){this.platform.browser(()=>{this.generateQRCode();});}generateQRCode(){return J(this,null,function*(){try{let e=this.buildScanUrl(),t=yield Wx.default.toDataURL(e,{errorCorrectionLevel:"H",type:"image/png",margin:2,width:400,color:{dark:"#000000",light:"#FFFFFF"}});this.qrCodeUrl.set(t);}catch(e){console.error("Error generating QR code:",e);}});}buildScanUrl(){let e="";typeof window<"u"&&(e=window.location.origin);let t=new URLSearchParams({workspace:this.workspaceId(),api_key:this.apiKey(),replace_item:this.itemId()});return`${e}/scan?${t.toString()}`;}downloadQRCode(){this.platform.browser(()=>{let e=document.createElement("a");e.href=this.qrCodeUrl()||"",e.download=`qr-code-replace-item-${this.itemId()}.png`,e.click();});}copyQRLink(){this.platform.browser(()=>{this.copying.set(!0);let e=this.buildScanUrl();navigator.clipboard.writeText(e).then(()=>{setTimeout(()=>this.copying.set(!1),2e3);}).catch(()=>{this.copying.set(!1);});});}close(){this.closed.emit();}static fac=function(t){return new(t||n)();};static cmp=Me({type:n,selectors:[["app-qr-code-modal"]],inputs:{workspaceId:[1,"workspaceId"],apiKey:[1,"apiKey"],itemId:[1,"itemId"]},outputs:{closed:"closed"},decls:18,vars:4,consts:[[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],["aria-label","Close dialog",1,"close-button",3,"click"],[1,"modal-body"],[1,"instructions"],[1,"qr-code-container"],[1,"loading"],[1,"actions"],[1,"button","secondary",3,"click","disabled"],[1,"button","primary",3,"click","disabled"],["alt","QR Code for scanning replacement image",1,"qr-code",3,"src"]],template:function(t,i){t&1&&(P(0,"div",0),Z("click",function(){return i.close();}),P(1,"div",1),Z("click",function(o){return o.stopPropagation();}),P(2,"div",2)(3,"h2"),N(4,"Scan to Replace on Mobile"),S(),P(5,"button",3),Z("click",function(){return i.close();}),N(6,"\xD7"),S()(),P(7,"div",4)(8,"p",5),N(9," Scan this QR code with your mobile device to open the scanner and replace this image. "),S(),ge(10,ZR,2,1,"div",6)(11,KR,3,0,"div",7),P(12,"div",8)(13,"button",9),Z("click",function(){return i.downloadQRCode();}),N(14," Download QR Code "),S(),P(15,"button",10),Z("click",function(){return i.copyQRLink();}),ge(16,JR,1,0)(17,QR,1,0),S()()()()()),t&2&&(I(10),he(i.qrCodeUrl()?10:11),I(3),K("disabled",!i.qrCodeUrl()),I(2),K("disabled",!i.qrCodeUrl()),I(),he(i.copying()?16:17));},dependencies:[ri],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 8px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
.modal-overlay[_ngcontent-%COMP%] {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  padding: 16px;
}
.modal-content[_ngcontent-%COMP%] {
  background: white;
  border-radius: 16px;
  max-width: 500px;
  width: 100%;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}
.modal-header[_ngcontent-%COMP%] {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  border-bottom: 1px solid #e0e0e0;
}
.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {
  margin: 0;
  font-size: 20px;
  font-weight: 700;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] {
  background: none;
  border: none;
  font-size: 32px;
  color: #9B90AA;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  transition: color 0.2s;
}
.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover {
  color: #4E02B2;
}
.modal-body[_ngcontent-%COMP%] {
  padding: 24px;
  text-align: center;
}
.modal-body[_ngcontent-%COMP%]   .instructions[_ngcontent-%COMP%] {
  margin: 0 0 24px;
  font-size: 16px;
  color: #333;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-body[_ngcontent-%COMP%]   .qr-code-container[_ngcontent-%COMP%] {
  margin: 0 0 24px;
  padding: 20px;
  background: #FBF5F6;
  border-radius: 12px;
  display: flex;
  justify-content: center;
}
.modal-body[_ngcontent-%COMP%]   .qr-code-container[_ngcontent-%COMP%]   .qr-code[_ngcontent-%COMP%] {
  max-width: 100%;
  height: auto;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}
.modal-body[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%] {
  padding: 40px 20px;
  color: #9B90AA;
  font-size: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.modal-body[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {
  margin: 0;
}
.modal-body[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] {
  display: flex;
  gap: 12px;
  justify-content: center;
  flex-wrap: wrap;
}
.modal-body[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  padding: 10px 20px;
  border-radius: 6px;
  border: 1px solid #F1E5F3;
  background: white;
  color: #4E02B2;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 14px;
}
.modal-body[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover:not(:disabled) {
  background: #FBF5F6;
  border-color: #4E02B2;
}
.modal-body[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
.modal-body[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  background: #4E02B2;
  color: white;
  border-color: #4E02B2;
}
.modal-body[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%]:hover:not(:disabled) {
  background: #380180;
  box-shadow: 0 2px 8px rgba(107, 55, 180, 0.3);
}
@media (max-width: 600px) {
  .modal-content[_ngcontent-%COMP%] {
    max-width: calc(100vw - 32px);
  }
  .modal-body[_ngcontent-%COMP%] {
    padding: 16px;
  }
}`],changeDetection:0});};var Gx=(n,e)=>e._id,eL=(n,e)=>e.value,tL=(n,e)=>e[0];function nL(n,e){if(n&1&&(P(0,"span",5),N(1),S()),n&2){let t,i=j();I(),Ve((t=i.workspace())==null?null:t.source);}}function iL(n,e){if(n&1&&(P(0,"span",15),N(1),S()),n&2){let t=j();I(),Ve(t.selectedCount());}}function rL(n,e){if(n&1){let t=ve();P(0,"section",16)(1,"button",19),Z("click",function(){X(t);let r=j();return q(r.page.set(r.page()-1));}),N(2," \u2190 Previous "),S(),P(3,"span",20),N(4),S(),P(5,"button",21),Z("click",function(){X(t);let r=j();return q(r.page.set(r.page()+1));}),N(6," Next \u2192 "),S()();}if(n&2){let t=j();I(),K("disabled",t.page()===0),I(3),vt("Page ",t.page()+1,""),I(),K("disabled",!t.items().length);}}function oL(n,e){if(n&1&&(P(0,"div",17)(1,"span"),N(2,"\u26A0\uFE0F Database index required"),S(),P(3,"a",22),N(4,"Create index"),S()()),n&2){let t=j();I(3),K("href",t.indexLink(),Ue);}}function sL(n,e){if(n&1){let t=ve();P(0,"label",68)(1,"input",69),tt("ngModelChange",function(r){X(t);let o=j(4);return et(o.selectedItem().transition_bar_position,r)||(o.selectedItem().transition_bar_position=r),q(r);}),Z("change",function(){X(t);let r=j(4);return q(r.autoSaveTransitionBarPosition(r.selectedItem()));}),S(),P(2,"span"),N(3,"Before"),S()(),P(4,"label",68)(5,"input",70),tt("ngModelChange",function(r){X(t);let o=j(4);return et(o.selectedItem().transition_bar_position,r)||(o.selectedItem().transition_bar_position=r),q(r);}),Z("change",function(){X(t);let r=j(4);return q(r.autoSaveTransitionBarPosition(r.selectedItem()));}),S(),P(6,"span"),N(7,"During"),S()(),P(8,"label",68)(9,"input",71),tt("ngModelChange",function(r){X(t);let o=j(4);return et(o.selectedItem().transition_bar_position,r)||(o.selectedItem().transition_bar_position=r),q(r);}),Z("change",function(){X(t);let r=j(4);return q(r.autoSaveTransitionBarPosition(r.selectedItem()));}),S(),P(10,"span"),N(11,"After"),S()();}if(n&2){let t=j(4);I(),Qe("ngModel",t.selectedItem().transition_bar_position),I(4),Qe("ngModel",t.selectedItem().transition_bar_position),I(4),Qe("ngModel",t.selectedItem().transition_bar_position);}}function aL(n,e){if(n&1&&te(0,"span",72),n&2){let t=e.$index,i=j(4);Se("active",i.getIndicatorSlot(i.selectedItem())===t+1)("prefer",i.isPreferDirection(i.selectedItem()))("prevent",i.isPreventDirection(i.selectedItem()))("neutral",i.isNeutralDirection(i.selectedItem()))("mostly-prefer",i.isMostlyPrefer(i.selectedItem()))("mostly-prevent",i.isMostlyPrevent(i.selectedItem()));}}function lL(n,e){if(n&1&&(P(0,"span",80),N(1),S()),n&2){let t=j(5);I(),vt("",t.getUserItemCount(t.selectedItem().author_id)," items");}}function cL(n,e){if(n&1&&(P(0,"span",80),N(1),S()),n&2){let t=j(5);I(),vt("",t.getUserItemCount("unknown")," unattributed");}}function hL(n,e){if(n&1&&(P(0,"option",84),N(1),S()),n&2){let t=e.$implicit;K("ngValue",t.value),I(),Ve(t.label);}}function dL(n,e){if(n&1){let t=ve();P(0,"div",93)(1,"textarea",115),tt("ngModelChange",function(r){X(t);let o=j(5);return et(o.selectedItem().future_scenario_tagline,r)||(o.selectedItem().future_scenario_tagline=r),q(r);}),S(),P(2,"div",116)(3,"button",117),Z("click",function(){X(t);let r=j(5);return q(r.setTagline(r.selectedItem()));}),N(4,"\u2713"),S(),P(5,"button",118),Z("click",function(){X(t);let r=j(5);return q(r.editTagline.set(null));}),N(6,"\u2715"),S()()();}if(n&2){let t=j(5);I(),Qe("ngModel",t.selectedItem().future_scenario_tagline);}}function uL(n,e){if(n&1){let t=ve();P(0,"div",121),Z("click",function(){X(t);let r=j(6);return q(r.editTagline.set(r.selectedItem()._id));}),N(1),S();}if(n&2){let t=j(6);I(),vt(" ",t.selectedItem().future_scenario_tagline," ");}}function pL(n,e){if(n&1){let t=ve();P(0,"div",122),Z("click",function(){X(t);let r=j(6);return q(r.editTagline.set(r.selectedItem()._id));}),N(1," + Add tagline "),S();}}function fL(n,e){if(n&1&&ge(0,uL,2,1,"div",119)(1,pL,2,0,"div",120),n&2){let t=j(5);he(t.selectedItem().future_scenario_tagline?0:1);}}function gL(n,e){if(n&1){let t=ve();P(0,"span",123),N(1),P(2,"button",124),Z("click",function(){let r=X(t).$index,o=j(6);return q(o.removeTag(o.selectedItem(),r));}),N(3,"\xD7"),S()();}if(n&2){let t=e.$implicit;I(),vt(" ",t," ");}}function mL(n,e){if(n&1&&ze(0,gL,4,1,"span",123,jt),n&2){let t=j(5);je(t.selectedItem().tags);}}function _L(n,e){if(n&1){let t=ve();P(0,"label",109)(1,"span",125),N(2),S(),P(3,"input",126),Z("ngModelChange",function(r){let o=X(t).$implicit,s=j(5);return q(s.updateMetadataField(o[0],r));}),S()();}if(n&2){let t=e.$implicit;I(2),Ve(t[0]),I(),K("ngModel",t[1]),ct("aria-label","Edit metadata field "+t[0]);}}function vL(n,e){n&1&&(P(0,"span",127),N(1,"ARCHIVED \u{1F5D1}\uFE0F"),S(),P(2,"span",128),N(3,"UNARCHIVE"),S());}function yL(n,e){n&1&&N(0," PUBLISHED \u2713 ");}function CL(n,e){n&1&&N(0," PUBLISH ");}function bL(n,e){if(n&1){let t=ve();P(0,"aside",73),Z("click",function(r){return X(t),q(r.stopPropagation());}),P(1,"div",74)(2,"h2"),N(3,"Item Details"),S(),P(4,"button",75),Z("click",function(){X(t);let r=j(4);return q(r.toggleLightboxSidebar());}),N(5,"\xD7"),S()(),P(6,"div",76)(7,"article",77)(8,"div",78)(9,"button",79),Z("click",function(){X(t);let r=j(4);return q(r.filterByUser(r.selectedItem().author_id));}),ge(10,lL,2,1,"span",80)(11,cL,2,1,"span",80),S()(),P(12,"div",81)(13,"label",82),N(14,"Status"),S(),P(15,"select",83),Z("ngModelChange",function(r){X(t);let o=j(4);return q(o.setStatusFromSidebar(r));}),ze(16,hL,2,2,"option",84,eL),S()(),P(18,"div",85)(19,"div",86)(20,"span",87),N(21),S(),P(22,"button",88),Z("click",function(){X(t);let r=j(4);return q(r.highlight(r.selectedItem()._id));}),N(23),S(),P(24,"span",89),N(25),S(),P(26,"button",90),Z("click",function(){X(t);let r=j(4);return q(r.reject(r.selectedItem()._id));}),N(27," \u{1F5D1}\uFE0F "),S()()(),P(28,"div",91)(29,"div",92),ge(30,dL,7,1,"div",93)(31,fL,2,1),S(),P(32,"div",94)(33,"div",95),ge(34,mL,2,0),P(35,"div",96)(36,"input",97,0),Z("keydown.enter",function(){X(t);let r=$i(37),o=j(4);return q(o.addTag(o.selectedItem(),r));}),S()()()(),P(38,"div",98)(39,"div",99)(40,"select",100),tt("ngModelChange",function(r){X(t);let o=j(4);return et(o.selectedItem().favorable_future,r)||(o.selectedItem().favorable_future=r),q(r);}),Z("change",function(){X(t);let r=j(4);return q(r.setFavorable(r.selectedItem()));}),P(41,"option",45),N(42,"Desirability?"),S(),P(43,"option",101),N(44,"prefer"),S(),P(45,"option",102),N(46,"prefer-ish"),S(),P(47,"option",103),N(48,"uncertain"),S(),P(49,"option",104),N(50,"prevent-ish"),S(),P(51,"option",105),N(52,"prevent"),S()()(),P(53,"div",99)(54,"select",106),tt("ngModelChange",function(r){X(t);let o=j(4);return et(o.selectedItem().plausibility,r)||(o.selectedItem().plausibility=r),q(r);}),Z("change",function(){X(t);let r=j(4);return q(r.setPlausibility(r.selectedItem()));}),P(55,"option",45),N(56,"Plausibility?"),S(),P(57,"option",45),N(58,"Projected"),S(),P(59,"option",45),N(60,"Probable"),S(),P(61,"option",45),N(62,"Plausible"),S(),P(63,"option",45),N(64,"Possible"),S(),P(65,"option",45),N(66,"Preposterous"),S()()()(),P(67,"div",107)(68,"h3"),N(69,"Metadata"),S(),P(70,"div",108),ze(71,_L,4,3,"label",109,tL),S()(),P(73,"div",110)(74,"p",111),N(75,"Regenerate AI fields from the current edits."),S(),P(76,"button",112),Z("click",function(){X(t);let r=j(4);return q(r.regenerateAiFieldsFromUserInput());}),N(77," \u267B\uFE0F Regenerate AI fields "),S()()(),P(78,"div",113)(79,"button",114),Z("click",function(){X(t);let r=j(4);return q(r.selectedItem()._private_moderation===0?r.unarchive(r.selectedItem()._id):r.approve(r.selectedItem()._id));}),ge(80,vL,4,0)(81,yL,1,0)(82,CL,1,0),S()()()()();}if(n&2){let t=j(4);I(7),ct("data-status",t.LEVELS[t.selectedItem()._private_moderation]),I(2),K("title",t.getEmail(t.selectedItem())),I(),he(t.selectedItem().author_id&&t.selectedItem().author_id!=="unknown"?10:11),I(5),K("ngModel",t.selectedItem()._private_moderation),I(),je(t.STATUS_OPTIONS),I(5),Ve(t.formatDate(t.selectedItem().created_at)),I(),Se("active",t.selectedItem()._private_moderation===5),I(),vt(" ",t.selectedItem()._private_moderation===5?"\u2605":"\u2606"," "),I(),ct("data-confidence",t.getConfidenceLevel(t.selectedItem())),I(),vt(" AI: ",t.getAIConfidence(t.selectedItem()),"% "),I(5),he(t.editTagline()===t.selectedItem()._id?30:31),I(4),he(t.selectedItem().tags&&t.selectedItem().tags.length>0?34:-1),I(6),mr("desirability-select "+t.getDesirabilityClass(t.selectedItem().favorable_future)),Qe("ngModel",t.selectedItem().favorable_future),I(),K("value",null),I(13),mr("plausibility-select "+t.getPlausibilityClass(t.selectedItem().plausibility)),Qe("ngModel",t.selectedItem().plausibility),I(),K("value",null),I(2),K("value",100),I(2),K("value",75),I(2),K("value",50),I(2),K("value",25),I(2),K("value",0),I(6),je(t.editableMetadata()),I(8),Se("published",t.selectedItem()._private_moderation>=4)("archived",t.selectedItem()._private_moderation===0),ct("aria-label",t.selectedItem()._private_moderation===0?"Unarchive":t.selectedItem()._private_moderation>=4?"Published":"Publish"),I(),he(t.selectedItem()._private_moderation===0?80:t.selectedItem()._private_moderation>=4?81:82);}}function xL(n,e){if(n&1){let t=ve();P(0,"div",30),Z("click",function(){X(t);let r=j(3);return q(r.closeSidebar());}),P(1,"div",31)(2,"div",32),Z("click",function(r){return X(t),q(r.stopPropagation());}),P(3,"button",33),Z("click",function(){X(t);let r=j(3);return q(r.closeSidebar());}),N(4,"\xD7"),S(),P(5,"button",34),Z("click",function(){X(t);let r=j(3);return q(r.toggleLightboxSidebar());}),N(6,"\u22EE"),S(),P(7,"button",35),Z("click",function(){X(t);let r=j(3);return q(r.prevItem());}),N(8,"\u2190"),S(),P(9,"button",36),Z("click",function(){X(t);let r=j(3);return q(r.nextItem());}),N(10,"\u2192"),S(),P(11,"div",37)(12,"button",38),Z("click",function(r){let o;X(t);let s=j(3);return r.stopPropagation(),q(s.openImageReplacementModal((o=s.selectedItem())==null?null:o._id));}),N(13," \u270E Replace "),S(),P(14,"button",39),Z("click",function(r){let o;X(t);let s=j(3);return r.stopPropagation(),q(s.openQrModal((o=s.selectedItem())==null?null:o._id));}),N(15," \u{1F4F1} QR "),S()(),P(16,"div",40)(17,"div",41)(18,"div",42)(19,"label",43),N(20,"Screenshot Type"),S(),P(21,"select",44),tt("ngModelChange",function(r){X(t);let o=j(3);return et(o.selectedItem().screenshot_type,r)||(o.selectedItem().screenshot_type=r),q(r);}),Z("change",function(){X(t);let r=j(3);return q(r.autoSaveScreenshotType(r.selectedItem()));}),P(22,"option",45),N(23,"Select type..."),S(),P(24,"option",46),N(25,"\u{1FAA7} Sign"),S(),P(26,"option",47),N(27,"\u{1F4E3} Social"),S(),P(28,"option",48),N(29,"\u{1F4AC} Chat"),S(),P(30,"option",49),N(31,"\u{1F514} Alert"),S(),P(32,"option",50),N(33,"\u{1F916} AI"),S(),P(34,"option",51),N(35,"\u2B50 Review"),S(),P(36,"option",52),N(37,"\u{1F5FA}\uFE0F Map"),S(),P(38,"option",53),N(39,"\u{1F4F8} Photo"),S()()(),P(40,"div",54)(41,"label",55),N(42,"Content"),S(),P(43,"textarea",56),tt("ngModelChange",function(r){X(t);let o=j(3);return et(o.selectedItem().content,r)||(o.selectedItem().content=r),q(r);}),Z("change",function(){X(t);let r=j(3);return q(r.autoSaveContent(r.selectedItem()));}),S()(),P(44,"div",57)(45,"div",58)(46,"div",59)(47,"input",60),tt("ngModelChange",function(r){X(t);let o=j(3);return et(o.selectedItem().transition_bar_event,r)||(o.selectedItem().transition_bar_event=r),q(r);}),Z("change",function(){X(t);let r=j(3);return q(r.autoSaveTransitionBarEvent(r.selectedItem()));}),S()(),P(48,"div",61),ge(49,sL,12,3),S()()()(),P(50,"div",62),te(51,"img",63),P(52,"div",64),ze(53,aL,1,12,"span",65,jt),S()()(),P(55,"div",66),N(56),S()(),ge(57,bL,83,31,"aside",67),S()();}if(n&2){let t=j(3);I(),Se("sidebar-open",t.lightboxSidebarOpen()),I(6),K("disabled",t.selectedItemIndex()<=0),I(2),K("disabled",t.selectedItemIndex()>=t.items().length-1),I(12),Qe("ngModel",t.selectedItem().screenshot_type),I(),K("value",null),I(21),Qe("ngModel",t.selectedItem().content),I(4),Qe("ngModel",t.selectedItem().transition_bar_event),K("placeholder",t.selectedItem().transition_bar_event?"":"unclear"),I(2),he(t.selectedItem().transition_bar_event&&t.selectedItem().transition_bar_event!=="unclear"?49:-1),I(2),K("src",t.selectedItem().screenshot_url,Ue),I(),ct("aria-label",t.getIndicatorLabel(t.selectedItem())),I(),je(t.Array(9)),I(3),Sc("",t.selectedItemIndex()+1," / ",t.items().length,""),I(),he(t.lightboxSidebarOpen()?57:-1);}}function PL(n,e){if(n&1){let t=ve();P(0,"label",130)(1,"input",136),Z("click",function(r){return X(t),q(r.stopPropagation());})("change",function(){X(t);let r=j().$implicit,o=j(3);return q(o.toggleItemSelection(r._id));}),S()();}if(n&2){let t=j().$implicit,i=j(3);I(),K("checked",i.isItemSelected(t._id));}}function wL(n,e){if(n&1&&te(0,"span",72),n&2){let t=e.$index,i=j().$implicit,r=j(3);Se("active",r.getIndicatorSlot(i)===t+1)("prefer",r.isPreferDirection(i))("prevent",r.isPreventDirection(i))("neutral",r.isNeutralDirection(i))("mostly-prefer",r.isMostlyPrefer(i))("mostly-prevent",r.isMostlyPrevent(i));}}function ML(n,e){if(n&1){let t=ve();P(0,"div",129),Z("click",function(){let r=X(t).$implicit,o=j(3);return q(o.selectItem(r));}),ge(1,PL,2,1,"label",130),P(2,"div",131),te(3,"img",132),P(4,"div",64),ze(5,wL,1,12,"span",65,jt),S(),P(7,"div",133)(8,"button",134),Z("click",function(r){let o=X(t).$implicit,s=j(3);return r.stopPropagation(),q(s.openImageReplacementModal(o._id));}),N(9," \u270E "),S(),P(10,"button",135),Z("click",function(r){let o=X(t).$implicit,s=j(3);return r.stopPropagation(),q(s.openQrModal(o._id));}),N(11," QR "),S()()()();}if(n&2){let t,i=e.$implicit,r=j(3);Se("selected",((t=r.selectedItem())==null?null:t._id)===i._id)("select-mode",r.multiSelectMode())("bulk-selected",r.isItemSelected(i._id)),ct("data-status",r.LEVELS[i._private_moderation]),I(),he(r.multiSelectMode()?1:-1),I(2),K("src",i.screenshot_url,Ue),I(),ct("aria-label",r.getIndicatorLabel(i)),I(),je(r.Array(9));}}function SL(n,e){if(n&1){let t=ve();P(0,"app-image-replacement-modal",137),Z("closed",function(){X(t);let r=j(3);return q(r.closeImageReplacementModal());})("imageReplaced",function(r){X(t);let o=j(3);return q(o.onImageReplaced(o.replacingImageItemId(),r));}),S();}if(n&2){let t=j(3);K("workspaceId",t.workspaceId())("apiKey",t.apiKey())("itemId",t.replacingImageItemId())("currentImageUrl",t.currentReplacingImageUrl());}}function EL(n,e){if(n&1){let t=ve();P(0,"app-qr-code-modal",138),Z("closed",function(){X(t);let r=j(3);return q(r.closeQrModal());}),S();}if(n&2){let t=j(3);K("workspaceId",t.workspaceId())("apiKey",t.apiKey())("itemId",t.qrItemId());}}function OL(n,e){if(n&1&&(P(0,"div",23),ge(1,xL,58,15,"div",25),P(2,"div",26),ze(3,ML,12,10,"div",27,Gx),ge(5,SL,1,4,"app-image-replacement-modal",28)(6,EL,1,3,"app-qr-code-modal",29),S()()),n&2){let t=j(2);I(),he(t.selectedItem()?1:-1),I(2),je(t.items()),I(2),he(t.replacingImageItemId()&&t.currentReplacingImageUrl()&&t.workspaceId()&&t.apiKey()?5:-1),I(),he(t.showQRModal()&&t.qrItemId()&&t.workspaceId()&&t.apiKey()?6:-1);}}function TL(n,e){if(n&1){let t=ve();P(0,"label",130)(1,"input",144),Z("change",function(){X(t);let r=j().$implicit,o=j(3);return q(o.toggleItemSelection(r._id));}),S()();}if(n&2){let t=j().$implicit,i=j(3);I(),K("checked",i.isItemSelected(t._id));}}function kL(n,e){if(n&1&&(P(0,"span",80),N(1),S()),n&2){let t=j().$implicit,i=j(3);I(),vt("",i.getUserItemCount(t.author_id)," items");}}function IL(n,e){if(n&1&&(P(0,"span",80),N(1),S()),n&2){let t=j(4);I(),vt("",t.getUserItemCount("unknown")," unattributed");}}function AL(n,e){if(n&1&&te(0,"span",72),n&2){let t=e.$index,i=j(2).$implicit,r=j(3);Se("active",r.getIndicatorSlot(i)===t+1)("prefer",r.isPreferDirection(i))("prevent",r.isPreventDirection(i))("neutral",r.isNeutralDirection(i))("mostly-prefer",r.isMostlyPrefer(i))("mostly-prevent",r.isMostlyPrevent(i));}}function FL(n,e){if(n&1){let t=ve();P(0,"div",145),te(1,"img",132),P(2,"div",64),ze(3,AL,1,12,"span",65,jt),S(),P(5,"div",146)(6,"button",147),Z("click",function(){X(t);let r=j().$implicit,o=j(3);return q(o.openImageReplacementModal(r._id));}),N(7," \u270E Replace "),S(),P(8,"button",39),Z("click",function(){X(t);let r=j().$implicit,o=j(3);return q(o.openQrModal(r._id));}),N(9," \u{1F4F1} QR "),S()()(),P(10,"button",148),Z("click",function(){X(t);let r=j().$implicit,o=j(3);return q(o.toggleDescriptionView(r._id));}),N(11," \u2139\uFE0F "),S();}if(n&2){let t=j().$implicit,i=j(3);I(),K("src",t.screenshot_url,Ue),I(),ct("aria-label",i.getIndicatorLabel(t)),I(),je(i.Array(9));}}function RL(n,e){if(n&1){let t=ve();P(0,"div",149)(1,"div",152)(2,"label"),N(3,"Content"),S(),P(4,"textarea",153),tt("ngModelChange",function(r){X(t);let o=j(2).$implicit;return et(o.content,r)||(o.content=r),q(r);}),S()(),P(5,"div",152)(6,"label"),N(7,"Description"),S(),P(8,"textarea",154),tt("ngModelChange",function(r){X(t);let o=j(2).$implicit;return et(o.future_scenario_description,r)||(o.future_scenario_description=r),q(r);}),S()(),P(9,"div",116)(10,"button",117),Z("click",function(){X(t);let r=j(2).$implicit,o=j(3);return q(o.setDescription(r));}),N(11,"\u2713"),S(),P(12,"button",118),Z("click",function(){X(t);let r=j(5);return q(r.editDescription.set(null));}),N(13,"\u2715"),S()()();}if(n&2){let t=j(2).$implicit;I(4),Qe("ngModel",t.content),I(4),Qe("ngModel",t.future_scenario_description);}}function LL(n,e){if(n&1&&(P(0,"div",157)(1,"strong"),N(2,"Content:"),S(),P(3,"p"),N(4),S()()),n&2){let t=j(4).$implicit;I(4),Ve(t.content);}}function DL(n,e){if(n&1&&(P(0,"div",157)(1,"strong"),N(2,"Description:"),S(),P(3,"p"),N(4),S()()),n&2){let t=j(4).$implicit;I(4),Ve(t.future_scenario_description);}}function NL(n,e){if(n&1&&ge(0,LL,5,1,"div",157)(1,DL,5,1,"div",157),n&2){let t=j(3).$implicit;he(t.content?0:-1),I(),he(t.future_scenario_description?1:-1);}}function BL(n,e){n&1&&(P(0,"p",156),N(1,"+ Add content and description"),S());}function VL(n,e){if(n&1){let t=ve();P(0,"div",155),Z("click",function(){X(t);let r=j(2).$implicit,o=j(3);return q(o.editDescription.set(r._id));}),ge(1,NL,2,2)(2,BL,2,0,"p",156),S();}if(n&2){let t=j(2).$implicit;I(),he(t.content||t.future_scenario_description?1:2);}}function zL(n,e){if(n&1){let t=ve();ge(0,RL,14,2,"div",149)(1,VL,3,1,"div",150),P(2,"button",151),Z("click",function(){X(t);let r=j().$implicit,o=j(3);return q(o.toggleDescriptionView(r._id));}),N(3," \u{1F5BC}\uFE0F "),S();}if(n&2){let t=j().$implicit,i=j(3);he(i.editDescription()===t._id?0:1);}}function jL(n,e){if(n&1){let t=ve();P(0,"div",93)(1,"textarea",115),tt("ngModelChange",function(r){X(t);let o=j().$implicit;return et(o.future_scenario_tagline,r)||(o.future_scenario_tagline=r),q(r);}),S(),P(2,"div",116)(3,"button",117),Z("click",function(){X(t);let r=j().$implicit,o=j(3);return q(o.setTagline(r));}),N(4,"\u2713"),S(),P(5,"button",118),Z("click",function(){X(t);let r=j(4);return q(r.editTagline.set(null));}),N(6,"\u2715"),S()()();}if(n&2){let t=j().$implicit;I(),Qe("ngModel",t.future_scenario_tagline);}}function $L(n,e){if(n&1){let t=ve();P(0,"div",121),Z("click",function(){X(t);let r=j(2).$implicit,o=j(3);return q(o.editTagline.set(r._id));}),N(1),S();}if(n&2){let t=j(2).$implicit;I(),vt(" ",t.future_scenario_tagline," ");}}function UL(n,e){if(n&1){let t=ve();P(0,"div",122),Z("click",function(){X(t);let r=j(2).$implicit,o=j(3);return q(o.editTagline.set(r._id));}),N(1," + Add tagline "),S();}}function HL(n,e){if(n&1&&ge(0,$L,2,1,"div",119)(1,UL,2,0,"div",120),n&2){let t=j().$implicit;he(t.future_scenario_tagline?0:1);}}function WL(n,e){if(n&1){let t=ve();P(0,"span",123),N(1),P(2,"button",124),Z("click",function(){let r=X(t).$index,o=j(2).$implicit,s=j(3);return q(s.removeTag(o,r));}),N(3,"\xD7"),S()();}if(n&2){let t=e.$implicit;I(),vt(" ",t," ");}}function GL(n,e){if(n&1&&ze(0,WL,4,1,"span",123,jt),n&2){let t=j().$implicit;je(t.tags);}}function YL(n,e){n&1&&(P(0,"span",127),N(1,"ARCHIVED \u{1F5D1}\uFE0F"),S(),P(2,"span",128),N(3,"UNARCHIVE"),S());}function XL(n,e){n&1&&N(0," PUBLISHED \u2713 ");}function qL(n,e){n&1&&N(0," PUBLISH ");}function ZL(n,e){if(n&1){let t=ve();P(0,"article",140)(1,"div",78),ge(2,TL,2,1,"label",130),P(3,"button",79),Z("click",function(){let r=X(t).$implicit,o=j(3);return q(o.filterByUser(r.author_id));}),ge(4,kL,2,1,"span",80)(5,IL,2,1,"span",80),S(),P(6,"span",141),N(7),S()(),P(8,"div",142),ge(9,FL,12,2)(10,zL,4,1),S(),P(11,"div",85)(12,"div",86)(13,"span",87),N(14),S(),P(15,"button",88),Z("click",function(){let r=X(t).$implicit,o=j(3);return q(o.highlight(r._id));}),N(16),S(),P(17,"span",89),N(18),S(),P(19,"button",90),Z("click",function(){let r=X(t).$implicit,o=j(3);return q(o.reject(r._id));}),N(20," \u{1F5D1}\uFE0F "),S()()(),P(21,"div",91)(22,"div",92),ge(23,jL,7,1,"div",93)(24,HL,2,1),S(),P(25,"div",94)(26,"div",95),ge(27,GL,2,0),P(28,"div",96)(29,"input",97,0),Z("keydown.enter",function(){let r=X(t).$implicit,o=$i(30),s=j(3);return q(s.addTag(r,o));}),S()()()(),P(31,"div",98)(32,"div",99)(33,"select",100),tt("ngModelChange",function(r){let o=X(t).$implicit;return et(o.favorable_future,r)||(o.favorable_future=r),q(r);}),Z("change",function(){let r=X(t).$implicit,o=j(3);return q(o.setFavorable(r));}),P(34,"option",45),N(35,"Desirability?"),S(),P(36,"option",101),N(37,"prefer"),S(),P(38,"option",102),N(39,"prefer-ish"),S(),P(40,"option",103),N(41,"uncertain"),S(),P(42,"option",104),N(43,"prevent-ish"),S(),P(44,"option",105),N(45,"prevent"),S()()(),P(46,"div",99)(47,"select",106),tt("ngModelChange",function(r){let o=X(t).$implicit;return et(o.plausibility,r)||(o.plausibility=r),q(r);}),Z("change",function(){let r=X(t).$implicit,o=j(3);return q(o.setPlausibility(r));}),P(48,"option",45),N(49,"Plausibility?"),S(),P(50,"option",45),N(51,"Projected"),S(),P(52,"option",45),N(53,"Probable"),S(),P(54,"option",45),N(55,"Plausible"),S(),P(56,"option",45),N(57,"Possible"),S(),P(58,"option",45),N(59,"Preposterous"),S()()()()(),P(60,"div",143)(61,"button",114),Z("click",function(){let r=X(t).$implicit,o=j(3);return q(r._private_moderation===0?o.unarchive(r._id):o.approve(r._id));}),ge(62,YL,4,0)(63,XL,1,0)(64,qL,1,0),S()()();}if(n&2){let t=e.$implicit,i=j(3);Se("select-mode",i.multiSelectMode())("bulk-selected",i.isItemSelected(t._id)),ct("data-status",i.LEVELS[t._private_moderation]),I(2),he(i.multiSelectMode()?2:-1),I(),K("title",i.getEmail(t)),I(),he(t.author_id&&t.author_id!=="unknown"?4:5),I(2),K("title",t.screenshot_type||"screenshot"),I(),Ve(i.getScreenshotTypeEmoji(t.screenshot_type)),I(2),he(i.isShowingDescription(t._id)?10:9),I(5),Ve(i.formatDate(t.created_at)),I(),Se("active",t._private_moderation===5),I(),vt(" ",t._private_moderation===5?"\u2605":"\u2606"," "),I(),ct("data-confidence",i.getConfidenceLevel(t)),I(),vt(" AI: ",i.getAIConfidence(t),"% "),I(5),he(i.editTagline()===t._id?23:24),I(4),he(t.tags&&t.tags.length>0?27:-1),I(6),mr("desirability-select "+i.getDesirabilityClass(t.favorable_future)),Qe("ngModel",t.favorable_future),I(),K("value",null),I(13),mr("plausibility-select "+i.getPlausibilityClass(t.plausibility)),Qe("ngModel",t.plausibility),I(),K("value",null),I(2),K("value",100),I(2),K("value",75),I(2),K("value",50),I(2),K("value",25),I(2),K("value",0),I(3),Se("published",t._private_moderation>=4)("archived",t._private_moderation===0),ct("aria-label",t._private_moderation===0?"Unarchive":t._private_moderation>=4?"Published":"Publish"),I(),he(t._private_moderation===0?62:t._private_moderation>=4?63:64);}}function KL(n,e){if(n&1&&(P(0,"div",24),ze(1,ZL,65,38,"article",139,Gx),S()),n&2){let t=j(2);I(),je(t.items());}}function JL(n,e){if(n&1&&ge(0,OL,7,3,"div",23)(1,KL,3,0,"div",24),n&2){let t=j();he(t.viewMode()==="grid"?0:1);}}function QL(n,e){if(n&1&&(P(0,"div",166),N(1),S()),n&2){let t=j(2);I(),Ve(t.bulkError());}}function e3(n,e){n&1&&(P(0,"div",167),N(1,"Applying changes..."),S());}function t3(n,e){if(n&1){let t=ve();P(0,"div",18)(1,"div",158)(2,"strong"),N(3),S(),N(4," selected "),P(5,"button",159),Z("click",function(){X(t);let r=j();return q(r.selectAll());}),N(6,"Select all"),S()(),P(7,"div",160)(8,"label"),N(9," Status "),P(10,"select",161),Z("ngModelChange",function(r){X(t);let o=j();return q(o.bulkStatus.set(r));}),P(11,"option",84),N(12,"No change"),S(),P(13,"option",84),N(14,"Rejected"),S(),P(15,"option",84),N(16,"Flagged"),S(),P(17,"option",84),N(18,"Pending"),S(),P(19,"option",84),N(20,"Not Flagged"),S(),P(21,"option",84),N(22,"Approved"),S(),P(23,"option",84),N(24,"Highlighted"),S()()(),P(25,"label"),N(26," Author "),P(27,"input",162),Z("ngModelChange",function(r){X(t);let o=j();return q(o.bulkAuthor.set(r||""));}),S()(),P(28,"label"),N(29," Plausibility "),P(30,"select",161),Z("ngModelChange",function(r){X(t);let o=j();return q(o.bulkPlausibility.set(o.parseNumber(r)));}),P(31,"option",84),N(32,"No change"),S(),P(33,"option",84),N(34,"Projected (100)"),S(),P(35,"option",84),N(36,"Probable (75)"),S(),P(37,"option",84),N(38,"Plausible (50)"),S(),P(39,"option",84),N(40,"Possible (25)"),S(),P(41,"option",84),N(42,"Preposterous (0)"),S()()(),P(43,"label"),N(44," Favorable future "),P(45,"select",161),Z("ngModelChange",function(r){X(t);let o=j();return q(o.bulkFavorable.set(r||null));}),P(46,"option",84),N(47,"No change"),S(),P(48,"option",101),N(49,"prefer"),S(),P(50,"option",102),N(51,"mostly prefer"),S(),P(52,"option",103),N(53,"uncertain"),S(),P(54,"option",104),N(55,"mostly prevent"),S(),P(56,"option",105),N(57,"prevent"),S()()(),P(58,"label"),N(59," Type "),P(60,"select",161),Z("ngModelChange",function(r){X(t);let o=j();return q(o.bulkType.set(r||null));}),P(61,"option",84),N(62,"No change"),S(),P(63,"option",46),N(64,"Sign"),S(),P(65,"option",47),N(66,"Social"),S(),P(67,"option",48),N(68,"Chat"),S(),P(69,"option",49),N(70,"Alert"),S(),P(71,"option",50),N(72,"AI"),S(),P(73,"option",51),N(74,"Review"),S(),P(75,"option",52),N(76,"Map"),S(),P(77,"option",53),N(78,"Photo"),S()()()(),P(79,"div",163)(80,"button",164),Z("click",function(){X(t);let r=j();return q(r.applyBulkChanges());}),N(81,"Apply to selected"),S(),P(82,"button",165),Z("click",function(){X(t);let r=j();return q(r.clearBulkSelection());}),N(83,"Clear selection"),S(),P(84,"button",165),Z("click",function(){X(t);let r=j();return q(r.toggleMultiSelectMode());}),N(85,"Exit"),S()(),ge(86,QL,2,1,"div",166)(87,e3,2,0,"div",167),S();}if(n&2){let t=j();I(3),Ve(t.selectedCount()),I(2),K("disabled",t.items().length===0),I(5),K("ngModel",t.bulkStatus()),I(),K("ngValue",null),I(2),K("ngValue",0),I(2),K("ngValue",1),I(2),K("ngValue",2),I(2),K("ngValue",3),I(2),K("ngValue",4),I(2),K("ngValue",5),I(4),K("ngModel",t.bulkAuthor()),I(3),K("ngModel",t.bulkPlausibility()),I(),K("ngValue",null),I(2),K("ngValue",100),I(2),K("ngValue",75),I(2),K("ngValue",50),I(2),K("ngValue",25),I(2),K("ngValue",0),I(4),K("ngModel",t.bulkFavorable()),I(),K("ngValue",null),I(14),K("ngModel",t.bulkType()),I(),K("ngValue",null),I(19),K("disabled",t.bulkSaving()||t.selectedCount()===0),I(2),K("disabled",t.bulkSaving()),I(2),K("disabled",t.bulkSaving()),I(2),he(t.bulkError()?86:-1),I(),he(t.bulkSaving()?87:-1);}}var yu=class n{constructor(e,t){this.route=e;this.api=t;if(typeof window<"u"&&window.location.hash){let i=window.location.hash.substring(1);if(i){let r=new URLSearchParams(i),o=r.get("status");if(o){let m=kn.parseHashParam(o),_;m.included.length>0?_=m.included:_=kn.ALL_STATUSES.filter(y=>!m.excluded.includes(y)),this.filterStatus.set(_);}let s=r.get("author");s&&this.filterAuthor.set(s);let l=r.get("preference");if(l){let m=l.split(",");this.filterPreference.set(m);}let c=r.get("potential");if(c){let m=c.split(",");this.filterPotential.set(m);}let d=r.get("type");d&&this.filterType.set(d);let u=r.get("search");if(u){let m=u.replace(/\+/g," ");this.searchText.set(m);}let g=r.get("order");g&&this.orderBy.set(g);let f=r.get("view");(f==="grid"||f==="list")&&this.viewMode.set(f);}}this.route.queryParams.subscribe(i=>{this.apiKey.set(i.api_key||null),this.workspaceId.set(i.workspace||this.workspaceId());}),this.route.fragment.subscribe(i=>{if(i){let r=new URLSearchParams(i),o=r.get("status");if(o){let u=kn.parseHashParam(o),g;u.included.length>0?g=u.included:g=kn.ALL_STATUSES.filter(f=>!u.excluded.includes(f)),this.filterStatus.set(g);}else this.filterStatus.set(kn.DEFAULT_STATUSES);this.filterAuthor.set(r.get("author")||"all");let s=r.get("preference");this.filterPreference.set(s?s.split(","):[...this.preferenceOptions]);let l=r.get("potential");this.filterPotential.set(l?l.split(","):[...this.potentialOptions]),this.filterType.set(r.get("type")||"all");let c=r.get("search");this.searchText.set(c?c.replace(/\+/g," "):""),this.orderBy.set(r.get("order")||"date");let d=r.get("view");(d==="grid"||d==="list")&&this.viewMode.set(d);}}),at(()=>{let i=this.workspaceId(),r=this.apiKey(),o=this.page();i&&r&&this.api.getItems(i,r,o,"").subscribe(s=>{if(s["index-required"])this.indexLink.set(s["index-required"]||null),this.allFetchedItems.set([]);else{this.indexLink.set(null),s=s.filter(d=>!!d?.screenshot_url),s.forEach(d=>{d.screenshot_url=this.fix_url(d.screenshot_url),d.favorable_future=this.fix_favorable_future(d.favorable_future);let u=d.tags||[],g=[];d.future_scenario_topics&&(typeof d.future_scenario_topics=="object"&&!Array.isArray(d.future_scenario_topics)?g.push(...Object.values(d.future_scenario_topics).filter(m=>m)):Array.isArray(d.future_scenario_topics)&&(g=d.future_scenario_topics));let f=[...new Set([...u,...g])];d.tags=f,d.future_scenario_topics=g;});let l=this.allFetchedItems(),c=s.filter(d=>!l.find(u=>u._id===d._id));this.allFetchedItems.set([...l,...c]);}});}),at(()=>{let i=this.workspaceId(),r=this.apiKey();i&&r&&this.api.getWorkspace(i,r).subscribe(o=>{this.workspace.set(o);});}),at(()=>{this.filterState(),this.updateHashParams();});}Array=Array;FILTERS=[{name:"highlighted",filter:"metadata._private_moderation == 5"},{name:"approved",filter:"metadata._private_moderation == 4"},{name:"not-flagged",filter:"metadata._private_moderation == 3"},{name:"pending",filter:"metadata._private_moderation == 2"},{name:"flagged",filter:"metadata._private_moderation == 1"},{name:"rejected",filter:"metadata._private_moderation == 0"},{name:"all",filter:""}];workspaceId=G(null);workspace=G({});apiKey=G(null);page=G(0);filterStatus=G(kn.DEFAULT_STATUSES);filterAuthor=G("all");preferenceOptions=["prefer","mostly prefer","uncertain","mostly prevent","prevent","none"];potentialOptions=["100","75","50","25","0","none"];filterPreference=G([...this.preferenceOptions]);filterPotential=G([...this.potentialOptions]);filterType=G("all");searchText=G("");orderBy=G("date");filterCountsData=_e(()=>this.filterService.calculateFilterCounts(this.allFetchedItems()));statusCounts=_e(()=>this.filterCountsData().status);authorCounts=_e(()=>this.filterCountsData().author);preferenceCounts=_e(()=>this.filterCountsData().preference);potentialCounts=_e(()=>this.filterCountsData().potential);typeCounts=_e(()=>this.filterCountsData().type);editTagline=G(null);editDescription=G(null);editTags=G(null);newTag=G("");showDescription=G(new Set());userItemCounts=_e(()=>{let e=this.allFetchedItems(),t=new Map();return e.forEach(i=>{let r=i.author_id||"unknown";t.set(r,(t.get(r)||0)+1);}),t;});allItemsForCounting=G([]);allFetchedItems=G([]);viewMode=G("grid");selectedItem=G(null);lightboxSidebarOpen=G(!0);selectedItemIndex=G(-1);multiSelectMode=G(!1);selectedIds=G(new Set());bulkStatus=G(null);bulkAuthor=G("");bulkPlausibility=G(null);bulkFavorable=G(null);bulkType=G(null);bulkSaving=G(!1);bulkError=G(null);filteredItems=_e(()=>this.filterService.applyFilters(this.allFetchedItems(),this.filterState()));items=_e(()=>this.filterService.sortItems(this.filteredItems(),this.orderBy(),this.userItemCounts()));indexLink=G(null);preferSlotMap=new Map([[0,1],[25,2],[50,3],[75,4],[100,5]]);preventSlotMap=new Map([[100,5],[75,6],[50,7],[25,8],[0,9]]);plausibilityLabelMap={100:"projected",75:"probable",50:"plausible",25:"possible",0:"preposterous"};replacingImageItemId=G(null);currentReplacingImageUrl=_e(()=>{let e=this.replacingImageItemId();if(!e)return null;let t=this.selectedItem()&&this.selectedItem()._id===e?this.selectedItem():null,i=this.items().find(o=>o._id===e)||null;return(t||i)?.screenshot_url||null;});showQRModal=G(!1);qrItemId=G(null);LEVELS=["banned","flagged","pending","not-flagged","approved","highlighted"];STATUS_OPTIONS=[{label:"Highlighted",value:5},{label:"Approved",value:4},{label:"Not flagged",value:3},{label:"Pending",value:2},{label:"Flagged",value:1},{label:"Rejected",value:0}];editableMetadata=_e(()=>{let e=this.selectedItem();if(!e)return[];let t=new Set(["_id"]);return Object.entries(e).filter(([i,r])=>!t.has(i)&&["string","number","boolean"].includes(typeof r));});filterService=zt(gu);updateModeration(e,t){let i=this.workspaceId(),r=this.apiKey();i&&r?this.api.updateItemModeration(i,r,e,t).subscribe(o=>{this.allFetchedItems.set(this.allFetchedItems().filter(s=>s._id!==e));}):console.error("workspaceId or apiKey is null");}reject(e){this.updateModeration(e,0);}approve(e){this.updateModeration(e,4);}highlight(e){this.updateModeration(e,5);}unarchive(e){this.updateModeration(e,2);}setStatusFromSidebar(e){let t=this.workspaceId(),i=this.apiKey(),r=this.selectedItem();!t||!i||!r||this.api.updateItemModeration(t,i,r._id,e).subscribe({next:()=>{this.allFetchedItems.update(o=>o.map(s=>s._id===r._id?se(D({},s),{_private_moderation:e}):s)),this.selectedItem.update(o=>o&&se(D({},o),{_private_moderation:e}));},error:o=>console.error("Error updating status",o)});}updateHashParams(){let e=new URLSearchParams(),t=this.filterStatus(),i=kn.ALL_STATUSES.filter(o=>!t.includes(o));if(!kn.isDefaultStatusFilter(t)){let o=kn.encodeHashParam(t,i);o&&e.set("status",o);}this.filterAuthor()!=="all"&&e.set("author",this.filterAuthor()),this.filterPreference().length>0&&this.filterPreference().length<this.preferenceOptions.length&&e.set("preference",this.filterPreference().join(",")),this.filterPotential().length>0&&this.filterPotential().length<this.potentialOptions.length&&e.set("potential",this.filterPotential().join(",")),this.filterType()!=="all"&&e.set("type",this.filterType()),this.searchText()&&e.set("search",this.searchText().replace(/ /g,"+")),this.orderBy()!=="date"&&e.set("order",this.orderBy()),e.set("view",this.viewMode());let r=e.toString();typeof window<"u"&&(window.location.hash=r);}clearAllFilters(){this.filterStatus.set(kn.DEFAULT_STATUSES),this.filterAuthor.set("all"),this.filterPreference.set([...this.preferenceOptions]),this.filterPotential.set([...this.potentialOptions]),this.filterType.set("all"),this.searchText.set(""),this.page.set(0),this.allFetchedItems.set([]);}getAuthorsSortedByCount(){let e=this.authorCounts();return Array.from(e.keys()).sort((i,r)=>i==="unknown"?1:r==="unknown"?-1:(e.get(r)||0)-(e.get(i)||0));}getCount(e,t){return e.get(t)||0;}getTruncatedAuthorId(e){return!e||e==="unknown"?"unknown":e.substring(0,8);}updateMetadataField(e,t){let i=this.workspaceId(),r=this.apiKey(),o=this.selectedItem();if(!i||!r||!o)return;let s=o[e],l=this.coerceValue(s,t);this.api.updateItem(i,r,o._id,{[e]:l}).subscribe({next:()=>{this.allFetchedItems.update(c=>c.map(d=>d._id===o._id?se(D({},d),{[e]:l}):d)),this.selectedItem.update(c=>c&&se(D({},c),{[e]:l}));},error:c=>console.error("Error updating field",e,c)});}coerceValue(e,t){if(typeof e=="number"){let i=Number(t);return Number.isNaN(i)?e:i;}return typeof e=="boolean"?t===!0||t==="true":t;}getEmail(e){return e._private_email||e.email||e.user_email||"unknown@user.com";}getScreenshotTypeEmoji(e){return{sign_in_a_demonstration:"\u{1FAA7}",social_media_post:"\u{1F4E3}",chat_conversation:"\u{1F4AC}",notification_alert:"\u{1F514}",ai_agent_query:"\u{1F916}",review:"\u2B50",map_visualization:"\u{1F5FA}\uFE0F",photograph:"\u{1F4F8}"}[e]||"\u2753";}filterByUser(e){!e||e==="unknown"?this.filterAuthor.set("unattributed"):this.filterAuthor.set(e);}getUserItemCount(e){return this.userItemCounts().get(e)||0;}getAIConfidence(e){let t=e.content_certainty||0,i=e.transition_bar_certainty||0;return Math.round((t+i)/2);}getConfidenceLevel(e){let t=this.getAIConfidence(e);return t>=80?"high":t>=50?"medium":"low";}getDesirabilityClass(e){return e?e.includes("prefer")?"prefer":e.includes("prevent")?"prevent":"uncertain":"";}getPlausibilityClass(e){return e?e>=75?"high":e>=25?"medium":"low":"";}getIndicatorSlot(e){if(!e)return null;let t=Number(e.plausibility);if(!Number.isFinite(t))return null;let i=this.normalizeDirection(e.favorable_future);return i==="prefer"||i==="mostly-prefer"?this.preferSlotMap.get(t)??null:i==="prevent"||i==="mostly-prevent"?this.preventSlotMap.get(t)??null:null;}getIndicatorLabel(e){if(!e)return"No score";let t=Number(e.plausibility),i=this.plausibilityLabelMap[t],r=this.normalizeDirection(e.favorable_future);if(!i)return"No plausibility score";switch(r){case"prefer":return`prefer ${i}`;case"mostly-prefer":return`mostly prefer ${i}`;case"prevent":return`prevent ${i}`;case"mostly-prevent":return`mostly prevent ${i}`;default:return`uncertain ${i}`;}}isPreferDirection(e){let t=this.normalizeDirection(e?.favorable_future);return t==="prefer"||t==="mostly-prefer";}isPreventDirection(e){let t=this.normalizeDirection(e?.favorable_future);return t==="prevent"||t==="mostly-prevent";}isMostlyPrefer(e){return this.normalizeDirection(e?.favorable_future)==="mostly-prefer";}isMostlyPrevent(e){return this.normalizeDirection(e?.favorable_future)==="mostly-prevent";}isNeutralDirection(e){return this.normalizeDirection(e?.favorable_future)==="uncertain";}normalizeDirection(e){let t=(e||"").toLowerCase();return t==="prefer"?"prefer":t==="mostly prefer"?"mostly-prefer":t==="mostly prevent"?"mostly-prevent":t==="prevent"?"prevent":"uncertain";}formatDate(e){if(!e)return"N/A";let t=new Date(e),i=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getFullYear()).slice(-2),s=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return`${i}.${r}.${o} ${s}:${l}`;}fix_url(e){return e=e.replace("https://storage.googleapis.com/chronomaps3.firebasestorage.app/","https://storage.googleapis.com/chronomaps3-eu/"),e;}fix_favorable_future(e){return e?(e=e.replace("preferred","prefer"),e==="yes"?"prefer":e==="no"?"prevent":e):"uncertain";}setPlausibility(e){let t=this.workspaceId(),i=this.apiKey();t&&i?(e.plausibility=parseInt(e.plausibility,10),this.api.updateItem(t,i,e._id,{plausibility:e.plausibility}).subscribe(r=>{console.log("item updated",r);})):console.error("workspaceId or apiKey is null");}setFavorable(e){let t=this.workspaceId(),i=this.apiKey();t&&i?this.api.updateItem(t,i,e._id,{favorable_future:e.favorable_future}).subscribe(r=>{console.log("item updated",r);}):console.error("workspaceId or apiKey is null");}setTagline(e){let t=this.workspaceId(),i=this.apiKey();if(t&&i){let r={future_scenario_tagline:e.future_scenario_tagline,future_scenario_description:e.future_scenario_tagline,embedding:null,future_scenario_topics:null};this.api.updateItem(t,i,e._id,r).subscribe(o=>{console.log("item updated, re-analysis triggered",o),this.editTagline.set(null);});}}setDescription(e){let t=this.workspaceId(),i=this.apiKey();if(t&&i){let r={content:e.content,future_scenario_description:e.future_scenario_description,embedding:null,future_scenario_topics:null};this.api.updateItem(t,i,e._id,r).subscribe(o=>{console.log("item content and description updated, re-analysis triggered",o),this.editDescription.set(null);});}}toggleDescriptionView(e){let t=this.showDescription(),i=new Set(t);i.has(e)?i.delete(e):i.add(e),this.showDescription.set(i);}isShowingDescription(e){return this.showDescription().has(e);}removeTag(e,t){e.tags=e.tags.filter((i,r)=>r!==t),this.setTags(e);}addTag(e,t){let i=t.value.trim();i&&!e.tags.includes(i)&&(e.tags=[...(e.tags||[]),i],this.setTags(e),t.value="");}setTags(e){let t=this.workspaceId(),i=this.apiKey();if(t&&i){let r={tags:e.tags,future_scenario_topics:e.future_scenario_topics};this.api.updateItem(t,i,e._id,r).subscribe(o=>{console.log("tags updated, re-analysis triggered",o);});}}toggleViewMode(){let e=this.viewMode()==="list"?"grid":"list";this.viewMode.set(e),e==="list"&&this.selectedItem.set(null);}selectItem(e){if(this.multiSelectMode()){this.toggleItemSelection(e._id);return;}this.selectedItem.set(e);let t=this.items().findIndex(i=>i._id===e._id);this.selectedItemIndex.set(t),this.lightboxSidebarOpen.set(!0),typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"});}closeSidebar(){let e=this.selectedItem();this.selectedItem.set(null),this.lightboxSidebarOpen.set(!1);}nextItem(){let e=this.selectedItem(),t=this.selectedItemIndex();t<this.items().length-1&&this.selectItem(this.items()[t+1]);}prevItem(){let e=this.selectedItem(),t=this.selectedItemIndex();t>0&&this.selectItem(this.items()[t-1]);}regenerateAiFieldsFromUserInput(){let e=this.workspaceId(),t=this.apiKey(),i=this.selectedItem();if(!e||!t||!i)return;let r=Array.isArray(i.tags)&&i.tags.length?(()=>{let s={};return i.tags.forEach((l,c)=>{typeof l=="string"&&l&&(s[`topic_${c+1}`]=l);}),s;})():i.future_scenario_topics||null,o={content_title:i.content_title||null,future_scenario_description:i.future_scenario_description||null,future_scenario_tagline:i.future_scenario_tagline||null,future_scenario_topics:r,embedding:null,content_certainty:null,transition_bar_certainty:null,transition_bar_event_prediction:null};this.api.updateItem(e,t,i._id,o).subscribe({next:()=>{this.allFetchedItems.update(s=>s.map(l=>l._id===i._id?D(D({},l),o):l)),this.selectedItem.update(s=>s&&D(D({},s),o));},error:s=>console.error("Error regenerating AI fields",s)});}toggleLightboxSidebar(){this.lightboxSidebarOpen.update(e=>!e);}autoSaveScreenshotType(e){let t=this.workspaceId(),i=this.apiKey();t&&i&&this.api.updateItem(t,i,e._id,{screenshot_type:e.screenshot_type}).subscribe(r=>console.log("screenshot_type updated",r),r=>console.error("Error updating screenshot_type",r));}autoSaveContent(e){let t=this.workspaceId(),i=this.apiKey();t&&i&&this.api.updateItem(t,i,e._id,{content:e.content}).subscribe(r=>console.log("content updated",r),r=>console.error("Error updating content",r));}autoSaveTransitionBarEvent(e){let t=this.workspaceId(),i=this.apiKey();t&&i&&this.api.updateItem(t,i,e._id,{transition_bar_event:e.transition_bar_event||null}).subscribe(r=>console.log("transition_bar_event updated",r),r=>console.error("Error updating transition_bar_event",r));}autoSaveTransitionBarPosition(e){let t=this.workspaceId(),i=this.apiKey();t&&i&&this.api.updateItem(t,i,e._id,{transition_bar_position:e.transition_bar_position||null}).subscribe(r=>console.log("transition_bar_position updated",r),r=>console.error("Error updating transition_bar_position",r));}toggleMultiSelectMode(){let e=!this.multiSelectMode();this.multiSelectMode.set(e),e?(this.selectedItem.set(null),this.selectedItemIndex.set(-1)):this.clearBulkSelection();}isItemSelected(e){return this.selectedIds().has(e);}toggleItemSelection(e){let t=new Set(this.selectedIds());t.has(e)?t.delete(e):t.add(e),this.selectedIds.set(t);}selectedCount(){return this.selectedIds()?.size||0;}getSingleSelectedId(){return this.selectedIds()?.size!==1?null:Array.from(this.selectedIds())[0]??null;}selectAll(){let e=new Set(this.items().map(t=>t._id));this.selectedIds.set(e);}clearBulkSelection(){this.selectedIds.set(new Set()),this.resetBulkFields(),this.bulkSaving.set(!1),this.bulkError.set(null);}resetBulkFields(){this.bulkStatus.set(null),this.bulkAuthor.set(""),this.bulkPlausibility.set(null),this.bulkFavorable.set(null),this.bulkType.set(null);}applyBulkChanges(){return J(this,null,function*(){let e=Array.from(this.selectedIds());if(!e.length){this.bulkError.set("Select at least one item.");return;}let t=this.workspaceId(),i=this.apiKey();if(!t||!i){this.bulkError.set("Workspace ID and API key are required.");return;}let r={},o=this.bulkStatus(),s=o?this.statusToModeration(o):null;if(s!==null&&(r._private_moderation=s),this.bulkAuthor()&&(r.author_id=this.bulkAuthor()),this.bulkPlausibility()!==null&&(r.plausibility=this.bulkPlausibility()),this.bulkFavorable()&&(r.favorable_future=this.bulkFavorable()),this.bulkType()&&(r.screenshot_type=this.bulkType()),Object.keys(r).length===0){this.bulkError.set("Choose at least one field to update.");return;}this.bulkSaving.set(!0),this.bulkError.set(null);let c=(yield Promise.all(e.map(u=>J(this,null,function*(){try{return yield d0(this.api.updateItem(t,i,u,r)),{id:u,ok:!0};}catch(g){return{id:u,ok:!1,error:g};}})))).filter(u=>!u.ok);c.length&&this.bulkError.set(`Failed to update ${c.length} item(s).`);let d=u=>u.map(g=>e.includes(g._id)?D(D({},g),r):g);this.allFetchedItems.set(d(this.allFetchedItems())),this.bulkSaving.set(!1),this.clearBulkSelection();});}statusToModeration(e){return e??null;}parseNumber(e){if(e==null||e==="")return null;let t=Number(e);return Number.isNaN(t)?null:t;}filterState=_e(()=>({status:this.filterStatus(),author:this.filterAuthor(),preference:this.filterPreference(),potential:this.filterPotential(),type:this.filterType(),search:this.searchText(),orderBy:this.orderBy(),view:this.viewMode()}));filterCounts=_e(()=>({status:this.statusCounts(),author:this.authorCounts(),preference:this.preferenceCounts(),potential:this.potentialCounts(),type:this.typeCounts()}));onFiltersChange(e){this.filterStatus.set(e.status),this.filterAuthor.set(e.author),this.filterPreference.set(e.preference),this.filterPotential.set(e.potential),this.filterType.set(e.type),this.searchText.set(e.search),this.orderBy.set(e.orderBy),e.view&&this.viewMode.set(e.view);}onFiltersCommit(e){this.onFiltersChange(e);}openImageReplacementModal(e){this.replacingImageItemId.set(e);}closeImageReplacementModal(){this.replacingImageItemId.set(null);}onImageReplaced(e,t){let i=t.screenshot_url;this.allFetchedItems.update(r=>r.map(o=>o._id===e?se(D({},o),{screenshot_url:i}):o)),this.selectedItem()&&this.selectedItem()._id===e&&this.selectedItem.update(r=>r&&se(D({},r),{screenshot_url:i})),this.replacingImageItemId.set(null);}onRefreshGrid(){this.allFetchedItems.set([]),this.page.set(0);}openQrModal(e){this.qrItemId.set(e),this.showQRModal.set(!0);}closeQrModal(){this.showQRModal.set(!1),this.qrItemId.set(null);}static fac=function(t){return new(t||n)(ue(Ct),ue(cr));};static cmp=Me({type:n,selectors:[["app-moderate"]],decls:26,vars:13,consts:[["tagInput",""],[1,"moderate-container"],["role","banner",1,"topbar"],[1,"brand"],["aria-hidden","true",1,"logo"],[1,"workspace-name"],[1,"actions"],[1,"cred-inline"],["type","text","placeholder","workspace","aria-label","Workspace ID",3,"ngModelChange","ngModel"],["type","text","placeholder","api key","aria-label","API key",3,"ngModelChange","ngModel"],["href","/admin","aria-label","Back to admin",1,"back-link"],[1,"filters-bar-row"],[3,"filtersChange","filtersCommit","counts","totalCount","filteredCount","showViewToggle","initialState"],["aria-label","Toggle multi-edit mode",1,"multi-select-toggle",3,"click"],[1,"icon"],[1,"multi-select-count"],["aria-label","Pagination",1,"pagination-section"],["role","alert",1,"index-notice"],["role","region","aria-label","Bulk edit panel",1,"bulk-bar"],["aria-label","Previous page",1,"pagination-btn",3,"click","disabled"],[1,"page-info"],["aria-label","Next page",1,"pagination-btn",3,"click","disabled"],["target","_blank",1,"index-link",3,"href"],[1,"grid-layout"],["role","list",1,"items-grid"],["role","dialog","aria-modal","true","aria-labelledby","lightbox-title",1,"lightbox-overlay"],["role","list",1,"thumbnails-grid"],["role","button","tabindex","0",1,"thumbnail-item",3,"selected","select-mode","bulk-selected"],[3,"workspaceId","apiKey","itemId","currentImageUrl"],[3,"workspaceId","apiKey","itemId"],["role","dialog","aria-modal","true","aria-labelledby","lightbox-title",1,"lightbox-overlay",3,"click"],[1,"lightbox-container"],[1,"lightbox-content",3,"click"],["aria-label","Close lightbox",1,"lightbox-close-btn",3,"click"],["aria-label","Toggle sidebar",1,"lightbox-sidebar-toggle-btn",3,"click"],["aria-label","Previous item",1,"nav-btn","nav-prev",3,"click","disabled"],["aria-label","Next item",1,"nav-btn","nav-next",3,"click","disabled"],[1,"lightbox-actions"],["aria-label","Replace image from lightbox",1,"image-action-btn",3,"click"],["aria-label","Open scanner QR for this image",1,"image-action-btn","ghost",3,"click"],[1,"lightbox-main"],[1,"lightbox-info-boxes"],[1,"info-box","info-box-screenshot-type"],["for","screenshot-type"],["id","screenshot-type","aria-label","Select screenshot type",3,"ngModelChange","change","ngModel"],[3,"value"],["value","sign_in_a_demonstration"],["value","social_media_post"],["value","chat_conversation"],["value","notification_alert"],["value","ai_agent_query"],["value","review"],["value","map_visualization"],["value","photograph"],[1,"info-box","info-box-content"],["for","content-input"],["id","content-input","placeholder","Enter content...","aria-label","Edit content",3,"ngModelChange","change","ngModel"],[1,"info-box","info-box-transition"],[1,"transition-content"],[1,"transition-event-input"],["id","transition-event","type","text","aria-label","Edit transition event",3,"ngModelChange","change","ngModel","placeholder"],[1,"radio-group-inline"],[1,"lightbox-image-container"],["alt","Future scenario screenshot","id","lightbox-title",3,"src"],["role","img",1,"plausibility-scale"],[1,"scale-dot",3,"active","prefer","prevent","neutral","mostly-prefer","mostly-prevent"],[1,"lightbox-counter"],["role","complementary",1,"lightbox-sidebar"],[1,"radio-label"],["type","radio","name","position","value","before","aria-label","Before",3,"ngModelChange","change","ngModel"],["type","radio","name","position","value","during","aria-label","During",3,"ngModelChange","change","ngModel"],["type","radio","name","position","value","after","aria-label","After",3,"ngModelChange","change","ngModel"],[1,"scale-dot"],["role","complementary",1,"lightbox-sidebar",3,"click"],[1,"sidebar-header"],["aria-label","Close sidebar",1,"close-sidebar-btn",3,"click"],[1,"sidebar-content"],[1,"item-card"],[1,"card-header"],[1,"user-info",3,"click","title"],[1,"user-count-link"],[1,"status-row"],["for","status-select"],["id","status-select","aria-label","Set item status",3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"card-metadata"],[1,"metadata-row"],[1,"date"],["aria-label","Highlight",1,"icon-btn","star-btn",3,"click"],[1,"ai-confidence"],["aria-label","Archive",1,"icon-btn","trash-btn",3,"click"],[1,"card-content"],[1,"tagline-section"],[1,"tagline-edit"],[1,"tags-section"],[1,"tags-container"],[1,"tag-input-wrapper"],["type","text","placeholder","+ Add tag","aria-label","Add new tag",1,"tag-input",3,"keydown.enter"],[1,"properties-selectors"],[1,"property-selector"],["aria-label","Set desirability",3,"ngModelChange","change","ngModel"],["value","prefer"],["value","mostly prefer"],["value","uncertain"],["value","mostly prevent"],["value","prevent"],["aria-label","Set plausibility",3,"ngModelChange","change","ngModel"],[1,"metadata-editor"],[1,"metadata-grid"],[1,"metadata-field"],[1,"ai-regenerate"],[1,"ai-regenerate-help"],["aria-label","Regenerate AI generated fields from current values",1,"regenerate-btn",3,"click"],[1,"card-footer","pinned-footer"],[1,"publish-btn",3,"click"],["placeholder","Enter tagline","rows","3","aria-label","Edit tagline",3,"ngModelChange","ngModel"],[1,"edit-actions"],["aria-label","Save",1,"btn-icon","btn-save",3,"click"],["aria-label","Cancel",1,"btn-icon","btn-cancel",3,"click"],["role","button","tabindex","0",1,"tagline"],["role","button","tabindex","0",1,"tagline","tagline-empty"],["role","button","tabindex","0",1,"tagline",3,"click"],["role","button","tabindex","0",1,"tagline","tagline-empty",3,"click"],[1,"tag"],["aria-label","Remove tag",1,"tag-remove",3,"click"],[1,"field-name"],["type","text",3,"ngModelChange","ngModel"],[1,"btn-default"],[1,"btn-hover"],["role","button","tabindex","0",1,"thumbnail-item",3,"click"],[1,"select-checkbox"],[1,"thumbnail-image"],["alt","Future scenario screenshot",3,"src"],[1,"thumbnail-actions"],["aria-label","Replace image",1,"thumb-btn",3,"click"],["aria-label","Open scanner QR for this image",1,"thumb-btn","ghost",3,"click"],["type","checkbox","aria-label","Select item for bulk edit",3,"click","change","checked"],[3,"closed","imageReplaced","workspaceId","apiKey","itemId","currentImageUrl"],[3,"closed","workspaceId","apiKey","itemId"],["role","listitem",1,"item-card",3,"select-mode","bulk-selected"],["role","listitem",1,"item-card"],[1,"screenshot-type",3,"title"],[1,"screenshot-container"],[1,"card-footer"],["type","checkbox","aria-label","Select item for bulk edit",3,"change","checked"],[1,"screenshot-image-wrapper"],[1,"screenshot-actions"],["aria-label","Replace image",1,"image-action-btn",3,"click"],["aria-label","Show description",1,"toggle-view-btn",3,"click"],[1,"description-edit"],["role","button","tabindex","0",1,"description-view"],["aria-label","Show image",1,"toggle-view-btn",3,"click"],[1,"field-group"],["placeholder","Enter content","rows","4","aria-label","Edit content",3,"ngModelChange","ngModel"],["placeholder","Enter description","rows","4","aria-label","Edit description",3,"ngModelChange","ngModel"],["role","button","tabindex","0",1,"description-view",3,"click"],[1,"description-empty"],[1,"field-display"],[1,"bulk-summary"],["aria-label","Select all items",1,"select-all-btn",3,"click","disabled"],[1,"bulk-controls"],[3,"ngModelChange","ngModel"],["type","text","placeholder","author id",3,"ngModelChange","ngModel"],[1,"bulk-actions"],[1,"bulk-btn",3,"click","disabled"],[1,"bulk-btn","ghost",3,"click","disabled"],[1,"bulk-error"],[1,"bulk-progress"]],template:function(t,i){if(t&1&&(P(0,"div",1)(1,"header",2)(2,"div",3)(3,"span",4),N(4,"\u2726"),S(),P(5,"h1"),N(6,"Content Moderation"),S(),ge(7,nL,2,1,"span",5),S(),P(8,"div",6)(9,"div",7)(10,"input",8),Z("ngModelChange",function(o){return i.workspaceId.set(o||null);}),S(),P(11,"input",9),Z("ngModelChange",function(o){return i.apiKey.set(o||null);}),S()(),P(12,"a",10),N(13,"\u2190 Back"),S()()(),P(14,"div",11)(15,"app-filters-bar",12),Z("filtersChange",function(o){return i.onFiltersChange(o);})("filtersCommit",function(o){return i.onFiltersCommit(o);}),S(),P(16,"button",13),Z("click",function(){return i.toggleMultiSelectMode();}),P(17,"span",14),N(18,"\u{1F5C2}"),S(),P(19,"span"),N(20),S(),ge(21,iL,2,1,"span",15),S()(),ge(22,rL,7,3,"section",16)(23,oL,5,1,"div",17)(24,JL,2,1)(25,t3,88,27,"div",18),S()),t&2){let r,o,s;I(7),he((r=i.workspace())!=null&&r.source?7:-1),I(3),K("ngModel",(o=i.workspaceId())!==null&&o!==void 0?o:""),I(),K("ngModel",(s=i.apiKey())!==null&&s!==void 0?s:""),I(4),K("counts",i.filterCounts())("totalCount",i.allFetchedItems().length)("filteredCount",i.items().length)("showViewToggle",!0)("initialState",i.filterState()),I(5),Ve(i.multiSelectMode()?"Close multi-edit":"Multi-edit"),I(),he(i.multiSelectMode()&&i.selectedCount()>0?21:-1),I(),he(i.items().length>=500||i.page()>0?22:-1),I(),he(i.indexLink()?23:24),I(2),he(i.multiSelectMode()?25:-1);}},dependencies:[on,Tc,kc,Hi,Oc,H0,On,Tn,G0,_u,vu,ri],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 8px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
[_nghost-%COMP%] {
  display: flex;
  flex-flow: column;
  align-items: stretch;
  width: 100%;
  height: 100%;
  overflow: auto;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.moderate-container[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  gap: 12px;
  padding: 12px;
  max-width: 1400px;
  margin: 0 auto;
  width: 100%;
}
.topbar[_ngcontent-%COMP%] {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 0;
  border-bottom: 1px solid rgba(78, 2, 178, 0.2);
}
.topbar[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 8px;
}
.topbar[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%] {
  background: #E7CBFF;
  color: #4E02B2;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
}
.topbar[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%] {
  color: #4E02B2;
  margin: 0;
  font-size: 20px;
  font-weight: 700;
}
.topbar[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   .workspace-name[_ngcontent-%COMP%] {
  color: #9B90AA;
  font-size: 16px;
  font-weight: 400;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 10px;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .cred-inline[_ngcontent-%COMP%] {
  display: flex;
  gap: 8px;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .cred-inline[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {
  padding: 6px 10px;
  border: 1px solid #F1E5F3;
  border-radius: 8px;
  font-size: 13px;
  min-width: 140px;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .cred-inline[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus {
  outline: 2px solid #B969FF;
  outline-offset: 1px;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%] {
  color: #4E02B2;
  text-decoration: none;
  font-weight: 600;
  transition: color 0.2s;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%]:hover {
  color: #B969FF;
}
.filters-bar[_ngcontent-%COMP%] {
  margin-bottom: 8px;
  background: #FFFFFF;
  border: 1px solid #F1E5F3;
  border-radius: 10px;
  padding: 12px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%] {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: flex-end;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 110px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  font-size: 10px;
  font-weight: 700;
  color: #4E02B2;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] {
  padding: 6px 10px;
  border: 1px solid #F1E5F3;
  border-radius: 8px;
  background: #FFFFFF;
  color: #6C707B;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1 1l4 4 4-4' stroke='%238A3FFC' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 32px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #4E02B2;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover {
  border-color: #B969FF;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%] {
  position: relative;
  min-width: 180px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-container[_ngcontent-%COMP%] {
  position: relative;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-trigger[_ngcontent-%COMP%] {
  width: 100%;
  padding: 6px 10px;
  border: 1px solid #F1E5F3;
  border-radius: 8px;
  background: #FFFFFF;
  color: #6C707B;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  text-align: left;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-trigger[_ngcontent-%COMP%]:hover {
  border-color: #B969FF;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-trigger[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #4E02B2;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-trigger[_ngcontent-%COMP%]   .multiselect-label[_ngcontent-%COMP%] {
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-trigger[_ngcontent-%COMP%]   .multiselect-arrow[_ngcontent-%COMP%] {
  font-size: 10px;
  color: #9B90AA;
  flex-shrink: 0;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-dropdown[_ngcontent-%COMP%] {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  right: 0;
  background: #FFFFFF;
  border: 1px solid #F1E5F3;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 1000;
  max-height: 280px;
  overflow-y: auto;
  padding: 4px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-dropdown[_ngcontent-%COMP%]   .multiselect-option[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.15s;
  font-size: 13px;
  color: #6C707B;
  -webkit-user-select: none;
  user-select: none;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-dropdown[_ngcontent-%COMP%]   .multiselect-option[_ngcontent-%COMP%]:hover {
  background: #FBF5F6;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-dropdown[_ngcontent-%COMP%]   .multiselect-option[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] {
  width: 16px;
  height: 16px;
  cursor: pointer;
  flex-shrink: 0;
  accent-color: #4E02B2;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-dropdown[_ngcontent-%COMP%]   .multiselect-option[_ngcontent-%COMP%]   .option-label[_ngcontent-%COMP%] {
  flex: 1;
  font-weight: 500;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.custom-multiselect[_ngcontent-%COMP%]   .multiselect-dropdown[_ngcontent-%COMP%]   .multiselect-option[_ngcontent-%COMP%]   .option-count[_ngcontent-%COMP%] {
  font-size: 12px;
  color: #9B90AA;
  font-weight: 600;
  background: #FBF5F6;
  padding: 2px 6px;
  border-radius: 4px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.search-group[_ngcontent-%COMP%] {
  flex: 1;
  min-width: 160px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.search-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {
  padding: 6px 10px;
  border: 1px solid #F1E5F3;
  border-radius: 8px;
  background: #FFFFFF;
  color: #6C707B;
  font-size: 13px;
  font-weight: 500;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.search-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #4E02B2;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-group.search-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder {
  color: #9B90AA;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-info[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 8px;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-info[_ngcontent-%COMP%]   .count-display[_ngcontent-%COMP%] {
  color: #6C707B;
  font-size: 13px;
  font-weight: 600;
  white-space: nowrap;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-info[_ngcontent-%COMP%]   .view-toggle-btn[_ngcontent-%COMP%] {
  padding: 6px 10px;
  border: 1px solid #F1E5F3;
  border-radius: 8px;
  background: #FFFFFF;
  color: #4E02B2;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 44px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-info[_ngcontent-%COMP%]   .view-toggle-btn[_ngcontent-%COMP%]:hover {
  background: #4E02B2;
  color: #FFFFFF;
  border-color: #4E02B2;
}
.filters-bar[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filter-info[_ngcontent-%COMP%]   .view-toggle-btn[_ngcontent-%COMP%]:focus {
  outline: 2px solid #B969FF;
  outline-offset: 2px;
}
.pagination-section[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  margin-bottom: 24px;
}
.pagination-section[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%] {
  padding: 8px 16px;
  border-radius: 16px;
  border: 2px solid #F1E5F3;
  background: #FFFFFF;
  color: #4E02B2;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}
.pagination-section[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]:hover:not(:disabled) {
  background: #E7CBFF;
  border-color: #B969FF;
}
.pagination-section[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}
.pagination-section[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%] {
  color: #4E02B2;
  font-size: 16px;
  font-weight: 700;
  min-width: 80px;
  text-align: center;
}
.index-notice[_ngcontent-%COMP%] {
  background: #fff3cd;
  border: 1px solid #ffc107;
  border-radius: 16px;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}
.index-notice[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {
  color: #856404;
  font-weight: 600;
}
.index-notice[_ngcontent-%COMP%]   .index-link[_ngcontent-%COMP%] {
  color: #0056b3;
  font-weight: 600;
  text-decoration: underline;
}
.index-notice[_ngcontent-%COMP%]   .index-link[_ngcontent-%COMP%]:hover {
  color: #003d82;
}
.items-grid[_ngcontent-%COMP%] {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  width: 100%;
}
.item-card[_ngcontent-%COMP%] {
  background: #FFFFFF;
  border: 2px solid #F1E5F3;
  border-radius: 16px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  transition: all 0.3s;
  max-width: 420px;
  margin: 0 auto;
}
.item-card[_ngcontent-%COMP%]:hover {
  box-shadow: 0 6px 20px rgba(78, 2, 178, 0.15);
  transform: translateY(-2px);
}
.item-card[data-status=highlighted][_ngcontent-%COMP%] {
  border: 3px solid #ffc107;
}
.item-card[data-status=approved][_ngcontent-%COMP%] {
  border-color: #698CFF;
}
.item-card[data-status=flagged][_ngcontent-%COMP%] {
  border-color: #F73C3C;
}
.item-card[data-status=banned][_ngcontent-%COMP%] {
  border: 1px dashed #301A4E;
  opacity: 0.5;
}
.item-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%] {
  padding: 12px 16px;
  background: #FBF5F6;
  border-bottom: 1px solid #F1E5F3;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}
.item-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .screenshot-type[_ngcontent-%COMP%] {
  font-size: 18px;
  cursor: help;
  margin-left: auto;
}
.item-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 6px;
  background: transparent;
  border: none;
  cursor: pointer;
  font-family: inherit;
  transition: color 0.2s;
}
.item-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]:hover {
  color: #4E02B2;
}
.item-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .user-count-link[_ngcontent-%COMP%] {
  font-size: 14px;
  color: #4E02B2;
  font-weight: 600;
  text-decoration: underline;
  text-decoration-style: dotted;
}
.item-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .user-count-link[_ngcontent-%COMP%]:hover {
  text-decoration-style: solid;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%] {
  width: 100%;
  min-height: 300px;
  max-height: 600px;
  overflow: hidden;
  background: #F5F0E7;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: auto;
  object-fit: contain;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%] {
  position: relative;
  width: 100%;
  height: 100%;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: auto;
  object-fit: contain;
  display: block;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%]   .screenshot-actions[_ngcontent-%COMP%] {
  position: absolute;
  top: 10px;
  right: 10px;
  display: flex;
  gap: 8px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%]   .screenshot-actions[_ngcontent-%COMP%]   .image-action-btn[_ngcontent-%COMP%] {
  padding: 8px 12px;
  border-radius: 20px;
  border: 1px solid #F1E5F3;
  background: rgba(255, 255, 255, 0.92);
  color: #301A4E;
  cursor: pointer;
  font-weight: 700;
  transition: all 0.2s;
  box-shadow: 0 2px 8px rgba(155, 144, 170, 0.25);
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%]   .screenshot-actions[_ngcontent-%COMP%]   .image-action-btn.ghost[_ngcontent-%COMP%] {
  background: rgba(78, 2, 178, 0.1);
  color: #4E02B2;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%]   .screenshot-actions[_ngcontent-%COMP%]   .image-action-btn[_ngcontent-%COMP%]:hover {
  background: #4E02B2;
  color: #fff;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(78, 2, 178, 0.3);
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%] {
  position: absolute;
  top: 12px;
  right: 6px;
  bottom: 12px;
  width: 20px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
  pointer-events: none;
  gap: 8px;
  z-index: 1;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot[_ngcontent-%COMP%] {
  width: 7px;
  height: 7px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .screenshot-image-wrapper[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active[_ngcontent-%COMP%] {
  width: 16px;
  height: 16px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .toggle-view-btn[_ngcontent-%COMP%] {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid #F1E5F3;
  border-radius: 50%;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .toggle-view-btn[_ngcontent-%COMP%]:hover {
  background: #FFFFFF;
  transform: scale(1.1);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-view[_ngcontent-%COMP%] {
  width: 100%;
  padding: 20px;
  cursor: pointer;
  overflow-y: auto;
  max-height: 600px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-view[_ngcontent-%COMP%]   .field-display[_ngcontent-%COMP%] {
  margin-bottom: 16px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-view[_ngcontent-%COMP%]   .field-display[_ngcontent-%COMP%]:last-child {
  margin-bottom: 0;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-view[_ngcontent-%COMP%]   .field-display[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%] {
  display: block;
  font-size: 12px;
  font-weight: 700;
  color: #6C707B;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 6px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-view[_ngcontent-%COMP%]   .field-display[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {
  margin: 0;
  font-size: 15px;
  line-height: 1.6;
  color: #6C707B;
  white-space: pre-wrap;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-view[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {
  margin: 0;
  font-size: 15px;
  line-height: 1.6;
  color: #6C707B;
  white-space: pre-wrap;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-view[_ngcontent-%COMP%]   .description-empty[_ngcontent-%COMP%] {
  color: #9B90AA;
  font-style: italic;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-view[_ngcontent-%COMP%]:hover {
  background: rgba(251, 245, 246, 0.5);
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%] {
  width: 100%;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  font-size: 12px;
  font-weight: 700;
  color: #6C707B;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {
  width: 100%;
  padding: 12px;
  border: 1px solid #F1E5F3;
  border-radius: 8px;
  font-family: inherit;
  font-size: 15px;
  line-height: 1.6;
  resize: vertical;
  min-height: 80px;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #4E02B2;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%] {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%] {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: none;
  cursor: pointer;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon.btn-save[_ngcontent-%COMP%] {
  background: #698CFF;
  color: #FFFFFF;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon.btn-save[_ngcontent-%COMP%]:hover {
  background: #3665ff;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon.btn-cancel[_ngcontent-%COMP%] {
  background: #9B90AA;
  color: #FFFFFF;
}
.item-card[_ngcontent-%COMP%]   .screenshot-container[_ngcontent-%COMP%]   .description-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon.btn-cancel[_ngcontent-%COMP%]:hover {
  background: #6C707B;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%] {
  padding: 12px 16px;
  border-bottom: 1px solid #F1E5F3;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 12px;
  justify-content: space-between;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%] {
  font-size: 14px;
  color: #6C707B;
  font-weight: 600;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%] {
  background: transparent;
  border: none;
  font-size: 20px;
  cursor: pointer;
  padding: 4px;
  transition: transform 0.2s;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:hover {
  transform: scale(1.1);
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .icon-btn.star-btn[_ngcontent-%COMP%] {
  color: #9B90AA;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .icon-btn.star-btn.active[_ngcontent-%COMP%] {
  color: gold;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .icon-btn.trash-btn[_ngcontent-%COMP%] {
  font-size: 18px;
  opacity: 0.6;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .icon-btn.trash-btn[_ngcontent-%COMP%]:hover {
  opacity: 1;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .ai-confidence[_ngcontent-%COMP%] {
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 700;
  margin-left: auto;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .ai-confidence[data-confidence=high][_ngcontent-%COMP%] {
  background: #e8f5e9;
  color: #2e7d32;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .ai-confidence[data-confidence=medium][_ngcontent-%COMP%] {
  background: #fff3cd;
  color: #856404;
}
.item-card[_ngcontent-%COMP%]   .card-metadata[_ngcontent-%COMP%]   .metadata-row[_ngcontent-%COMP%]   .ai-confidence[data-confidence=low][_ngcontent-%COMP%] {
  background: #f8d7da;
  color: #842029;
}
.item-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%] {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  flex: 1;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline[_ngcontent-%COMP%] {
  width: 100%;
  padding: 12px;
  text-align: left;
  font-weight: 600;
  font-size: 16px;
  line-height: 1.4;
  color: #4E02B2;
  cursor: pointer;
  border-radius: 8px;
  background: #FBF5F6;
  transition: all 0.2s;
  min-height: 60px;
  white-space: pre-wrap;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline[_ngcontent-%COMP%]:hover {
  background: #E7CBFF;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline.tagline-empty[_ngcontent-%COMP%] {
  color: #9B90AA;
  font-weight: 500;
  border: 2px dashed #F1E5F3;
  background: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline.tagline-empty[_ngcontent-%COMP%]:hover {
  border-color: #B969FF;
  color: #4E02B2;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {
  width: 100%;
  padding: 12px;
  border: 2px solid #F1E5F3;
  border-radius: 8px;
  font-size: 15px;
  color: #4E02B2;
  font-weight: 600;
  font-family: inherit;
  line-height: 1.4;
  resize: vertical;
  min-height: 80px;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #B969FF;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%] {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%] {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 18px;
  font-weight: 700;
  transition: all 0.2s;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon.btn-save[_ngcontent-%COMP%] {
  background: #698CFF;
  color: white;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon.btn-save[_ngcontent-%COMP%]:hover {
  background: #0030CC;
  transform: scale(1.05);
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon.btn-cancel[_ngcontent-%COMP%] {
  background: #EDECEC;
  color: #6C707B;
}
.item-card[_ngcontent-%COMP%]   .tagline-section[_ngcontent-%COMP%]   .tagline-edit[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .btn-icon.btn-cancel[_ngcontent-%COMP%]:hover {
  background: #F73C3C;
  color: white;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tags-container[_ngcontent-%COMP%] {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%] {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: #FFFFFF;
  border: 1px solid #F1E5F3;
  border-radius: 16px;
  font-size: 13px;
  color: #4E02B2;
  font-weight: 500;
  transition: all 0.2s;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]:hover {
  border-color: #4E02B2;
  background: #FBF5F6;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%] {
  background: transparent;
  border: none;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
  color: #9B90AA;
  padding: 0;
  margin-left: 2px;
  transition: color 0.2s;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]   .tag-remove[_ngcontent-%COMP%]:hover {
  color: #F73C3C;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tag-input-wrapper[_ngcontent-%COMP%] {
  display: inline-flex;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tag-input-wrapper[_ngcontent-%COMP%]   .tag-input[_ngcontent-%COMP%] {
  padding: 6px 12px;
  border: 1px dashed #F1E5F3;
  border-radius: 16px;
  font-size: 13px;
  background: transparent;
  color: #4E02B2;
  min-width: 100px;
  transition: all 0.2s;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tag-input-wrapper[_ngcontent-%COMP%]   .tag-input[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #4E02B2;
  border-style: solid;
  background: #FFFFFF;
}
.item-card[_ngcontent-%COMP%]   .tags-section[_ngcontent-%COMP%]   .tag-input-wrapper[_ngcontent-%COMP%]   .tag-input[_ngcontent-%COMP%]::placeholder {
  color: #9B90AA;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%] {
  width: 100%;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] {
  width: 100%;
  padding: 12px 16px;
  border-radius: 12px;
  border: 2px solid #F1E5F3;
  background: #FFFFFF;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%234E02B2' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  padding-right: 36px;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #B969FF;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%]   select.desirability-select.prefer[_ngcontent-%COMP%] {
  color: #0030CC;
  border-color: #698CFF;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%]   select.desirability-select.prevent[_ngcontent-%COMP%] {
  color: #B50F0F;
  border-color: #F73C3C;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%]   select.desirability-select.uncertain[_ngcontent-%COMP%] {
  color: #9B90AA;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%]   select.plausibility-select.high[_ngcontent-%COMP%] {
  color: #0030CC;
  border-color: #698CFF;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%]   select.plausibility-select.medium[_ngcontent-%COMP%] {
  color: #856404;
  border-color: #ffc107;
}
.item-card[_ngcontent-%COMP%]   .properties-selectors[_ngcontent-%COMP%]   .property-selector[_ngcontent-%COMP%]   select.plausibility-select.low[_ngcontent-%COMP%] {
  color: #B50F0F;
  border-color: #F73C3C;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%] {
  padding: 16px;
  background: #FBF5F6;
  border-top: 1px solid #F1E5F3;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn[_ngcontent-%COMP%] {
  width: 100%;
  padding: 16px;
  border-radius: 12px;
  border: none;
  background: #4E02B2;
  color: white;
  font-size: 16px;
  font-weight: 700;
  letter-spacing: 1px;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn[_ngcontent-%COMP%]:hover {
  background: #B969FF;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(78, 2, 178, 0.3);
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn.published[_ngcontent-%COMP%] {
  background: #698CFF;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn.published[_ngcontent-%COMP%]:hover {
  background: #0030CC;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn.archived[_ngcontent-%COMP%] {
  background: #9B90AA;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn.archived[_ngcontent-%COMP%]   .btn-default[_ngcontent-%COMP%] {
  display: block;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn.archived[_ngcontent-%COMP%]   .btn-hover[_ngcontent-%COMP%] {
  display: none;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn.archived[_ngcontent-%COMP%]:hover {
  background: #F73C3C;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn.archived[_ngcontent-%COMP%]:hover   .btn-default[_ngcontent-%COMP%] {
  display: none;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn.archived[_ngcontent-%COMP%]:hover   .btn-hover[_ngcontent-%COMP%] {
  display: block;
}
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn[_ngcontent-%COMP%]   .btn-default[_ngcontent-%COMP%], 
.item-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .publish-btn[_ngcontent-%COMP%]   .btn-hover[_ngcontent-%COMP%] {
  display: block;
}
.grid-layout[_ngcontent-%COMP%] {
  position: relative;
  display: flex;
  gap: 8px;
  align-items: flex-start;
  height: auto;
}
.lightbox-overlay[_ngcontent-%COMP%] {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(51, 50, 49, 0.75);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  animation: _ngcontent-%COMP%_fadeIn 0.2s ease-in-out;
}
@keyframes _ngcontent-%COMP%_fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
.lightbox-container[_ngcontent-%COMP%] {
  display: flex;
  gap: 20px;
  max-width: 95vw;
  max-height: 95vh;
  width: 100%;
  transition: transform 0.3s ease-in-out;
}
.lightbox-content[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 12px;
  position: relative;
  flex: 1;
}
.lightbox-close-btn[_ngcontent-%COMP%] {
  position: fixed;
  top: 32px;
  left: 32px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  background: #FFFFFF;
  color: #6C707B;
  font-size: 32px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  line-height: 1;
  padding: 0;
  font-weight: 300;
  z-index: 1001;
}
.lightbox-close-btn[_ngcontent-%COMP%]:hover {
  background: #F73C3C;
  color: #FFFFFF;
  transform: scale(1.1);
}
.lightbox-close-btn[_ngcontent-%COMP%]:focus {
  outline: 2px solid #B969FF;
  outline-offset: 2px;
}
.lightbox-sidebar-toggle-btn[_ngcontent-%COMP%] {
  position: fixed;
  top: 32px;
  right: 32px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  background: #FFFFFF;
  color: #4E02B2;
  font-size: 24px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  padding: 0;
  z-index: 1001;
}
.lightbox-sidebar-toggle-btn[_ngcontent-%COMP%]:hover {
  background: #4E02B2;
  color: #FFFFFF;
  transform: scale(1.1);
}
.lightbox-sidebar-toggle-btn[_ngcontent-%COMP%]:focus {
  outline: 2px solid #B969FF;
  outline-offset: 2px;
}
.lightbox-main[_ngcontent-%COMP%] {
  display: flex;
  gap: 24px;
  align-items: flex-start;
  justify-content: center;
  flex: 1;
  max-height: 75vh;
}
.lightbox-actions[_ngcontent-%COMP%] {
  position: fixed;
  top: 32px;
  right: 88px;
  display: flex;
  gap: 10px;
  z-index: 1001;
}
.lightbox-actions[_ngcontent-%COMP%]   .image-action-btn[_ngcontent-%COMP%] {
  padding: 10px 14px;
  border-radius: 24px;
  border: 1px solid #F1E5F3;
  background: rgba(255, 255, 255, 0.92);
  color: #301A4E;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 2px 10px rgba(155, 144, 170, 0.25);
  transition: all 0.2s;
}
.lightbox-actions[_ngcontent-%COMP%]   .image-action-btn.ghost[_ngcontent-%COMP%] {
  background: rgba(78, 2, 178, 0.1);
  color: #4E02B2;
}
.lightbox-actions[_ngcontent-%COMP%]   .image-action-btn[_ngcontent-%COMP%]:hover {
  background: #4E02B2;
  color: #fff;
  transform: translateY(-1px);
  box-shadow: 0 4px 14px rgba(78, 2, 178, 0.3);
}
.lightbox-image-section[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 16px;
  align-items: center;
  flex: 1;
}
.lightbox-image-container[_ngcontent-%COMP%] {
  max-width: 50vw;
  max-height: 75vh;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}
.lightbox-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  max-width: 100%;
  max-height: 70vh;
  object-fit: contain;
  border-radius: 8px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
}
.lightbox-image-container[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%] {
  top: 16px;
  right: 12px;
  bottom: 16px;
  width: 22px;
  gap: 10px;
}
.lightbox-image-container[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot[_ngcontent-%COMP%] {
  width: 8px;
  height: 8px;
}
.lightbox-image-container[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active[_ngcontent-%COMP%] {
  width: 18px;
  height: 18px;
}
.lightbox-info-boxes[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 25px;
  width: 370px;
  max-width: 370px;
  height: 600px;
  flex-shrink: 0;
}
.lightbox-info-boxes[_ngcontent-%COMP%]   .info-box[_ngcontent-%COMP%] {
  flex-shrink: 0;
}
.lightbox-info-boxes[_ngcontent-%COMP%]   .info-box.info-box-content[_ngcontent-%COMP%] {
  flex: 1;
  display: flex;
  flex-direction: column;
}
.lightbox-info-boxes[_ngcontent-%COMP%]   .info-box.info-box-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  flex-shrink: 0;
  margin-bottom: 4px;
}
.lightbox-info-boxes[_ngcontent-%COMP%]   .info-box.info-box-content[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {
  flex: 1;
  resize: none;
}
.lightbox-info-boxes[_ngcontent-%COMP%]   .info-box.info-box-screenshot-type[_ngcontent-%COMP%], 
.lightbox-info-boxes[_ngcontent-%COMP%]   .info-box.info-box-transition[_ngcontent-%COMP%] {
  height: 58px;
  justify-content: center;
  gap: 0;
}
.info-box[_ngcontent-%COMP%] {
  background: transparent;
  border-radius: 8px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  box-shadow: none;
  border: 1px solid #F1E5F3;
  box-sizing: border-box;
}
.info-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  font-size: 11px;
  font-weight: 700;
  color: #F1E5F3;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.info-box[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], 
.info-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], 
.info-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {
  font-family: "Source Sans Pro", sans-serif;
  font-size: 16px;
  line-height: 20px;
  padding: 0;
  border: none;
  border-radius: 0;
  background: transparent;
  color: #FFFFFF;
}
.info-box[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, 
.info-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, 
.info-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus {
  outline: none;
  border: none;
  box-shadow: none;
}
.info-box[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]::placeholder, 
.info-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder, 
.info-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::placeholder {
  color: #9B90AA;
  opacity: 0.5;
}
.info-box[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] {
  cursor: pointer;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='white' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0 center;
  padding-right: 24px;
}
.info-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {
  resize: none;
  min-height: auto;
}
.radio-group[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: row;
  gap: 48px;
  justify-content: center;
  margin-top: 8px;
}
.radio-group-inline[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: row;
  gap: 32px;
  align-items: center;
  position: absolute;
  bottom: -50px;
}
.radio-label[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  font-family: "Source Sans Pro", sans-serif;
  font-size: 14px;
  line-height: 18px;
  color: #6C707B;
}
.radio-label[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] {
  appearance: none;
  cursor: pointer;
  width: 16px;
  height: 16px;
  background: #0D001F;
  border: 1px solid #6C707B;
  border-radius: 8px;
  position: relative;
  margin: 0;
}
.radio-label[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked {
  border-color: #F1E5F3;
}
.radio-label[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked::after {
  content: "";
  position: absolute;
  width: 10px;
  height: 10px;
  background: #F1E5F3;
  border-radius: 8px;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
.radio-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {
  flex: none;
}
.radio-label[_ngcontent-%COMP%]:has(input:checked) {
  color: #F1E5F3;
}
.transition-content[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 16px;
  width: 100%;
  position: relative;
}
.transition-content[_ngcontent-%COMP%]   .transition-event-input[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  width: 100%;
}
.transition-content[_ngcontent-%COMP%]   .transition-event-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {
  width: 100%;
  min-width: 120px;
}
.transition-content[_ngcontent-%COMP%]   .transition-arrows[_ngcontent-%COMP%] {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
}
.transition-content[_ngcontent-%COMP%]   .radio-group-inline[_ngcontent-%COMP%] {
  flex: 1;
  justify-content: flex-end;
}
.radio-disabled[_ngcontent-%COMP%] {
  font-family: "Source Sans Pro", sans-serif;
  font-size: 14px;
  line-height: 18px;
  color: #6C707B;
  font-style: italic;
  text-align: center;
}
.nav-btn[_ngcontent-%COMP%] {
  position: fixed;
  top: 50%;
  transform: translateY(-50%);
  width: 44px;
  height: 44px;
  border-radius: 8px;
  border: 2px solid #FFFFFF;
  background: rgba(255, 255, 255, 0.2);
  color: #FFFFFF;
  font-size: 24px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  font-weight: 300;
  flex-shrink: 0;
  z-index: 1001;
}
.nav-btn.nav-prev[_ngcontent-%COMP%] {
  left: 32px;
}
.nav-btn.nav-next[_ngcontent-%COMP%] {
  right: 32px;
}
.nav-btn[_ngcontent-%COMP%]:hover:not(:disabled) {
  background: #FFFFFF;
  color: #6C707B;
  transform: translateY(-50%) scale(1.1);
}
.nav-btn[_ngcontent-%COMP%]:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}
.nav-btn[_ngcontent-%COMP%]:focus {
  outline: 2px solid #B969FF;
  outline-offset: 2px;
}
.lightbox-counter[_ngcontent-%COMP%] {
  position: fixed;
  bottom: 32px;
  left: 32px;
  color: #FFFFFF;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  z-index: 1001;
}
.lightbox-sidebar[_ngcontent-%COMP%] {
  width: 420px;
  height: 90vh;
  background: #FFFFFF;
  border-radius: 12px;
  border: 1px solid #F1E5F3;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
  animation: _ngcontent-%COMP%_slideIn 0.3s ease-in-out;
}
@keyframes _ngcontent-%COMP%_slideIn {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}
.lightbox-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%] {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid #F1E5F3;
  background: #FBF5F6;
}
.lightbox-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {
  margin: 0;
  font-size: 16px;
  font-weight: 700;
  color: #4E02B2;
}
.lightbox-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .close-sidebar-btn[_ngcontent-%COMP%] {
  background: none;
  border: none;
  font-size: 24px;
  color: #6C707B;
  cursor: pointer;
  padding: 4px;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  transition: all 0.2s;
  line-height: 1;
  font-weight: 300;
}
.lightbox-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .close-sidebar-btn[_ngcontent-%COMP%]:hover {
  background: #F73C3C;
  color: #FFFFFF;
}
.lightbox-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .close-sidebar-btn[_ngcontent-%COMP%]:focus {
  outline: 2px solid #B969FF;
  outline-offset: 2px;
}
.lightbox-sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%] {
  flex: 1;
  overflow-y: auto;
  padding: 12px;
}
.lightbox-sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%] {
  margin: 0;
  max-width: none;
  border: none;
  box-shadow: none;
}
.lightbox-sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]:hover {
  box-shadow: none;
  transform: none;
}
.thumbnails-grid[_ngcontent-%COMP%] {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(106px, 106px));
  gap: 4px;
  padding: 8px;
  background: #FBF5F6;
  border-radius: 16px;
  border: 1px solid #F1E5F3;
  align-content: start;
  justify-content: start;
}
.thumbnails-grid[_ngcontent-%COMP%]   .thumbnail-item.select-mode[_ngcontent-%COMP%] {
  position: relative;
  cursor: pointer;
  outline: 2px solid transparent;
  transition: outline-color 120ms ease, box-shadow 120ms ease;
}
.thumbnails-grid[_ngcontent-%COMP%]   .thumbnail-item.bulk-selected[_ngcontent-%COMP%] {
  outline-color: #4E02B2;
  box-shadow: 0 0 0 3px rgba(78, 2, 178, 0.25);
}
.thumbnails-grid[_ngcontent-%COMP%]   .thumbnail-item[_ngcontent-%COMP%]   .select-checkbox[_ngcontent-%COMP%], 
.thumbnails-grid[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   .select-checkbox[_ngcontent-%COMP%] {
  position: absolute;
  top: 8px;
  left: 8px;
  background: rgba(255, 255, 255, 0.95);
  border: 1px solid #F1E5F3;
  border-radius: 6px;
  padding: 4px 6px;
  z-index: 2;
  box-shadow: 0 2px 6px rgba(155, 144, 170, 0.25);
}
.thumbnails-grid[_ngcontent-%COMP%]   .item-card.select-mode[_ngcontent-%COMP%] {
  position: relative;
}
.thumbnails-grid[_ngcontent-%COMP%]   .item-card.bulk-selected[_ngcontent-%COMP%] {
  border-color: #4E02B2;
  box-shadow: 0 0 0 3px rgba(78, 2, 178, 0.25);
}
.filters-bar-row[_ngcontent-%COMP%] {
  display: flex;
  gap: 12px;
  align-items: stretch;
  margin-bottom: 12px;
}
.filters-bar-row[_ngcontent-%COMP%]   app-filters-bar[_ngcontent-%COMP%] {
  flex: 1;
}
.multi-select-toggle[_ngcontent-%COMP%] {
  padding: 10px 14px;
  border: 1px solid #F1E5F3;
  background: #FBF5F6;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 700;
  color: #301A4E;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  min-width: 150px;
  justify-content: center;
  transition:
    background 120ms ease,
    box-shadow 120ms ease,
    transform 80ms ease;
}
.multi-select-toggle[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%] {
  font-size: 16px;
}
.multi-select-toggle[_ngcontent-%COMP%]:hover {
  background: rgba(241, 229, 243, 0.6);
  box-shadow: 0 2px 6px rgba(155, 144, 170, 0.2);
}
.multi-select-toggle[_ngcontent-%COMP%]:active {
  transform: translateY(1px);
}
.multi-select-count[_ngcontent-%COMP%] {
  color: #301A4E;
  font-weight: 700;
  background: #fff;
  border: 1px solid #F1E5F3;
  border-radius: 10px;
  padding: 2px 8px;
  line-height: 1;
}
.bulk-bar[_ngcontent-%COMP%] {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  background: #fff;
  border-top: 1px solid #F1E5F3;
  box-shadow: 0 -6px 18px rgba(155, 144, 170, 0.18);
  padding: 12px 16px;
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 16px;
  z-index: 10;
}
.bulk-controls[_ngcontent-%COMP%] {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 12px;
}
.bulk-controls[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  font-size: 12px;
  color: #9B90AA;
  gap: 4px;
}
.bulk-controls[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], 
.bulk-controls[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {
  padding: 8px 10px;
  border: 1px solid #F1E5F3;
  border-radius: 6px;
  background: #fff;
  color: #301A4E;
}
.bulk-actions[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 8px;
}
.bulk-btn[_ngcontent-%COMP%] {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #F1E5F3;
  background: #4E02B2;
  color: #fff;
  cursor: pointer;
  font-weight: 600;
  transition:
    transform 100ms ease,
    box-shadow 120ms ease,
    background 120ms ease;
}
.bulk-btn[_ngcontent-%COMP%]:hover {
  box-shadow: 0 2px 8px rgba(155, 144, 170, 0.25);
  transform: translateY(-1px);
}
.bulk-btn.ghost[_ngcontent-%COMP%] {
  background: #fff;
  color: #301A4E;
}
.bulk-error[_ngcontent-%COMP%] {
  color: #c62828;
  font-weight: 600;
}
.bulk-progress[_ngcontent-%COMP%] {
  color: #301A4E;
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot[_ngcontent-%COMP%] {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid rgba(255, 255, 255, 0.7);
  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
  transition: all 120ms ease;
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot.prefer[_ngcontent-%COMP%] {
  background: rgba(105, 140, 255, 0.35);
  border-color: rgba(105, 140, 255, 0.55);
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot.prevent[_ngcontent-%COMP%] {
  background: rgba(247, 60, 60, 0.35);
  border-color: rgba(247, 60, 60, 0.55);
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot.neutral[_ngcontent-%COMP%] {
  background: rgba(155, 144, 170, 0.3);
  border-color: rgba(255, 255, 255, 0.5);
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active[_ngcontent-%COMP%] {
  width: 14px;
  height: 14px;
  background: #FFFFFF;
  border: 2px solid #FFFFFF;
  box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active.prefer[_ngcontent-%COMP%] {
  background: #698CFF;
  border-color: rgba(105, 140, 255, 0.75);
  box-shadow: 0 0 0 2px rgba(105, 140, 255, 0.3), 0 0 0 4px rgba(255, 255, 255, 0.35);
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active.prevent[_ngcontent-%COMP%] {
  background: #F73C3C;
  border-color: rgba(247, 60, 60, 0.75);
  box-shadow: 0 0 0 2px rgba(247, 60, 60, 0.3), 0 0 0 4px rgba(255, 255, 255, 0.35);
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active.mostly-prefer[_ngcontent-%COMP%] {
  box-shadow: 0 0 0 2px rgba(105, 140, 255, 0.3), 0 0 0 4px rgba(247, 60, 60, 0.45);
}
.plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active.mostly-prevent[_ngcontent-%COMP%] {
  box-shadow: 0 0 0 2px rgba(247, 60, 60, 0.3), 0 0 0 4px rgba(105, 140, 255, 0.45);
}
.thumbnail-item[_ngcontent-%COMP%] {
  position: relative;
  width: 106px;
  height: 200px;
  border-radius: 2px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.2s;
  border: 2px solid #F1E5F3;
}
.thumbnail-item[_ngcontent-%COMP%]:hover {
  border: 2px solid #4E02B2;
  transform: scale(1.02);
}
.thumbnail-item[_ngcontent-%COMP%]:focus {
  outline: 2px solid #B969FF;
  outline-offset: 2px;
}
.thumbnail-item.selected[_ngcontent-%COMP%] {
  border-color: #4E02B2;
  box-shadow: 0 0 0 2px rgba(78, 1, 178, 0.5) inset;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%] {
  position: relative;
  width: 100%;
  height: 100%;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .thumbnail-actions[_ngcontent-%COMP%] {
  position: absolute;
  top: 6px;
  right: 6px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  opacity: 0;
  transition: opacity 120ms ease;
  z-index: 2;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .thumbnail-actions[_ngcontent-%COMP%]   .thumb-btn[_ngcontent-%COMP%] {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: none;
  background: rgba(255, 255, 255, 0.92);
  color: #301A4E;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(155, 144, 170, 0.3);
  font-weight: 700;
  transition:
    transform 120ms ease,
    background 120ms ease,
    color 120ms ease;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .thumbnail-actions[_ngcontent-%COMP%]   .thumb-btn.ghost[_ngcontent-%COMP%] {
  background: rgba(78, 2, 178, 0.1);
  color: #4E02B2;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .thumbnail-actions[_ngcontent-%COMP%]   .thumb-btn[_ngcontent-%COMP%]:hover {
  transform: scale(1.07);
  background: #4E02B2;
  color: #fff;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%] {
  position: absolute;
  top: 6px;
  right: 4px;
  bottom: 6px;
  width: 18px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
  pointer-events: none;
  gap: 6px;
  z-index: 1;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot[_ngcontent-%COMP%] {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid rgba(255, 255, 255, 0.7);
  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
  transition: all 120ms ease;
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.prefer[_ngcontent-%COMP%] {
  background: rgba(105, 140, 255, 0.35);
  border-color: rgba(105, 140, 255, 0.55);
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.prevent[_ngcontent-%COMP%] {
  background: rgba(247, 60, 60, 0.35);
  border-color: rgba(247, 60, 60, 0.55);
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.neutral[_ngcontent-%COMP%] {
  background: rgba(155, 144, 170, 0.3);
  border-color: rgba(255, 255, 255, 0.5);
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active[_ngcontent-%COMP%] {
  width: 14px;
  height: 14px;
  background: #FFFFFF;
  border: 2px solid #FFFFFF;
  box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active.prefer[_ngcontent-%COMP%] {
  background: #698CFF;
  border-color: rgba(105, 140, 255, 0.75);
  box-shadow: 0 0 0 2px rgba(105, 140, 255, 0.3), 0 0 0 4px rgba(255, 255, 255, 0.35);
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active.prevent[_ngcontent-%COMP%] {
  background: #F73C3C;
  border-color: rgba(247, 60, 60, 0.75);
  box-shadow: 0 0 0 2px rgba(247, 60, 60, 0.3), 0 0 0 4px rgba(255, 255, 255, 0.35);
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active.mostly-prefer[_ngcontent-%COMP%] {
  box-shadow: 0 0 0 2px rgba(105, 140, 255, 0.3), 0 0 0 4px rgba(247, 60, 60, 0.45);
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]   .plausibility-scale[_ngcontent-%COMP%]   .scale-dot.active.mostly-prevent[_ngcontent-%COMP%] {
  box-shadow: 0 0 0 2px rgba(247, 60, 60, 0.3), 0 0 0 4px rgba(105, 140, 255, 0.45);
}
.thumbnail-item[_ngcontent-%COMP%]   .thumbnail-image[_ngcontent-%COMP%]:hover   .thumbnail-actions[_ngcontent-%COMP%] {
  opacity: 1;
}
.thumbnail-item[data-status=highlighted][_ngcontent-%COMP%] {
  border: 3px solid #ffc107;
}
.thumbnail-item[data-status=banned][_ngcontent-%COMP%] {
  border: 1px dashed #301A4E;
  opacity: 0.5;
}
.item-sidebar[_ngcontent-%COMP%] {
  width: 420px;
  max-width: 35vw;
  max-height: 90vh;
  background: #FFFFFF;
  border-radius: 12px;
  border: 1px solid #F1E5F3;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
.item-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%] {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid #F1E5F3;
  background: #FBF5F6;
}
.item-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {
  margin: 0;
  font-size: 18px;
  font-weight: 700;
  color: #4E02B2;
}
.item-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .close-sidebar-btn[_ngcontent-%COMP%] {
  background: none;
  border: none;
  font-size: 28px;
  color: #6C707B;
  cursor: pointer;
  padding: 4px;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  transition: all 0.2s;
  line-height: 1;
  font-weight: 300;
}
.item-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .close-sidebar-btn[_ngcontent-%COMP%]:hover {
  background: #F73C3C;
  color: #FFFFFF;
}
.item-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   .close-sidebar-btn[_ngcontent-%COMP%]:focus {
  outline: 2px solid #B969FF;
  outline-offset: 2px;
}
.item-sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%] {
  flex: 1;
  overflow-y: auto;
  padding: 12px 12px calc(12px + 70px);
}
.item-sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%] {
  margin: 0;
  max-width: none;
  border: none;
  box-shadow: none;
  display: flex;
  flex-direction: column;
}
.item-sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]:hover {
  box-shadow: none;
  transform: none;
}
.item-sidebar[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%] {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  width: 420px;
  max-width: 35vw;
  padding: 16px;
  background: #FFFFFF;
  border-top: 1px solid #F1E5F3;
  z-index: 100;
}
.pinned-footer[_ngcontent-%COMP%] {
  margin-top: auto;
  background: #FFFFFF;
}
.status-row[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin: 12px 0;
}
.status-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  font-size: 12px;
  font-weight: 700;
  color: #4E02B2;
}
.status-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] {
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid #F1E5F3;
  background: #fff;
  font-weight: 600;
}
.metadata-editor[_ngcontent-%COMP%] {
  margin-top: 16px;
}
.metadata-editor[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {
  margin: 0 0 8px 0;
  font-size: 14px;
  font-weight: 700;
  color: #4E02B2;
}
.metadata-editor[_ngcontent-%COMP%]   .metadata-grid[_ngcontent-%COMP%] {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 8px 12px;
}
.metadata-editor[_ngcontent-%COMP%]   .metadata-field[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.metadata-editor[_ngcontent-%COMP%]   .metadata-field[_ngcontent-%COMP%]   .field-name[_ngcontent-%COMP%] {
  font-size: 11px;
  font-weight: 700;
  color: #6C707B;
  text-transform: uppercase;
}
.metadata-editor[_ngcontent-%COMP%]   .metadata-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {
  padding: 8px 10px;
  border: 1px solid #F1E5F3;
  border-radius: 8px;
  font-size: 13px;
}
.ai-regenerate[_ngcontent-%COMP%] {
  margin-top: 16px;
  padding: 12px;
  border: 1px dashed #F1E5F3;
  border-radius: 10px;
  background: #FBF5F6;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}
.ai-regenerate[_ngcontent-%COMP%]   .ai-regenerate-help[_ngcontent-%COMP%] {
  margin: 0;
  color: #6C707B;
  font-size: 13px;
  line-height: 1.4;
}
.ai-regenerate[_ngcontent-%COMP%]   .regenerate-btn[_ngcontent-%COMP%] {
  padding: 10px 14px;
  border-radius: 10px;
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
  cursor: pointer;
  transition:
    background 0.2s ease,
    box-shadow 0.2s ease,
    transform 0.1s ease;
}
.ai-regenerate[_ngcontent-%COMP%]   .regenerate-btn[_ngcontent-%COMP%]:hover {
  background: #B969FF;
  box-shadow: 0 4px 12px rgba(78, 2, 178, 0.35);
}
.ai-regenerate[_ngcontent-%COMP%]   .regenerate-btn[_ngcontent-%COMP%]:active {
  transform: translateY(1px);
}
@media (max-width: 768px) {
  .grid-layout[_ngcontent-%COMP%] {
    flex-direction: column;
    height: auto;
  }
  .item-sidebar[_ngcontent-%COMP%] {
    width: 100%;
    max-height: 70vh;
  }
  .thumbnails-grid[_ngcontent-%COMP%] {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    max-height: 50vh;
  }
  .thumbnail-item[_ngcontent-%COMP%] {
    height: 150px;
  }
  .items-grid[_ngcontent-%COMP%] {
    grid-template-columns: 1fr;
  }
  .credentials[_ngcontent-%COMP%]   .creds-row[_ngcontent-%COMP%] {
    flex-direction: column;
  }
  .credentials[_ngcontent-%COMP%]   .creds-row[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] {
    min-width: 100%;
  }
  .filters-section[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%] {
    justify-content: center;
  }
  .filters-section[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%]   .filter-chip[_ngcontent-%COMP%] {
    flex: 1 1 auto;
    min-width: 120px;
    justify-content: center;
  }
  .pagination-section[_ngcontent-%COMP%] {
    flex-wrap: wrap;
  }
  .item-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%] {
    grid-template-columns: 1fr;
  }
  .item-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%] {
    flex-direction: row;
    justify-content: center;
  }
  .item-card[_ngcontent-%COMP%]   .properties-grid[_ngcontent-%COMP%] {
    grid-template-columns: 1fr;
  }
}`]});};var n3=(n,e)=>e.code,i3=(n,e)=>e.id;function r3(n,e){if(n&1&&(P(0,"div",2),N(1),S()),n&2){let t=j();I(),Ve(t.errorMessage());}}function o3(n,e){if(n&1){let t=ve();P(0,"label",20)(1,"input",36),Z("change",function(){let r=X(t).$implicit,o=j();return q(o.toggleLanguage(r.code));}),S(),N(2),S();}if(n&2){let t=e.$implicit,i=j();I(),K("checked",i.isLanguageSelected(t.code)),I(),vt(" ",t.name," ");}}function s3(n,e){if(n&1&&(P(0,"span",37),N(1),S()),n&2){let t=e.$implicit,i=e.$index,r=j(2);I(),Sc("",i+1,". ",r.getLanguageName(t),"");}}function a3(n,e){if(n&1&&(P(0,"div",21)(1,"strong"),N(2,"Selected order:"),S(),ze(3,s3,2,2,"span",37,jt),S()),n&2){let t=j();I(3),je(t.formData().languages);}}function l3(n,e){if(n&1){let t=ve();P(0,"button",40),Z("click",function(){X(t);let r=j().$index,o=j();return q(o.removeFacilitatorName(r));}),N(1,"Remove"),S();}}function c3(n,e){if(n&1){let t=ve();P(0,"div",22)(1,"input",38),Z("ngModelChange",function(r){let o=X(t).$index,s=j();return q(s.updateFacilitatorName(o,r));}),S(),ge(2,l3,2,0,"button",39),S();}if(n&2){let t=e.$implicit,i=e.$index,r=j();I(),K("name","facilitator_name_"+i)("ngModel",t),I(),he(r.formData().facilitator_names.length>1?2:-1);}}function h3(n,e){if(n&1){let t=ve();P(0,"div",41)(1,"span",42),N(2),S(),P(3,"button",43),Z("click",function(){let r=X(t).$implicit,o=j(2);return q(o.removeKeyword(r));}),N(4,"\xD7"),S()();}if(n&2){let t=e.$implicit;I(2),Ve(t);}}function d3(n,e){if(n&1&&(P(0,"div",26),ze(1,h3,5,1,"div",41,ji),S()),n&2){let t=j();I(),je(t.formData().keywords);}}function u3(n,e){if(n&1){let t=ve();P(0,"label",20)(1,"input",36),Z("change",function(){let r=X(t).$implicit,o=j();return q(o.toggleTemplate(r.id));}),S(),N(2),S();}if(n&2){let t=e.$implicit,i=j();I(),K("checked",i.isTemplateSelected(t.id)),I(),vt(" ",t.name," ");}}var ec=class n{constructor(e,t,i){this.route=e;this.router=t;this.adminApi=i;}isEditMode=G(!1);workspaceId=G(null);adminKey=G(null);formData=G({date:"",city:"",country:"",venue:"",event_name:"",interactive_workshop:!1,languages:[],facilitator_names:[""],keywords:[],active_templates:["post","chat","notification","review","prompt","photo","sign","holyland","world"],"context-label":"",source:"","email-template":""});publicVisible=G(!1);collaborate=G(!1);availableLanguages=[{code:"he",name:"Hebrew"},{code:"ar",name:"Arabic"},{code:"en",name:"English"},{code:"nl",name:"Dutch"}];keywordInput=G("");availableTemplates=[{id:"post",name:"Post"},{id:"chat",name:"Chat"},{id:"notification",name:"Notification"},{id:"review",name:"Review"},{id:"prompt",name:"Prompt"},{id:"photo",name:"Photo"},{id:"sign",name:"Sign"},{id:"holyland",name:"Holy Land"},{id:"world",name:"World"},{id:"jerusalem",name:"Jerusalem"},{id:"europe",name:"Europe"},{id:"us",name:"United States"}];isSubmitting=G(!1);errorMessage=G(null);ngOnInit(){this.route.params.subscribe(e=>{e.workspaceId&&(this.isEditMode.set(!0),this.workspaceId.set(e.workspaceId));}),this.route.queryParams.subscribe(e=>{e.key&&this.adminKey.set(e.key);}),this.isEditMode()&&this.workspaceId()&&this.adminKey()&&this.loadWorkspaceData();}loadWorkspaceData(){let e=this.workspaceId(),t=this.adminKey();!e||!t||this.adminApi.getWorkspace(e,t).subscribe({next:i=>{if(i){let r=D({},i);this.reverseEngineerFields(r),this.formData.set(r),this.publicVisible.set(i.public||!1),this.collaborate.set(i.collaborate||!1),(!this.formData().facilitator_names||this.formData().facilitator_names.length===0)&&this.formData.update(o=>se(D({},o),{facilitator_names:[""]}));}},error:i=>{console.error("Error loading workspace:",i),this.errorMessage.set("Failed to load workspace data. Please check the admin key.");}});}reverseEngineerFields(e){if(!e.date&&e.source){let t=e.source.match(/^(\d{2,4})[\.-](\d{2})[\.-](\d{2})/);t&&(t[1].length===2&&(t[1]="20"+t[1]),e.date=`${t[1]}-${t[2]}-${t[3]}`);}if(e.source){let t=e.source.match(/^\d{2,4}[\.-]\d{2}[\.-]\d{2}[- ]+(.+?)\/(.+)$/);t&&(e.venue||(e.venue=t[1].trim()),e.event_name||(e.event_name=t[2].trim()));}if(!e.city&&e["context-label"]){let t=e["context-label"].match(/^([^,]+),/);t&&(e.city=t[1].trim());}if(e.interactive_workshop===void 0&&e["email-template"]&&(e.interactive_workshop=e["email-template"].startsWith("to-evaluate-")),(!e.languages||e.languages.length===0)&&e["email-template"]){let t=e["email-template"].match(/-(he|ar|en|nl)$/);t&&(e.languages=[t[1]]);}e.languages=e.languages||[],e.facilitator_names||(e.facilitator_names=[]),e.keywords||(e.keywords=[]),e.active_templates||(e.active_templates=["post","chat","notification","review","prompt","photo","sign","holyland","world"]);}isLanguageSelected(e){return this.formData().languages.includes(e);}toggleLanguage(e){let t=[...(this.formData().languages||[])],i=t.indexOf(e);i>-1?t.splice(i,1):t.push(e),this.formData.update(r=>se(D({},r),{languages:t})),this.updateAutoGeneratedFields();}addKeyword(){let e=this.keywordInput().trim();if(!e)return;let t=[...(this.formData().keywords||[])];t.includes(e)||(t.push(e),this.formData.update(i=>se(D({},i),{keywords:t}))),this.keywordInput.set("");}removeKeyword(e){let t=[...(this.formData().keywords||[])],i=t.indexOf(e);i>-1&&(t.splice(i,1),this.formData.update(r=>se(D({},r),{keywords:t})));}onKeywordKeyPress(e){e.key==="Enter"&&(e.preventDefault(),this.addKeyword());}isTemplateSelected(e){return this.formData().active_templates?.includes(e)||!1;}toggleTemplate(e){let t=[...(this.formData().active_templates||[])],i=t.indexOf(e);i>-1?t.splice(i,1):t.push(e),this.formData.update(r=>se(D({},r),{active_templates:t}));}addFacilitatorName(){let e=[...this.formData().facilitator_names,""];this.formData.update(t=>se(D({},t),{facilitator_names:e}));}removeFacilitatorName(e){let t=[...this.formData().facilitator_names];t.length>1&&(t.splice(e,1),this.formData.update(i=>se(D({},i),{facilitator_names:t})));}updateFacilitatorName(e,t){let i=[...this.formData().facilitator_names];i[e]=t,this.formData.update(r=>se(D({},r),{facilitator_names:i}));}updateAutoGeneratedFields(){let e=this.formData();if(e.date&&e.city){let t=new Date(e.date),i=t.toLocaleDateString("en-US",{month:"long"}),r=t.getFullYear();e["context-label"]=`${e.city}, ${i} ${r}`;}if(e.date&&e.venue&&e.event_name){let[t,i,r]=e.date.split("-");e.source=`${t}.${i}.${r} - ${e.venue}/${e.event_name}`;}if(e.languages.length>0){let t=e.languages[0];e["email-template"]=e.interactive_workshop?`to-evaluate-${t}`:`after-evaluate-${t}`;}this.formData.set(D({},e));}onFieldChange(){this.updateAutoGeneratedFields();}isFormValid(){let e=this.formData();return!!(e.date&&e.city&&e.country&&e.venue&&e.event_name&&e.languages.length>0&&e.facilitator_names.length>0&&e.facilitator_names.every(t=>t.trim().length>0));}onSubmit(){if(!this.isFormValid()){this.errorMessage.set("Please fill in all required fields.");return;}this.isSubmitting.set(!0),this.errorMessage.set(null),this.updateAutoGeneratedFields(),this.isEditMode()?this.updateWorkspace():this.createWorkspace();}createWorkspace(){let e={metadata:this.formData(),public:this.publicVisible(),collaborate:this.collaborate()};this.adminApi.createWorkspace(e).subscribe({next:t=>{console.log("Workspace created successfully:",t),this.router.navigate(["/admin"],{state:{message:"Workspace created successfully!"}});},error:t=>{console.error("Error creating workspace:",t),this.errorMessage.set(t.error?.message||"Failed to create workspace. Please try again."),this.isSubmitting.set(!1);}});}updateWorkspace(){let e=this.workspaceId(),t=this.adminKey();if(!e||!t){this.errorMessage.set("Missing workspace ID or admin key."),this.isSubmitting.set(!1);return;}let i={metadata:this.formData(),public:this.publicVisible(),collaborate:this.collaborate()};this.adminApi.updateWorkspace(e,t,i).subscribe({next:r=>{console.log("Workspace updated successfully:",r),this.router.navigate(["/admin"],{state:{message:"Workspace updated successfully!"}});},error:r=>{console.error("Error updating workspace:",r),this.errorMessage.set(r.error?.message||"Failed to update workspace. Please try again."),this.isSubmitting.set(!1);}});}cancel(){this.router.navigate(["/admin"]);}getLanguageName(e){return this.availableLanguages.find(t=>t.code===e)?.name||e;}static fac=function(t){return new(t||n)(ue(Ct),ue(gt),ue(cr));};static cmp=Me({type:n,selectors:[["app-workspace-form"]],decls:109,vars:19,consts:[["workspaceForm","ngForm"],[1,"workspace-form-container"],[1,"error-message"],[3,"ngSubmit"],[1,"form-group"],["for","date"],[1,"required"],["type","date","id","date","name","date","required","",3,"ngModelChange","ngModel"],["for","city"],["type","text","id","city","name","city","required","",3,"ngModelChange","ngModel"],["for","country"],["type","text","id","country","name","country","required","",3,"ngModelChange","ngModel"],["for","venue"],["type","text","id","venue","name","venue","required","",3,"ngModelChange","ngModel"],["for","event_name"],["type","text","id","event_name","name","event_name","required","",3,"ngModelChange","ngModel"],[1,"form-group","checkbox-group"],["type","checkbox","name","interactive_workshop",3,"ngModelChange","ngModel"],[1,"field-hint"],[1,"multi-select-group"],[1,"checkbox-item"],[1,"selected-order"],[1,"name-input-group"],["type","button",1,"add-btn",3,"click"],[1,"keyword-input-row"],["type","text","placeholder","Type a keyword...",3,"ngModelChange","keypress","ngModel"],[1,"keyword-chips"],[1,"auto-generated-section"],[1,"form-group","readonly"],["type","text","readonly","",3,"value"],[1,"visibility-section"],["type","checkbox","name","publicVisible",3,"ngModelChange","ngModel"],["type","checkbox","name","collaborate",3,"ngModelChange","ngModel"],[1,"form-actions"],["type","button",1,"cancel-btn",3,"click","disabled"],["type","submit",1,"submit-btn",3,"disabled"],["type","checkbox",3,"change","checked"],[1,"order-item"],["type","text","placeholder","Enter facilitator name","required","",3,"ngModelChange","name","ngModel"],["type","button",1,"remove-btn"],["type","button",1,"remove-btn",3,"click"],[1,"keyword-chip"],[1,"keyword-text"],["type","button","title","Remove keyword",1,"remove-chip-btn",3,"click"]],template:function(t,i){if(t&1){let r=ve();P(0,"div",1)(1,"h1"),N(2),S(),ge(3,r3,2,1,"div",2),P(4,"form",3,0),Z("ngSubmit",function(){return X(r),q(i.onSubmit());}),P(6,"div",4)(7,"label",5),N(8,"Date "),P(9,"span",6),N(10,"*"),S()(),P(11,"input",7),tt("ngModelChange",function(s){return X(r),et(i.formData().date,s)||(i.formData().date=s),q(s);}),Z("ngModelChange",function(){return X(r),q(i.onFieldChange());}),S()(),P(12,"div",4)(13,"label",8),N(14,"City "),P(15,"span",6),N(16,"*"),S()(),P(17,"input",9),tt("ngModelChange",function(s){return X(r),et(i.formData().city,s)||(i.formData().city=s),q(s);}),Z("ngModelChange",function(){return X(r),q(i.onFieldChange());}),S()(),P(18,"div",4)(19,"label",10),N(20,"Country "),P(21,"span",6),N(22,"*"),S()(),P(23,"input",11),tt("ngModelChange",function(s){return X(r),et(i.formData().country,s)||(i.formData().country=s),q(s);}),S()(),P(24,"div",4)(25,"label",12),N(26,"Venue "),P(27,"span",6),N(28,"*"),S()(),P(29,"input",13),tt("ngModelChange",function(s){return X(r),et(i.formData().venue,s)||(i.formData().venue=s),q(s);}),Z("ngModelChange",function(){return X(r),q(i.onFieldChange());}),S()(),P(30,"div",4)(31,"label",14),N(32,"Event Name "),P(33,"span",6),N(34,"*"),S()(),P(35,"input",15),tt("ngModelChange",function(s){return X(r),et(i.formData().event_name,s)||(i.formData().event_name=s),q(s);}),Z("ngModelChange",function(){return X(r),q(i.onFieldChange());}),S()(),P(36,"div",16)(37,"label")(38,"input",17),tt("ngModelChange",function(s){return X(r),et(i.formData().interactive_workshop,s)||(i.formData().interactive_workshop=s),q(s);}),Z("ngModelChange",function(){return X(r),q(i.onFieldChange());}),S(),N(39," Interactive Workshop "),S()(),P(40,"div",4)(41,"label"),N(42,"Languages "),P(43,"span",6),N(44,"*"),S()(),P(45,"p",18),N(46,"Select at least one language. The first selected language will be the primary one."),S(),P(47,"div",19),ze(48,o3,3,2,"label",20,n3),S(),ge(50,a3,5,0,"div",21),S(),P(51,"div",4)(52,"label"),N(53,"Facilitator Names "),P(54,"span",6),N(55,"*"),S()(),ze(56,c3,3,3,"div",22,jt),P(58,"button",23),Z("click",function(){return X(r),q(i.addFacilitatorName());}),N(59,"Add Another Facilitator"),S()(),P(60,"div",4)(61,"label"),N(62,"Keywords (optional)"),S(),P(63,"p",18),N(64,"Press Enter or click Add to create a keyword tag"),S(),P(65,"div",24)(66,"input",25),Z("ngModelChange",function(s){return X(r),q(i.keywordInput.set(s));})("keypress",function(s){return X(r),q(i.onKeywordKeyPress(s));}),S(),P(67,"button",23),Z("click",function(){return X(r),q(i.addKeyword());}),N(68,"Add"),S()(),ge(69,d3,3,0,"div",26),S(),P(70,"div",4)(71,"label"),N(72,"Template Gallery (optional)"),S(),P(73,"p",18),N(74,"Select which templates should be available in the no-paper flow template gallery"),S(),P(75,"div",19),ze(76,u3,3,2,"label",20,i3),S()(),P(78,"div",27)(79,"h3"),N(80,"Auto-Generated Fields"),S(),P(81,"div",28)(82,"label"),N(83,"Context Label"),S(),te(84,"input",29),S(),P(85,"div",28)(86,"label"),N(87,"Source"),S(),te(88,"input",29),S(),P(89,"div",28)(90,"label"),N(91,"Email Template"),S(),te(92,"input",29),S()(),P(93,"div",30)(94,"h3"),N(95,"Workspace Settings"),S(),P(96,"div",16)(97,"label")(98,"input",31),Z("ngModelChange",function(s){return X(r),q(i.publicVisible.set(s));}),S(),N(99," Public Visibility "),S()(),P(100,"div",16)(101,"label")(102,"input",32),Z("ngModelChange",function(s){return X(r),q(i.collaborate.set(s));}),S(),N(103," Allow Collaboration (new items can be added) "),S()()(),P(104,"div",33)(105,"button",34),Z("click",function(){return X(r),q(i.cancel());}),N(106," Cancel "),S(),P(107,"button",35),N(108),S()()()();}t&2&&(I(2),Ve(i.isEditMode()?"Edit Workspace":"Create New Workspace"),I(),he(i.errorMessage()?3:-1),I(8),Qe("ngModel",i.formData().date),I(6),Qe("ngModel",i.formData().city),I(6),Qe("ngModel",i.formData().country),I(6),Qe("ngModel",i.formData().venue),I(6),Qe("ngModel",i.formData().event_name),I(3),Qe("ngModel",i.formData().interactive_workshop),I(10),je(i.availableLanguages),I(2),he(i.formData().languages.length>0?50:-1),I(6),je(i.formData().facilitator_names),I(10),K("ngModel",i.keywordInput()),I(3),he(i.formData().keywords&&i.formData().keywords.length>0?69:-1),I(7),je(i.availableTemplates),I(8),K("value",i.formData()["context-label"]),I(4),K("value",i.formData().source),I(4),K("value",i.formData()["email-template"]),I(6),K("ngModel",i.publicVisible()),I(4),K("ngModel",i.collaborate()),I(3),K("disabled",i.isSubmitting()),I(2),K("disabled",!i.isFormValid()||i.isSubmitting()),I(),vt(" ",i.isSubmitting()?"Saving...":i.isEditMode()?"Save Changes":"Create Workspace"," "));},dependencies:[ri,on,U0,Hi,Bs,On,j0,W0,Tn,$0],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 8px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
[_nghost-%COMP%] {
  display: block;
  width: 100%;
  height: 100%;
  overflow: auto;
}
.workspace-form-container[_ngcontent-%COMP%] {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.workspace-form-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%] {
  color: #4E02B2;
  margin-bottom: 2rem;
  font-size: 2rem;
}
.workspace-form-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {
  color: #4E02B2;
  margin-top: 2rem;
  margin-bottom: 1rem;
  font-size: 1.3rem;
}
.workspace-form-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%] {
  background-color: #ffebee;
  color: #c62828;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  border: 1px solid #ef9a9a;
}
.workspace-form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%] {
  background-color: #F5F0E7;
  padding: 2rem;
  border-radius: 16px;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%] {
  margin-bottom: 1.5rem;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: #4E02B2;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%] {
  color: #c62828;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .field-hint[_ngcontent-%COMP%] {
  font-size: 0.9rem;
  color: #9B90AA;
  margin-bottom: 0.5rem;
  margin-top: -0.25rem;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], 
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%] {
  width: 100%;
  padding: 0.75rem;
  border: 2px solid #E7CBFF;
  border-radius: 8px;
  font-size: 1rem;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  background-color: white;
  transition: border-color 0.2s;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus, 
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #B969FF;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:disabled, 
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]:disabled, 
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][readonly][_ngcontent-%COMP%], 
.workspace-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=date][readonly][_ngcontent-%COMP%] {
  background-color: #f5f5f5;
  color: #9B90AA;
  cursor: not-allowed;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group.checkbox-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: normal;
  cursor: pointer;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group.checkbox-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] {
  width: 1.2rem;
  height: 1.2rem;
  cursor: pointer;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-group.readonly[_ngcontent-%COMP%] {
  opacity: 0.7;
}
.workspace-form-container[_ngcontent-%COMP%]   .multi-select-group[_ngcontent-%COMP%] {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  margin-top: 0.5rem;
}
.workspace-form-container[_ngcontent-%COMP%]   .multi-select-group[_ngcontent-%COMP%]   .checkbox-item[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  background-color: white;
  border: 2px solid #E7CBFF;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
}
.workspace-form-container[_ngcontent-%COMP%]   .multi-select-group[_ngcontent-%COMP%]   .checkbox-item[_ngcontent-%COMP%]:hover {
  border-color: #B969FF;
  background-color: #F1E5F3;
}
.workspace-form-container[_ngcontent-%COMP%]   .multi-select-group[_ngcontent-%COMP%]   .checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] {
  width: 1.2rem;
  height: 1.2rem;
  cursor: pointer;
}
input[type=checkbox][_ngcontent-%COMP%]:checked    + .workspace-form-container[_ngcontent-%COMP%]   .multi-select-group[_ngcontent-%COMP%]   .checkbox-item[_ngcontent-%COMP%] {
  background-color: #B969FF;
  color: white;
}
.workspace-form-container[_ngcontent-%COMP%]   .selected-order[_ngcontent-%COMP%] {
  margin-top: 1rem;
  padding: 1rem;
  background-color: white;
  border-radius: 8px;
  font-size: 0.9rem;
}
.workspace-form-container[_ngcontent-%COMP%]   .selected-order[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%] {
  display: block;
  margin-bottom: 0.5rem;
  color: #4E02B2;
}
.workspace-form-container[_ngcontent-%COMP%]   .selected-order[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%] {
  display: inline-block;
  margin-right: 1rem;
  color: #9B90AA;
}
.workspace-form-container[_ngcontent-%COMP%]   .name-input-group[_ngcontent-%COMP%] {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 0.75rem;
}
.workspace-form-container[_ngcontent-%COMP%]   .name-input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {
  flex: 1;
}
.workspace-form-container[_ngcontent-%COMP%]   .name-input-group[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%] {
  padding: 0.5rem 1rem;
  background-color: #ffebee;
  color: #c62828;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-weight: 600;
  transition: background-color 0.2s;
}
.workspace-form-container[_ngcontent-%COMP%]   .name-input-group[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]:hover {
  background-color: #ffcdd2;
}
.workspace-form-container[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%] {
  padding: 0.5rem 1rem;
  background-color: #E7CBFF;
  color: #4E02B2;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-weight: 600;
  transition: all 0.2s;
}
.workspace-form-container[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]:hover {
  background-color: #B969FF;
  color: white;
}
.workspace-form-container[_ngcontent-%COMP%]   .keyword-input-row[_ngcontent-%COMP%] {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
}
.workspace-form-container[_ngcontent-%COMP%]   .keyword-input-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {
  flex: 1;
}
.workspace-form-container[_ngcontent-%COMP%]   .keyword-input-row[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%] {
  flex-shrink: 0;
}
.workspace-form-container[_ngcontent-%COMP%]   .keyword-chips[_ngcontent-%COMP%] {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 1rem;
}
.workspace-form-container[_ngcontent-%COMP%]   .keyword-chips[_ngcontent-%COMP%]   .keyword-chip[_ngcontent-%COMP%] {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.4rem 0.75rem;
  background-color: #4E02B2;
  color: white;
  border-radius: 16px;
  font-size: 0.9rem;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.workspace-form-container[_ngcontent-%COMP%]   .keyword-chips[_ngcontent-%COMP%]   .keyword-chip[_ngcontent-%COMP%]   .keyword-text[_ngcontent-%COMP%] {
  line-height: 1;
}
.workspace-form-container[_ngcontent-%COMP%]   .keyword-chips[_ngcontent-%COMP%]   .keyword-chip[_ngcontent-%COMP%]   .remove-chip-btn[_ngcontent-%COMP%] {
  background: none;
  border: none;
  color: white;
  font-size: 1.3rem;
  line-height: 1;
  cursor: pointer;
  padding: 0;
  width: 1.2rem;
  height: 1.2rem;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background-color 0.2s;
}
.workspace-form-container[_ngcontent-%COMP%]   .keyword-chips[_ngcontent-%COMP%]   .keyword-chip[_ngcontent-%COMP%]   .remove-chip-btn[_ngcontent-%COMP%]:hover {
  background-color: rgba(255, 255, 255, 0.2);
}
.workspace-form-container[_ngcontent-%COMP%]   .auto-generated-section[_ngcontent-%COMP%], 
.workspace-form-container[_ngcontent-%COMP%]   .visibility-section[_ngcontent-%COMP%] {
  margin-top: 2rem;
  padding-top: 2rem;
  border-top: 2px solid #E7CBFF;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%] {
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 2rem;
  padding-top: 2rem;
  border-top: 2px solid #E7CBFF;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {
  padding: 0.75rem 2rem;
  border: none;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%] {
  background-color: white;
  color: #4E02B2;
  border: 2px solid #E7CBFF;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover:not(:disabled) {
  background-color: #F1E5F3;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%] {
  background-color: #4E02B2;
  color: white;
}
.workspace-form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]:hover:not(:disabled) {
  background-color: #B969FF;
}`]});};var Cu=()=>["/admin/moderate"],bu=(n,e)=>({api_key:n,workspace:e}),p3=()=>["/showcase-ws"],f3=(n,e,t)=>({workspace:n,api_key:e,admin_key:t}),g3=n=>["/admin/edit",n],m3=n=>({key:n});function _3(n,e){if(n&1){let t=ve();P(0,"div",18),Z("click",function(r){return X(t),q(r.stopPropagation());}),P(1,"a",19)(2,"span",20),N(3,"\u{1F916}"),S(),P(4,"span",21),N(5,"Batch Scan"),S()(),P(6,"a",19)(7,"span",20),N(8,"\u{1F465}"),S(),P(9,"span",21),N(10,"Scan in Workshop"),S()(),P(11,"a",19)(12,"span",20),N(13,"\u{1F4DD}"),S(),P(14,"span",21),N(15,"Scan + Evaluate"),S()()();}if(n&2){let t=j(2);I(),K("href","/"+t.ingestSuffixAutomatic(),Ue),I(5),K("href","/"+t.ingestSuffixWorkshop(),Ue),I(5),K("href","/"+t.ingestSuffix(),Ue);}}function v3(n,e){if(n&1){let t=ve();P(0,"article",0)(1,"div",1)(2,"a",2)(3,"div",3)(4,"span",4),N(5),S()()(),P(6,"a",2)(7,"div",5)(8,"div",6),N(9),S(),P(10,"div",7),N(11),S()()(),P(12,"a",2)(13,"div",8),N(14),S()(),P(15,"a",2)(16,"div",9),N(17),S()(),P(18,"div",10)(19,"a",11),Z("click",function(r){return X(t),q(r.stopPropagation());}),P(20,"span",12),N(21,"\u{1F4FA}"),S(),P(22,"span",13),N(23,"Display"),S()(),P(24,"div",14),Z("click",function(r){X(t);let o=j();return q(o.toggleIngestMenu(r));}),P(25,"span",12),N(26,"\u2B07"),S(),P(27,"span",13),N(28,"Ingest"),S(),ge(29,_3,16,3,"div",15),S(),P(30,"a",16),Z("click",function(r){return X(t),q(r.stopPropagation());}),P(31,"span",12),N(32,"\u{1F5FA}\uFE0F"),S(),P(33,"span",13),N(34,"Map"),S()(),P(35,"a",17),Z("click",function(r){return X(t),q(r.stopPropagation());}),P(36,"span",12),N(37,"\u2699\uFE0F"),S(),P(38,"span",13),N(39,"Settings"),S()()()()();}if(n&2){let t=j(),i=P0(0);I(2),K("routerLink",yt(21,Cu))("queryParams",Ha(22,bu,i.keys.admin,i.id)),I(3),Ve(t.formattedDate()),I(),K("routerLink",yt(25,Cu))("queryParams",Ha(26,bu,i.keys.admin,i.id)),I(3),Ve(i.metadata.event_name||i.metadata.source),I(2),Ve(t.locationText()),I(),K("routerLink",yt(29,Cu))("queryParams",Ha(30,bu,i.keys.admin,i.id)),I(2),Ve(t.facilitatorsText()),I(),K("routerLink",yt(33,Cu))("queryParams",Ha(34,bu,i.keys.admin,i.id)),I(2),Ve(t.languagesText()),I(2),K("routerLink",yt(37,p3))("queryParams",w0(38,f3,i.id,i.keys.collaborate,i.keys.admin)),I(5),Se("active",t.ingestMenuOpen()),I(5),he(t.ingestMenuOpen()?29:-1),I(),K("href",t.mapLink(),Ue),I(5),K("routerLink",op(42,g3,i.id))("queryParams",op(44,m3,i.keys.admin));}}var xu=class n{workspace=nn();ingestMenuOpen=G(!1);ingestSuffix=_e(()=>{let e=this.workspace();return e&&e.id&&e.keys?`?workspace=${e.id}&api_key=${e.keys.collaborate}`:"";});ingestSuffixWorkshop=_e(()=>this.ingestSuffix()+"&ws=true");ingestSuffixAutomatic=_e(()=>this.ingestSuffix()+"&automatic=true");mapLink=_e(()=>{let e=this.workspace();return e&&e.id?`/?tag=${e.id}&lang=he`:"";});formattedDate=_e(()=>{let e=this.workspace()?.metadata?.date||"",t=/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/.exec(e);return t?`${t[3]}.${t[2]}.${t[1]}`:e;});facilitatorsText=_e(()=>(this.workspace()?.metadata?.facilitator_names||[]).join(", "));languagesText=_e(()=>(this.workspace()?.metadata?.languages||[]).join(", "));locationText=_e(()=>{let e=this.workspace()?.metadata;if(!e)return"";let t=e.city||"",i=e.country||"";return t&&i?`${t}, ${i}`:t||i;});toggleIngestMenu(e){e.stopPropagation(),this.ingestMenuOpen.update(t=>!t);}closeIngestMenu(){this.ingestMenuOpen.set(!1);}static fac=function(t){return new(t||n)();};static cmp=Me({type:n,selectors:[["app-workspace-item"]],hostBindings:function(t,i){t&1&&Z("click",function(){return i.closeIngestMenu();},!1,v0);},inputs:{workspace:[1,"workspace"]},decls:2,vars:2,consts:[["role","listitem","aria-label","Workspace item",1,"workspace-item"],[1,"row"],[1,"workspace-link",3,"routerLink","queryParams"],[1,"cell","date"],[1,"date-chip"],[1,"cell","title"],[1,"title-text"],[1,"meta"],[1,"cell","facilitators"],[1,"cell","languages"],["aria-label","Workspace actions",1,"cell","actions"],["aria-label","Display workshop screen","title","Display",1,"action-btn",3,"click","routerLink","queryParams"],[1,"icon"],[1,"label"],["title","Ingest",1,"action-btn","ingest-btn",3,"click"],[1,"ingest-menu"],["aria-label","View map","title","Map",1,"action-btn",3,"click","href"],["aria-label","Edit settings","title","Settings",1,"action-btn",3,"click","routerLink","queryParams"],[1,"ingest-menu",3,"click"],[1,"menu-item",3,"href"],[1,"menu-icon"],[1,"menu-label"]],template:function(t,i){if(t&1&&(b0(0),ge(1,v3,40,46,"article",0)),t&2){let r=x0(i.workspace());I(),he(r?1:-1);}},dependencies:[rn],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 8px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
.workspace-item[_ngcontent-%COMP%] {
  width: 100%;
  background: #FBF5F6;
  border: 1px solid #F1E5F3;
  border-radius: 16px;
  padding: 12px 16px;
  min-height: 72px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  position: relative;
}
.workspace-item[_ngcontent-%COMP%]:hover {
  background: #FFF8FA;
  border-color: #B969FF;
}
.workspace-item[_ngcontent-%COMP%]:hover   .title-text[_ngcontent-%COMP%] {
  color: #B969FF;
}
.workspace-link[_ngcontent-%COMP%] {
  display: contents;
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
.row[_ngcontent-%COMP%] {
  display: grid;
  grid-template-columns: 120px 2fr 1.2fr 1.2fr auto;
  align-items: center;
  gap: 16px;
}
.cell[_ngcontent-%COMP%] {
  color: #4E02B2;
}
.date[_ngcontent-%COMP%] {
  color: #9B90AA;
}
.title[_ngcontent-%COMP%] {
  font-weight: 600;
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.title-text[_ngcontent-%COMP%] {
  color: #4E02B2;
  transition: color 0.15s ease;
}
.meta[_ngcontent-%COMP%] {
  color: #9B90AA;
  font-size: 12px;
}
.date-chip[_ngcontent-%COMP%] {
  display: inline-flex;
  min-width: 100px;
  justify-content: center;
  align-items: center;
  padding: 6px 12px;
  border-radius: 12px;
  background: #F1E5F3;
  color: #4E02B2;
  font-weight: 600;
}
.actions[_ngcontent-%COMP%] {
  display: flex;
  gap: 6px;
  justify-content: flex-end;
}
.action-btn[_ngcontent-%COMP%] {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 6px 10px;
  border-radius: 10px;
  border: 1px solid #E7CBFF;
  background: white;
  color: #4E02B2;
  text-decoration: none;
  font-size: 12px;
  font-weight: 500;
  transition: all 0.15s ease;
  cursor: pointer;
  position: relative;
  white-space: nowrap;
}
.action-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%] {
  font-size: 14px;
}
.action-btn[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%] {
  font-weight: 600;
}
.action-btn[_ngcontent-%COMP%]:hover {
  background: #F8F4FF;
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(78, 2, 178, 0.08);
}
.action-btn.ingest-btn.active[_ngcontent-%COMP%] {
  background: #B969FF;
  color: white;
  border-color: #B969FF;
}
.ingest-menu[_ngcontent-%COMP%] {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  min-width: 200px;
  background: white;
  border: 1px solid #E7CBFF;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(78, 2, 178, 0.15);
  overflow: hidden;
  z-index: 100;
}
.ingest-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  color: #4E02B2;
  text-decoration: none;
  transition: background 0.15s ease;
}
.ingest-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   .menu-icon[_ngcontent-%COMP%] {
  font-size: 18px;
  width: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.ingest-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   .menu-label[_ngcontent-%COMP%] {
  font-size: 13px;
  font-weight: 500;
}
.ingest-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover {
  background: #F8F4FF;
}
.ingest-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:not(:last-child) {
  border-bottom: 1px solid #F1E5F3;
}`],changeDetection:0});};var y3=(n,e)=>e.id;function C3(n,e){if(n&1&&(P(0,"div",7),N(1),S()),n&2){let t=j();I(),Ve(t.successMessage());}}function b3(n,e){if(n&1&&(P(0,"option",26),N(1),S()),n&2){let t=e.$implicit;K("value",t),I(),Ve(t);}}function x3(n,e){if(n&1&&(P(0,"option",26),N(1),S()),n&2){let t=e.$implicit;K("value",t),I(),Ve(t);}}function P3(n,e){if(n&1&&te(0,"app-workspace-item",37),n&2){let t=e.$implicit;K("workspace",t);}}var Pu=class n{constructor(e,t,i){this.adminApi=e;this.auth=t;this.router=i;}workspaces=G([]);successMessage=G(null);statusFilter=G("all");languageFilter=G("all");facilitatorFilter=G("all");searchQuery=G("");orderBy=G("date");allFacilitators=_e(()=>{let e=new Set();return this.workspaces().forEach(t=>{(t?.metadata?.facilitator_names||[]).forEach(i=>e.add(i));}),Array.from(e).sort();});allKeywords=_e(()=>{let e=new Set();return this.workspaces().forEach(t=>{(t?.metadata?.keywords||[]).forEach(i=>e.add(i));}),Array.from(e).sort();});getWorkspaceStatus(e){let t=e?.metadata?.date;if(!t)return"upcoming";let i=new Date();i.setHours(0,0,0,0);let r=new Date(t);r.setHours(0,0,0,0);let o=e?.item_count??0,s=e?.reviewed_count??0;return r>i?"upcoming":r.getTime()===i.getTime()&&o>1?"active":o>0&&s<o?"in-review":o>0&&s===o?"done":"upcoming";}filteredWorkspaces=_e(()=>{let e=this.searchQuery().trim().toLowerCase(),t=this.languageFilter(),i=this.statusFilter(),r=this.facilitatorFilter(),o=this.orderBy();return[...this.workspaces()].filter(l=>i!=="all"&&this.getWorkspaceStatus(l)!==i||t!=="all"&&!(l?.metadata?.languages??[]).map(d=>d.toLowerCase()).includes(t.toLowerCase())||r!=="all"&&!(l?.metadata?.facilitator_names??[]).includes(r)?!1:e.length>0?[l?.metadata?.event_name,l?.metadata?.venue,l?.metadata?.city,l?.metadata?.country,(l?.metadata?.facilitator_names||[]).join(" "),(l?.metadata?.keywords||[]).join(" "),l?.metadata?.source,l?.id].filter(Boolean).join(" ").toLowerCase().includes(e):!0).sort((l,c)=>{if(o==="screenshots")return(c?.item_count??0)-(l?.item_count??0);if(o==="completion"){let g=(l?.item_count??0)>0?(l?.reviewed_count??0)/l.item_count:0;return((c?.item_count??0)>0?(c?.reviewed_count??0)/c.item_count:0)-g;}let d=l?.metadata?.date??"";return(c?.metadata?.date??"").localeCompare(d);});});ngOnInit(){let e=this.router.getCurrentNavigation();e?.extras?.state?.message&&(this.successMessage.set(e.extras.state.message),setTimeout(()=>this.successMessage.set(null),5e3)),this.auth.user.pipe(Vt(t=>!!t),Xt(1),Nt(0)).subscribe(()=>{console.log("AUTH TOKEN:",this.auth.token()),this.adminApi.listWorkspaces().subscribe(t=>{console.log("Workspaces:",t);let i=[...t].sort((r,o)=>{let s=r?.metadata?.date??"";return(o?.metadata?.date??"").localeCompare(s);});this.workspaces.set(i);});});}static fac=function(t){return new(t||n)(ue(cr),ue(nr),ue(gt));};static cmp=Me({type:n,selectors:[["app-admin"]],decls:71,vars:6,consts:[[1,"admin-container"],["role","banner",1,"topbar"],[1,"brand"],["aria-hidden","true",1,"logo"],[1,"actions"],["routerLink","/admin/new","aria-label","Create new workspace",1,"create-workspace-btn"],["routerLink","/settings","aria-label","Settings",1,"settings"],["role","status",1,"success-message"],["aria-label","Filters",1,"filters"],[1,"filter-row"],[1,"filter-group"],["for","status"],["id","status",3,"change","value"],["value","all"],["value","upcoming"],["value","active"],["value","in-review"],["value","done"],["for","language"],["id","language",3,"change","value"],["value","en"],["value","nl"],["value","he"],["value","ar"],["for","facilitator"],["id","facilitator",3,"change","value"],[3,"value"],[1,"filter-group","search-group"],["for","search"],["id","search","type","search","placeholder","any text","list","keywords-list",3,"input","value"],["id","keywords-list"],["for","order"],["id","order",3,"change","value"],["value","date"],["value","screenshots"],["value","completion"],["role","list",1,"workspaces-list"],[3,"workspace"]],template:function(t,i){t&1&&(P(0,"div",0)(1,"header",1)(2,"div",2)(3,"span",3),N(4,"\u2726"),S(),P(5,"h1"),N(6,"MapFutures Admin"),S()(),P(7,"div",4)(8,"a",5),N(9,"+ add"),S(),P(10,"a",6),N(11,"\u2699\uFE0F"),S()()(),ge(12,C3,2,1,"div",7),P(13,"section",8)(14,"div",9)(15,"div",10)(16,"label",11),N(17,"Status:"),S(),P(18,"select",12),Z("change",function(o){return i.statusFilter.set(o.target.value);}),P(19,"option",13),N(20,"all"),S(),P(21,"option",14),N(22,"Upcoming"),S(),P(23,"option",15),N(24,"Active"),S(),P(25,"option",16),N(26,"In Review"),S(),P(27,"option",17),N(28,"Done"),S()()(),P(29,"div",10)(30,"label",18),N(31,"Language:"),S(),P(32,"select",19),Z("change",function(o){return i.languageFilter.set(o.target.value);}),P(33,"option",13),N(34,"all"),S(),P(35,"option",20),N(36,"English"),S(),P(37,"option",21),N(38,"Dutch"),S(),P(39,"option",22),N(40,"Hebrew"),S(),P(41,"option",23),N(42,"Arabic"),S()()(),P(43,"div",10)(44,"label",24),N(45,"Facilitator:"),S(),P(46,"select",25),Z("change",function(o){return i.facilitatorFilter.set(o.target.value);}),P(47,"option",13),N(48,"all"),S(),ze(49,b3,2,2,"option",26,ji),S()(),P(51,"div",27)(52,"label",28),N(53,"Search:"),S(),P(54,"input",29),Z("input",function(o){return i.searchQuery.set(o.target.value);}),S(),P(55,"datalist",30),ze(56,x3,2,2,"option",26,ji),S()(),P(58,"div",10)(59,"label",31),N(60,"Order by:"),S(),P(61,"select",32),Z("change",function(o){return i.orderBy.set(o.target.value);}),P(62,"option",33),N(63,"Date"),S(),P(64,"option",34),N(65,"Screenshots"),S(),P(66,"option",35),N(67,"Completion"),S()()()()(),P(68,"div",36),ze(69,P3,1,1,"app-workspace-item",37,y3),S()()),t&2&&(I(12),he(i.successMessage()?12:-1),I(6),K("value",i.statusFilter()),I(14),K("value",i.languageFilter()),I(14),K("value",i.facilitatorFilter()),I(3),je(i.allFacilitators()),I(5),K("value",i.searchQuery()),I(2),je(i.allKeywords()),I(5),K("value",i.orderBy()),I(8),je(i.filteredWorkspaces()));},dependencies:[xu,z0,rn,ri],styles:[`

.font-sans[_ngcontent-%COMP%] {
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.buttons[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: column;
  padding: 8px 0;
  gap: 4px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%] {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  gap: 8px;
}
.buttons[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]    > .button[_ngcontent-%COMP%] {
  flex: 1 1 auto;
}
.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%] {
  height: 52px;
  padding: 0px 8px;
  display: flex;
  flex-flow: row;
  gap: 4px;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 16px;
  line-height: normal;
  font-weight: 400;
  border: 1px solid #E7CBFF;
  background: #FBF5F6;
  color: #4E02B2;
  cursor: pointer;
}
.buttons[_ngcontent-%COMP%]   .button.primary[_ngcontent-%COMP%] {
  border: 1px solid #4E02B2;
  background: #4E02B2;
  color: #FFFFFF;
  font-weight: 700;
}
.buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {
  text-decoration: none;
  color: inherit;
  cursor: pointer;
}
[_nghost-%COMP%] {
  display: flex;
  flex-flow: column;
  align-items: stretch;
  gap: 16px;
  padding: 16px;
  width: 100%;
  height: 100%;
  overflow: auto;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
}
.admin-container[_ngcontent-%COMP%] {
  width: 100%;
}
.topbar[_ngcontent-%COMP%] {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px solid rgba(78, 2, 178, 0.2);
}
.topbar[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 8px;
}
.topbar[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%] {
  color: #4E02B2;
  margin: 0;
  font-size: 20px;
}
.topbar[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%] {
  background: #E7CBFF;
  color: #4E02B2;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%] {
  display: flex;
  align-items: center;
  gap: 12px;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .reviewed-toggle[_ngcontent-%COMP%] {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  color: #9B90AA;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .create-workspace-btn[_ngcontent-%COMP%] {
  padding: 4px 10px;
  background-color: #4E02B2;
  color: white;
  text-decoration: none;
  border-radius: 12px;
  font-weight: 600;
}
.topbar[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%] {
  color: #4E02B2;
  text-decoration: none;
}
.filters[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 24px;
}
.filters[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%] {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  align-items: flex-end;
}
.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%] {
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-width: 150px;
}
.filters[_ngcontent-%COMP%]   .filter-group.search-group[_ngcontent-%COMP%] {
  flex: 1;
  min-width: 250px;
}
.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {
  color: #6C707B;
  font-size: 14px;
  font-weight: 600;
  text-transform: uppercase;
}
.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], 
.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%] {
  display: inline-flex;
  height: auto;
  min-width: 100px;
  padding: 4px 8px;
  border-radius: 16px;
  border: 1px solid #F1E5F3;
  background: #FBF5F6;
  color: #4E02B2;
  font-family:
    "Readex Pro",
    "Miriam Libre",
    "Source Sans 3",
    sans-serif;
  font-optical-sizing: auto;
  font-style: normal;
  leading-trim: both;
  text-edge: cap;
  font-size: 14px;
  font-weight: 400;
  line-height: normal;
  transition: border-color 0.2s ease;
}
.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, 
.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%]:focus {
  outline: none;
  border-color: #E7CBFF;
}
.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%] {
  width: 100%;
}
.success-message[_ngcontent-%COMP%] {
  background-color: #e8f5e9;
  color: #2e7d32;
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #81c784;
}
.workspaces-list[_ngcontent-%COMP%] {
  display: flex;
  flex-flow: column;
  gap: 8px;
  width: 100%;
}`],changeDetection:0});};var Yx=[{path:"show/pps25w",component:Oh},{path:"show/pps25",component:Th},{path:"show/jma25",component:kh},{path:"show",component:Gn},{path:"showcase-ws",loadComponent:()=>import("./chunk-GA6SLDCV.js").then(n=>n.ShowcaseWsComponent)},{path:"admin/login",component:fu},{path:"admin/moderate",component:yu},{path:"admin/new",component:ec,canActivate:[ha]},{path:"admin/edit/:workspaceId",component:ec,canActivate:[ha]},{path:"admin",component:Pu,canActivate:[ha]},{path:"scan",component:ph},{path:"canvas-creator",component:pu},{path:"confirm",component:fh},{path:"props",component:Lh},{path:"discuss",component:xh},{path:"prescan",component:Ch},{path:"pps25",component:Ji,data:{redirectTo:"/he/?workspace=03da8ede-395b-4fd2-b46e-bc2bc7f4035c&api_key=a356977d-219f-4d65-ae18-d8e98280bca1"}},{path:"timeisnow25",component:Ji,data:{redirectTo:"/he/?workspace=03da8ede-395b-4fd2-b46e-bc2bc7f4035c&api_key=a356977d-219f-4d65-ae18-d8e98280bca1"}},{path:"jma25",component:Ji,data:{redirectTo:"/nl/prescan?workspace=ceaed215-e28a-4988-aca4-458c20d5cf1d&api_key=2dbffec8-9175-4dc4-b553-5b8cf085b5fe&tag=jma25"}},{path:"testing",component:Ji,data:{redirectTo:"/?workspace=61358757-cf32-483f-847f-3e4eb3855408&api_key=212aa064-4d02-4edb-8f0b-9f649d026fb2"}},{path:"testing-ws",component:Ji,data:{redirectTo:"/?workspace=61358757-cf32-483f-847f-3e4eb3855408&api_key=212aa064-4d02-4edb-8f0b-9f649d026fb2&ws=true"}},{path:"ajeec",component:Ji,data:{redirectTo:"/he/?workspace=6043fe29-bedb-45cb-8057-b63723b1a26e&api_key=86c03c59-0502-498f-9ccd-23e6f8a17682&ws=true"}},{path:"c4aa-26-01-21",component:Ji,data:{redirectTo:"/showcase-ws?workspace=0a698fad-7e49-428f-bceb-c9d51b3512e1&api_key=4c408712-b7c3-44bb-b0a2-d030d4826ed4"}},{path:"privacy-policy",component:ta,data:{prefix:"privacy-policy-"}},{path:"",component:Eh}];var Xx={providers:[S0({eventCoalescing:!0}),B0(Yx,V0()),D0(L0(),R0({filter:n=>!n.url.includes("config.json")})),I0(A0()),A1(()=>F1({projectId:"chronomaps3",appId:"1:815296345105:web:78e29a3b24d788c9162db0",storageBucket:"chronomaps3.firebasestorage.app",apiKey:"AIzaSyCvFFOSsL36ra0r4cCdNbGL_lAeJhmuqR0",authDomain:"chronomaps3.firebaseapp.com",messagingSenderId:"815296345105",measurementId:"G-JDGT5FJ3EB"})),IC(()=>AC())]};var wu=class n{constructor(e){this.platform=e;this.platform.browser(()=>{let t=new Ee.Renderer(),i=t.link;t.link=(r,o,s)=>{let l=r.startsWith(`${location.protocol}//${location.hostname}`),c=i.call(t,r,o,s);return l?c:c.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ');},Ee.use({renderer:t});try{let r=window.screen.orientation;screen&&r?.lock;}catch(r){console.error("Error locking screen orientation",r);}});}static fac=function(t){return new(t||n)(ue(it));};static cmp=Me({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){t&1&&te(0,"router-outlet");},dependencies:[N0],encapsulation:2});};Fy({dsn:"https://9d7e8aa0d51101008271d36419391e6c@o367221.ingest.us.sentry.io/4509518184579072",sendDefaultPii:!0});k0(wu,Xx).catch(n=>console.error(n));/**i18n:8dff8178f621bcc69192725557201a809317b399ed00a24037a7b59a2f24ea18*/