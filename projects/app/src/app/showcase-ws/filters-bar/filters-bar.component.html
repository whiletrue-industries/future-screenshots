<section class="filters-bar" aria-label="Filters">
  <div class="filters-row">
    <!-- Status Filter (Multi-select) -->
    <div class="filter-group custom-multiselect">
      <label>STATUS:</label>
      <div class="multiselect-container">
        <button 
          type="button"
          class="multiselect-trigger" 
          (click)="toggleStatusDropdown()">
          <span class="multiselect-label">
            @if (getSelectedStatusCount() === 0) {
              Select status...
            } @else if (getSelectedStatusCount() === options().statuses.length) {
              All statuses
            } @else {
              {{ getSelectedStatusCount() }} selected
            }
          </span>
          <span class="multiselect-arrow">▼</span>
        </button>
        @if (statusDropdownOpen()) {
          <div class="multiselect-dropdown" (click)="$event.stopPropagation()">
            @for (status of options().statuses; track status) {
              <label class="multiselect-option">
                <input 
                  type="checkbox" 
                  [checked]="isStatusSelected(status)"
                  (change)="toggleStatusFilter(status)" />
                <span class="option-label">{{ status }}</span>
                <span class="option-count">{{ getCount(statusCounts(), status) }}</span>
              </label>
            }
          </div>
        }
      </div>
    </div>

    <!-- Author Filter -->
    <div class="filter-group">
      <label for="filter-author">AUTHOR:</label>
      <select 
        id="filter-author" 
        [value]="selectedAuthor()" 
        (change)="onAuthorChange($any($event.target).value)">
        <option value="all">all</option>
        @for (author of options().authors; track author) {
          <option [value]="author">
            {{ author }} ({{ getCount(authorCounts(), author) }})
          </option>
        }
      </select>
    </div>

    <!-- Preference Filter (Multi-select) -->
    <div class="filter-group custom-multiselect">
      <label>PREFERENCE:</label>
      <div class="multiselect-container">
        <button 
          type="button"
          class="multiselect-trigger" 
          (click)="togglePreferenceDropdown()">
          <span class="multiselect-label">
            @if (getSelectedPreferenceCount() === 0) {
              Select preferences...
            } @else if (getSelectedPreferenceCount() === options().preferences.length) {
              All preferences
            } @else {
              {{ getSelectedPreferenceCount() }} selected
            }
          </span>
          <span class="multiselect-arrow">▼</span>
        </button>
        @if (preferenceDropdownOpen()) {
          <div class="multiselect-dropdown" (click)="$event.stopPropagation()">
            @for (preference of options().preferences; track preference) {
              <label class="multiselect-option">
                <input 
                  type="checkbox" 
                  [checked]="isPreferenceSelected(preference)"
                  (change)="togglePreferenceFilter(preference)" />
                <span class="option-label">{{ preference }}</span>
                <span class="option-count">{{ getCount(preferenceCounts(), preference) }}</span>
              </label>
            }
          </div>
        }
      </div>
    </div>

    <!-- Potential Filter (Multi-select) -->
    <div class="filter-group custom-multiselect">
      <label>POTENTIAL:</label>
      <div class="multiselect-container">
        <button 
          type="button"
          class="multiselect-trigger" 
          (click)="togglePotentialDropdown()">
          <span class="multiselect-label">
            @if (getSelectedPotentialCount() === 0) {
              Select potentials...
            } @else if (getSelectedPotentialCount() === options().potentials.length) {
              All potentials
            } @else {
              {{ getSelectedPotentialCount() }} selected
            }
          </span>
          <span class="multiselect-arrow">▼</span>
        </button>
        @if (potentialDropdownOpen()) {
          <div class="multiselect-dropdown" (click)="$event.stopPropagation()">
            @for (potential of options().potentials; track potential) {
              <label class="multiselect-option">
                <input 
                  type="checkbox" 
                  [checked]="isPotentialSelected(potential)"
                  (change)="togglePotentialFilter(potential)" />
                <span class="option-label">{{ potential }}</span>
                <span class="option-count">{{ getCount(potentialCounts(), potential) }}</span>
              </label>
            }
          </div>
        }
      </div>
    </div>

    <!-- Type Filter -->
    <div class="filter-group">
      <label for="filter-type">TYPE:</label>
      <select 
        id="filter-type" 
        [value]="selectedType()" 
        (change)="onTypeChange($any($event.target).value)">
        <option value="all">all</option>
        @for (type of options().types; track type) {
          <option [value]="type">
            {{ type }} ({{ getCount(typeCounts(), type) }})
          </option>
        }
      </select>
    </div>

    <!-- Search -->
    <div class="filter-group search-group">
      <label for="filter-search">SEARCH:</label>
      <input 
        id="filter-search" 
        type="search" 
        placeholder="any text" 
        [value]="searchText()" 
        (input)="onSearchChange($any($event.target).value)" />
    </div>

    <!-- Order By -->
    <div class="filter-group">
      <label for="filter-order">ORDER BY:</label>
      <select 
        id="filter-order" 
        [value]="orderBy()" 
        (change)="onOrderByChange($any($event.target).value)">
        <option value="date">Date</option>
        <option value="author">Author</option>
        <option value="preference">Preference</option>
      </select>
    </div>
  </div>
</section>
