<div class='container' [class.dragging]='isDragging()' [class.hovering]='isHoveringItem()' #container></div>

<!-- QR Code (Only shown if additional contributions are allowed and not on mobile) -->
@if (allowAdditionalContributions() && !isMobile()) {
  <app-qrcode [small]='qrSmall()' [url]='qrUrl()'></app-qrcode>
}

<!-- Evaluation Sidebar -->
<app-evaluation-sidebar
  [isOpen]='sidebarOpen() && canEditSelectedItem()'
  [itemId]='selectedItemId()'
  [itemKey]='selectedItemKey()'
  [workspaceId]='workspace()'
  [apiKey]='api_key()'
  [adminKey]='admin_key()'
  [lang]='lang()'
  (close)='onSidebarClose()'
  (metadataUpdated)='onMetadataUpdated($event)'
></app-evaluation-sidebar>
<div class='logo'>
</div>

<!-- Workspace Title -->
@if (workspaceTitle()) {
<div class='workspace-title'>
  {{ workspaceTitle() }}
</div>
}

<!-- Zoom Controls (Top Right) -->
<div class='zoom-controls' [class.sidebar-open]='sidebarOpen()'>
  <div class='zoom-buttons'>
    <button 
      class='zoom-button'
      (click)='zoomIn()'
      title='Zoom In (+)'>
      <svg viewBox='0 0 24 24' class='button-icon'>
        <path d='M12 5v14M5 12h14' stroke='currentColor' stroke-width='2' stroke-linecap='round'/>
      </svg>
    </button>
    <button 
      class='zoom-button'
      (click)='zoomOut()'
      title='Zoom Out (-)'>
      <svg viewBox='0 0 24 24' class='button-icon'>
        <path d='M5 12h14' stroke='currentColor' stroke-width='2' stroke-linecap='round'/>
      </svg>
    </button>
    <button 
      class='zoom-button'
      (click)='resetView()'
      title='Reset View (R)'>
      <svg viewBox='0 0 24 24' class='button-icon'>
        <path d='M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z' fill='currentColor'/>
      </svg>
    </button>
  </div>

  @if (isAdmin()) {
    <button 
      class='showcase-toggle'
      [class.active]='enableRandomShowcase()'
      (click)='toggleRandomShowcase()'
      title='Toggle Random Showcase'>
      <svg viewBox='0 0 24 24' class='button-icon'>
        <circle cx='12' cy='8' r='2' fill='currentColor'/>
        <circle cx='12' cy='16' r='2' fill='currentColor'/>
        <circle cx='6' cy='12' r='2' fill='currentColor'/>
        <circle cx='18' cy='12' r='2' fill='currentColor'/>
      </svg>
    </button>
  }
</div>

<!-- Layout Selection Toggle (Visible to All Users) -->
<div class='layout-toggle-centered'>
  <div class='layout-toggle'>
    <div class='toggle-background'>
    </div>
    <div class='toggle-buttons'>
      <button 
        class='toggle-button map-button'
        [class.active]='currentLayout() === "svg"'
        (click)='switchToSvgLayout()'
        title='Map Layout'>
        <div class='button-content'>
          <img src='/icon-cone.svg' alt='Map' class='button-icon'>
          <span class='button-label'>Map</span>
        </div>
      </button>
      <button 
        class='toggle-button clusters-button'
        [class.active]='currentLayout() === "circle-packing"'
        (click)='switchToCirclePackingLayout()'
        title='Clusters Layout'>
        <div class='button-content'>
          <img src='/icon-clusters.svg' alt='Clusters' class='button-icon'>
          <span class='button-label'>Clusters</span>
        </div>
      </button>
    </div>
  </div>
  
  <!-- SVG Auto-Positioning Toggle (only visible when SVG layout is active and user is admin) -->
  @if (currentLayout() === 'svg' && isAdmin()) {
    <div class='svg-auto-toggle'>
      <button 
        class='svg-auto-button'
        [class.active]='enableSvgAutoPositioning()'
        (click)='toggleSvgAutoPositioning()'
        title='Toggle SVG Auto-Positioning'>
        <svg viewBox='0 0 24 24' class='button-icon'>
          <path d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z' fill='currentColor'/>
        </svg>
      </button>
    </div>
  }
</div>

